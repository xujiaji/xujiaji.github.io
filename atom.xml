<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å¾ä½³å‰çš„åšå®¢</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.xujiaji.com/"/>
  <updated>2019-12-17T17:36:39.831Z</updated>
  <id>https://blog.xujiaji.com/</id>
  
  <author>
    <name>XuJiaji</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ç”µå¤§è‡ªè€ƒçœŸé¢˜ç»ƒä¹ </title>
    <link href="https://blog.xujiaji.com/post/self-study-one/index.html"/>
    <id>https://blog.xujiaji.com/post/self-study-one/index.html</id>
    <published>2019-12-14T16:51:08.000Z</published>
    <updated>2019-12-17T17:36:39.831Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è‡ªè€ƒçœŸé¢˜">è‡ªè€ƒçœŸé¢˜<a href="post/self-study-one#è‡ªè€ƒçœŸé¢˜"></a></h1><blockquote><p>å†å¹´çœŸé¢˜å®Œæˆè¿›åº¦è¡¨<br>æœ‰é”™è¯¯çš„åœ°æ–¹å„ä½å°ä¼™ä¼´å¯ä»¥åœ¨è¯¥é¡µé¢ä¸‹æ–¹ç•™è¨€ï¼Œæˆ–åœ¨QQç¾¤è”ç³»æˆ‘ä¿®æ”¹~</p></blockquote><div class="article-bounded"><div class="article-table"><table><thead><tr><th>è¯•å·å</th><th>è·³è½¬æµè§ˆ</th><th style="text-align:center">2016</th><th style="text-align:center">2017</th><th style="text-align:center">2018</th><th style="text-align:center">2019</th></tr></thead><tbody><tr><td>Javaè¯­è¨€ç¨‹åºè®¾è®¡</td><td><a href="https://gitee.com/xujiaji/Source/raw/master/JAVA%E8%AF%AD%E8%A8%802016-2019%E7%9C%9F%E9%A2%98.pdf" target="_blank" rel="noopener">æµè§ˆæ–‡ä»¶&gt;&gt;</a></td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ”ï¸</td></tr><tr><td>äº’è”ç½‘åŠå…¶åº”ç”¨</td><td><a href="https://gitee.com/xujiaji/Source/raw/master/%E4%BA%92%E8%81%94%E7%BD%91%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A82016-2019%20%E7%9C%9F%E9%A2%98.pdf" target="_blank" rel="noopener">æµè§ˆæ–‡ä»¶&gt;&gt;</a></td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ–ï¸</td><td style="text-align:center">âœ–ï¸</td></tr><tr><td>è½¯ä»¶å·¥ç¨‹</td><td><a href="https://gitee.com/xujiaji/Source/raw/master/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B2016-2019%20%E7%9C%9F%E9%A2%98.pdf" target="_blank" rel="noopener">æµè§ˆæ–‡ä»¶&gt;&gt;</a></td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ–ï¸</td><td style="text-align:center">âœ–ï¸</td></tr><tr><td>ç½‘é¡µè®¾è®¡ä¸åˆ¶ä½œ</td><td><a href="https://gitee.com/xujiaji/Source/raw/master/%E7%BD%91%E9%A1%B5%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%88%B6%E4%BD%9C2016-2019%E7%9C%9F%E9%A2%98.pdf" target="_blank" rel="noopener">æµè§ˆæ–‡ä»¶&gt;&gt;</a></td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ–ï¸</td><td style="text-align:center">âœ–ï¸</td><td style="text-align:center">âœ–ï¸</td></tr><tr><td>C++ç¨‹åºè®¾è®¡</td><td><a href="https://gitee.com/xujiaji/Source/raw/master/C%2B%2B%E7%A8%8B%E5%BA%8F2016-2019%E7%9C%9F%E9%A2%98.pdf" target="_blank" rel="noopener">æµè§ˆæ–‡ä»¶&gt;&gt;</a></td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ–ï¸</td><td style="text-align:center">âœ–ï¸</td><td style="text-align:center">âœ–ï¸</td></tr></tbody></table></div></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;è‡ªè€ƒçœŸé¢˜&quot;&gt;è‡ªè€ƒçœŸé¢˜&lt;a href=&quot;post/self-study-one#è‡ªè€ƒçœŸé¢˜&quot;&gt;&lt;/a&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;å†å¹´çœŸé¢˜å®Œæˆè¿›åº¦è¡¨&lt;br&gt;æœ‰é”™è¯¯çš„åœ°æ–¹å„ä½å°ä¼™ä¼´å¯ä»¥åœ¨è¯¥é¡µé¢ä¸‹æ–¹ç•™è¨€ï¼Œæˆ–åœ¨QQç¾¤è”ç³»æˆ‘ä¿®æ”¹~&lt;/p&gt;
&lt;/blockquot
      
    
    </summary>
    
      <category term="è‡ªè€ƒ" scheme="https://blog.xujiaji.com/categories/%E8%87%AA%E8%80%83/"/>
    
    
      <category term="è‡ªè€ƒ" scheme="https://blog.xujiaji.com/tags/%E8%87%AA%E8%80%83/"/>
    
  </entry>
  
  <entry>
    <title>Flutterèµ„æºè‡ªåŠ¨ç”Ÿæˆé…ç½®è„šæœ¬</title>
    <link href="https://blog.xujiaji.com/post/flutter-assets-sync/index.html"/>
    <id>https://blog.xujiaji.com/post/flutter-assets-sync/index.html</id>
    <published>2019-11-27T09:36:09.000Z</published>
    <updated>2019-11-27T16:18:15.683Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Flutterèµ„æºè‡ªåŠ¨ç”Ÿæˆé…ç½®">Flutterèµ„æºè‡ªåŠ¨ç”Ÿæˆé…ç½®<a href="post/flutter-assets-sync#Flutterèµ„æºè‡ªåŠ¨ç”Ÿæˆé…ç½®"></a></h1><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/xujiaji/FlutterAssetsSync/" target="_blank" rel="noopener">https://github.com/xujiaji/FlutterAssetsSync/</a></p><h2 id="ç®€ä»‹">ç®€ä»‹<a href="post/flutter-assets-sync#ç®€ä»‹"></a></h2><p>å„ä½å°ä¼™ä¼´éƒ½çŸ¥é“flutterçš„èµ„æºé…ç½®éœ€è¦åœ¨<code>pubspec.yaml</code>ä¸­é…ç½®èµ„æºè·¯å¾„ã€‚</p><p>æˆ‘æƒ³å§ï¼è¿™ä¹ˆéº»çƒ¦çš„äº‹æƒ…å› è¯¥æœ‰åšè´¡çŒ®çš„åŒå­¦æä¾›æ’ä»¶å§ï¼æœä¸å…¶ç„¶æˆ‘æ‰¾åˆ°ä¸€ä¸ªå«<a href="https://github.com/Leo0618/flutter-img-sync" target="_blank" rel="noopener">flutter-img-sync</a>çš„æ’ä»¶ï¼Œå¯ä»¥å¿«é€Ÿæ·»åŠ åˆ°é…ç½®ä¸­ï¼Œå¹¶ä¸”ç”Ÿæˆä¸€ä¸ªç±»ä¼¼androidçš„Ræ–‡ä»¶ï¼Œæ–¹ä¾¿å¿«é€Ÿå‡†ç¡®çš„è°ƒç”¨ã€‚</p><p>çˆ½äº†å‡ å¤©ï¼Œå‘ç°è¿™ä¸ªæ¡†æ¶å¹¶ä¸èƒ½æ»¡è¶³äº†ï¼Œé¦–å…ˆæ¯æ¬¡ç”Ÿæˆèµ„æºä¼šé‡æ–°æ’åºå¯¼è‡´gitç‰ˆæœ¬åˆå¹¶ä»£ç éƒ½éœ€è¦æ‰‹åŠ¨åˆå¹¶ï¼Œå…¶æ¬¡ç”Ÿæˆçš„2.0xå’Œ3.0xæ˜¯ç”¨çš„åŒ…å«2.0xå’Œ3.0xçš„å…¨è·¯å¾„åã€‚</p><p>ç”±äºå¤§ä½¬æ’ä»¶ä»£ç ä¸æ˜¯å¼€æºçš„ï¼Œäºæ˜¯æƒ³äº†æƒ³è¿˜æ˜¯è‡ªå·±ç”¨pythonå¿«é€Ÿæä¸€ä¸ªä¸€æ ·åŠŸèƒ½çš„å‡ºæ¥å§ï¼Œå¯ä»¥è‡ªå·±è‡ªå®šä¹‰ï¼Œå¹¶ä¸”å¯ä»¥å…¨æ–¹ä½æ»¡è¶³è‡ªå·±éœ€æ±‚ï¼</p><h2 id="è§†é¢‘æ¼”ç¤º">è§†é¢‘æ¼”ç¤º<a href="post/flutter-assets-sync#è§†é¢‘æ¼”ç¤º"></a></h2><div style="width: 100%; display: inline-block; position: relative; padding-top: 70%; display: block; content: '';"><br>    <div style="position: absolute; top: 0; bottom: 0; right: 0; left: 0;"><br>    <iframe src="//player.bilibili.com/player.html?aid=77259024&cid=132151550&page=1" width="100%" height="100%" frameborder="0" allowfullscreen></iframe><br>    </div><br></div><h2 id="ç¯å¢ƒ">ç¯å¢ƒ<a href="post/flutter-assets-sync#ç¯å¢ƒ"></a></h2><blockquote><p>å®‰è£…äº†Python3.0+å°±è¡Œäº†</p></blockquote><h2 id="é…ç½®">é…ç½®<a href="post/flutter-assets-sync#é…ç½®"></a></h2><ol><li>åœ¨<code>pubspec.yaml</code>çš„<code>assets</code>å¤„æ·»åŠ è‡ªåŠ¨è‡ªåŠ¨æ„å»ºçš„ä½ç½®åŒºé—´</li></ol><blockquote><p>è¿™ä¸ªåŒºé—´å†…ä¸å¯æ·»åŠ å…¶ä»–èµ„æºï¼Œå› ä¸ºæ¯æ¬¡æ„å»ºéƒ½ä¼šæ›¿æ¢<code># assets-generator-begin</code>å’Œ<code># assets-generator-end</code>ä¹‹é—´çš„å†…å®¹</p></blockquote><figure class="highlight yaml"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">assets:</span></span><br><span class="line"><span class="comment"># assets-generator-begin</span></span><br><span class="line"><span class="comment"># assets-generator-end</span></span><br></pre></td></tr></table></div></figure><ol start="2"><li>æ¥ä¸‹äº†å°±æ˜¯é…ç½®èµ„æºçš„ç›®å½•äº†</li></ol><p>é¦–å…ˆï¼Œåœ¨é¡¹ç›®ä¸­å‡å¦‚è¯´ä½ çš„èµ„æºç›®å½•å°±å¦‚ä¸‹æ‰€ç¤ºæ˜¯<code>assets</code><br><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/flutter_pubspec/55813610-18E1-478F-BBFD-C24D4307F949.png" alt=""><br>é‚£ä¹ˆï¼Œä½ éœ€è¦åœ¨<code>assets_generator.py</code>ï¼ˆé¡¶éƒ¨è¿›å…¥é¡¹ç›®åœ°å€ä¸‹è½½å“¦ï¼‰ä¸­é…ç½®å¯¹åº”çš„ä½ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/flutter_pubspec/B8358DF2-32C5-4D24-B7DC-D6062B42AA31.png" alt=""></p><ol start="3"><li>æŠŠè„šæœ¬<code>assets_generator.py</code>æ‹·è´åˆ°æ‚¨çš„é¡¹ç›®æ ¹ç›®å½•</li></ol><h2 id="ä½¿ç”¨">ä½¿ç”¨<a href="post/flutter-assets-sync#ä½¿ç”¨"></a></h2><p>åœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰“å¼€å‘½ä»¤è¡Œï¼Œè¿è¡Œ<code>./assets_generator.py</code><br><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/flutter_pubspec/1F3A4EDA-47F3-4236-9ED6-39076479FF7F.png" alt=""></p><p>æ­¤æ—¶ä¼šåœ¨<code>pubspec.yaml</code>é…ç½®çš„åŒºåŸŸæ·»åŠ ä¸Šè·¯å¾„<br><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/flutter_pubspec/21218262-4206-424D-A578-DE1A968BAE4B.png" alt=""></p><p>åŒæ—¶ä¼šç”Ÿæˆä¸€ä¸ª<code>r.dart</code>çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼šï¼ˆç¯‡å¹…åŸå› å°±ç²˜è´´éƒ¨åˆ†äº†ï¼‰<br><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">R</span> </span>&#123;</span><br><span class="line">  <span class="comment">/// ![](http://127.0.0.1:3333/assets/fonts/fzxz300.ttf)</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">String</span> assetsFontsFzxz300 = <span class="string">'assets/fonts/fzxz300.ttf'</span>;</span><br><span class="line">  <span class="comment">/// ![](http://127.0.0.1:3333/assets/h5/index.html)</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">String</span> assetsH5Index = <span class="string">'assets/h5/index.html'</span>;</span><br><span class="line">  <span class="comment">/// ![](http://127.0.0.1:3333/assets/h5/relationship.js)</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">String</span> assetsH5Relationship = <span class="string">'assets/h5/relationship.js'</span>;</span><br><span class="line">  <span class="comment">/// ![](http://127.0.0.1:3333/assets/image/add_ico.png)</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">String</span> assetsImageAddIco = <span class="string">'assets/image/add_ico.png'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p>åœ¨ä»£ç ä¸­ä½¿ç”¨éå¸¸æ–¹ä¾¿åªéœ€è¦å‘ä¸‹é¢è¿™æ ·ï¼Œå½“ç„¶éœ€è¦å…ˆå¯¼å…¥<code>r.dart</code></p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Image.asset(R.assetsImageMan)</span><br></pre></td></tr></table></div></figure><p>åŒæ—¶åœ¨é€‰å¯¹åº”çš„å›¾ç‰‡æ—¶ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œå›¾ç‰‡é¢„è§ˆï¼ˆå¦‚æœä½ æŠŠé‚£ä¸ªpythonè„šæœ¬ç»ˆæ­¢äº†é‚£å°±ä¸èƒ½é¢„è§ˆäº†ï¼‰</p><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/flutter_pubspec/241D6239-21E2-4651-9840-576E094997C8.png" alt="" class="article-img"></p><blockquote><p>å¦‚æœæ·»åŠ äº†æ–°çš„å›¾ç‰‡ï¼Œé‡æ–°è¿è¡Œä¸€ä¸‹è¿™ä¸ªè„šæœ¬å°±å¯ä»¥äº†</p></blockquote><h2 id="åŠŸèƒ½">åŠŸèƒ½<a href="post/flutter-assets-sync#åŠŸèƒ½"></a></h2><ol><li>è‡ªåŠ¨åœ¨yamlæ–‡ä»¶ä¸­ç”Ÿæˆèµ„æºè·¯å¾„é…ç½®</li><li>è‡ªåŠ¨åœ¨libç›®å½•åˆ›å»ºä¸€ä¸ª<code>r.dart</code>æ¥ç®¡ç†èµ„æºè°ƒç”¨</li><li>ç”Ÿæˆåå­—æœ‰åº</li><li>é€šè¿‡<code>R.</code>å¯¹åº”èµ„æºå¯ä»¥è¿›è¡Œé¢„è§ˆ</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Flutterèµ„æºè‡ªåŠ¨ç”Ÿæˆé…ç½®&quot;&gt;Flutterèµ„æºè‡ªåŠ¨ç”Ÿæˆé…ç½®&lt;a href=&quot;post/flutter-assets-sync#Flutterèµ„æºè‡ªåŠ¨ç”Ÿæˆé…ç½®&quot;&gt;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/xuji
      
    
    </summary>
    
      <category term="Flutter" scheme="https://blog.xujiaji.com/categories/Flutter/"/>
    
    
      <category term="Flutter" scheme="https://blog.xujiaji.com/tags/Flutter/"/>
    
      <category term="å·¥å…·" scheme="https://blog.xujiaji.com/tags/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="Python" scheme="https://blog.xujiaji.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>å¥½ç”¨çš„iOSç½‘ç»œè¯·æ±‚è°ƒè¯•å·¥å…·Bagel</title>
    <link href="https://blog.xujiaji.com/post/ios-bagel-use/index.html"/>
    <id>https://blog.xujiaji.com/post/ios-bagel-use/index.html</id>
    <published>2019-10-24T15:24:42.000Z</published>
    <updated>2019-10-27T05:50:26.253Z</updated>
    
    <content type="html"><![CDATA[<h1 id="iOSç½‘ç»œè¯·æ±‚è°ƒè¯•ç¥å™¨ä½¿ç”¨">iOSç½‘ç»œè¯·æ±‚è°ƒè¯•ç¥å™¨ä½¿ç”¨<a href="post/ios-bagel-use#iOSç½‘ç»œè¯·æ±‚è°ƒè¯•ç¥å™¨ä½¿ç”¨"></a></h1><p>è¿™æ˜¯ä¸€ä¸ªæ–¹ä¾¿è°ƒè¯•apiçš„å·¥å…·ï¼Œåªéœ€è¦ç®€å•çš„é…ç½®å³å¯æ–¹ä¾¿çš„çœ‹åˆ°Appä¸­æ•°æ®çš„è¯·æ±‚</p><p>Bagel: <a href="https://github.com/yagiz/Bagel/" target="_blank" rel="noopener">https://github.com/yagiz/Bagel/</a></p><h2 id="è§†é¢‘æ¼”ç¤º">è§†é¢‘æ¼”ç¤º<a href="post/ios-bagel-use#è§†é¢‘æ¼”ç¤º"></a></h2><div style="width: 100%; display: inline-block; position: relative; padding-top: 70%; display: block; content: '';"><br>    <div style="position: absolute; top: 0; bottom: 0; right: 0; left: 0;"><br>    <iframe src="//player.bilibili.com/player.html?aid=73544560&cid=125799021&page=1" width="100%" height="100%" frameborder="0" allowfullscreen></iframe><br>    </div><br></div><h2 id="å®‰è£…Macåº”ç”¨">å®‰è£…Macåº”ç”¨<a href="post/ios-bagel-use#å®‰è£…Macåº”ç”¨"></a></h2><p>é€šè¿‡ä¸‹è½½æºç è¿è¡Œå¾—åˆ°ä¸€ä¸ªmacä¸Šé¢è¿è¡Œçš„ç¨‹åº</p><ol><li><p>ä¸‹è½½æºç </p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/yagiz/Bagel.git</span><br></pre></td></tr></table></div></figure></li><li><p>å®‰è£…å¯¹åº”çš„ä¾èµ–åº“<code>pod install</code></p></li><li>ç¼–è¯‘è¿è¡Œé¡¹ç›®</li></ol><h2 id="é…ç½®é¡¹ç›®">é…ç½®é¡¹ç›®<a href="post/ios-bagel-use#é…ç½®é¡¹ç›®"></a></h2><ol><li><p>ä¸ºé¡¹ç›®æ·»åŠ ä¾èµ–ï¼Œè¿™é‡Œå±•ç¤ºçš„æ˜¯podfileçš„é…ç½®æ–¹å¼ã€‚åœ¨Podfileä¸­æ·»åŠ </p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod 'Bagel', '~&gt;  1.3.2'</span><br></pre></td></tr></table></div></figure></li><li><p>ä¸‹è½½Bagelåº“<code>pod install</code></p></li></ol><h2 id="ä½¿ç”¨">ä½¿ç”¨<a href="post/ios-bagel-use#ä½¿ç”¨"></a></h2><ol><li>å¯¼å…¥Bagelæ¨¡å—<code>import Bagel</code></li><li>å¼€å¯Bagel<code>Bagel.start()</code><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åªåœ¨debugçš„æ¨¡å¼ä¸‹æ‰å¼€å¯ç½‘ç»œç›‘å¬</span></span><br><span class="line">#<span class="keyword">if</span> <span class="type">DEBUG</span></span><br><span class="line"><span class="type">Bagel</span>.start()</span><br><span class="line">#endif</span><br></pre></td></tr></table></div></figure></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;iOSç½‘ç»œè¯·æ±‚è°ƒè¯•ç¥å™¨ä½¿ç”¨&quot;&gt;iOSç½‘ç»œè¯·æ±‚è°ƒè¯•ç¥å™¨ä½¿ç”¨&lt;a href=&quot;post/ios-bagel-use#iOSç½‘ç»œè¯·æ±‚è°ƒè¯•ç¥å™¨ä½¿ç”¨&quot;&gt;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªæ–¹ä¾¿è°ƒè¯•apiçš„å·¥å…·ï¼Œåªéœ€è¦ç®€å•çš„é…ç½®å³å¯æ–¹ä¾¿çš„çœ‹åˆ°Appä¸­æ•°æ®çš„è¯·æ±‚&lt;/p&gt;
&lt;p&gt;Ba
      
    
    </summary>
    
      <category term="å·¥å…·" scheme="https://blog.xujiaji.com/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="å·¥å…·" scheme="https://blog.xujiaji.com/tags/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="iOS" scheme="https://blog.xujiaji.com/tags/iOS/"/>
    
      <category term="Debug" scheme="https://blog.xujiaji.com/tags/Debug/"/>
    
  </entry>
  
  <entry>
    <title>ffmpeg ä½¿ç”¨å°è®°</title>
    <link href="https://blog.xujiaji.com/post/ffmpeg-note/index.html"/>
    <id>https://blog.xujiaji.com/post/ffmpeg-note/index.html</id>
    <published>2019-10-16T14:54:28.000Z</published>
    <updated>2019-10-27T05:49:28.878Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ffmpeg-ä½¿ç”¨å°è®°">ffmpeg ä½¿ç”¨å°è®°<a href="post/ffmpeg-note#ffmpeg-ä½¿ç”¨å°è®°"></a></h1><h2 id="åˆå¹¶ä¸¤ä¸ªè§†å±æ–‡ä»¶">åˆå¹¶ä¸¤ä¸ªè§†å±æ–‡ä»¶<a href="post/ffmpeg-note#åˆå¹¶ä¸¤ä¸ªè§†å±æ–‡ä»¶"></a></h2><p>åˆå¹¶<code>1.mp4</code>å’Œ<code>2.mp4</code></p><blockquote><p>å°†mp4è½¬åŒ–ä¸ºåŒæ ·ç¼–ç å½¢å¼çš„tsæºœï¼Œå› ä¸ºtsæ˜¯å¯ä»¥concateçš„<br>ç„¶åconcate tsæµ<br>æœ€åå†æŠŠtsæµè½¬ä¸ºmp4</p></blockquote><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i 1.mp4 -vcodec copy -acodec copy -vbsf h264_mp4toannexb 1.ts</span><br><span class="line">ffmpeg -i 2.mp4 -vcodec copy -acodec copy -vbsf h264_mp4toannexb 2.ts</span><br><span class="line">ffmpeg -i "concat:1.ts|2.ts" -acodec copy -vcodec copy -absf aac_adtstoasc output.mp4</span><br></pre></td></tr></table></div></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ffmpeg-ä½¿ç”¨å°è®°&quot;&gt;ffmpeg ä½¿ç”¨å°è®°&lt;a href=&quot;post/ffmpeg-note#ffmpeg-ä½¿ç”¨å°è®°&quot;&gt;&lt;/a&gt;&lt;/h1&gt;&lt;h2 id=&quot;åˆå¹¶ä¸¤ä¸ªè§†å±æ–‡ä»¶&quot;&gt;åˆå¹¶ä¸¤ä¸ªè§†å±æ–‡ä»¶&lt;a href=&quot;post/ffmpeg-note#åˆå¹¶ä¸¤ä¸ªè§†å±æ–‡ä»¶
      
    
    </summary>
    
      <category term="å·¥å…·" scheme="https://blog.xujiaji.com/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="ç¬”è®°" scheme="https://blog.xujiaji.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="FFMPEG" scheme="https://blog.xujiaji.com/tags/FFMPEG/"/>
    
  </entry>
  
  <entry>
    <title>å¥½ç”¨çš„iOSè°ƒè¯•å·¥å…·PonyDebugger</title>
    <link href="https://blog.xujiaji.com/post/ios-ponydebuger/index.html"/>
    <id>https://blog.xujiaji.com/post/ios-ponydebuger/index.html</id>
    <published>2019-10-15T15:38:02.000Z</published>
    <updated>2019-11-27T16:26:36.545Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¥½ç”¨çš„iOSè°ƒè¯•å·¥å…·PonyDebugger">å¥½ç”¨çš„iOSè°ƒè¯•å·¥å…·PonyDebugger<a href="post/ios-ponydebuger#å¥½ç”¨çš„iOSè°ƒè¯•å·¥å…·PonyDebugger"></a></h1><p>PonyDebuggerï¼š<a href="https://github.com/square/PonyDebugger/" target="_blank" rel="noopener">https://github.com/square/PonyDebugger/</a></p><h2 id="ç®€ä»‹">ç®€ä»‹<a href="post/ios-ponydebuger#ç®€ä»‹"></a></h2><p>PoneyDebuggeræ˜¯ä¸€ä¸ªå¾ˆç»™åŠ›çš„è°ƒè¯•å·¥å…·ï¼Œå®ƒèƒ½é€šè¿‡æµè§ˆå™¨è°ƒè¯•Appã€‚</p><p>éœ€è¦ç”µè„‘ä¸Šé…ç½®æœåŠ¡ç¯å¢ƒï¼Œåœ¨iOSé¡¹ç›®æ·»åŠ sdkçš„é…ç½®ã€‚ä¾¿å¯ä»¥å¯¹Appè¿›è¡Œç½‘ç»œè¯·æ±‚ç›‘æ§ã€Core Dataæ•°æ®æŸ¥çœ‹ã€æŸ¥çœ‹å½“å‰ç•Œé¢UIå±‚çº§ç­‰ã€‚</p><h3 id="ç½‘ç»œè¯·æ±‚è°ƒè¯•">ç½‘ç»œè¯·æ±‚è°ƒè¯•<a href="post/ios-ponydebuger#ç½‘ç»œè¯·æ±‚è°ƒè¯•"></a></h3><p>æˆ‘ä»¬çš„è¯·æ±‚ä¼šé€šè¿‡PonyDebuggerçš„ä»£ç†æœåŠ¡<a href="https://github.com/square/PonyDebugger/tree/master/ponyd" target="_blank" rel="noopener">ponyd</a>ï¼Œå¯ä»¥ç›´è§‚çš„åƒåœ¨æµè§ˆå™¨ä¸Šè°ƒè¯•ç½‘é¡µè¯·æ±‚ä¸€æ ·ï¼Œè°ƒè¯•Appçš„è¯·æ±‚ã€‚</p><blockquote><p>æˆ‘å°±ç›´æ¥æŠŠå®˜æ–¹çš„å›¾æ¬è¿è¿‡æ¥ç”¨äº†<code>^_^</code></p></blockquote><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/poneydebugger/NetworkDebugging.png" alt="NetworkDebugging" class="article-img"></p><h3 id="Core-Data-æµè§ˆ">Core Data æµè§ˆ<a href="post/ios-ponydebuger#Core-Data-æµè§ˆ"></a></h3><p>Core Dataæµè§ˆï¼Œåªéœ€è¦é€šè¿‡åœ¨åº”ç”¨ç¨‹åºçš„ä»£ç ä¸­å¯ç”¨å°±å¯ä»¥äº†<code>ponyDebugger?.enableCoreDataDebugging()</code></p><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/poneydebugger/CoreDataBrowser.png" alt="CoreDataBrowser" class="article-img"></p><h3 id="è§†å›¾å±‚æ¬¡è°ƒè¯•">è§†å›¾å±‚æ¬¡è°ƒè¯•<a href="post/ios-ponydebuger#è§†å›¾å±‚æ¬¡è°ƒè¯•"></a></h3><p>PonyDebuggerä¼šåœ¨æµè§ˆå™¨ä¸­ä»¥XMLçš„æ–¹å¼å±•ç¤ºåº”ç”¨è§†å›¾å±‚æ¬¡ç»“æ„ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å…¶ä¸­çœ‹åˆ°è§†å›¾å…ƒç´ çš„å±æ€§ã€‚åœ¨é¢æ¿ä¸­é€‰ä¸­ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œå¯¹åº”æ‰‹æœºä¸Šä¹Ÿä¼šè¢«é€‰ä¸­ã€‚å½“åˆ é™¤ä¸€ä¸ªæ—¶ä¹Ÿå¯¹åº”åˆ é™¤ï¼Œå¯è°ƒæ•´è§†å›¾å¤§å°ã€‚</p><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/poneydebugger/ViewHierarchyDebugging.png" alt="ViewHierarchyDebugging" class="article-img"></p><h2 id="è¿œç¨‹æ—¥å¿—">è¿œç¨‹æ—¥å¿—<a href="post/ios-ponydebuger#è¿œç¨‹æ—¥å¿—"></a></h2><p>PonyDebuggerté€šè¿‡PDLogå’ŒPDLogObjectså‡½æ•°è¿œç¨‹è®°å½•æ—¥å¿—æŸ¥çœ‹å¯¹è±¡æ•°æ®</p><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/poneydebugger/RemoteLogging.png" alt="RemoteLogging" class="article-img"></p><h2 id="å®‰è£…è§†é¢‘æ¼”ç¤º">å®‰è£…è§†é¢‘æ¼”ç¤º<a href="post/ios-ponydebuger#å®‰è£…è§†é¢‘æ¼”ç¤º"></a></h2><div style="width: 100%; display: inline-block; position: relative; padding-top: 70%; display: block; content: '';"><br>    <div style="position: absolute; top: 0; bottom: 0; right: 0; left: 0;"><br>    <iframe src="//player.bilibili.com/player.html?aid=71370834&cid=123663162&page=1" width="100%" height="100%" frameborder="0" allowfullscreen></iframe><br>    </div><br></div><h2 id="åˆ›å»ºä¸€ä¸ªç›®å½•ponydï¼Œå¹¶è¿›å»è¯¥ç›®å½•">åˆ›å»ºä¸€ä¸ªç›®å½•<code>ponyd</code>ï¼Œå¹¶è¿›å»è¯¥ç›®å½•<a href="post/ios-ponydebuger#åˆ›å»ºä¸€ä¸ªç›®å½•ponydï¼Œå¹¶è¿›å»è¯¥ç›®å½•"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir ponyd</span><br><span class="line">cd ponyd</span><br></pre></td></tr></table></div></figure><h2 id="å°†å¿…è¦çš„ä¾èµ–ä¸‹è½½è¿™ä¸ªç›®å½•ä¸­ponyd">å°†å¿…è¦çš„ä¾èµ–ä¸‹è½½è¿™ä¸ªç›®å½•ä¸­<code>ponyd</code><a href="post/ios-ponydebuger#å°†å¿…è¦çš„ä¾èµ–ä¸‹è½½è¿™ä¸ªç›®å½•ä¸­ponyd"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl -O -L https://pypi.python.org/packages/11/b6/abcb525026a4be042b486df43905d6893fb04f05aac21c32c638e939e447/pip-9.0.1.tar.gz</span><br><span class="line"></span><br><span class="line">curl -O -L https://pypi.python.org/packages/25/5d/cc55d39ac39383dd6e04ae80501b9af3cc455be64740ad68a4e12ec81b00/setuptools-0.6c11-py2.7.egg</span><br><span class="line"></span><br><span class="line">curl -O -L https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/pybonjour/pybonjour-1.1.1.tar.gz</span><br><span class="line"></span><br><span class="line">tar xvf pybonjour-1.1.1.tar.gz</span><br><span class="line">mv pybonjour-1.1.1 pybonjour</span><br></pre></td></tr></table></div></figure><h2 id="ä¸‹è½½bootstrap-ponyd-py">ä¸‹è½½<code>bootstrap-ponyd.py</code><a href="post/ios-ponydebuger#ä¸‹è½½bootstrap-ponyd-py"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -O -L https://github.com/downloads/square/PonyDebugger/bootstrap-ponyd.py</span><br></pre></td></tr></table></div></figure><h2 id="åœ¨bootstrap-ponyd-pyæ·»åŠ å®‰è£…pybonjourçš„å‘½ä»¤">åœ¨<code>bootstrap-ponyd.py</code>æ·»åŠ å®‰è£…<code>pybonjour</code>çš„å‘½ä»¤<a href="post/ios-ponydebuger#åœ¨bootstrap-ponyd-pyæ·»åŠ å®‰è£…pybonjourçš„å‘½ä»¤"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subprocess.check_call([join(home_dir, 'bin', 'python'),  join('pybonjour', 'setup.py'), 'install'])</span><br></pre></td></tr></table></div></figure><blockquote><p>æ·»åŠ åœ¨å¦‚ä¸‹çš„ä½ç½®ä¸Š</p></blockquote><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def after_install(options, home_dir):</span><br><span class="line">    subprocess.check_call([join(home_dir, 'bin', 'python'),  join('pybonjour', 'setup.py'), 'install'])</span><br><span class="line"></span><br><span class="line">    subprocess.check_call([join(home_dir, 'bin', 'pip'),</span><br><span class="line">                     'install', '-U', '-e', 'git+https://github.com/square/PonyDebugger.git#egg=ponydebugger'])</span><br></pre></td></tr></table></div></figure><h2 id="é€šè¿‡è¿è¡Œbootstrapå®‰è£…">é€šè¿‡è¿è¡Œbootstrapå®‰è£…<a href="post/ios-ponydebuger#é€šè¿‡è¿è¡Œbootstrapå®‰è£…"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat ./bootstrap-ponyd.py | python - --never-download --ponyd-symlink=/usr/local/bin/ponyd ~/Library/PonyDebugger</span><br></pre></td></tr></table></div></figure><h2 id="ä¸Šé¢çš„å®‰è£…ä¼šå‡ºé”™ï¼Œå› ä¸ºä¸€äº›åŒ…æ— æ³•æ‰¾åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å»ä¿®å¤">ä¸Šé¢çš„å®‰è£…ä¼šå‡ºé”™ï¼Œå› ä¸ºä¸€äº›åŒ…æ— æ³•æ‰¾åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å»ä¿®å¤<a href="post/ios-ponydebuger#ä¸Šé¢çš„å®‰è£…ä¼šå‡ºé”™ï¼Œå› ä¸ºä¸€äº›åŒ…æ— æ³•æ‰¾åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å»ä¿®å¤"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">~/Library/PonyDebugger/bin/easy_install --find-links https://pypi.python.org/simple/singledispatch/ -U singledispatch</span><br><span class="line">~/Library/PonyDebugger/bin/easy_install --find-links https://pypi.python.org/simple/backports-abc/ -U backports_abc</span><br><span class="line">~/Library/PonyDebugger/bin/easy_install --find-links https://pypi.python.org/simple/certifi -U certifi</span><br><span class="line">~/Library/PonyDebugger/bin/easy_install --find-links https://pypi.python.org/simple/six/ -U six</span><br><span class="line">~/Library/PonyDebugger/bin/easy_install --find-links https://pypi.python.org/simple/futures -U futures</span><br><span class="line">sudo ~/Library/PonyDebugger/bin/easy_install -U pybonjour</span><br></pre></td></tr></table></div></figure><h2 id="å®‰è£…devtools">å®‰è£…devtools<a href="post/ios-ponydebuger#å®‰è£…devtools"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ponyd update-devtools</span><br></pre></td></tr></table></div></figure><h2 id="è¿è¡Œ">è¿è¡Œ<a href="post/ios-ponydebuger#è¿è¡Œ"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ponyd serve --listen-interface=127.0.0.1</span><br></pre></td></tr></table></div></figure><h2 id="é…ç½®iOS-sdk">é…ç½®iOS sdk<a href="post/ios-ponydebuger#é…ç½®iOS-sdk"></a></h2><blockquote><p>ä¸‹é¢æ¼”ç¤ºçš„æ˜¯é€šè¿‡podå®‰è£…çš„</p></blockquote><ol><li>åœ¨é¡¹ç›®Podfileä¸­å¼•å…¥<code>pod &#39;PonyDebugger&#39;</code></li><li>æ‰“å¼€ä¸€ä¸ªåœ¨é¡¹ç›®ç›®å½•çš„å‘½ä»¤çª—å£ï¼Œè¿è¡Œ<code>pod install</code></li><li>swifté¡¹ç›®ï¼Œéœ€è¦åœ¨è¿æ¥æ¡¥æ–‡ä»¶ä¸­å¯¼å…¥å¤´æ–‡ä»¶ï¼Œ<code>#import &lt;PonyDebugger/PonyDebugger.h&gt;</code></li><li>æ·»åŠ sdké…ç½®ï¼š<figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ponyDebugger = <span class="type">PDDebugger</span>.defaultInstance()</span><br><span class="line">ponyDebugger?.enableNetworkTrafficDebugging()</span><br><span class="line">ponyDebugger?.enableViewHierarchyDebugging()</span><br><span class="line">ponyDebugger?.setDisplayedViewAttributeKeyPaths([<span class="string">"frame"</span>, <span class="string">"hidden"</span>, <span class="string">"alpha"</span>])</span><br><span class="line">ponyDebugger?.forwardAllNetworkTraffic()</span><br><span class="line">ponyDebugger?.enableCoreDataDebugging()</span><br><span class="line">ponyDebugger?.enableRemoteLogging()</span><br><span class="line">ponyDebugger?.connect(to: <span class="type">URL</span>(string: <span class="string">"ws://localhost:9000/device"</span>))</span><br></pre></td></tr></table></div></figure></li></ol><h2 id="æ‰“å¼€è°ƒè¯•ç½‘é¡µ">æ‰“å¼€è°ƒè¯•ç½‘é¡µ<a href="post/ios-ponydebuger#æ‰“å¼€è°ƒè¯•ç½‘é¡µ"></a></h2><p><a href="http://localhost:9000/" target="_blank" rel="noopener">http://localhost:9000/</a></p><h2 id="ç»“æŸ">ç»“æŸ<a href="post/ios-ponydebuger#ç»“æŸ"></a></h2><p>è¿™é‡Œä¸»è¦è¿˜æ˜¯æ¼”ç¤ºäº†ä¸€äº›æ€ä¹ˆå®‰è£…é…ç½®çš„PonyDebuggerï¼Œå› ä¸ºåœ¨è¿™é‡Œé‡åˆ°äº›é—®é¢˜æ‰€ä»¥åœ¨æ­¤è®°å½•ä¸€æ³¢ã€‚è°¢è°¢è§‚çœ‹ï¼</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å¥½ç”¨çš„iOSè°ƒè¯•å·¥å…·PonyDebugger&quot;&gt;å¥½ç”¨çš„iOSè°ƒè¯•å·¥å…·PonyDebugger&lt;a href=&quot;post/ios-ponydebuger#å¥½ç”¨çš„iOSè°ƒè¯•å·¥å…·PonyDebugger&quot;&gt;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;PonyDebuggerï¼š&lt;a href
      
    
    </summary>
    
      <category term="å·¥å…·" scheme="https://blog.xujiaji.com/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="iOS" scheme="https://blog.xujiaji.com/tags/iOS/"/>
    
      <category term="Debug" scheme="https://blog.xujiaji.com/tags/Debug/"/>
    
  </entry>
  
  <entry>
    <title>å®‰è£…Gitlabå°è®°</title>
    <link href="https://blog.xujiaji.com/post/linux-gitlab/index.html"/>
    <id>https://blog.xujiaji.com/post/linux-gitlab/index.html</id>
    <published>2019-09-24T12:49:42.000Z</published>
    <updated>2019-11-27T13:40:17.574Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å®‰è£…Gitlabå°è®°">å®‰è£…Gitlabå°è®°<a href="post/linux-gitlab#å®‰è£…Gitlabå°è®°"></a></h1><blockquote><p>ç¯å¢ƒï¼šCentOS7.6ã€å¤–éƒ¨Nginx</p></blockquote><h2 id="åšäº†äº›ä»€ä¹ˆï¼Ÿ">åšäº†äº›ä»€ä¹ˆï¼Ÿ<a href="post/linux-gitlab#åšäº†äº›ä»€ä¹ˆï¼Ÿ"></a></h2><ol><li>å®‰è£…gitlab</li><li>é…ç½®å‘é€é‚®ç®±ï¼ˆç”¨æ¥éªŒè¯è´¦å·ä¿®æ”¹å¯†ç ï¼‰</li><li>å¤–ç½®nginxé…ç½®ï¼ˆhttpsï¼‰</li><li>æ±‰åŒ–</li><li>CI Pipelineså®‰è£…</li></ol><h2 id="å®‰è£…Gitlab">å®‰è£…Gitlab<a href="post/linux-gitlab#å®‰è£…Gitlab"></a></h2><p>å®‰è£…é…åˆä¾èµ–ï¼ˆå…¶å®è¿™é‡Œéƒ½æ˜¯å®˜ç½‘çš„å®‰è£…è¯´æ–‡æ¡£ï¼Œæˆ‘å°±ç›´æ¥æ¬è¿è¿‡æ¥äº†ï¼‰</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y curl policycoreutils-python openssh-server</span><br><span class="line">sudo systemctl enable sshd</span><br><span class="line">sudo systemctl start sshd</span><br><span class="line"></span><br><span class="line">sudo firewall-cmd --permanent --add-service=http</span><br><span class="line">sudo firewall-cmd --permanent --add-service=https</span><br><span class="line">sudo systemctl reload firewalld</span><br></pre></td></tr></table></div></figure><p>æ·»åŠ Gitlabä»“åº“</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.rpm.sh | sudo bash</span><br></pre></td></tr></table></div></figure><p>å®‰è£…Gitlabï¼Œè¿™é‡Œçš„<code>EXTERNAL_URL</code>æ¢æˆè‡ªå·±çš„åŸŸå</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo EXTERNAL_URL="https://gitlab.example.com" yum install -y gitlab-ee</span><br></pre></td></tr></table></div></figure><h2 id="é…ç½®é‚®ç®±ï¼ˆä¸é…ç½®å¯ä»¥è·³è¿‡è¿™ä¸ªæ­¥éª¤ï¼‰">é…ç½®é‚®ç®±ï¼ˆä¸é…ç½®å¯ä»¥è·³è¿‡è¿™ä¸ªæ­¥éª¤ï¼‰<a href="post/linux-gitlab#é…ç½®é‚®ç®±ï¼ˆä¸é…ç½®å¯ä»¥è·³è¿‡è¿™ä¸ªæ­¥éª¤ï¼‰"></a></h2><p>æ‰“å¼€é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ é‚®ç®±é…ç½®ã€‚</p><p>è¿™é‡Œä»¥qqé‚®ç®±æ¥ä¸¾æ —å­ï¼ˆå› ä¸ºæˆ‘é…ç½®çš„qqé‚®ç®±ğŸ˜†ï¼‰ï¼Œå…¶ä»–éƒ½å·®ä¸å¤šç±»ä¼¼ã€‚</p><p>æ³¨æ„éœ€è¦åœ¨é‚®ç®±è®¾ç½®ä¸­å¼€å¯smtpæœåŠ¡</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/gitlab/gitlab.rb</span><br></pre></td></tr></table></div></figure><blockquote><p>ç›´æ¥åœ¨æ–‡ä»¶ä¸­æ·»åŠ ä¸‹æ–¹é…ç½®</p></blockquote><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">gitlab_rails['smtp_enable'] = true</span><br><span class="line">gitlab_rails['smtp_address'] = "smtp.qq.com"</span><br><span class="line">gitlab_rails['smtp_port'] = 465</span><br><span class="line">gitlab_rails['smtp_user_name'] = "é‚®ç®±å@qq.com"</span><br><span class="line">gitlab_rails['smtp_password'] = "dtjhinszpsasdhi"</span><br><span class="line">gitlab_rails['smtp_domain'] = "smtp.qq.com"</span><br><span class="line">gitlab_rails['smtp_authentication'] = "login"</span><br><span class="line">gitlab_rails['smtp_enable_starttls_auto'] = true</span><br><span class="line">gitlab_rails['smtp_tls'] = true</span><br></pre></td></tr></table></div></figure><div class="article-bounded"><div class="article-table"><table><thead><tr><th>å­—æ®µ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>smtp_enable</code></td><td>å¯ç”¨smtp</td></tr><tr><td><code>smtp_address</code></td><td>smtp.qq.comæ˜¯qqçš„smtpæœåŠ¡å™¨ï¼Œæ ¹æ®è‡ªå·±çš„æƒ…å†µæ›´æ¢</td></tr><tr><td><code>smtp_user_name</code></td><td>æ˜¯ä½ è¦ç”¨æ¥è®©gitlabå‘é€çš„é‚®ç®±</td></tr><tr><td><code>smtp_password</code></td><td>æ˜¯é‚®ç®±çš„ç™»å½•å¯†ç ï¼ˆQQçš„æ˜¯åœ¨è®¾ç½®ä¸­ç”Ÿæˆçš„ç¬¬ä¸‰æ–¹ç™»å½•å¯†ç ï¼‰</td></tr><tr><td><code>smtp_tls</code></td><td>å¼€å¯tlsåŠ å¯†</td></tr></tbody></table></div></div><p>é…ç½®é‚®ç®±æ¥æºï¼Œä¸å±•ç¤ºçš„åç§°</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gitlab_rails['gitlab_email_enabled'] = true</span><br><span class="line">gitlab_rails['gitlab_email_from'] = 'é‚®ç®±å@qq.com'</span><br><span class="line">gitlab_rails['gitlab_email_display_name'] = 'å‘é€é‚®ä»¶çš„é»˜è®¤æ ‡é¢˜'</span><br></pre></td></tr></table></div></figure><h2 id="å¤–ç½®nginxé…ç½®">å¤–ç½®nginxé…ç½®<a href="post/linux-gitlab#å¤–ç½®nginxé…ç½®"></a></h2><h3 id="å…³é—­Gilabå†…éƒ¨nginxå’Œä¸€äº›å…¶ä»–é…ç½®">å…³é—­Gilabå†…éƒ¨nginxå’Œä¸€äº›å…¶ä»–é…ç½®<a href="post/linux-gitlab#å…³é—­Gilabå†…éƒ¨nginxå’Œä¸€äº›å…¶ä»–é…ç½®"></a></h3><p>æ‰“å¼€é…ç½®æ–‡ä»¶</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/gitlab/gitlab.rb</span><br></pre></td></tr></table></div></figure><p>æ·»åŠ å¦‚ä¸‹é…ç½®</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">external_url 'https://git.longpuji.com'</span><br><span class="line"></span><br><span class="line">gitlab_workhorse['enable'] = true</span><br><span class="line">gitlab_workhorse['listen_network'] = "tcp"</span><br><span class="line">gitlab_workhorse['listen_addr'] = "127.0.0.1:8181"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> This example renews every 7th day at 12:30</span></span><br><span class="line">letsencrypt['auto_renew_hour'] = "12"</span><br><span class="line">letsencrypt['auto_renew_minute'] = "30"</span><br><span class="line">letsencrypt['auto_renew_day_of_month'] = "*/7"</span><br><span class="line"></span><br><span class="line">nginx['enable'] = false</span><br></pre></td></tr></table></div></figure><div class="article-bounded"><div class="article-table"><table><thead><tr><th>å­—æ®µ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>external_url</code></td><td>å¤–éƒ¨çš„urlä½¿ç”¨çš„urlï¼Œå¦‚æœä¸é…ç½®ä¼šå¯¼è‡´æœ‰äº›é“¾æ¥ä¸æ­£å¸¸</td></tr><tr><td><code>gitlab_workhorse[&#39;enable&#39;]</code></td><td>å¼€å¯gitlabå·¥ä½œç©ºé—´é…ç½®</td></tr><tr><td><code>gitlab_workhorse[&#39;listen_network&#39;]</code></td><td>tcpç½‘ç»œåè®®</td></tr><tr><td><code>gitlab_workhorse[&#39;listen_addr&#39;]</code></td><td><code>127.0.0.1:8181</code>ï¼ˆä¸€ä¼šå„¿nginxåå‘ä»£ç†çš„æ—¶å€™å°±ç”¨è¿™ä¸ªç«¯å£å·ï¼‰</td></tr><tr><td><code>nginx[&#39;enable&#39;]</code></td><td>å…³é—­Gitlabå†…éƒ¨nginx</td></tr></tbody></table></div></div><h3 id="ä¸ºå¤–éƒ¨nginxåå‘ä»£ç†é…ç½®">ä¸ºå¤–éƒ¨nginxåå‘ä»£ç†é…ç½®<a href="post/linux-gitlab#ä¸ºå¤–éƒ¨nginxåå‘ä»£ç†é…ç½®"></a></h3><p>é…ç½®å¦‚ä¸‹</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">location /</span><br><span class="line">&#123;</span><br><span class="line">    expires 12h;</span><br><span class="line">    if ($request_uri ~* "(php|jsp|cgi|asp|aspx)")</span><br><span class="line">    &#123;</span><br><span class="line">         expires 0;</span><br><span class="line">    &#125;</span><br><span class="line">    # è¿™ä¸ªå°±æ˜¯ä¸Šé¢è®¾ç½®çš„gitlab_workhorse['listen_addr']</span><br><span class="line">    proxy_pass http://127.0.0.1:8181;</span><br><span class="line">    proxy_set_header Host $host;</span><br><span class="line">    proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">    proxy_set_header REMOTE-HOST $remote_addr;</span><br><span class="line">    # æ³¨æ„å¦‚æœæ˜¯åŸŸåé…ç½®äº†sslï¼Œé‚£ä¹ˆåˆ™å¿…é¡»åŠ ä¸Šè¿™ä¸ªé…ç½®ï¼Œä¸ç„¶gitlabä¼šåœ¨é‡ç½®å¯†ç çš„æ—¶å€™æŠ¥é”™422</span><br><span class="line">    proxy_set_header X-Forwarded-Proto https;</span><br><span class="line">    proxy_set_header X-Forwarded-Ssl on;</span><br><span class="line"></span><br><span class="line">    proxy_read_timeout                  900;</span><br><span class="line">    proxy_cache off;</span><br><span class="line">    proxy_buffering off;</span><br><span class="line">    proxy_request_buffering off;</span><br><span class="line">    proxy_http_version 1.1;</span><br><span class="line"></span><br><span class="line">    add_header X-Cache $upstream_cache_status;</span><br><span class="line">    add_header Cache-Control no-cache;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="å¯åŠ¨">å¯åŠ¨<a href="post/linux-gitlab#å¯åŠ¨"></a></h2><blockquote><p>ä¸Šé¢çš„é‚£äº›åŸºæœ¬ä¸ŠGitlabå°±å·²ç»é…ç½®å¥½å•¦ï¼Œç°åœ¨éœ€è¦å¯¹Gitlabé‡æ–°åŠ è½½é…ç½®å’Œé‡å¯</p></blockquote><p>é‡è½½é…ç½®</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl reconfigure</span><br></pre></td></tr></table></div></figure><p>é‡å¯æœåŠ¡</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl start</span><br></pre></td></tr></table></div></figure><p>åˆ°è¿™é‡Œå¯ä»¥æ‰“å¼€åŸŸåé“¾æ¥å»çœ‹çœ‹ï¼Œæ²¡æœ‰å•¥é—®é¢˜å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œç¬¬ä¸€æ¬¡è¿›å…¥çš„æ—¶å€™éœ€è¦è®¾ç½®åˆå§‹å¯†ç ã€‚<br>åˆå§‹çš„è´¦å·æ˜¯<code>root</code><br>å»ç™»é™†è¯•è¯•å§</p><h2 id="æ±‰åŒ–">æ±‰åŒ–<a href="post/linux-gitlab#æ±‰åŒ–"></a></h2><p>æŸ¥çœ‹å½“å‰ç‰ˆæœ¬</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /opt/gitlab/embedded/service/gitlab-rails/VERSION</span><br></pre></td></tr></table></div></figure><p>è¾“å‡º</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">12.3.0-ee</span><br></pre></td></tr></table></div></figure><blockquote><p>ç”±äºæ±‰åŒ–ç°åœ¨è¿˜æ²¡æœ‰æ”¯æŒåˆ°è¿™ä¹ˆé«˜çš„ç‰ˆæœ¬ï¼Œäºæ˜¯è¿™é‡Œä»¥v12.2.4çš„ç‰ˆæœ¬æ±‰åŒ–çš„ã€‚ï¼ˆå¤§éƒ¨åˆ†éƒ½æ²¡æœ‰è¢«æ±‰åŒ–ğŸ˜…ï¼Œä¹‹åå¦‚æœè¯¥ä»“åº“æ›´æ–°çš„å¯¹åº”ç‰ˆæœ¬å¯ä»¥å†æ¬¡å°è¯•ï¼‰</p></blockquote><p>cloneæ±‰åŒ–é¡¹ç›®</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://gitlab.com/xhang/gitlab.git</span><br></pre></td></tr></table></div></figure><p>è¿›å…¥ä»“åº“</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd gitlab</span><br></pre></td></tr></table></div></figure><p>å¤‡ä»½<code>gitlab-rails</code>åˆ°å½“å‰ç›®å½•ï¼ˆå¦‚æœä¹‹åå‡ºç°é—®é¢˜ï¼Œæ–¹ä¾¿æ¢å¤ï¼‰</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -rf /opt/gitlab/embedded/service/gitlab-rails/ .</span><br></pre></td></tr></table></div></figure><p>ç”Ÿæˆ12.2.4ç‰ˆæœ¬çš„æ±‰åŒ–è¡¥ä¸</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff v12.2.4 v12.2.4-zh &gt; ./12.2.4-zh.diff</span><br></pre></td></tr></table></div></figure><p>å…³é—­gitlabæœåŠ¡</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl stop</span><br></pre></td></tr></table></div></figure><p>æ‰“æ±‰åŒ–è¡¥ä¸</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">patch -d /opt/gitlab/embedded/service/gitlab-rails/ -p1 &lt; ./12.2.4-zh.diff</span><br></pre></td></tr></table></div></figure><blockquote><p>è¿™é‡Œæœ‰äº›æ±‰åŒ–æ–‡ä»¶æ²¡æœ‰å¯¹åº”åˆ°çš„æ–‡ä»¶ï¼Œç›´æ¥å›è½¦ï¼Œyesè·³è¿‡å°±å¯ä»¥äº†</p></blockquote><p>å¯åŠ¨æœåŠ¡</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl start</span><br></pre></td></tr></table></div></figure><h2 id="CI-Pipelineså®‰è£…">CI Pipelineså®‰è£…<a href="post/linux-gitlab#CI-Pipelineså®‰è£…"></a></h2><p>è¿™ç¯‡æ–‡ä»¶ä¸é”™ï¼Œæˆ‘å°±ä¸å•°å—¦äº†å“ˆå“ˆ</p><p><a href="https://scarletsky.github.io/2016/07/29/use-gitlab-ci-for-continuous-integration/" target="_blank" rel="noopener">https://scarletsky.github.io/2016/07/29/use-gitlab-ci-for-continuous-integration/</a></p><h2 id="å‘½ä»¤æ–‡ä»¶æ•´ç†">å‘½ä»¤æ–‡ä»¶æ•´ç†<a href="post/linux-gitlab#å‘½ä»¤æ–‡ä»¶æ•´ç†"></a></h2><blockquote><p>å‘½ä»¤æ•´ç†</p></blockquote><div class="article-bounded"><div class="article-table"><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>gitlab-ctl reconfigure</code></td><td>é‡è½½gitlabé…ç½®</td></tr><tr><td><code>gitlab-ctl restart</code></td><td>é‡å¯gitlab</td></tr><tr><td><code>gitlab-ctl stop</code></td><td>åœæ­¢gitlabæœåŠ¡</td></tr><tr><td><code>gitlab-ctl start</code></td><td>å¯åŠ¨gitlabæœåŠ¡</td></tr></tbody></table></div></div><blockquote><p>æ–‡ä»¶è¯´æ˜</p></blockquote><div class="article-bounded"><div class="article-table"><table><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>/etc/gitlab/gitlab.rb</code></td><td>gitlabé…ç½®æ–‡ä»¶</td></tr><tr><td><code>/var/log/gitlab/gitlab-rails/production.log</code></td><td>gitlab-railsæ—¥å¿—æ–‡ä»¶</td></tr></tbody></table></div></div><h2 id="å¤‡ä»½">å¤‡ä»½<a href="post/linux-gitlab#å¤‡ä»½"></a></h2><p>å¤‡ä»½å‘½ä»¤</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-rake gitlab:backup:create</span><br></pre></td></tr></table></div></figure><p>å®‰è£…åŒç‰ˆæœ¬gitlab</p><p>ä»å…¶ä»–æœåŠ¡å™¨æ‹·è´åˆ°å½“å‰æœåŠ¡å™¨</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp root@172.28.17.155:/var/opt/gitlab/backups/1502357536_2017_08_10_9.4.3_gitlab_backup.tar /var/opt/gitlab/backups/</span><br></pre></td></tr></table></div></figure><p>ä½™ä¸‹æ­¥éª¤å‚é˜…ï¼š<a href="https://blog.csdn.net/ouyang_peng/article/details/77070977" target="_blank" rel="noopener">https://blog.csdn.net/ouyang_peng/article/details/77070977</a></p><h3 id="æ¢å¤å¤‡ä»½åci-500é”™è¯¯é—®é¢˜">æ¢å¤å¤‡ä»½åci 500é”™è¯¯é—®é¢˜<a href="post/linux-gitlab#æ¢å¤å¤‡ä»½åci-500é”™è¯¯é—®é¢˜"></a></h3><p>Rails console</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-rails console</span><br></pre></td></tr></table></div></figure><p>é‡ç½®token</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Project.find_by_full_path('root/my-project').update(runners_token: nil, runners_token_encrypted:nil)</span><br><span class="line">ApplicationSetting.current.reset_runners_registration_token!</span><br></pre></td></tr></table></div></figure><p>DB Console</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-psql -d gitlabhq_production</span><br></pre></td></tr></table></div></figure><p>æŸ¥çœ‹æ•°æ®åº“ä¿¡æ¯</p><figure class="highlight sql"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,runners_token,runners_token_encrypted <span class="keyword">from</span> projects;</span><br></pre></td></tr></table></div></figure><p>é‡ç½®æ•°æ®token</p><figure class="highlight sql"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> projects <span class="keyword">SET</span> runners_token = <span class="literal">null</span>, runners_token_encrypted = <span class="literal">null</span> <span class="keyword">WHERE</span> <span class="keyword">id</span> = <span class="number">28</span>;</span><br></pre></td></tr></table></div></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å®‰è£…Gitlabå°è®°&quot;&gt;å®‰è£…Gitlabå°è®°&lt;a href=&quot;post/linux-gitlab#å®‰è£…Gitlabå°è®°&quot;&gt;&lt;/a&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;ç¯å¢ƒï¼šCentOS7.6ã€å¤–éƒ¨Nginx&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=
      
    
    </summary>
    
    
      <category term="Git" scheme="https://blog.xujiaji.com/tags/Git/"/>
    
      <category term="Linux" scheme="https://blog.xujiaji.com/tags/Linux/"/>
    
      <category term="CentOS" scheme="https://blog.xujiaji.com/tags/CentOS/"/>
    
  </entry>
  
  <entry>
    <title>Dartå­¦ä¹ ç¬”è®°</title>
    <link href="https://blog.xujiaji.com/post/Note-Learn-Dart/index.html"/>
    <id>https://blog.xujiaji.com/post/Note-Learn-Dart/index.html</id>
    <published>2019-03-29T08:45:28.000Z</published>
    <updated>2019-10-27T05:51:23.751Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Dartç¬”è®°">Dartç¬”è®°<a href="post/Note-Learn-Dart#Dartç¬”è®°"></a></h1><h2 id="å˜é‡">å˜é‡<a href="post/Note-Learn-Dart#å˜é‡"></a></h2><p>åˆå§‹åŒ–ä¸€ä¸ªå˜é‡</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'Bob'</span>;</span><br></pre></td></tr></table></div></figure><p><code>name</code>å°†è‡ªåŠ¨åˆ¤æ–­ä¸º<code>String</code>ç±»å‹ï¼Œå¦‚æœä¸æƒ³è®©å…¶é™åˆ¶ä¸ºäº†ä¸€ä¸ªç±»å‹å¯ä»¥ä½¿ç”¨<code>Object</code>æˆ–<code>dynamic</code>ç±»å‹ã€‚<code>Object</code>ç±»å‹å’Œjavaä¸­å·®ä¸å¤šæ˜¯ä¸€ä¸ªé“ç†ã€‚</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dynamic</span> name = <span class="string">'Bob'</span>;</span><br></pre></td></tr></table></div></figure><p>å¦‚æœæƒ³æ˜ç¡®æ˜¾ç¤ºå£°æ˜ç±»å‹ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> name = <span class="string">'Bob'</span>;</span><br></pre></td></tr></table></div></figure><h2 id="é»˜è®¤å€¼">é»˜è®¤å€¼<a href="post/Note-Learn-Dart#é»˜è®¤å€¼"></a></h2><p>dartä¸­æœªåˆå§‹åŒ–çš„å€¼éƒ½æ˜¯nullï¼Œå³ä½¿æ˜¯æ•°å­—ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> lineCount;</span><br><span class="line"><span class="built_in">print</span>(lineCount);</span><br><span class="line"></span><br><span class="line"><span class="comment">//: null</span></span><br></pre></td></tr></table></div></figure><h2 id="fianl-å’Œ-const">fianl å’Œ const<a href="post/Note-Learn-Dart#fianl-å’Œ-const"></a></h2><p>å½“ä½ ä¸æƒ³è®©å˜é‡å¯ä»¥å†æ¬¡æ”¹å˜çš„æ—¶å€™ç”¨<code>final</code>æˆ–<code>const</code>ä¿®é¥°ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> name = <span class="string">'Bob'</span>; <span class="comment">// æˆ–è€…ï¼š final String name = 'Bob'; const name = 'Bob';</span></span><br></pre></td></tr></table></div></figure><p>æ­¤æ—¶nameçš„å€¼ä¸å¯ä»¥åœ¨ä¿®æ”¹ï¼</p><p>äºŒè€…çš„åŒºåˆ«æ˜¯ï¼Œ<code>const</code>æ˜¯ç¼–è¯‘æ—¶æœŸå¸¸é‡ï¼Œæ„æ€æ˜¯è¯´åœ¨ç¼–è¯‘åå°±æœ‰ç¡®åˆ‡çš„å€¼ã€‚</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚ä¸‹è¡¨è¾¾å¼å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯å°†barå˜é‡å‰é¢çš„ä¿®é¥°è¯constæ¢æ‰ï¼Œé‚£ä¹ˆå°±ä¼šæŠ¥é”™ã€‚å»æ‰å°±ä»£è¡¨äº†barçš„å€¼åœ¨ç¼–è¯‘æ—¶çš„ä¸ç¡®å®šæ€§ã€‚</span></span><br><span class="line"><span class="keyword">const</span> bar = <span class="number">1000000</span>;</span><br><span class="line"><span class="comment">// å¦‚æœatmå‰é¢çš„ä¿®é¥°constæ¢æˆfinalåï¼Œå³ä½¿baræ˜¯å˜é‡ä¹Ÿæ˜¯æ— æ‰€è°“äº†</span></span><br><span class="line"><span class="keyword">const</span> <span class="built_in">double</span> atm = <span class="number">1.01325</span> * bar;</span><br></pre></td></tr></table></div></figure><p><code>const</code>å…³é”®å­—è¿˜å¯ä»¥ç”¨æ¥ä¿®é¥°å€¼</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="keyword">const</span> [];</span><br><span class="line"><span class="keyword">final</span> bar = [];</span><br><span class="line"><span class="keyword">const</span> baz = [];</span><br></pre></td></tr></table></div></figure><p>æ­¤æ—¶<code>foo</code>æ˜¯å˜é‡ï¼Œå€¼æ˜¯å¸¸é‡ã€‚æ„æ€æ˜¯<code>foo</code>è¿˜å¯ä»¥å¼•ç”¨å…¶ä»–åŒç±»å‹çš„å€¼ï¼Œ<code>foo = [1, 2, 3];</code>æ˜¯è«å¾—é—®é¢˜çš„ã€‚ä½†æ˜¯å¦‚æœè®©å€¼<code>const []</code>æ”¹å˜å°±ä¸è¡Œäº†<del><code>foo.add(1);</code></del></p><p><code>bar</code>å˜é‡è™½ç„¶æ— æ³•æ”¹å˜å¼•ç”¨ï¼Œä½†æ˜¯å€¼æ˜¯å¯ä»¥æ”¹å˜çš„ã€‚<code>bar.add(1);</code>æ˜¯OKçš„ï¼Œä½†æ˜¯ <del><code>bar = [1];</code></del> æ˜¯NOã€‚</p><p><code>baz</code>ï¼Œä¸Šé¢ä¸¤æ ·éƒ½æ²¡å¾—ç©ï¼</p><p>å¦‚æœ<code>const</code>çš„å˜é‡æ˜¯ç±»ä¸€ä¸ªçº§åˆ«çš„ï¼Œè¿™æ ·å£°æ˜ï¼š<code>static const</code></p><h2 id="å†…ç½®ç±»å‹">å†…ç½®ç±»å‹<a href="post/Note-Learn-Dart#å†…ç½®ç±»å‹"></a></h2><p>ä»¥ä¸‹ç±»å‹æ˜¯<code>Dart</code>ä¸­ç‰¹æ®Šæ”¯æŒçš„ç±»å‹</p><ul><li><code>æ•°å­— numbers</code></li><li><code>å­—ç¬¦ä¸² strings</code></li><li><code>å¸ƒå°” booleans</code></li><li><code>åˆ—è¡¨ lists</code>(ä¹Ÿç§°ä¸ºæ•°ç»„)</li><li><code>é›†åˆ sets</code></li><li><code>æ˜ å°„ maps</code></li><li><code>ç¬¦æ–‡ runes</code>(ç”¨äºåœ¨å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºUnicodeå­—ç¬¦)</li><li><code>ç¬¦å· symbols</code></li></ul><p>æ‚¨å¯ä»¥ä½¿ç”¨å­—é¢æ–‡å­—åˆå§‹åŒ–ä¸€äº›ç‰¹åˆ«çš„ç±»å‹å¯¹è±¡ï¼Œä¾‹å¦‚<code>&#39;this is a string&#39;</code>æ˜¯ä¸€ä¸ªstringå¯¹è±¡ï¼Œ<code>true</code>æ˜¯ä¸€ä¸ªbooleanå¯¹è±¡ã€‚</p><p>å› ä¸ºåœ¨Dartä¸­æ¯ä¸ªå˜é‡éƒ½å¼•ç”¨äº†ä¸€ä¸ªå¯¹è±¡ï¼ˆä¸€ä¸ªç±»çš„å®ä¾‹ï¼‰ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ„é€ æ–¹æ³•åˆå§‹åŒ–å˜é‡ï¼Œæœ‰äº›å†…ç½®ç±»å‹æœ‰å®ƒä»¬è‡ªå·±çš„æ„é€ å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<code>Map()</code>æ„é€ æ¥åˆ›å»ºä¸€ä¸ªmapå®ä¾‹ã€‚</p><h3 id="æ•°å­—-Numbers">æ•°å­— Numbers<a href="post/Note-Learn-Dart#æ•°å­—-Numbers"></a></h3><p>Dartæœ‰ä¸¤ç§æ–¹å¼è¡¨ç¤ºæ•°å­—</p><p><strong><a href="https://api.dartlang.org/stable/2.2.0/dart-core/int-class.html" target="_blank" rel="noopener">int</a></strong></p><p>æ•´å‹æœ€å¤§ä¸è¶…è¿‡64bitï¼Œå¹¶ä¾èµ–äºå¹³å°ã€‚åœ¨Dartè™šæ‹Ÿæœºä¸Šï¼Œå€¼å–å€¼èŒƒå›´<code>[-2^63,2^63 - 1]</code>ã€‚ç¼–è¯‘ä¸ºJavaScriptæ—¶ä½¿ç”¨<a href="https://stackoverflow.com/questions/2802957/number-of-bits-in-javascript-numbers/2803010#2803010" target="_blank" rel="noopener">JavaScriptæ•°å­—</a>ï¼ŒåŒºé—´èŒƒå›´ä¸º<code>[-2^53,2^53-1]</code>ã€‚</p><p><strong><a href="https://stackoverflow.com/questions/2802957/number-of-bits-in-javascript-numbers/2803010#2803010" target="_blank" rel="noopener">double</a></strong></p><p>64bitï¼ˆåŒç²¾åº¦ï¼‰æµ®ç‚¹æ•°ç”±IEEE 754æ ‡å‡†è§„å®š</p><p><code>int</code>å’Œ<code>double</code>éƒ½æ˜¯<a href="https://api.dartlang.org/stable/dart-core/num-class.html" target="_blank" rel="noopener">num</a>çš„å­ç±»å‹ï¼Œåœ¨<code>num</code>ç±»å‹ä¸­åŒ…å«äº†<code>+</code>ã€<code>-</code>ã€<code>*</code>ã€<code>/</code>åŸºæœ¬è¿ç®—ç¬¦ï¼Œåœ¨å…¶ä»–æ–¹æ³•ä¸­æ‚¨ä¹Ÿå¯ä»¥æ‰¾åˆ°<code>abs()</code>,<code>ceil()</code>,<code>floor()</code>ã€‚ï¼ˆä½è¿ç®—ç¬¦ï¼Œå¦‚<code>&gt;&gt;</code>ï¼Œå®šä¹‰åœ¨<code>int</code>ç±»ï¼‰å¦‚æœ<code>num</code>å’Œå…¶å­ç±»æ²¡æœ‰æ‚¨æƒ³è¦çš„ï¼Œ<a href="https://api.dartlang.org/stable/dart-math" target="_blank" rel="noopener">dart:math</a>ç±»åº“ä¸­å¯èƒ½æœ‰ã€‚</p><p>å­—ç¬¦ä¸²å’Œæ•°å­—äº’è½¬</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// String -&gt; int</span></span><br><span class="line"><span class="built_in">int</span>.parse(<span class="string">'1'</span>); <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// String -&gt; double</span></span><br><span class="line"><span class="built_in">double</span>.parse(<span class="string">'1.1'</span>); <span class="comment">// 1.1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// int -&gt; String</span></span><br><span class="line"><span class="number">1.</span>toString(); <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// double -&gt; String ä¿ç•™ä¸¤ä½å°æ•°ï¼Œå››èˆäº”å…¥</span></span><br><span class="line"><span class="number">3.14159</span>.toStringAsFixed(<span class="number">2</span>); <span class="comment">// 1.14</span></span><br></pre></td></tr></table></div></figure><h3 id="å­—ç¬¦ä¸²-Strings">å­—ç¬¦ä¸² Strings<a href="post/Note-Learn-Dart#å­—ç¬¦ä¸²-Strings"></a></h3><p>Dartå­—ç¬¦ä¸²æ˜¯ä¸€ç³»åˆ—UTF-16ä»£ç å•å…ƒï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å•å¼•å·æˆ–åŒå¼•å·åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å•å¼•å·å¯ä»¥è¡¨ç¤º</span></span><br><span class="line"><span class="keyword">var</span> s1 = <span class="string">'single quotes string'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒå¼•å·ä¹Ÿå¯ä»¥è¡¨ç¤º</span></span><br><span class="line"><span class="keyword">var</span> s2 = <span class="string">"double quotes strings"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å•å¼•å·è¡¨ç¤ºæ—¶ï¼Œé‡Œé¢æœ‰å•å¼•å·éœ€è¦è½¬ä¹‰</span></span><br><span class="line"><span class="keyword">var</span> s3 = <span class="string">'i\'m a cool boy'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒå¼•å·è¡¨ç¤ºæ—¶ï¼Œé‡Œé¢æœ‰å•å¼•å·ä¸éœ€è¦è½¬ä¹‰</span></span><br><span class="line"><span class="keyword">var</span> s4 = <span class="string">"i'm a cool boy"</span>;</span><br></pre></td></tr></table></div></figure><p>å¯ä»¥å°†è¡¨è¾¾å¼æ”¾åœ¨å­—ç¬¦ä¸²é‡Œé¢é€šè¿‡<code>${expression}</code>çš„å½¢å¼ï¼Œè¡¨è¾¾å¼åªæ˜¯å˜é‡æ—¶ï¼Œæ‚¨å¯ä»¥ä¸è¦<code>{}</code>ã€‚å¦‚æœæ˜¯ä¸€ä¸ªå¯¹è±¡æ—¶Dartä¼šé€šè¿‡è°ƒç”¨<code>toString()</code>æ–¹æ³•è·å–è¿™å¯¹è±¡çš„å­—ç¬¦ä¸²ã€‚</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> v = <span class="string">'bc'</span>;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'a<span class="subst">$v<span class="string">'); // abc</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">print('</span></span>A<span class="subst">$&#123;v.toUpperCase()&#125;</span>'</span>); <span class="comment">// ABC</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">'<span class="subst">$Set</span>()'</span>); <span class="comment">// Set&lt;dynamic&gt;()</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">'<span class="subst">$&#123;Set().toString()&#125;</span>'</span>); <span class="comment">// &#123;&#125;</span></span><br></pre></td></tr></table></div></figure><p>ç›¸é‚»çš„å­—ç¬¦ä¸²ä¼šè‡ªå·±æ‹¼æ¥æˆ–é€šè¿‡<code>+</code>å·æ‹¼æ¥</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">'1'</span></span><br><span class="line">  <span class="string">'2'</span></span><br><span class="line">  <span class="string">"3"</span></span><br><span class="line">  <span class="string">'4'</span>;</span><br><span class="line"><span class="built_in">print</span>(a); <span class="comment">// 1234</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = <span class="string">'1'</span> + <span class="string">'2'</span> + <span class="string">"3"</span>;</span><br><span class="line"><span class="built_in">print</span>(b); <span class="comment">// 123</span></span><br></pre></td></tr></table></div></figure><p>å¯ä»¥ä½¿ç”¨ä¸‰å€çš„å•å¼•å·æˆ–åŒå¼•å·åˆ›å»ºå¤šè¡Œå­—ç¬¦ä¸²ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s1 =</span><br><span class="line">  <span class="string">'''</span></span><br><span class="line"><span class="string">  1</span></span><br><span class="line"><span class="string">    2\n3</span></span><br><span class="line"><span class="string">  '''</span>;</span><br><span class="line"><span class="built_in">print</span>(s1);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸‹é¢æ˜¯è¾“å‡ºï¼Œè¯•äº†ä¸‹åŒå¼•å·å•å¼•å·æ•ˆæœä¸€æ ·</span></span><br><span class="line"><span class="comment">//    1</span></span><br><span class="line"><span class="comment">//      2</span></span><br><span class="line"><span class="comment">//3</span></span><br></pre></td></tr></table></div></figure><p>æ‚¨å¯ä»¥åœ¨å¼•å·å‰é¢åŠ <code>r</code>è¡¨ç¤ºå­—ç¬¦ä¸²æ˜¯åŸå§‹(raw)ç±»å‹ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">r'a\nb'</span>); <span class="comment">// a\nb</span></span><br></pre></td></tr></table></div></figure><p>æ˜¯ä»€ä¹ˆå°±è¾“å‡ºä»€ä¹ˆï¼Œä¸éœ€è¦è½¬ä¹‰ï¼Œå•å¼•å·åŒå¼•å·ä¸‰å€å¼•å·éƒ½å¯ä»¥ç”¨ã€‚</p><p>æœ‰å…³å­—ç¬¦ä¸²ä¸­è¡¨è¾¾Unicodeå­—ç¬¦çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://www.dartlang.org/guides/language/language-tour#runes" target="_blank" rel="noopener">å­—ç¬¦ Runes</a></p><p>å­—ç¬¦ä¸²æ–‡å­—æ˜¯ä¸€ä¸ªç¼–è¯‘æœŸå¸¸é‡</p><p>æ›´å¤šå­—ç¬¦ä¸²ä½¿ç”¨ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://www.dartlang.org/guides/libraries/library-tour#strings-and-regular-expressions" target="_blank" rel="noopener">å­—ç¬¦ä¸²å’Œæ­£åˆ™è¡¨è¾¾å¼</a></p><h3 id="å¸ƒå°”-Booleans">å¸ƒå°” Booleans<a href="post/Note-Learn-Dart#å¸ƒå°”-Booleans"></a></h3><p>Dartç”¨ç±»å‹<code>bool</code>è¡¨ç¤ºå¸ƒå°”å€¼ã€‚åªæœ‰ä¸¤ä¸ªå¯¹è±¡è¡¨ç¤º<code>bool</code>ç±»å‹ï¼š<code>true</code>å’Œ<code>false</code>ï¼Œå®ƒä»¬çš„æ–‡å­—è¡¨è¾¾éƒ½æ˜¯ç¼–è¯‘æ—¶æœŸå¸¸é‡ã€‚</p><p>Dartæ˜¯ç±»å‹å®‰å…¨çš„ï¼Œæ„å‘³ç€æ‚¨ä¸èƒ½ä½¿ç”¨åƒ<code>if (éå¸ƒå°”å€¼)</code>æˆ–<code>assert(éå¸ƒå°”å€¼)</code>çš„ä»£ç ã€‚å–è€Œä»£ä¹‹çš„æ˜¯æ˜ç¡®æŒ‡å‡ºå¸ƒå°”å€¼ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ£€æŸ¥ç©ºå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">var</span> fullName = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">assert</span>(fullName.isEmpty);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥0</span></span><br><span class="line"><span class="keyword">var</span> hitPoints = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">assert</span>(hitPoints &lt;= <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥null</span></span><br><span class="line"><span class="keyword">var</span> unicorn;</span><br><span class="line"><span class="keyword">assert</span>(unicorn == <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥ NaN ï¼ˆNot a Number ä¸æ˜¯ä¸€ä¸ªæ•°ï¼‰</span></span><br><span class="line"><span class="keyword">var</span> iMeantToDoThis = <span class="number">0</span> / <span class="number">0</span>;</span><br><span class="line"><span class="keyword">assert</span>(iMeantToDoThis.isNaN);</span><br></pre></td></tr></table></div></figure><h3 id="åˆ—è¡¨-Lists">åˆ—è¡¨ Lists<a href="post/Note-Learn-Dart#åˆ—è¡¨-Lists"></a></h3><p>ä¹Ÿè®¸å‡ ä¹æ‰€æœ‰ç¼–ç¨‹è¯­è¨€ä¸­æœ€å¸¸è§çš„é›†åˆæ˜¯æ•°ç»„ï¼Œæˆ–æœ‰åºçš„å¯¹è±¡ç»„ã€‚åœ¨Dartä¸­æ•°ç»„å°±æ˜¯<a href="https://api.dartlang.org/stable/2.2.0/dart-core/List-class.html" target="_blank" rel="noopener">List</a>å¯¹è±¡ï¼Œå› æ­¤å¤§å¤šæ•°äººå«ä»–ä»¬åˆ—è¡¨ã€‚</p><p>Dartçš„åˆ—è¡¨å†™æ³•çœ‹èµ·æ¥å°±æ˜¯å…¶ä»–è¯­è¨€æ•°ç»„çš„å†™æ³•ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªDartåˆ—è¡¨çš„ç¤ºä¾‹ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br></pre></td></tr></table></div></figure><p>ä¸Šé¢çš„ç±»å‹ä¸º<code>List&lt;int&gt;</code></p><p>æ›´å¤šå…³äºåˆ—è¡¨çš„ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://www.dartlang.org/guides/language/language-tour#generics" target="_blank" rel="noopener">æ³›å‹</a>å’Œ<a href="https://www.dartlang.org/guides/libraries/library-tour#collections" target="_blank" rel="noopener">é›†åˆ</a></p><h3 id="é›†åˆ-Sets">é›†åˆ Sets<a href="post/Note-Learn-Dart#é›†åˆ-Sets"></a></h3><p>set åœ¨Dartä¸­æ˜¯ä¸€ä¸ªæ— åºé›†åˆï¼ŒDartæ”¯æŒé€šè¿‡æ–‡å­—è¡¨è¾¾å’Œ<a href="https://api.dartlang.org/stable/2.2.0/dart-core/Set-class.html" target="_blank" rel="noopener">Set</a>æ¥åˆ›å»ºé›†åˆã€‚</p><p>ç®€å•çš„é€šè¿‡æ–‡å­—è¡¨è¾¾</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> halogens = &#123;<span class="string">'fluorine'</span>, <span class="string">'chlorine'</span>, <span class="string">'bromine'</span>, <span class="string">'iodine'</span>, <span class="string">'astatine'</span>&#125;;</span><br></pre></td></tr></table></div></figure><p>ä¸Šé¢ç±»å‹ä¸ºï¼š<code>Set&lt;String&gt;</code></p><p>åˆ›å»ºä¸€ä¸ªç©ºé›†åˆï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> names1 = &lt;<span class="built_in">String</span>&gt;&#123;&#125;;</span><br><span class="line"><span class="built_in">Set</span>&lt;<span class="built_in">String</span>&gt; names2 = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// var names3 = &#123;&#125;; //æ³¨æ„è¿™æ ·åˆ›å»ºçš„ä¸æ˜¯ä¸€ä¸ªSetï¼Œè€Œæ˜¯ä¸€ä¸ªMapï¼Œå…·ä½“æ¥è¯´æ˜¯ä¸€ä¸ª Map&lt;dynamic, dynamic&gt;</span></span><br></pre></td></tr></table></div></figure><h3 id="æ˜ å°„-Maps">æ˜ å°„ Maps<a href="post/Note-Learn-Dart#æ˜ å°„-Maps"></a></h3><p>é€šå¸¸ï¼Œä¸€ä¸ªmapæœ‰keyå’Œvalueã€‚keyå’Œvalueå¯ä»¥æ˜¯ä»»ä½•å¯¹è±¡ï¼Œkeyåªèƒ½å‡ºç°ä¸€ä¸ªï¼Œä½†å€¼å¯ä»¥å¯¹åº”å¤šä¸ªkeyã€‚Dartåˆ›å»ºæ˜ å°„ä¹Ÿå¯ä»¥é€šè¿‡ç›´æ¥è¡¨è¾¾å’Œ<a href="https://api.dartlang.org/stable/dart-core/Map-class.html" target="_blank" rel="noopener">Set</a>ç±»å‹è¡¨è¾¾ã€‚</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> aa = &#123;</span><br><span class="line">  <span class="string">'a'</span>: <span class="string">'1'</span>,</span><br><span class="line">  <span class="string">'b'</span>: <span class="string">'2'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bb = &#123;</span><br><span class="line">  <span class="number">1</span>: <span class="string">'a'</span>,</span><br><span class="line">  <span class="number">2</span>: <span class="string">'b'</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure><p>ä¸Šé¢ï¼Œç¬¬ä¸€ä¸ª<code>aa</code>æ˜¯<code>Map&lt;String, String&gt;</code>ç±»å‹ï¼Œç¬¬äºŒä¸ª<code>bb</code>æ˜¯<code>Map&lt;int, String&gt;</code>ç±»å‹ã€‚</p><p>é€šè¿‡Mapæ„é€ ä¹Ÿå¯ä»¥åˆ›å»ºåŒæ ·çš„æ•ˆæœï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> aa = <span class="built_in">Map</span>();</span><br><span class="line">aa[<span class="string">'a'</span>] = <span class="string">'1'</span>;</span><br><span class="line">aa[<span class="string">'b'</span>] = <span class="string">'2'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bb = <span class="built_in">Map</span>();</span><br><span class="line">bb[<span class="number">1</span>] = <span class="string">'a'</span>;</span><br><span class="line">bb[<span class="number">2</span>] = <span class="string">'b'</span>;</span><br></pre></td></tr></table></div></figure><h3 id="Runes">Runes<a href="post/Note-Learn-Dart#Runes"></a></h3><p>Dartä¸­Runesæ˜¯UTF-32å­—ç¬¦é›†çš„å­—ç¬¦ä¸²å¯¹è±¡</p><p>Unicodeä¸ºä¸–ç•Œä¸Šçš„æ‰€æœ‰æ–‡å­—ç³»ç»Ÿéƒ½å®šä¹‰äº†ä¸€ä¸ªå”¯ä¸€æ•°å­—ä»£è¡¨æ–‡å­—ã€æ•°å­—å’Œç¬¦å·ã€‚å› ä¸ºä¸€ä¸ªDartå­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªUTF-16å­—ç¬¦é›†åºåˆ—ï¼Œåœ¨å­—ç¬¦ä¸²ä¸­è¡¨ç¤º32ä½Unicodeå€¼éœ€è¦ç‰¹æ®Šè¯­æ³•ã€‚</p><p>å¸¸ç”¨æ¥è¡¨è¾¾ä¸€ä¸ªUnicodeå­—ç¬¦çš„æ–¹å¼æ˜¯<code>\uXXXX</code>ï¼Œè¿™å„¿çš„<code>XXXX</code>æ˜¯ä¸€ä¸ª4ä½16è¿›åˆ¶å€¼ã€‚ä¾‹å¦‚ï¼Œå¿ƒå­—ç¬¦ï¼ˆâ™¥ï¼‰æ˜¯<code>\u2665</code>ã€‚å¦‚æœæ˜¯å¤šä½™æˆ–å°‘äº4ä¸ª16è¿›åˆ¶æ•°å­—çš„ï¼Œå°†å€¼æ”¾è¿›å¤§æ‹¬å·é‡Œé¢ã€‚ä¾‹å¦‚ç¬‘çš„emojiï¼ˆğŸ˜†ï¼‰æ˜¯<code>\u{1f600}</code>ã€‚</p><p><a href="https://api.dartlang.org/stable/2.2.0/dart-core/String-class.html" target="_blank" rel="noopener">String</a>ç±»æœ‰å‡ ä¸ªå±æ€§ä½¿æ‚¨å¯ä»¥å°†å­—ç¬¦ä¸²è½¬ä¸ºç¬¦æ–‡runesã€‚<code>codeUnitAt</code>å’Œ<code>codeUnits</code>è¿”å›16ä½å­—ç¬¦é›†ï¼ˆæ•°å­—ç¼–ç ï¼‰ã€‚ä½¿ç”¨<code>runes</code>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç¬¦æ–‡</p><p>ä¸‹é¢è¯´æ˜äº†ç¬¦æ–‡ï¼Œ16ä½å’Œ32ä½å­—ç¬¦é›†ä¹‹é—´çš„å…³ç³»</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> clapping = <span class="string">'\u&#123;1f44f&#125;ab'</span>;</span><br><span class="line"><span class="built_in">print</span>(clapping); <span class="comment">// ğŸ‘ab</span></span><br><span class="line"><span class="built_in">print</span>(clapping.codeUnitAt(<span class="number">0</span>)); <span class="comment">// 55357</span></span><br><span class="line"><span class="built_in">print</span>(clapping.codeUnits); <span class="comment">// [55357, 56399, 97, 98]</span></span><br><span class="line"><span class="built_in">print</span>(clapping.runes.toList()); <span class="comment">// [128079, 97, 98]</span></span><br><span class="line"></span><br><span class="line">Runes input = <span class="keyword">new</span> Runes(</span><br><span class="line">    <span class="string">'\u2665  \u&#123;1f605&#125;  \u&#123;1f60e&#125;  \u&#123;1f47b&#125;  \u&#123;1f596&#125;  \u&#123;1f44d&#125;'</span>);</span><br><span class="line"><span class="built_in">print</span>(<span class="keyword">new</span> <span class="built_in">String</span>.fromCharCodes(input)); <span class="comment">// â™¥  ğŸ˜…  ğŸ˜  ğŸ‘»  ğŸ––  ğŸ‘</span></span><br></pre></td></tr></table></div></figure><h3 id="ç¬¦å·-Symbols">ç¬¦å· Symbols<a href="post/Note-Learn-Dart#ç¬¦å·-Symbols"></a></h3><p>åœ¨Dartç¨‹åºä¸­ï¼Œ<a href="https://api.dartlang.org/stable/2.2.0/dart-core/Symbol-class.html" target="_blank" rel="noopener">Symbol</a>å¯¹è±¡è¡¨ç¤ºå£°æ˜è¿ç®—ç¬¦æˆ–æ ‡è¯†ç¬¦ã€‚æ‚¨å¯èƒ½ä»æ¥ä¸ä¼šä½¿ç”¨åˆ°Symbolï¼Œä½†æ˜¯å®ƒä»¬åœ¨æŒ‰åå­—å¼•ç”¨æ ‡è¯†ç¬¦çš„APIéå¸¸æœ‰ç”¨ï¼Œå› ä¸ºç¼©å°åˆ°æ”¹å˜æ ‡è¯†ç¬¦åç§°è€Œä¸æ›´æ”¹æ ‡è¯†ç¬¦ã€‚</p><p>è·å–æ ‡è¯†ç¬¦çš„symbolï¼Œä½¿ç”¨sybolè¡¨è¾¾å¼ï¼Œåªéœ€<code>#</code>å·åè·Ÿæ ‡è¯†ç¬¦ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="built_in">Map</span>();</span><br><span class="line">map[#foo] = <span class="string">"foo's value"</span>;</span><br><span class="line"><span class="built_in">print</span>(map[#foo]); <span class="comment">// foo's value</span></span><br><span class="line"><span class="built_in">print</span>(#foo); <span class="comment">// Symbol("foo")</span></span><br></pre></td></tr></table></div></figure><p>Symbolæ˜¯ç¼–è¯‘å™¨å¸¸é‡ã€‚</p><h2 id="æ–¹æ³•-Functions">æ–¹æ³• Functions<a href="post/Note-Learn-Dart#æ–¹æ³•-Functions"></a></h2><p>Dartæ˜¯ä¸€ä¸ªçœŸæ­£çš„é¢å‘å¯¹è±¡è¯­è¨€ï¼Œå› æ­¤ç”šè‡³å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡æœ‰ä¸€ä¸ªç±»å‹ï¼Œ<a href="https://api.dartlang.org/stable/dart-core/Function-class.html" target="_blank" rel="noopener">Function</a>ã€‚è¿™æ„å‘³ç€æ–¹æ³•èƒ½åˆ†é…ç»™å˜é‡æˆ–ä¼ å…¥å…¶ä»–æ–¹æ³•ï¼Œä½ ä¹Ÿå¯ä»¥å¥½åƒè°ƒç”¨ä¸€ä¸ªå‡½æ•°ä¸€æ ·ï¼Œè°ƒç”¨Dartç±»çš„å®ä¾‹ã€‚è¯¦æƒ…ï¼Œè¯·å‚é˜…<a href="https://www.dartlang.org/guides/language/language-tour#callable-classes" target="_blank" rel="noopener">å¯è°ƒç”¨çš„ç±»</a>ã€‚</p><p>è¿™å„¿æœ‰ä¸ªå®ç°æ–¹æ³•çš„ä¾‹å­ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span> isNoble(<span class="built_in">int</span> atomicNumber) &#123;</span><br><span class="line">  <span class="keyword">return</span> _nobleGases[atomicNumber] != <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>å°½ç®¡<a href="https://www.dartlang.org/guides/language/effective-dart/design#prefer-type-annotating-public-fields-and-top-level-variables-if-the-type-isnt-obvious" target="_blank" rel="noopener">Effective Dartå»ºè®®å†™ä¸Šè¿”å›ç±»å‹</a>ï¼Œä½†æ˜¯å¦‚æœä½ ä¸å†™ä¹Ÿå¯ä»¥æ­£å¸¸å·¥ä½œï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">isNoble(atomicNumber) &#123;</span><br><span class="line">  <span class="keyword">return</span> _nobleGases[atomicNumber] != <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>è¿™ä¸ªæ–¹æ³•é‡Œé¢åªæœ‰ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œäºæ˜¯å¯ä»¥ç®€å†™ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span> isNoble(<span class="built_in">int</span> atomicNumber) =&gt; _nobleGases[atomicNumber] != <span class="keyword">null</span>;</span><br></pre></td></tr></table></div></figure><p><code>=&gt; è¡¨è¾¾å¼</code>è¯­æ³•æ˜¯<code>{ return è¡¨è¾¾å¼;}</code>çš„ç®€å†™ã€‚<code>=&gt;</code>ç¬¦å·æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºç®­å¤´è¯­æ³•ã€‚</p><p>ä¸€ä¸ªæ–¹æ³•å¯èƒ½æœ‰ä¸¤ä¸ªç±»å‹çš„å‚æ•°ï¼šå¿…é¡»å’Œå¯é€‰ã€‚å¿…è¦çš„å‚æ•°åœ¨æœ€å‰ï¼Œéšåæ˜¯å¯é€‰å‚æ•°ã€‚</p><h3 id="å¯é€‰å‚æ•°">å¯é€‰å‚æ•°<a href="post/Note-Learn-Dart#å¯é€‰å‚æ•°"></a></h3><p>å¯é€‰å‚æ•°å¯ä»¥æ˜¯ä½ç½®å‚æ•°æˆ–å‘½åå‚æ•°ï¼Œä¸èƒ½åŒæ—¶å­˜åœ¨</p><h4 id="å¯é€‰å‘½åå‚æ•°">å¯é€‰å‘½åå‚æ•°<a href="post/Note-Learn-Dart#å¯é€‰å‘½åå‚æ•°"></a></h4><p>å½“è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼Œæ‚¨å¯ä»¥æŒ‡å®šå‘½åå‚æ•°<code>paramName: value.</code>ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enableFlags(bold: <span class="keyword">true</span>, hidden: <span class="keyword">false</span>);</span><br></pre></td></tr></table></div></figure><p>å½“å®šä¹‰ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œä½¿ç”¨<code>{param1, param2, ...}</code>æ¥æŒ‡å®šå‘½åå‚æ•°ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// è®¾ç½®åŠ ç²—å’Œéšè—æ ‡è®°</span></span><br><span class="line"><span class="keyword">void</span> enableFlags(&#123;<span class="built_in">bool</span> bold, <span class="built_in">bool</span> hidden&#125;) &#123;...&#125;</span><br></pre></td></tr></table></div></figure><p><a href="https://flutter.dev/" target="_blank" rel="noopener">Flutter</a>å®ä¾‹åˆ›å»ºå¯èƒ½æ›´å¤æ‚ï¼Œå› æ­¤widgetæ„é€ å™¨ä»…ä½¿ç”¨å‘½åå‚æ•°ã€‚è¿™è®©å®ä¾‹çš„åˆ›å»ºæ›´åŠ å®¹æ˜“é˜…è¯»ã€‚</p><p>æ‚¨å¯ä»¥åœ¨ä»»ä½•Dardä»£ç ä¸­æ ‡è®°æ³¨è§£<a href="https://pub.dartlang.org/documentation/meta/latest/meta/required-constant.html" target="_blank" rel="noopener">@required</a>ï¼Œè¡¨é¢å®ƒæ˜¯ä¸€ä¸ªå¿…ä¼ å‚æ•°ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Scrollbar(&#123;Key key, <span class="meta">@required</span> Widget child&#125;)</span><br></pre></td></tr></table></div></figure><p>å½“<code>Scrollbar</code>è¢«åˆ›å»ºæ—¶ï¼Œå¦‚æœæ²¡æœ‰ä¼ å…¥childé‚£ä¹ˆè§£æå™¨å°±ä¼šæŠ¥å‘Šé—®é¢˜ã€‚</p><p><a href="https://pub.dartlang.org/documentation/meta/latest/meta/required-constant.html" target="_blank" rel="noopener">Required</a>è¢«å®šä¹‰åœ¨<a href="https://pub.dartlang.org/packages/meta" target="_blank" rel="noopener">meta</a>åŒ…ä¸­ï¼Œè¦ä¹ˆç›´æ¥å¯¼å…¥<code>package:meta/meta.dart</code>ï¼Œè¦ä¹ˆå¯¼å…¥çš„å…¶ä»–åŒ…ä¸­å¯¼å…¥è¿‡<code>meta</code>ï¼Œä¾‹å¦‚Flutterçš„<code>package:flutter/material.dart</code>ã€‚</p><p>å‘½åå‚æ•°åŠ äº†<code>@required</code>å¿…ä¼ ï¼Œå…¶ä»–å¯ä¼ å¯ä¸ä¼ ã€‚</p><h4 id="å¯é€‰ä½ç½®å‚æ•°">å¯é€‰ä½ç½®å‚æ•°<a href="post/Note-Learn-Dart#å¯é€‰ä½ç½®å‚æ•°"></a></h4><p>åœ¨<code>[]</code>ä¸­è®¾ç½®å‡½æ•°ç±»å‹ä½¿å®ƒä»¬ä½œä¸ºå¯é€‰ä½ç½®å‚æ•°ï¼Œè¯¥å‚æ•°å¯ä¼ å¯ä¸ä¼ ã€‚</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> say(<span class="built_in">String</span> from, <span class="built_in">String</span> msg, [<span class="built_in">String</span> device]) &#123;</span><br><span class="line">  <span class="keyword">var</span> result = <span class="string">'<span class="subst">$from</span> says <span class="subst">$msg<span class="string">';</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  if (device != null) &#123;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">    result = '</span></span><span class="subst">$result</span> with a <span class="subst">$device<span class="string">';</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  &#125;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  return result;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;</span></span></span></span><br></pre></td></tr></table></div></figure><p>æ²¡æœ‰ä¼ å…¥å¯é€‰ä½ç½®å‚æ•°æ—¶ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(say(<span class="string">'Bob'</span>, <span class="string">'Howdy'</span>)); <span class="comment">// Bob says Howdy</span></span><br></pre></td></tr></table></div></figure><p>å½“ä¼ å…¥å¯é€‰ä½ç½®å‚æ•°çš„æ—¶å€™ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(say(<span class="string">'Bob'</span>, <span class="string">'Howdy'</span>, <span class="string">'smoke signal'</span>)); <span class="comment">// Bob says Howdy with a smoke a signal</span></span><br></pre></td></tr></table></div></figure><h4 id="å‚æ•°é»˜è®¤å€¼">å‚æ•°é»˜è®¤å€¼<a href="post/Note-Learn-Dart#å‚æ•°é»˜è®¤å€¼"></a></h4><p>å‘½åå‚æ•°å’Œä½ç½®å‚æ•°éƒ½å¯ä»¥ä½¿ç”¨<code>=</code>æ¥å®šä¹‰é»˜è®¤å€¼ï¼Œé»˜è®¤å€¼å¿…é¡»æ˜¯ç¼–è¯‘å™¨å¸¸é‡ã€‚å¦‚æœæ²¡æœ‰æä¾›é»˜è®¤å€¼ï¼Œé»˜è®¤å€¼ä¸º<code>null</code></p><p>è®¾ç½®å‘½åå‚æ•°çš„é»˜è®¤å€¼ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> enableFlags(&#123;<span class="built_in">bool</span> bold = <span class="keyword">false</span>, <span class="built_in">bool</span> hidden = <span class="keyword">false</span>&#125;) &#123;...&#125;</span><br><span class="line">enableFlags(bold: <span class="keyword">true</span>); <span class="comment">// bold = true, hidden = false</span></span><br></pre></td></tr></table></div></figure><p>è®¾ç½®å¯é€‰ä½ç½®å‚æ•°çš„é»˜è®¤å€¼ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> say(<span class="built_in">String</span> from, <span class="built_in">String</span> msg,</span><br><span class="line">    [<span class="built_in">String</span> device = <span class="string">'carrier pigeon'</span>, <span class="built_in">String</span> mood]) &#123; ... &#125;</span><br></pre></td></tr></table></div></figure><p>ä½ ä¹Ÿå¯ä»¥ä¸ºåˆ—è¡¨æˆ–é›†åˆå‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> doStuff(</span><br><span class="line">    &#123;<span class="built_in">List</span>&lt;<span class="built_in">int</span>&gt; list = <span class="keyword">const</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">String</span>&gt; gifts = <span class="keyword">const</span> &#123;</span><br><span class="line">      <span class="string">'first'</span>: <span class="string">'paper'</span>,</span><br><span class="line">      <span class="string">'second'</span>: <span class="string">'cotton'</span>,</span><br><span class="line">      <span class="string">'third'</span>: <span class="string">'leather'</span></span><br><span class="line">    &#125;&#125;) &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'list:  <span class="subst">$list<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  print('</span></span>gifts: <span class="subst">$gifts<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;</span></span></span></span><br></pre></td></tr></table></div></figure><h3 id="main-æ–¹æ³•"><code>main()</code>æ–¹æ³•<a href="post/Note-Learn-Dart#main-æ–¹æ³•"></a></h3><p>æ¯ä¸ªappå¿…é¡»æœ‰ä¸ªé¡¶çº§<code>main()</code>æ–¹æ³•ï¼Œå®ƒæ˜¯appçš„å…¥å£ç‚¹ã€‚<code>main()</code>æ–¹æ³•è¿”å›<code>void</code>å¹¶ä¸”æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°<code>List&lt;String&gt;</code>ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªweb appçš„main()æ–¹æ³•ä¾‹å­ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="built_in">querySelector</span>(<span class="string">'#sample_text_id'</span>)</span><br><span class="line">  ..text = <span class="string">'Click me!'</span></span><br><span class="line">  ..onClick.listen(reverseText);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>æ³¨æ„ï¼šè¿™é‡Œçš„<code>..</code>è¯­æ³•è¢«ç§°ä¸º<a href="https://www.dartlang.org/guides/language/language-tour#cascade-notation-" target="_blank" rel="noopener">çº§è”</a>ï¼Œé€šè¿‡çº§è”æ‚¨å¯ä»¥å¤šæ¬¡å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œæ“ä½œã€‚</p></blockquote><p>ä¸‹é¢æ˜¯åˆ›å»ºäº†ä¸€ä¸ªå‘½ä»¤è¡Œè¿è¡Œçš„appï¼Œåœ¨<code>main()</code>æ–¹æ³•çš„å‚æ•°å¯è·å¾—å‘½ä»¤è¡Œçš„å€¼ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main(<span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; arguments) &#123;</span><br><span class="line">  <span class="built_in">print</span>(arguments);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>é¦–å…ˆéœ€è¦é…ç½®å¥½dartç¯å¢ƒå˜é‡ï¼Œç„¶ååœ¨ç»ˆç«¯å½“å‰æ–‡ä»¶ç›®å½•è¿è¡Œï¼š<code>dart test.dart 1 test</code>ï¼Œå°†ä¼šè¾“å‡º<code>[1, test]</code>ã€‚</p><p>æ‚¨å¯ä»¥ä½¿ç”¨<a href="https://www.dartlang.org/guides/language/language-tour#cascade-notation-" target="_blank" rel="noopener">args</a>ç±»åº“å®šä¹‰æˆ–è§£æå‘½ä»¤è¡Œå‚æ•°ã€‚</p><h3 id="æ–¹æ³•çœ‹åšç±»å¯¹è±¡">æ–¹æ³•çœ‹åšç±»å¯¹è±¡<a href="post/Note-Learn-Dart#æ–¹æ³•çœ‹åšç±»å¯¹è±¡"></a></h3><p>æ‚¨å¯ä»¥å°†ä¸€ä¸ªæ–¹æ³•ä½œä¸ºå‚æ•°ä¼ å…¥å¦ä¸€ä¸ªæ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="keyword">void</span> printElement(<span class="built_in">int</span> element) &#123;</span><br><span class="line">    <span class="built_in">print</span>(element);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">  <span class="comment">// å°†æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ å…¥</span></span><br><span class="line">  list.forEach(printElement);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿è¡Œè¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 3</span></span><br></pre></td></tr></table></div></figure><p>æ‚¨ä¹Ÿå¯ä»¥ä¸ºå˜é‡åˆ†é…ä¸€ä¸ªæ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> loudify = (msg) =&gt; <span class="string">'!!!<span class="subst">$&#123;msg.toUpperCase()&#125;</span>!!!'</span>;</span><br><span class="line"><span class="built_in">print</span>(loudify(<span class="string">'hello'</span>)); <span class="comment">// !!!HELLO!!!</span></span><br></pre></td></tr></table></div></figure><p>è¿™ä¸ªä¾‹å­ä½¿ç”¨åŒ¿åæ–¹æ³•ï¼Œæ›´å¤šä¿¡æ¯è¯·æ¥ç€çœ‹çœ‹ä¸‹é¢å“¦ï¼</p><h3 id="åŒ¿åæ–¹æ³•">åŒ¿åæ–¹æ³•<a href="post/Note-Learn-Dart#åŒ¿åæ–¹æ³•"></a></h3><p>å¾ˆå¤šæ–¹é¢éƒ½æœ‰åå­—ï¼Œä¾‹å¦‚<code>main()</code>æˆ–<code>printElement()</code>ã€‚æ‚¨ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªæ²¡æœ‰åå­—çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºåŒ¿åæ–¹æ³•ï¼Œæˆ–<code>lambda</code>ï¼Œæˆ–<code>é—­åŒ…(closure)</code>ã€‚æ‚¨å¯ä»¥åˆ†é…ç»™å˜é‡ä¸€ä¸ªåŒ¿åæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥åœ¨åˆ—è¡¨ä¸­æ·»åŠ æˆ–ç§»é™¤å®ƒã€‚</p><p>åŒ¿åæ–¹æ³•å’Œå‘½åæ–¹æ³•å·®ä¸å¤šï¼Œä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°æ”¾åœ¨æ‹¬å·é‡Œï¼Œä¹‹é—´ç”¨é€—å·åˆ†éš”ã€‚</p><p>ä»£ç æ ·å¼çœ‹èµ·æ¥å¦‚ä¸‹é¢çš„æ ¼å¼ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">([[ç±»å‹] å‚æ•°<span class="number">1</span>[, â€¦]]) &#123;</span><br><span class="line">  ä»£ç å—;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure><p>ä¸‹é¢çš„ä¾‹å­ä¸­å®šä¹‰äº†ä¸€ä¸ªæ— ç±»å‹å‚æ•°<code>item</code>çš„åŒ¿åæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨åˆ—è¡¨è½®è¯¢æ—¶è¢«è°ƒç”¨ï¼Œæ‰“å°å¯¹åº”çš„å€¼å’Œä¸‹æ ‡ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> list = [<span class="string">'apples'</span>, <span class="string">'bananas'</span>, <span class="string">'oranges'</span>];</span><br><span class="line">list.forEach((item) &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'<span class="subst">$&#123;list.indexOf(item)&#125;</span>:<span class="subst">$item<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;);</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">// è¾“å‡ºï¼š</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">// 0:apples</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">// 1:bananas</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">// 2:oranges</span></span></span></span><br></pre></td></tr></table></div></figure><p>ç”±äºè¿™ä¸ªæ–¹æ³•åªæœ‰ä¸€æ¡æŒ‡ä»¤ï¼Œæ‚¨å¯ä»¥ç”¨ç®­å¤´è¡¨è¾¾ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list.forEach((item) =&gt; <span class="built_in">print</span>(<span class="string">'<span class="subst">$&#123;list.indexOf(item)&#125;</span>: <span class="subst">$item<span class="string">'));</span></span></span></span><br></pre></td></tr></table></div></figure><h3 id="ä½œç”¨åŸŸè¯­æ³•">ä½œç”¨åŸŸè¯­æ³•<a href="post/Note-Learn-Dart#ä½œç”¨åŸŸè¯­æ³•"></a></h3><p>Dartä¹Ÿæ˜¯ä¸€ä¸ªä½œç”¨åŸŸè¯­æ³•è¯­è¨€ï¼Œè¿™æ„å‘³ç€å˜é‡çš„ä½œç”¨åŸŸæ˜¯ç¡®å®šçš„ï¼Œåªéœ€æ”¹å˜ä»£ç å¸ƒå±€å°±å¯ã€‚æ‚¨å¯ä»¥ä½¿ç”¨èŠ±æ‹¬å·å¤–çš„å˜é‡æ¥æŸ¥çœ‹æ˜¯å¦åœ¨ä½œç”¨åŸŸå†…ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ–¹æ³•å†…åµŒçš„ä¾‹å­ï¼Œå¹¶ä¸”æ¯ä¸ªç­‰çº§çš„ä½œç”¨åŸŸä¸­éƒ½æœ‰ä¸€ä¸ªå˜é‡ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span> topLevel = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="keyword">var</span> insideMain = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> myFunction() &#123;</span><br><span class="line">    <span class="keyword">var</span> insideFunction = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> nestedFunction() &#123;</span><br><span class="line">      <span class="keyword">var</span> insideNestedFunction = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">assert</span>(topLevel);</span><br><span class="line">      <span class="keyword">assert</span>(insideMain);</span><br><span class="line">      <span class="keyword">assert</span>(insideFunction);</span><br><span class="line">      <span class="keyword">assert</span>(insideNestedFunction);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æ³¨æ„<code>nestedFunction()</code>å¦‚ä½•ä½¿ç”¨æ¯ä¸ªçº§åˆ«çš„å˜é‡ï¼Œä¸€ç›´åˆ°é¡¶çº§ã€‚</p><h3 id="é—­åŒ…è¯­æ³•">é—­åŒ…è¯­æ³•<a href="post/Note-Learn-Dart#é—­åŒ…è¯­æ³•"></a></h3><p>ä¸€ä¸ªé—­åŒ…æ˜¯ä¸€ä¸ªæ–¹æ³•å¯¹è±¡ï¼Œå®ƒèƒ½è®¿é—®åœ¨å®ƒä½œç”¨åŸŸè¯­æ³•å†…çš„å˜é‡ã€‚å³ä½¿å½“è¿™ä¸ªæ–¹æ³•ä½¿ç”¨åœ¨åŸæ¥çš„ä½œç”¨åŸŸä¹‹å¤–ã€‚</p><p>æ–¹æ³•èƒ½å…³è”ä½œç”¨åŸŸèŒƒå›´çš„å˜é‡ï¼Œåœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ<code>makeAdder()</code>è·å–çš„å˜é‡æ˜¯<code>addBy</code>ï¼Œè¿”å›ä¸€ä¸ªæ–¹æ³•ï¼Œæ— è®ºå®ƒè¿”å›åœ¨å“ªéƒ½ä¼šè®°ä½<code>addBy</code>ã€‚</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// è¿”å›ä¸€ä¸ªæ–¹æ³•</span></span><br><span class="line"><span class="comment">/// addBy + æ–¹æ³•çš„å‚æ•°i</span></span><br><span class="line"><span class="built_in">Function</span> makeAdder(<span class="built_in">num</span> addBy) =&gt; (i) =&gt; addBy + i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºä¸€ä¸ªåŠ 2çš„æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">var</span> add2 = makeAdder(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ›å»ºä¸€ä¸ªåŠ 4çš„æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">var</span> add4 = makeAdder(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'<span class="subst">$&#123;add2(<span class="number">3</span>)&#125;</span>, <span class="subst">$&#123;add4(<span class="number">3</span>)&#125;</span>'</span>); <span class="comment">// 5,  7</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="æµ‹è¯•æ–¹æ³•ç›¸ç­‰æ€§">æµ‹è¯•æ–¹æ³•ç›¸ç­‰æ€§<a href="post/Note-Learn-Dart#æµ‹è¯•æ–¹æ³•ç›¸ç­‰æ€§"></a></h3><p>è¿™å„¿æœ‰ä¸€ä¸ªæµ‹è¯•æœ€å¤–å±‚æ–¹æ³•ï¼Œé™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•çš„ç›¸ç­‰æ€§çš„ä¾‹å­ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> foo() &#123;&#125; <span class="comment">// æœ€å¤–å±‚æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">void</span> bar() &#123;&#125; <span class="comment">// é™æ€æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">void</span> baz() &#123;&#125; <span class="comment">// å®ä¾‹æ–¹æ³•</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="keyword">var</span> x;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¯”è¾ƒé™æ€æ–¹æ³•</span></span><br><span class="line">  x = foo;</span><br><span class="line">  <span class="built_in">print</span>(foo == x); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¯”è¾ƒå®ä¾‹æ–¹æ³•</span></span><br><span class="line">  x = A.bar;</span><br><span class="line">  <span class="built_in">print</span>(A.bar == x); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> v = A(); <span class="comment">// ç¬¬ä¸€ä¸ªAå®ä¾‹</span></span><br><span class="line">  <span class="keyword">var</span> w = A(); <span class="comment">// ç¬¬äºŒä¸ªAå®ä¾‹</span></span><br><span class="line">  <span class="keyword">var</span> y = w;</span><br><span class="line">  x = w.baz;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç”±äºè¿™ä¸¤ä¸ªå˜é‡å¼•ç”¨åŒä¸€ä¸ªå®ä¾‹ï¼Œå› æ­¤ä»–ä»¬çš„é—­åŒ…ç›¸ç­‰</span></span><br><span class="line">  <span class="built_in">print</span>(y.baz == x); <span class="comment">// true</span></span><br><span class="line">  <span class="comment">// ç”±äºè¿™æ˜¯ä¸¤ä¸ªå®ä¾‹ï¼Œå› æ­¤ä»–ä»¬çš„é—­åŒ…ä¸ç­‰</span></span><br><span class="line">  <span class="built_in">print</span>(v.baz == w.baz); <span class="comment">// false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="è¿”å›å€¼">è¿”å›å€¼<a href="post/Note-Learn-Dart#è¿”å›å€¼"></a></h3><p>æ‰€æœ‰æ–¹æ³•éƒ½æœ‰ä¸€ä¸ªè¿”å›å€¼ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šè¿”å›å€¼ï¼Œé‚£ä¹ˆåœ¨æ–¹æ³•ä½“ä¸­ä¼šéšå¼å£°æ˜<code>return null;</code></p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">foo() &#123;&#125;</span><br><span class="line"><span class="built_in">print</span>(foo()); <span class="comment">// null</span></span><br></pre></td></tr></table></div></figure><h2 id="è¿ç®—ç¬¦">è¿ç®—ç¬¦<a href="post/Note-Learn-Dart#è¿ç®—ç¬¦"></a></h2><p>ä¸‹é¢çš„è¡¨æ ¼ä¸­å±•ç¤ºäº†Dartä¸­å®šä¹‰çš„è¿ç®—ç¬¦ï¼Œæ‚¨å¯ä»¥è¦†ç›–ä¸‹é¢å¤§éƒ¨åˆ†è¿ç®—ç¬¦ï¼Œè¯¦æƒ…å‚ç…§ï¼š<a href="https://www.dartlang.org/guides/language/language-tour#overridable-operators" target="_blank" rel="noopener">å¯è¦†ç›–è¿ç®—ç¬¦</a></p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">æè¿°</th><th style="text-align:left">è¿ç®—ç¬¦</th></tr></thead><tbody><tr><td style="text-align:left">å•ç›®åç½®</td><td style="text-align:left"><code>expr++</code> <code>expr--</code> <code>()</code> <code>[]</code> <code>.</code> <code>?.</code></td></tr><tr><td style="text-align:left">å•ç›®å‰ç½®</td><td style="text-align:left"><code>-expr</code> <code>!expr</code> <code>~expr</code> <code>++expr</code> <code>--expr</code></td></tr><tr><td style="text-align:left">ä¹˜æ³•ç±»</td><td style="text-align:left"><code>*</code> <code>/</code> <code>%</code> <code>~/</code></td></tr><tr><td style="text-align:left">åŠ å‡ç±»</td><td style="text-align:left"><code>+</code> <code>-</code></td></tr><tr><td style="text-align:left">ä½ç§»</td><td style="text-align:left"><code>&gt;&gt;</code> <code>&lt;&lt;</code> <code>&gt;&gt;&gt;</code></td></tr><tr><td style="text-align:left">æŒ‰ä½ä¸</td><td style="text-align:left"><code>&amp;</code></td></tr><tr><td style="text-align:left">æŒ‰ä½å¼‚æˆ–</td><td style="text-align:left"><code>^</code></td></tr><tr><td style="text-align:left">æŒ‰ä½æˆ–</td><td style="text-align:left">`</td><td>`</td></tr><tr><td style="text-align:left">å…³ç³»å’Œç±»å‹æ ¡éªŒ</td><td style="text-align:left"><code>&gt;=</code> <code>&gt;</code> <code>&lt;=</code> <code>&lt;</code> <code>as</code> <code>is</code> â€˜is!â€™</td></tr><tr><td style="text-align:left">ç­‰æ€§</td><td style="text-align:left"><code>==</code> <code>!=</code></td></tr><tr><td style="text-align:left">é€»è¾‘ä¸</td><td style="text-align:left"><code>&amp;&amp;</code></td></tr><tr><td style="text-align:left">é€»è¾‘æˆ–</td><td style="text-align:left">`</td><td></td><td>`</td></tr><tr><td style="text-align:left">æ˜¯å¦æ˜¯null</td><td style="text-align:left">??</td></tr><tr><td style="text-align:left">ä¸‰ç›®è¿ç®—</td><td style="text-align:left"><code>expr1 ? expr2 : expr2</code></td></tr><tr><td style="text-align:left">çº§è”</td><td style="text-align:left"><code>..</code></td></tr><tr><td style="text-align:left">èµ‹å€¼</td><td style="text-align:left"><code>=</code> <code>*=</code> <code>/=</code> <code>+=</code> <code>-=</code> <code>&amp;=</code> <code>^=</code> ç­‰</td></tr></tbody></table></div></div><h3 id="ç®—æ•°è¿ç®—ç¬¦">ç®—æ•°è¿ç®—ç¬¦<a href="post/Note-Learn-Dart#ç®—æ•°è¿ç®—ç¬¦"></a></h3><p>Dartæ”¯æŒå¸¸ç”¨ç®—æ•°è¿ç®—ç¬¦ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">è¿ç®—ç¬¦</th><th style="text-align:left">è§£é‡Š</th></tr></thead><tbody><tr><td style="text-align:left"><code>+</code></td><td style="text-align:left">åŠ </td></tr><tr><td style="text-align:left"><code>-</code></td><td style="text-align:left">å‡</td></tr><tr><td style="text-align:left"><code>-expr</code></td><td style="text-align:left">ä¸€å…ƒå‡ï¼Œä¹Ÿç§°ä¸ºå¦å®šï¼ˆåè½¬è¡¨è¾¾å¼çš„ç¬¦å·ï¼‰</td></tr><tr><td style="text-align:left"><code>*</code></td><td style="text-align:left">ä¹˜</td></tr><tr><td style="text-align:left"><code>/</code></td><td style="text-align:left">é™¤</td></tr><tr><td style="text-align:left"><code>~/</code></td><td style="text-align:left">é™¤ä»¥ï¼Œå¹¶è¿”å›æ•´æ•°ç»“æœ</td></tr><tr><td style="text-align:left"><code>%</code></td><td style="text-align:left">æ±‚ä½™</td></tr></tbody></table></div></div><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="number">5</span> / <span class="number">2</span>); <span class="comment">// 2.5</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">5</span> ~/ <span class="number">2</span>); <span class="comment">// 2</span></span><br></pre></td></tr></table></div></figure><p>Dartä¹Ÿæ”¯æŒå•ç›®é€’å¢å’Œé€’å‡è¿ç®—ç¬¦</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">è¿ç®—ç¬¦</th><th style="text-align:left">è§£é‡Š</th></tr></thead><tbody><tr><td style="text-align:left"><code>++var</code></td><td style="text-align:left"><code>var = var + 1</code>(è¡¨è¾¾å¼çš„å€¼ä¸º<code>var + 1</code>)</td></tr><tr><td style="text-align:left"><code>var++</code></td><td style="text-align:left"><code>var = var + 1</code>(è¡¨è¾¾å¼çš„å€¼ä¸º<code>var</code>)</td></tr><tr><td style="text-align:left"><code>--var</code></td><td style="text-align:left"><code>var = var - 1</code>(è¡¨è¾¾å¼çš„å€¼ä¸º<code>var - 1</code>)</td></tr><tr><td style="text-align:left"><code>var--</code></td><td style="text-align:left"><code>var = var - 1</code>(è¡¨è¾¾å¼çš„å€¼ä¸º<code>var</code>)</td></tr></tbody></table></div></div><h3 id="ç­‰å¼å’Œå…³ç³»è¿ç®—ç¬¦">ç­‰å¼å’Œå…³ç³»è¿ç®—ç¬¦<a href="post/Note-Learn-Dart#ç­‰å¼å’Œå…³ç³»è¿ç®—ç¬¦"></a></h3><p>ä¸‹é¢çš„è¡¨æ ¼åˆ—å‡ºäº†ç­‰å¼å’Œå…³ç³»è¿ç®—ç¬¦çš„å«ä¹‰</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">è¿ç®—ç¬¦</th><th style="text-align:left">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left"><code>==</code></td><td style="text-align:left">æ’ç­‰äº</td></tr><tr><td style="text-align:left"><code>!=</code></td><td style="text-align:left">ä¸ç­‰äº</td></tr><tr><td style="text-align:left"><code>&gt;</code></td><td style="text-align:left">å¤§äº</td></tr><tr><td style="text-align:left"><code>&lt;</code></td><td style="text-align:left">å°äº</td></tr><tr><td style="text-align:left"><code>&gt;=</code></td><td style="text-align:left">å¤§äºæˆ–ç­‰äº</td></tr><tr><td style="text-align:left"><code>&lt;=</code></td><td style="text-align:left">å°äºæˆ–ç­‰äº</td></tr></tbody></table></div></div><p>ä½¿ç”¨<code>==</code>åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼ˆåœ¨å°‘æ•°æƒ…å†µä¸‹æ‚¨éœ€è¦åˆ¤æ–­ä¸¤ä¸ªå¼•ç”¨æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œä½¿ç”¨<a href="https://api.dartlang.org/stable/2.2.0/dart-core/identical.html" target="_blank" rel="noopener">identical()</a>ï¼‰</p><h3 id="ç±»å‹æ£€æµ‹è¿ç®—ç¬¦">ç±»å‹æ£€æµ‹è¿ç®—ç¬¦<a href="post/Note-Learn-Dart#ç±»å‹æ£€æµ‹è¿ç®—ç¬¦"></a></h3><p><code>as</code>,<code>is</code>å’Œ<code>is!</code>è¿ç®—ç¬¦ç”¨æ¥æ£€æµ‹è¿è¡Œæ—¶ç±»å‹</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">è¿ç®—ç¬¦</th><th style="text-align:left">æ„æ€</th></tr></thead><tbody><tr><td style="text-align:left"><code>as</code></td><td style="text-align:left">ç±»å‹è½¬æ¢ï¼ˆä¹Ÿç»å¸¸ç”¨æ¥æŒ‡å®š<a href="https://www.dartlang.org/guides/language/language-tour#specifying-a-library-prefix" target="_blank" rel="noopener">ç±»åº“å‰ç¼€</a>ï¼‰</td></tr><tr><td style="text-align:left"><code>is</code></td><td style="text-align:left">å¯¹è±¡æ˜¯å¦æœ‰æŒ‡å®šçš„ç±»å‹</td></tr><tr><td style="text-align:left"><code>is!</code></td><td style="text-align:left">å’Œä¸Šé¢ç›¸å</td></tr></tbody></table></div></div><p><code>as</code> å¼ºè½¬ç±»å‹ï¼Œ <code>is</code> ç±»å‹åˆ¤æ–­</p><h3 id="èµ‹å€¼è¿ç®—ç¬¦">èµ‹å€¼è¿ç®—ç¬¦<a href="post/Note-Learn-Dart#èµ‹å€¼è¿ç®—ç¬¦"></a></h3><p>æ‚¨å·²çŸ¥é“ï¼Œæ‚¨å¯ä»¥é€šè¿‡<code>=</code>è¿ç®—ç¬¦ä¸ºå˜é‡èµ‹å€¼ã€‚å¦‚æœè¦ä»…ä»…å˜é‡ä¸º<code>null</code>æ—¶æ‰èµ‹å€¼ï¼Œä½¿ç”¨<code>??=</code>è¿ç®—ç¬¦</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="built_in">int</span> a = <span class="number">5</span>;</span><br><span class="line">  <span class="built_in">int</span> b;</span><br><span class="line"></span><br><span class="line">  a ??= <span class="number">10</span>;</span><br><span class="line">  b ??= <span class="number">10</span>;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'a = <span class="subst">$a</span>, b = <span class="subst">$b<span class="string">'); // a = 5, b = 10</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;</span></span></span></span><br></pre></td></tr></table></div></figure><p>ç»„åˆèµ‹å€¼è¿ç®—ç¬¦ï¼Œå¦‚<code>+=</code>å°†è¿ç®—ç¬¦å’Œèµ‹å€¼ç»“åˆ</p><div class="article-bounded"><div class="article-table"><table><tbody><tr><td style="text-align:left"><code>=</code></td><td style="text-align:left"><code>-=</code></td><td style="text-align:left"><code>/=</code></td><td style="text-align:left"><code>%=</code></td><td style="text-align:left"><code>&gt;&gt;=</code></td><td style="text-align:left"><code>^=</code></td></tr><tr><td style="text-align:left"><code>+=</code></td><td style="text-align:left"><code>*=</code></td><td style="text-align:left"><code>~/=</code></td><td style="text-align:left"><code>&lt;&lt;=</code></td><td style="text-align:left"><code>&amp;=</code></td><td style="text-align:left"><code>&#124;=</code></td></tr></tbody></table></div></div><h3 id="é€»è¾‘è¿ç®—ç¬¦">é€»è¾‘è¿ç®—ç¬¦<a href="post/Note-Learn-Dart#é€»è¾‘è¿ç®—ç¬¦"></a></h3><p>æ‚¨å¯ä»¥é€šè¿‡é€»è¾‘è¿ç®—ç¬¦é¢ å€’æˆ–ç»„åˆå¸ƒå°”è¡¨è¾¾å¼</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">è¿ç®—ç¬¦</th><th style="text-align:left">æ„æ€</th></tr></thead><tbody><tr><td style="text-align:left"><code>!expr</code></td><td style="text-align:left">é¢ å€’æ˜¯é</td></tr><tr><td style="text-align:left"><code>&#124;&#124;</code></td><td style="text-align:left">é€»è¾‘æˆ–</td></tr><tr><td style="text-align:left"><code>&amp;&amp;</code></td><td style="text-align:left">é€»è¾‘ä¸</td></tr></tbody></table></div></div><h3 id="æŒ‰ä½è¿ç®—å’Œç§»ä½è¿ç®—ç¬¦">æŒ‰ä½è¿ç®—å’Œç§»ä½è¿ç®—ç¬¦<a href="post/Note-Learn-Dart#æŒ‰ä½è¿ç®—å’Œç§»ä½è¿ç®—ç¬¦"></a></h3><p>æ‚¨å¯ä»¥åœ¨Dartä¸­æ“ä½œæ•°å­—çš„ä½è¿ç®—</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">è¿ç®—ç¬¦</th><th style="text-align:left">æ„æ€</th></tr></thead><tbody><tr><td style="text-align:left"><code>&amp;</code></td><td style="text-align:left">ä¸</td></tr><tr><td style="text-align:left"><code>&#124;</code></td><td style="text-align:left">æˆ–</td></tr><tr><td style="text-align:left"><code>^</code></td><td style="text-align:left">å¼‚æˆ–</td></tr><tr><td style="text-align:left"><code>~expr</code></td><td style="text-align:left">å–å</td></tr><tr><td style="text-align:left"><code>&lt;&lt;</code></td><td style="text-align:left">å·¦ç§»</td></tr><tr><td style="text-align:left"><code>&gt;&gt;</code></td><td style="text-align:left">å³ç§»</td></tr></tbody></table></div></div><h3 id="æ¡ä»¶è¡¨è¾¾å¼">æ¡ä»¶è¡¨è¾¾å¼<a href="post/Note-Learn-Dart#æ¡ä»¶è¡¨è¾¾å¼"></a></h3><p>Dartæœ‰ä¸¤ç§è¡¨è¾¾å¼è®©æ‚¨ç®€æ˜çš„è¡¨è¾¾éœ€è¦ä½¿ç”¨åˆ°<code>if-else</code>çš„æƒ…æ™¯ï¼š</p><p>1.ä¸‰ç›®è¿ç®—ç¬¦</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">condition ? expr1 : expr2</span><br></pre></td></tr></table></div></figure><p>2.æ˜¯å¦ä¸ºnullï¼Œå¦‚æœä¸ºnullåˆ™ç”¨åé¢çš„è¡¨è¾¾å¼</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">expr1 ?? expr2</span><br></pre></td></tr></table></div></figure><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="number">1</span> &gt; <span class="number">2</span> ? <span class="string">"æ˜¯çš„1&gt;2"</span> : <span class="string">"ä¸ä¸ï¼Œ1&lt;2"</span>); <span class="comment">// ä¸ä¸ï¼Œ1&lt;2</span></span><br><span class="line">  <span class="built_in">int</span> value;</span><br><span class="line">  <span class="built_in">print</span>(value ?? <span class="number">100</span>); <span class="comment">// 100</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="çº§è”è¡¨ç¤ºæ³•">çº§è”è¡¨ç¤ºæ³•<a href="post/Note-Learn-Dart#çº§è”è¡¨ç¤ºæ³•"></a></h3><p><code>..</code>å…è®¸æ‚¨å¯¹åŒä¸€ä¸ªå¯¹è±¡è¿›è¡Œä¸€ç³»åˆ—è¿ç»­çš„æ“ä½œã€‚ä¸ä»…å¯ä»¥è°ƒç”¨æ–¹æ³•ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä¸ºè¿™ä¸ªå¯¹è±¡å­—æ®µèµ‹å€¼ã€‚è¿™é€šå¸¸ä¸ºæ‚¨èŠ‚çœäº†åˆ›å»ºä¸´æ—¶å˜é‡çš„ä¸æ­¥éª¤ï¼Œå¹¶èƒ½è®©ä½ å†™æˆæ›´å¤šæµç•…çš„ä»£ç ã€‚</p><p>è¯·å‚è€ƒä¸‹é¢ä»£ç ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">querySelector</span>(<span class="string">'#confirm'</span>) <span class="comment">// è·å¾—ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">  ..text = <span class="string">'Confirm'</span> <span class="comment">// ä½¿ç”¨å®ƒçš„æˆå‘˜å˜é‡</span></span><br><span class="line">  ..classes.add(<span class="string">'important'</span>)</span><br><span class="line">  ..onClick.listen((e) =&gt; <span class="built_in">window</span>.alert(<span class="string">'Confirmed!'</span>));</span><br></pre></td></tr></table></div></figure><p>è¿˜æœ‰å†…éƒ¨è”ç»“ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> addressBook = (AddressBookBuilder()</span><br><span class="line">      ..name = <span class="string">'jenny'</span></span><br><span class="line">      ..email = <span class="string">'jenny@example.com'</span></span><br><span class="line">      ..phone = (PhoneNumberBuilder()</span><br><span class="line">            ..number = <span class="string">'415-555-0100'</span></span><br><span class="line">            ..label = <span class="string">'home'</span>)</span><br><span class="line">          .build())</span><br><span class="line">    .build();</span><br></pre></td></tr></table></div></figure><h3 id="å…¶ä»–æ“ä½œç¬¦">å…¶ä»–æ“ä½œç¬¦<a href="post/Note-Learn-Dart#å…¶ä»–æ“ä½œç¬¦"></a></h3><p>æ‚¨å·²åœ¨å…¶ä»–æ¡ˆä¾‹ä¸­çœ‹åˆ°äº†å¤§å¤šæ•°çš„ç›¸å…³æ“ä½œç¬¦</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">æ“ä½œç¬¦</th><th style="text-align:left">åå­—</th><th style="text-align:left">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left"><code>()</code></td><td style="text-align:left">æ–¹æ³•</td><td style="text-align:left">è¡¨ç¤ºæ–¹æ³•è°ƒç”¨</td></tr><tr><td style="text-align:left"><code>[]</code></td><td style="text-align:left">åˆ—è¡¨è®¿é—®</td><td style="text-align:left">é€šè¿‡ç´¢å¼•å¼•ç”¨åˆ—è¡¨ä¸­çš„å€¼</td></tr><tr><td style="text-align:left"><code>.</code></td><td style="text-align:left">æˆå‘˜è®¿é—®</td><td style="text-align:left">å¼•ç”¨ä¸€ä¸ªå±æ€§ï¼›ä¾‹å¦‚ï¼š<code>foo.bar</code>ï¼Œå¼•ç”¨fooå¯¹è±¡ä¸­çš„barå±æ€§</td></tr><tr><td style="text-align:left"><code>?.</code></td><td style="text-align:left">æ¡ä»¶æˆå‘˜è®¿é—®</td><td style="text-align:left">å·¦è¾¹çš„å˜é‡å¯ä»¥æ˜¯null</td></tr></tbody></table></div></div><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  A a;</span><br><span class="line">  <span class="built_in">print</span>(a?.b); <span class="comment">// null, å¦‚æœä¸åŠ â€œï¼Ÿâ€å°±ä¼šæŠ¥é”™</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æ›´å¤šå…³äº<code>.</code>ï¼Œ<code>?.</code>å’Œ<code>..</code>çš„æ“ä½œï¼Œè¯·å‚è€ƒ<a href="https://www.dartlang.org/guides/language/language-tour#classes" target="_blank" rel="noopener">ç±»</a></p><h2 id="æ§åˆ¶æµè¯­å¥">æ§åˆ¶æµè¯­å¥<a href="post/Note-Learn-Dart#æ§åˆ¶æµè¯­å¥"></a></h2><p>æ‚¨å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»»æ„Dartä»£ç æ§åˆ¶æµç¨‹</p><ul><li><code>if</code> å’Œ <code>else</code></li><li><code>for</code> å¾ªç¯</li><li><code>while</code> å’Œ <code>do-while</code>å¾ªç¯</li><li><code>break</code> å’Œ <code>continue</code></li><li><code>switch</code> å’Œ <code>case</code></li><li><code>assert</code></li></ul><p>æ‚¨ä¹Ÿå¯ä»¥å¯ä»¥é€šè¿‡<code>try-catch</code>å’Œ<code>throw</code>å½±å“æµç¨‹ï¼Œè¯¦ç»†ä»‹ç»åœ¨<a href="https://www.dartlang.org/guides/language/language-tour#exceptions" target="_blank" rel="noopener">å¼‚å¸¸</a></p><h3 id="forå¾ªç¯">forå¾ªç¯<a href="post/Note-Learn-Dart#forå¾ªç¯"></a></h3><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="keyword">var</span> callback = [];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">    callback.add(() =&gt; <span class="built_in">print</span>(i));</span><br><span class="line">  &#125;</span><br><span class="line">  callback.forEach((c) =&gt; c());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment">// 0</span></span><br><span class="line"><span class="comment">// 1</span></span><br></pre></td></tr></table></div></figure><p>åˆ—è¡¨ä¸­æ”¾å…¥çš„æ˜¯ä¸¤ä¸ªé—­åŒ…ï¼Œåˆ—è¡¨æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<a href="https://api.dartlang.org/stable/2.2.0/dart-core/Iterable/forEach.html" target="_blank" rel="noopener">forEach()</a>æ–¹æ³•æ¥éå†ã€‚å¦‚æœä½ ä¸éœ€è¦çŸ¥é“å½“å‰çš„è¿­ä»£æ•°é‡ï¼Œä½¿ç”¨<code>forEach()</code>æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">candidates.forEach((candidate) =&gt; candidate.interview());</span><br></pre></td></tr></table></div></figure><p>å¯è¿­ä»£çš„ç±»å¦‚Listå’ŒSetä¹Ÿæ”¯æŒ<code>for-in</code><a href="https://www.dartlang.org/guides/libraries/library-tour#iteration" target="_blank" rel="noopener">iteration</a>ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> collection = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">in</span> collection) &#123;</span><br><span class="line">  <span class="built_in">print</span>(x); <span class="comment">// 0 1 2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="Switchå’Œcase">Switchå’Œcase<a href="post/Note-Learn-Dart#Switchå’Œcase"></a></h3><p>å€¼å¾—æ³¨æ„çš„æ˜¯switché‡Œé¢ä½¿ç”¨<code>==</code>ä½œä¸ºåˆ¤æ–­æ•´å‹ï¼Œå­—ç¬¦ä¸²æˆ–ç¼–è¯‘æœŸå¸¸é‡ã€‚ç”¨æ³•å¤§è‡´å’Œjavaå·®ä¸å¤šï¼Œä¸»è¦æ³¨æ„ä¸‹é¢è¿™æ ·çš„å†™æ³•æœ‰æ”¹è¿›ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> command = <span class="string">'OPEN'</span>;</span><br><span class="line"><span class="keyword">switch</span> (command) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'OPEN'</span>:</span><br><span class="line">    executeOpen();</span><br><span class="line">    <span class="comment">// é”™è¯¯ï¼š æ²¡æœ‰break ï¼ˆå¦‚æœå»æ‰executeOpen();ä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼‰</span></span><br><span class="line">  <span class="keyword">case</span> <span class="string">'CLOSED'</span>:</span><br><span class="line">    executeClosed();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æ”¹ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> command = <span class="string">'CLOSED'</span>;</span><br><span class="line"><span class="keyword">switch</span> (command) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'CLOSED'</span>:</span><br><span class="line">    executeClosed();</span><br><span class="line">    <span class="keyword">continue</span> nowClosed;</span><br><span class="line">  <span class="comment">// ç»§ç»­æ‰§è¡ŒnowClosedæ ‡ç­¾</span></span><br><span class="line"></span><br><span class="line">  nowClosed:</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'NOW_CLOSED'</span>:</span><br><span class="line">    <span class="comment">// Runs for both CLOSED and NOW_CLOSED.</span></span><br><span class="line">    executeNowClosed();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="æ–­è¨€">æ–­è¨€<a href="post/Note-Learn-Dart#æ–­è¨€"></a></h2><p>æ–­è¨€ä¸ä¼šå½±å“åˆ°ç”Ÿäº§ä»£ç ï¼Œåªåº”ç”¨åœ¨å¼€å‘è°ƒè¯•æ¨¡å¼ä¸‹</p><h2 id="å¼‚å¸¸">å¼‚å¸¸<a href="post/Note-Learn-Dart#å¼‚å¸¸"></a></h2><p>æ‚¨çš„Dartä»£ç å¯ä»¥æŠ›å‡ºæˆ–æ•è·å¼‚å¸¸ï¼Œå¼‚å¸¸æ˜¯å‘ç”Ÿäº†ä¸€äº›ä¸å¸Œæœ›çš„ã€‚å¦‚æœå¼‚å¸¸æ²¡æœ‰æ•è·å¤„ç†ï¼Œä¼šå¯¼è‡´ç¨‹åºç»ˆæ­¢ã€‚Dartæä¾›<a href="https://api.dartlang.org/stable/2.2.0/dart-core/Exception-class.html" target="_blank" rel="noopener">Exception</a>å’Œ<a href="https://api.dartlang.org/stable/2.2.0/dart-core/Error-class.html" target="_blank" rel="noopener">Error</a>ç±»å‹ï¼Œä»¥åŠè®¸å¤šé¢„å®šä¹‰çš„å­ç±»å‹ã€‚å½“ç„¶ï¼Œæ‚¨ä¹Ÿå¯ä»¥å®šä¹‰æ‚¨è‡ªå·±çš„å¼‚å¸¸ã€‚ç„¶è€Œå¯¹äºå¼‚å¸¸ï¼ŒDartç¨‹åºèƒ½æŠ›å‡ºä»»ä½•énullå¯¹è±¡ï¼Œä¸ä»…ä»…æ˜¯Exceptionå’ŒErrorå¯¹è±¡ã€‚</p><h3 id="Throw">Throw<a href="post/Note-Learn-Dart#Throw"></a></h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæŠ›å‡ºå¼‚å¸¸çš„åˆ—å­ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> FormatException(<span class="string">'Expected at least 1 section'</span>);</span><br></pre></td></tr></table></div></figure><p>æ‚¨ä¹Ÿå¯ä»¥éšæ„æŠ›å‡ºä¸€ä¸ªå¯¹è±¡ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="string">'å¼‚å¸¸ã€‚ã€‚ã€‚'</span>;</span><br></pre></td></tr></table></div></figure><p>ç”±äºæŠ›å‡ºå¼‚å¸¸æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå¯ä»¥é€šè¿‡<code>=&gt;</code>å¦‚ä¸‹è¡¨è¾¾ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> distanceTo(Point other) =&gt; <span class="keyword">throw</span> UnimplementedError();</span><br></pre></td></tr></table></div></figure><h3 id="Catch">Catch<a href="post/Note-Learn-Dart#Catch"></a></h3><p>æ•è·ä¸€ä¸ªå¼‚å¸¸</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  breedMoreLlamas();</span><br><span class="line">&#125; on OutOfLlamasException &#123;</span><br><span class="line">  buyMoreLlamas();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æ•è·å¤šä¸ªå¼‚å¸¸ï¼Œ<code>catch</code>å¯ä»¥å¾—åˆ°å¼‚å¸¸å¯¹è±¡çš„å¼•ç”¨ï¼Œå¦‚æœä¸æ˜ç¡®ç±»å‹ç›´æ¥ç”¨<code>catch</code>ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  breedMoreLlamas();</span><br><span class="line">&#125; on OutOfLlamasException &#123;</span><br><span class="line">  <span class="comment">// ä¸€ä¸ªç‰¹å®šå¼‚å¸¸</span></span><br><span class="line">  buyMoreLlamas();</span><br><span class="line">&#125; on Exception <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="comment">// ä»»ä½•å…¶ä»–ç±»å‹Exceptionå¼‚å¸¸</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'Unknown exception: <span class="subst">$e<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125; catch (e) &#123;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  // ä¸æŒ‡å®šç±»å‹ï¼Œå¤„ç†æ‰€æœ‰</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  print('</span></span>Something really unknown: <span class="subst">$e<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;</span></span></span></span><br></pre></td></tr></table></div></figure><p><code>catch()</code>å¯æŒ‡å®šä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æŠ›å‡ºçš„å¼‚å¸¸å¯¹è±¡ï¼Œç¬¬äºŒä¸ªæ˜¯å †æ ˆï¼ˆ<a href="https://api.dartlang.org/stable/2.2.0/dart-core/StackTrace-class.html" target="_blank" rel="noopener">StackTrace</a>ï¼‰</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">// Â·Â·Â·</span></span><br><span class="line">&#125; on Exception <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'Exception details:\n <span class="subst">$e<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125; catch (e, s) &#123;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  print('</span></span>Exception details:\n <span class="subst">$e<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  print('</span></span>Stack trace:\n <span class="subst">$s<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;</span></span></span></span><br></pre></td></tr></table></div></figure><p>æ—¢è¦å¤„ç†å¼‚å¸¸ï¼Œåˆè¦è®©å¼‚å¸¸é‡æ–°è·‘å‡ºå»ä½¿ç”¨<code>rethrow</code>å…³é”®å­—</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> misbehave() &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">dynamic</span> foo = <span class="keyword">true</span>;</span><br><span class="line">    <span class="built_in">print</span>(foo++); <span class="comment">// è¿è¡Œæ—¶é”™è¯¯</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'misbehave() partially handled <span class="subst">$&#123;e.runtimeType&#125;</span>.'</span>);</span><br><span class="line">    <span class="keyword">rethrow</span>; <span class="comment">// è®©è°ƒç”¨è€…ç»§ç»­å¾—åˆ°å¼‚å¸¸</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="Finally">Finally<a href="post/Note-Learn-Dart#Finally"></a></h3><p>å’Œjavaä¸€æ ·</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Dartç¬”è®°&quot;&gt;Dartç¬”è®°&lt;a href=&quot;post/Note-Learn-Dart#Dartç¬”è®°&quot;&gt;&lt;/a&gt;&lt;/h1&gt;&lt;h2 id=&quot;å˜é‡&quot;&gt;å˜é‡&lt;a href=&quot;post/Note-Learn-Dart#å˜é‡&quot;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;åˆå§‹åŒ–ä¸€ä¸ªå˜é‡&lt;/p&gt;
      
    
    </summary>
    
      <category term="Dart" scheme="https://blog.xujiaji.com/categories/Dart/"/>
    
    
      <category term="ç¬”è®°" scheme="https://blog.xujiaji.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="Dart" scheme="https://blog.xujiaji.com/tags/Dart/"/>
    
  </entry>
  
  <entry>
    <title>OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVBOï¼‰</title>
    <link href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven/index.html"/>
    <id>https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven/index.html</id>
    <published>2019-03-09T08:49:10.000Z</published>
    <updated>2019-04-12T17:44:07.238Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»è¯‘æ–‡</p></blockquote><p>åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Seven: An Introduction to Vertex Buffer Objects (VBOs)<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.learnopengles.com/android-lesson-seven-an-introduction-to-vertex-buffer-objects-vbos/" target="_blank" rel="noopener">http://www.learnopengles.com/android-lesson-seven-an-introduction-to-vertex-buffer-objects-vbos/</a><br><a id="more"></a></p><hr><h1 id="ä»‹ç»Vertex-Buffer-Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVBOï¼‰">ä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVBOï¼‰<a href="post/Learn-OpenGL-Lesson-Seven#ä»‹ç»Vertex-Buffer-Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVBOï¼‰"></a></h1><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>åœ¨è¿™èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•å®šä¹‰å’Œå¦‚ä½•å»ä½¿ç”¨<br>é¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼ˆVBOï¼‰ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬è¦è®²åˆ°çš„å‡ ç‚¹ï¼š<br><br>1.æ€æ ·ç”¨é¡¶ç‚¹ç¼“å†²å¯¹è±¡å®šä¹‰å’Œæ¸²æŸ“<br>2.å•ä¸ªç¼“å†²åŒºã€æ‰€æœ‰æ•°æ®æ‰“åŒ…è¿›å»ã€å¤šä¸ªç¼“å†²åŒºä¹‹é—´çš„åŒºåˆ«<br>3.é—®é¢˜å’Œé™·é˜±æˆ‘ä»¬å¦‚ä½•å–å¤„ç†å®ƒä»¬</td><td style="text-align:center"><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190309170313.png" alt="screenshot"></td></tr></tbody></table></div></div><h2 id="ä»€ä¹ˆæ˜¯é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨å®ƒä»¬ï¼Ÿ">ä»€ä¹ˆæ˜¯é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨å®ƒä»¬ï¼Ÿ<a href="post/Learn-OpenGL-Lesson-Seven#ä»€ä¹ˆæ˜¯é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨å®ƒä»¬ï¼Ÿ"></a></h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„è¯¾ç¨‹éƒ½æ˜¯å°†å¯¹è±¡æ•°æ®å­˜å‚¨åœ¨å®¢æˆ·ç«¯å†…å­˜ä¸­ï¼Œåªæœ‰åœ¨æ¸²æŸ“æ—¶å°†å…¶ä¼ è¾“åˆ°GPUä¸­ã€‚æ²¡æœ‰å¤§é‡æ•°æ®ä¼ è¾“æ—¶ï¼Œè¿™å¾ˆå¥½ï¼Œä½†éšç€æˆ‘ä»¬çš„åœºæ™¯è¶Šæ¥è¶Šå¤æ‚ï¼Œæœ‰æ›´å¤šçš„ç‰©ä½“å’Œä¸‰è§’å½¢ï¼Œè¿™ä¼šç»™GPUå’Œå†…å­˜å¢åŠ é¢å¤–çš„æˆæœ¬ã€‚</p><p>æˆ‘ä»¬èƒ½åšäº›ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ¯å¸§ä»å®¢æˆ·ç«¯å†…å­˜ä¼ è¾“é¡¶ç‚¹ä¿¡æ¯ï¼Œä¿¡æ¯å°†è¢«ä¼ è¾“ä¸€æ¬¡ï¼Œç„¶åæ¸²æŸ“å™¨å°†ä»è¯¥å›¾å½¢å­˜å‚¨å™¨ç¼“å­˜ä¸­å¾—åˆ°æ•°æ®ã€‚</p><h2 id="å‰ææ¡ä»¶">å‰ææ¡ä»¶<a href="post/Learn-OpenGL-Lesson-Seven#å‰ææ¡ä»¶"></a></h2><p>è¯·é˜…è¯»<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a>ä»‹ç»å¦‚ä½•ä»å®¢æˆ·ç«¯çš„å†…å­˜ä¸Šä¼ é¡¶ç‚¹æ•°æ®ã€‚äº†è§£OpenGL ESå¦‚ä½•ä¸é¡¶ç‚¹æ•°ç»„ä¸€èµ·å·¥ä½œå¯¹äºç†è§£æœ¬è¯¾è‡³å…³é‡è¦ã€‚</p><h2 id="æ›´è¯¦ç»†çš„äº†è§£å®¢æˆ·ç«¯ç¼“å†²åŒº">æ›´è¯¦ç»†çš„äº†è§£å®¢æˆ·ç«¯ç¼“å†²åŒº<a href="post/Learn-OpenGL-Lesson-Seven#æ›´è¯¦ç»†çš„äº†è§£å®¢æˆ·ç«¯ç¼“å†²åŒº"></a></h2><p>ä¸€ä½†äº†è§£äº†å¦‚ä½•ä½¿ç”¨å®¢æˆ·ç«¯å†…å­˜è¿›è¡Œæ¸²æŸ“ï¼Œåˆ‡æ¢åˆ°ä½¿ç”¨VBOå®é™…ä¸Šå¹¶ä¸å¤ªéš¾ã€‚å…¶ä¸»è¦çš„ä¸åŒåœ¨äºæ·»åŠ äº†ä¸€ä¸ªä¸Šä¼ æ•°æ®åˆ°å›¾å½¢å†…å­˜çš„é¢å¤–æ­¥éª¤ï¼Œä»¥åŠæ¸²æŸ“æ—¶æ·»åŠ äº†ç»‘å®šè¿™ä¸ªç¼“å†²åŒºçš„é¢å¤–è°ƒç”¨ã€‚</p><p>æœ¬èŠ‚è¯¾å°†ä½¿ç”¨å››ç§ä¸åŒçš„æ¨¡å¼ï¼š</p><ol><li>å®¢æˆ·ç«¯ï¼Œå•ç‹¬çš„ç¼“å†²åŒº</li><li>å®¢æˆ·ç«¯ï¼Œæ‰“åŒ…çš„ç¼“å†²</li><li>é¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼Œå•ç‹¬çš„ç¼“å†²åŒº</li><li>é¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼Œæ‰“åŒ…çš„ç¼“å†²</li></ol><p>æ— è®ºæˆ‘ä»¬æ˜¯å¦ä½¿ç”¨é¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼Œæˆ‘ä»¬éƒ½éœ€è¦å…ˆå°†æˆ‘ä»¬çš„æ•°æ®å­˜å‚¨åœ¨å®¢æˆ·ç«¯æœ¬åœ°ç¼“å†²åŒºã€‚ä¼šæƒ³åˆ°<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">ç¬¬ä¸€è¯¾</a>ä¸­OpenGL ES æ˜¯ä¸€ä¸ªæœ¬åœ°ç³»ç»Ÿåº“ï¼Œè€Œjavaæ˜¯è¿è¡Œåœ¨Androidä¸Šçš„ä¸€ä¸ªè™šæ‹Ÿæœºä¸­ã€‚å¦‚ä½•å»æ¡¥æ¥è¿™ä¸ªè·ç¦»ï¼Ÿæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ç»„ç‰¹æ®Šçš„ç¼“å†²åŒºç±»æ¥åœ¨æœ¬åœ°å †ä¸Šåˆ†é…å†…å­˜ï¼Œå¹¶ä½¿ä½¿å…¶ä¾›OpenGLè®¿é—®ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Java æ•°ç»„</span></span><br><span class="line"><span class="keyword">float</span>[] cubePositions;</span><br><span class="line">...</span><br><span class="line"><span class="comment">// æµ®ç‚¹ç¼“å†²åŒº</span></span><br><span class="line"><span class="keyword">final</span> FloatBuffer cubePositionsBuffer;</span><br><span class="line">...</span><br><span class="line"><span class="comment">// åœ¨æœ¬åœ°å †ä¸Šç›´æ¥åˆ†é…ä¸€å—å†…å­˜</span></span><br><span class="line"><span class="comment">// å­—èŠ‚å¤§å°ä¸ºcubePositionsçš„é•¿åº¦ä¹˜ä»¥æ¯ä¸ªæµ®ç‚¹æ•°çš„å­—èŠ‚å¤§å°</span></span><br><span class="line"><span class="comment">// æ¯ä¸ªfloatçš„å­—èŠ‚å¤§å°ä¸º4ï¼Œå› ä¸ºfloatæ˜¯32ä½æˆ–4å­—èŠ‚</span></span><br><span class="line">cubePositionsBuffer = ByteBuffer.allocateDirect(cubePositions.length * BYTES_PRE_FLOAT)</span><br><span class="line"><span class="comment">// æµ®ç‚¹ä¼šä»¥å¤§ç«¯ï¼ˆbig-endianï¼‰æˆ–å°æ®µï¼ˆlittle-endianï¼‰çš„é¡ºåºæ’åˆ—</span></span><br><span class="line"><span class="comment">// æˆ‘æƒ³è®©å…¶åŒæœ¬åœ°å¹³å°ç›¸åŒçš„æ’åˆ—</span></span><br><span class="line">.order(ByteOrder.nativeOrder())</span><br><span class="line"><span class="comment">// åœ¨è¿™ä¸ªå­—èŠ‚ç¼“å†²åŒºä¸Šç»™æˆ‘ä»¬ä¸€ä¸ªæµ®ç‚¹è§†è§’</span></span><br><span class="line">.asFloatBuffer();</span><br></pre></td></tr></table></div></figure><p>å°†Javaå †ä¸Šæ•°æ®è½¬æ¢åˆ°æœ¬åœ°å †ä¸Šï¼Œå°±æ˜¯ä¸¤æ–¹æ³•è°ƒç”¨çš„äº‹æƒ…ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†javaå †ä¸Šçš„æ•°æ®æ‹·è´åˆ°æœ¬åœ°å †</span></span><br><span class="line">cubePositionsBuffer.put(cubePositions)</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡ç½®è¿™ä¸ªç¼“å†²åŒºå¼€å§‹çš„ç¼“å†²ä½ç½®</span></span><br><span class="line">.position(<span class="number">0</span>);</span><br></pre></td></tr></table></div></figure><p>ç¼“å†²ä½ç½®çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿé€šå¸¸ï¼ŒJavaæ²¡æœ‰ä¸ºæˆ‘ä»¬æä¾›ä¸€ç§åœ¨å†…å­˜ä¸­ä½¿ç”¨<a href="https://en.wikipedia.org/wiki/Pointer_(computer_programming)" target="_blank" rel="noopener">æŒ‡é’ˆ</a>ï¼Œä»»æ„æŒ‡å®šä½ç½®çš„æ–¹æ³•ã€‚ç„¶è€Œï¼Œè®¾ç½®ç¼“å†²åŒºçš„ä½ç½®åœ¨åŠŸèƒ½ä¸Šç­‰åŒäºæ›´æ”¹æŒ‡å‘å†…å­˜å—æŒ‡é’ˆçš„å€¼ã€‚é€šè¿‡æ”¹å˜æŒ‡é’ˆçš„ä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç¼“å†²åŒºä¸­ä»»æ„çš„å†…å­˜ä½ç½®ä¼ é€’ç»™OpenGLè°ƒç”¨ã€‚å½“æˆ‘ä»¬ä½¿ç”¨æ‰“åŒ…çš„ç¼“å†²ä½œä¸šæ—¶ï¼Œè¿™å°†æ´¾ä¸Šç”¨åœºã€‚</p><p>ä¸€ä½†æ•°æ®å­˜æ”¾åˆ°æœ¬åœ°å †ä¸Šï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦é•¿æ—¶é—´æŒæœ‰float[]æ•°ç»„äº†ï¼Œæˆ‘ä»¬å¯ä»¥è®©åƒåœ¾å›æ”¶å™¨æ¸…ç†å®ƒã€‚</p><p>ä½¿ç”¨å®¢æˆ·ç«¯ç¼“å†²åŒºè¿›è¡Œæ¸²æŸ“éå¸¸ç®€å•ï¼Œæˆ‘ä»¬ä»…éœ€è¦å¯åŠ¨å¯¹åº”å±æ€§çš„é¡¶ç‚¹ç´ ç»„ï¼Œå¹¶å°†æŒ‡é’ˆä¼ é€’ç»™æˆ‘ä»¬çš„æ•°æ®ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ å…¥ä½ç½®ä¿¡æ¯</span></span><br><span class="line">GLES20.glEnableVertexAttribArray(mPositionHandle);</span><br><span class="line">GLES20.glVertexAttriPointer(mPositionHandle, POSITION_DATA_SIZE,</span><br><span class="line">    GLES20.GL_FLOAT, <span class="keyword">false</span>, <span class="number">0</span>, mCubePositions)</span><br></pre></td></tr></table></div></figure><p><a href="https://www.khronos.org/registry/OpenGL-Refpages/es2.0/xhtml/glVertexAttribPointer.xml" target="_blank" rel="noopener">glVertexAttriPointer</a>å‚æ•°è¯´æ˜ï¼š</p><ul><li><em>mPositionHandleï¼š</em> æˆ‘ä»¬ç€è‰²å™¨ç¨‹åºçš„ä½ç½®å±æ€§ç´¢å¼•</li><li><em>POSITION_DATA_SIZEï¼š</em> å®šä¹‰è¿™ä¸ªå±æ€§éœ€è¦å¤šå°‘ä¸ªfloatå…ƒç´ </li><li><em>GL_FLOATï¼š</em> æ¯ä¸ªå…ƒç´ çš„ç±»å‹</li><li><em>falseï¼š</em> å®šç‚¹æ•°æ®å› è¯¥æ ‡å‡†åŒ–å—ï¼Ÿç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯æµ®ç‚¹æ•°æ®ï¼Œå› æ­¤ä¸é€‚ç”¨ã€‚</li><li><em>0ï¼š</em> è·¨åº¦ï¼Œè®¾ç½®0ï¼Œä»¥ä¸ºç€åº”å®‰é¡ºåºè¯»å–ã€‚ç¬¬ä¸€è¯¾ä¸­è®¾ç½®ä¸º7ï¼Œè¡¨ç¤ºæ¯æ¬¡è¯»å–è·¨åº¦7ä¸ªä½ç½®</li><li><em>mCubePositionsï¼š</em> æŒ‡å‘ç¼“å†²åŒºçš„çš„æŒ‡é’ˆï¼ŒåŒ…å«æ‰€æœ‰ä½ç½®æ•°æ®</li></ul><h2 id="ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒº">ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒº<a href="post/Learn-OpenGL-Lesson-Seven#ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒº"></a></h2><p>ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒºæ˜¯éå¸¸ç›¸ä¼¼çš„ï¼Œæ›¿æ¢äº†æ¯ä¸ªä½ç½®ã€æ³•çº¿ç­‰çš„ç¼“å†²åŒºï¼Œç°åœ¨ä¸€ä¸ªç¼“å†²åŒºå°†åŒ…å«æ‰€æœ‰è¿™äº›æ•°æ®ã€‚ä¸åŒç‚¹çœ‹ä¸‹é¢ï¼š</p><blockquote><p>ä½¿ç”¨å•ç¼“å†²åŒº</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">positions = X,Y,Z,X,Y,Z,X,Y,Z,...</span><br><span class="line">colors = R,G,B,A,R,G,B,A,...</span><br><span class="line">textureCoordinates = S,T,S,T,S,T...</span><br></pre></td></tr></table></div></figure><blockquote><p>ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒº</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">buffer = X,Y,Z,R,G,B,A,S,T...</span><br></pre></td></tr></table></div></figure><p>ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒºçš„å¥½å¤„æ˜¯å®ƒå°†ä¼šä½¿GPUæ›´é«˜æ•ˆçš„æ¸²æŸ“ï¼Œå› ä¸ºæ¸²æŸ“ä¸‰è§’å½¢æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯éƒ½ä½äºå†…å­˜åŒä¸€å—åœ°æ–¹ã€‚ç¼ºç‚¹æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨åŠ¨æ€æ•°æ®ï¼Œæ›´æ–°å¯èƒ½ä¼šæ›´å›°éš¾ï¼Œæ›´æ…¢ã€‚</p><p>å½“æˆ‘ä»¬ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒºæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸‹å‡ ç§æ–¹å¼æ›´æ”¹æ¸²æŸ“è°ƒç”¨ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰OpenGL<code>è·¨åº¦ï¼ˆstrideï¼‰</code> ï¼Œå®šä¹‰ä¸€ä¸ªé¡¶ç‚¹çš„å­—èŠ‚æ•°ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> stride = (POSITION_DATA_SIZE + NORMAL_DATA_SIZE + TEXTURE_COORDINATE_DATA_SIZE)</span><br><span class="line">    * BYTES_PER_FLOAT;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼ å…¥ä½ç½®ä¿¡æ¯</span></span><br><span class="line">mCubeBuffer.position(<span class="number">0</span>);</span><br><span class="line">GLES20.glEnableVertexAttribArray(mPositionHandle);</span><br><span class="line">GLES20.glVertexAttribPointer(mPositionHandle, POSITION_DATA_SIZE,</span><br><span class="line">    GLES20.GL_FLOAT, <span class="keyword">false</span>, stride, mCubeBuffer);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼ å…¥æ³•çº¿ä¿¡æ¯</span></span><br><span class="line">mCubeBuffer.position(POSITION_DATA_SIZE);</span><br><span class="line">GLES20.glEnableVertexAttribArray(mNormalHandle);</span><br><span class="line">GLES20.glVertexAttribPointer(mNormalHandle, NORMAL_DATA_SIZE,</span><br><span class="line">    GLES20.GL_FLOAT, <span class="keyword">false</span>, stride, mCubeBuffer);</span><br><span class="line">...</span><br></pre></td></tr></table></div></figure><p>è¿™ä¸ªè·¨åº¦å‘Šè¯‰OpenGL ESä¸‹ä¸€ä¸ªé¡¶ç‚¹çš„åŒæ ·çš„å±æ€§è¦å†è·¨å¤šè¿œæ‰èƒ½æ‰¾åˆ°ã€‚ä¾‹å¦‚ï¼šå¦‚æœå…ƒç´ 0æ˜¯ç¬¬ä¸€ä¸ªé¡¶ç‚¹çš„å¼€å§‹ä½ç½®ï¼Œå¹¶ä¸”è¿™é‡Œæ¯ä¸ªé¡¶ç‚¹æœ‰8ä¸ªå…ƒç´ ï¼Œç„¶åè¿™ä¸ªè·¨åº¦å°†æ˜¯8ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯32ä¸ªå­—èŠ‚ã€‚ä¸‹ä¸€ä¸ªé¡¶ç‚¹çš„ä½ç½®å°†æ‰¾åˆ°ç¬¬8ä¸ªå…ƒç´ ï¼Œä¸‹ä¸‹ä¸ªé¡¶ç‚¹çš„ä½ç½®å°†æ‰¾åˆ°ç¬¬16ä¸ªå…ƒç´ ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>è¯·è®°ä½ï¼Œä¼ é€’ç»™<code>glVertexAttriPointer</code>çš„è·¨åº¦å•ä½æ˜¯å­—èŠ‚ï¼Œè€Œä¸æ˜¯å…ƒç´ ï¼Œå› æ­¤è¯·è®°ä½è¿›è¡Œè¯¥è½¬æ¢ã€‚</p><p>æ³¨æ„ï¼Œå½“æˆ‘ä»¬ä»æŒ‡å®šä½ç½®åˆ‡æ¢åˆ°æŒ‡å®šæ³•çº¿æ—¶ï¼Œæˆ‘ä»¬è¦æ›´æ”¹ç¼“å†²åŒºçš„å…¶å®ä½ç½®ã€‚è¿™æ˜¯æˆ‘ä»¬ä¹‹å‰æåˆ°çš„æŒ‡é’ˆç®—æ³•ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨OpengGL ESæ—¶ç”¨Javaåšçš„æ–¹å¼ã€‚æˆ‘ä»¬ä»ç„¶ä½¿ç”¨åŒä¸€ä¸ªç¼“å†²åŒº<code>mCubeBuffer</code>ï¼Œä½†æ˜¯æˆ‘ä»¬å‘Šè¯‰OpenGLä»ä½ç½®æ•°æ®åçš„ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹è¯»å–æ³•çº¿ä¿¡æ¯ã€‚æˆ‘ä»¬ä¹Ÿå‘Šè¯‰OpenGLä¸‹ä¸€ä¸ªæ³•çº¿è¦è·¨è¶Š8ä¸ªå…ƒç´ ï¼ˆä¹Ÿå¯ä»¥è¯´æ˜¯32ä¸ªå­—èŠ‚ï¼‰å¼€å§‹ã€‚</p><h2 id="Dalvikå’Œæœ¬åœ°å †ä¸Šçš„å†…å­˜">Dalvikå’Œæœ¬åœ°å †ä¸Šçš„å†…å­˜<a href="post/Learn-OpenGL-Lesson-Seven#Dalvikå’Œæœ¬åœ°å †ä¸Šçš„å†…å­˜"></a></h2><p>å¦‚æœä½ åœ¨æœ¬åœ°å †ä¸Šåˆ†é…å¤§é‡å†…å­˜æŠŠå¹¶å°†å…¶é‡Šæ”¾ï¼Œæ‚¨è¿Ÿæ—©ä¼šé‡åˆ°å¿ƒçˆ±çš„<code>OutOfMemoryError</code> ï¼ŒèƒŒåæœ‰å‡ ä¸ªåŸå› ï¼š</p><ol><li>æ‚¨å¯èƒ½è®¤ä¸ºé€šè¿‡è®©å¼•ç”¨è¶…å‡ºèŒƒå›´è€Œè‡ªåŠ¨é‡Šæ”¾äº†å†…å­˜ï¼Œä½†æ˜¯æœ¬åœ°å†…å­˜ä¼¼ä¹éœ€è¦ä¸€äº›é¢å¤–çš„GCå‘¨æœŸæ‰èƒ½å®Œå…¨æ¸…ç†ï¼Œå¦‚æœæ²¡æœ‰è¶³å¤Ÿå¯ç”¨çš„å†…å­˜å¹¶ä¸”å°šæœªé‡Šæ”¾æœ¬åœ°å†…å­˜ï¼ŒDalvikå°†æŠ›å‡ºå¼‚å¸¸ã€‚</li><li>æœ¬åœ°å †å¯èƒ½ä¼š<a href="https://stackoverflow.com/questions/6892676/android-bitmap-limit-preventing-java-lang-outofmemory" target="_blank" rel="noopener">ç¢ç‰‡åŒ–</a>ï¼Œè°ƒç”¨<code>allocateDirect()</code>å°†ä¼šè«åå…¶å¦™å¤±è´¥ï¼Œå°½ç®¡ä¼¼ä¹æœ‰è¶³å¤Ÿçš„å†…å­˜å¯ç”¨ã€‚æœ‰æ—¶å®ƒæœ‰åŠ©äºè¿›è¡Œè¾ƒå°çš„åˆ†é…ï¼Œé‡Šæ”¾å®ƒï¼Œç„¶åå†æ¬¡å°è¯•æ›´å¤§çš„åˆ†é…ã€‚</li></ol><p>å¦‚ä½•èƒ½é¿å…è¿™äº›é—®é¢˜ï¼Ÿé™¤äº†å¸Œæœ›Googleåœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­æ”¹è¿›Dalvikçš„è¡Œä¸ºä¹‹å¤–ï¼Œå¹¶ä¸å¤šã€‚æˆ–è€…é€šè¿‡æœ¬åœ°ä»£ç è¿›è¡Œåˆ†é…æˆ–é¢„å…ˆåˆ†é…ä¸€å¤§å—å†…å­˜æ¥è‡ªè¡Œç®¡ç†å †ï¼Œå¹¶æ ¹æ®æ­¤åˆ†ç¦»ç¼“å†²åŒºã€‚</p><blockquote><p>æ³¨æ„ï¼šè¿™äº›ä¿¡æ¯æœ€åˆå†™äº2012å¹´åˆï¼Œç°åœ¨Androidä½¿ç”¨äº†ä¸€ä¸ªåä¸ºARTçš„ä¸åŒè¿è¡Œæ—¶ï¼Œå®ƒå¯èƒ½åœ¨ç›¸åŒç¨‹åº¦ä¸Šä¸ä¼šé‡åˆ°è¿™äº›é—®é¢˜ã€‚</p></blockquote><h2 id="ç§»åŠ¨åˆ°é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡">ç§»åŠ¨åˆ°é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡<a href="post/Learn-OpenGL-Lesson-Seven#ç§»åŠ¨åˆ°é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡"></a></h2><p>ç°åœ¨æˆ‘ä»¬å·²ç»å›é¡¾äº†ä½¿ç”¨å®¢æˆ·ç«¯ç¼“å†²åŒºï¼Œè®©æˆ‘ä»¬ç»§ç»­è®¨è®ºé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å›é¡¾å‡ ä¸ªéå¸¸é‡è¦çš„é—®é¢˜ï¼š</p><h3 id="1-ç¼“å†²åŒºå¿…é¡»åˆ›å»ºåœ¨ä¸€ä¸ªæœ‰æ•ˆçš„OpenGLä¸Šä¸‹æ–‡ä¸­">1. ç¼“å†²åŒºå¿…é¡»åˆ›å»ºåœ¨ä¸€ä¸ªæœ‰æ•ˆçš„OpenGLä¸Šä¸‹æ–‡ä¸­<a href="post/Learn-OpenGL-Lesson-Seven#1-ç¼“å†²åŒºå¿…é¡»åˆ›å»ºåœ¨ä¸€ä¸ªæœ‰æ•ˆçš„OpenGLä¸Šä¸‹æ–‡ä¸­"></a></h3><p>è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„è§‚ç‚¹ï¼Œä½†æ˜¯å®ƒä»…ä»…æé†’ä½ å¿…é¡»ç­‰åˆ°<code>onSurfaceCreated()</code>æ‰§è¡Œï¼Œå¹¶ä¸”ä½ å¿…é¡»æ³¨æ„OpenGL ESè°ƒç”¨æ˜¯åœ¨GLçº¿ç¨‹ä¸Šå®Œæˆçš„ã€‚<br>çœ‹è¿™ä¸ªæ–‡æ¡£ï¼š<a href="https://developer.apple.com/library/archive/documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/Introduction/Introduction.html" target="_blank" rel="noopener">iOS OpenGL ESç¼–ç¨‹æŒ‡å—</a>ï¼Œå®ƒå¯èƒ½æ˜¯ä¸ºiOSå†™çš„ï¼Œä½†æ˜¯OpenGL ESåœ¨Androidçš„è¡Œä¸ºå’Œè¿™ç›¸åŒã€‚</p><h3 id="2-é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´å›¾å½¢é©±åŠ¨ç¨‹åºå´©æºƒ">2. é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´å›¾å½¢é©±åŠ¨ç¨‹åºå´©æºƒ<a href="post/Learn-OpenGL-Lesson-Seven#2-é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´å›¾å½¢é©±åŠ¨ç¨‹åºå´©æºƒ"></a></h3><p>å½“ä½ ä½¿ç”¨é¡¶ç‚¹ç¼“å†²å¯¹è±¡æ—¶ï¼Œéœ€è¦æ³¨æ„ä¼ é€’çš„æ•°æ®ã€‚ä¸å½“çš„å€¼å°†ä¼šå¯¼è‡´OpenGL ESç³»ç»Ÿåº“æˆ–å›¾å½¢é©±åŠ¨åº“æœ¬åœ°å´©æºƒã€‚åœ¨æˆ‘çš„Nexus Sä¸Šï¼Œä¸€äº›æ¸¸æˆå®Œå…¨å¡åœ¨æˆ‘çš„æ‰‹æœºä¸Šæˆ–å¯¼è‡´æ‰‹æœºé‡å¯ï¼Œå› ä¸ºå›¾å½¢é©±åŠ¨å› ä¸ºä»–ä»¬çš„æŒ‡ä»¤å´©æºƒã€‚å¹¶éæ‰€æœ‰çš„å´©æºƒéƒ½ä¼šé”å®šæ‚¨çš„è®¾å¤‡ï¼Œä½†è‡³å°‘æ‚¨ä¸ä¼šçœ‹åˆ°â€œæ­¤åº”ç”¨å·²åœæ­¢å·¥ä½œâ€çš„å¯¹è¯æ¡†ã€‚æ‚¨çš„æ´»åŠ¨å°†åœ¨æ²¡æœ‰è­¦å‘Šçš„æƒ…å†µä¸‹é‡æ–°å¯åŠ¨ï¼Œæ‚¨å°†è·å¾—å”¯ä¸€çš„ä¿¡æ¯å¯èƒ½æ˜¯æ—¥å¿—ä¸­çš„æœ¬åœ°è°ƒè¯•è·Ÿè¸ªã€‚</p><h2 id="ä¸Šä¼ é¡¶ç‚¹æ•°æ®åˆ°GPU">ä¸Šä¼ é¡¶ç‚¹æ•°æ®åˆ°GPU<a href="post/Learn-OpenGL-Lesson-Seven#ä¸Šä¼ é¡¶ç‚¹æ•°æ®åˆ°GPU"></a></h2><p>è¦ä¸Šä¼ æ•°æ®åˆ°GPUï¼Œæˆ‘ä»¬éœ€è¦åƒä»¥å‰ä¸€æ ·åˆ›å»ºå®¢æˆ·ç«¯ç¼“å†²åŒºçš„ç›¸åŒæ­¥éª¤ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">cubePositionsBuffer = ByteBuffer.allocateDirect(cubePositions.length * BYTES_PER_FLOAT)</span><br><span class="line">.order(ByteOrder.nativeOrder()).asFloatBuffer();</span><br><span class="line">cubePositionsBuffer.put(cubePositions).position(<span class="number">0</span>);</span><br><span class="line">...</span><br></pre></td></tr></table></div></figure><p>ä¸€æ—¦æˆ‘ä»¬æœ‰äº†å®¢æˆ·ç«¯ç¼“å†²åŒºï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸‹æŒ‡ä»¤å°†æ•°æ®ä»å®¢æˆ·ç«¯å†…å­˜ä¸Šä¼ åˆ°GPUï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é¦–å…ˆï¼Œæˆ‘ä»¬è¦å°½å¯èƒ½çš„ç”³è¯·æ›´å¤šçš„ç¼“å†²åŒº</span></span><br><span class="line"><span class="comment">// è¿™å°†ä¸ºæˆ‘ä»¬æä¾›è¿™äº›ç¼“å†²åŒºçš„handle</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> buffers[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>];</span><br><span class="line">GLES20.glGenBuffers(<span class="number">3</span>, buffers, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»‘å®šè¿™ä¸ªç¼“å†²åŒºï¼Œå°†æ¥çš„æŒ‡ä»¤å°†å•ç‹¬å½±å“æ­¤ç¼“å†²åŒº</span></span><br><span class="line">GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, buffers[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®¢æˆ·ç«¯å†…å­˜ä¸­çš„æ•°æ®è½¬ç§»åˆ°ç¼“å†²åŒº</span></span><br><span class="line"><span class="comment">// æˆ‘ä»¬èƒ½åœ¨æ­¤æ¬¡è°ƒåŠ¨åé‡Šæ”¾å®¢æˆ·ç«¯å†…å­˜</span></span><br><span class="line">GLES20.glBufferData(GLES20.GL_ARRAY_BUFFER, cubePositionsBuffer.capacity() * BYTES_PER_FLOAT,</span><br><span class="line">    cubePositionsBuffer, GLES20.GL_STATIC_DRAW);</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡è¦æé†’ï¼šå®Œæˆç¼“å†²åï¼Œä»ç¼“å†²åŒºå–æ¶ˆç»‘å®š</span></span><br><span class="line">GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, <span class="number">0</span>);</span><br></pre></td></tr></table></div></figure><p>ä¸€æ—¦æ•°æ®ä¸Šä¼ åˆ°äº†OpenGL ESï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡Šæ”¾è¿™ä¸ªå®¢æˆ·ç«¯å†…å­˜ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦å†ç»§ç»­ä¿ç•™å®ƒã€‚è¿™æ˜¯<a href="http://www.learnopengles.com/android-lesson-seven-an-introduction-to-vertex-buffer-objects-vbos/GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER,%200);" target="_blank" rel="noopener">glBufferData</a>çš„è§£é‡Šï¼š</p><ul><li><em>GL_ARRAY_BUFFERï¼š</em> è¿™ä¸ªç¼“å†²åŒºåŒ…å«é¡¶ç‚¹æ•°æ®æ•°ç»„</li><li><em>cubePositionsBuffer.capacity() </em> BYTES_PER_FLOATï¼š* è¿™ä¸ªç¼“å†²åŒºå› è¯¥åŒ…å«çš„å­—èŠ‚æ•°</li><li><em>cubePositionsBufferï¼š</em> å°†è¦æ‹·è´åˆ°è¿™ä¸ªé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡çš„æº</li><li><em>GL_STATIC_DRAWï¼š</em> è¿™ä¸ªç¼“å†²åŒºä¸ä¼šåŠ¨æ€æ›´æ–°</li></ul><p>æˆ‘ä»¬å¯¹<code>glVertexAttribPointer</code>çš„è°ƒç”¨çœ‹èµ·æ¥æœ‰ç‚¹å„¿ä¸åŒï¼Œå› ä¸ºæœ€åä¸€ä¸ªå‚æ•°ç°åœ¨æ˜¯åç§»é‡è€Œä¸æ˜¯æŒ‡å‘å®¢æˆ·ç«¯å†…å­˜çš„æŒ‡é’ˆï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ å…¥ä½ç½®ä¿¡æ¯</span></span><br><span class="line">GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, mCubePositionsBufferIdx);</span><br><span class="line">GLES20.glEnableVertexAttribArray(mPositionHandle);</span><br><span class="line">mGlEs20.glVertexAttribPointer(mPositionHandle, POSITION_DATA_SIZE, GLES20.GL_FLOAT, <span class="keyword">false</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">...</span><br></pre></td></tr></table></div></figure><p>åƒä»¥å‰ä¸€æ ·ï¼Œæˆ‘ä»¬ç»‘å®šåˆ°ç¼“å†²åŒºï¼Œç„¶åå¯ç”¨é¡¶ç‚¹æ•°ç»„ã€‚ç”±äºç¼“å†²åŒºæ—©å·²ç»‘å®šï¼Œå½“ä»ç¼“å†²åŒºè¯»å–æ•°æ®æ—¶ï¼Œæˆ‘ä»¬ä»…éœ€è¦å‘Šè¯‰OpenGLå¼€å§‹çš„åç§»ã€‚å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„ç‰¹å®šçš„ç¼“å†²åŒºï¼Œæˆ‘ä»¬ä¼ å…¥åç§»é‡0ã€‚å¦è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰ç»‘å®šæ¥è°ƒç”¨<code>glVertexAttribPointer</code>ï¼Œå› ä¸ºå®˜æ–¹SKDç¼ºå°‘æ­¤ç‰¹å®šå‡½æ•°è°ƒç”¨ã€‚</p><p>ä¸€æ—¦æˆ‘ä»¬ç”¨ç¼“å†²åŒºç»˜åˆ¶å®Œæˆï¼Œæˆ‘ä»¬åº”è¯¥è§£é™¤å®ƒï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, <span class="number">0</span>);</span><br></pre></td></tr></table></div></figure><p>å½“æˆ‘ä»¬ä¸æƒ³åœ¨ä¿ç•™ç¼“å†²åŒºæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é‡Šæ”¾å†…å­˜ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">int</span>[] buffersToDelete = <span class="keyword">new</span> <span class="keyword">int</span>[] &#123; mCubePositionsBufferIdx, mCubeNormalsBufferIdx,</span><br><span class="line">    mCubeTexCoordsBufferIdx &#125;;</span><br><span class="line">GLES20.glDeleteBuffers(buffersToDelete.length, buffersToDelete, <span class="number">0</span>);</span><br></pre></td></tr></table></div></figure><h2 id="æ‰“åŒ…é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡">æ‰“åŒ…é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡<a href="post/Learn-OpenGL-Lesson-Seven#æ‰“åŒ…é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡"></a></h2><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å•ä¸ªç¼“å†²åŒºæ‰“åŒ…é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡çš„æ‰€æœ‰é¡¶ç‚¹æ•°æ®ã€‚æ‰“åŒ…é¡¶ç‚¹ç¼“å†²åŒºçš„åˆ›å»ºå’Œä¸Šé¢ç›¸åŒï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯æˆ‘ä»¬ä»æ‰“åŒ…å®¢æˆ·ç«¯ç¼“å†²åŒºå¼€å§‹ã€‚æ‰“åŒ…ç¼“å†²åŒºæ¸²æŸ“ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œé™¤äº†æˆ‘ä»¬éœ€è¦ä¼ åç§»é‡ï¼Œå°±åƒåœ¨å®¢æˆ·ç«¯å†…å­˜ä¸­ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒºä¸€æ ·ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> stride = (POSITION_DATA_SIZE + NORMAL_DATA_SIZE + TEXTURE_COORDINATE_DATA_SIZE)</span><br><span class="line">    * BYTES_PER_FLOAT;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼ å…¥ä½ç½®ä¿¡æ¯</span></span><br><span class="line">GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, mCubeBufferIdx);</span><br><span class="line">GLES20.glEnableVertexAttribArray(mPositionHandle);</span><br><span class="line">mGlEs20.glVertexAttribPointer(mPositionHandle, POSITION_DATA_SIZE,</span><br><span class="line">    GLES20.GL_FLOAT, <span class="keyword">false</span>, stride, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼ å…¥æ³•çº¿ä¿¡æ¯</span></span><br><span class="line">GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, mCubeBufferIdx);</span><br><span class="line">GLES20.glEnableVertexAttribArray(mNormalHandle);</span><br><span class="line">mGlEs20.glVertexAttribPointer(mNormalHandle, NORMAL_DATA_SIZE,</span><br><span class="line">    GLES20.GL_FLOAT, <span class="keyword">false</span>, stride, POSITION_DATA_SIZE * BYTES_PER_FLOAT);</span><br><span class="line">...</span><br></pre></td></tr></table></div></figure><p>æ³¨æ„ï¼šåç§»é‡éœ€è¦ä»¥å­—èŠ‚ä¸ºå•ä½æŒ‡å®šã€‚ä¸ä¹‹å‰ä¸€æ ·è§£é™¤ç»‘å®šå’Œåˆ é™¤ç¼“å†²åŒºçš„ç›¸åŒæ³¨æ„äº‹é¡¹ä¹Ÿé€‚ç”¨ã€‚</p><h2 id="å°†é¡¶ç‚¹æ•°æ®æ”¾åˆ°ä¸€èµ·">å°†é¡¶ç‚¹æ•°æ®æ”¾åˆ°ä¸€èµ·<a href="post/Learn-OpenGL-Lesson-Seven#å°†é¡¶ç‚¹æ•°æ®æ”¾åˆ°ä¸€èµ·"></a></h2><p>è¿™èŠ‚è¯¾å·²æ„å»ºäº†å¤šç«‹æ–¹ä½“ç»„æˆçš„ç«‹æ–¹ä½“ï¼Œæ¯ä¸ªé¢çš„ç«‹æ–¹ä½“æ•°é‡ä½“ç›¸åŒã€‚å®ƒå°†åœ¨1x1x1ç«‹æ–¹ä½“å’Œ16x16x16ç«‹æ–¹ä½“ä¹‹é—´æ„å»ºç«‹æ–¹ä½“ã€‚ç”±äºæ¯ä¸ªç«‹æ–¹ä½“å…±äº«ç›¸åŒçš„æ³•çº¿å’Œçº¹ç†æ•°æ®ï¼Œå› æ­¤åœ¨åˆå§‹åŒ–å®¢æˆ·ç«¯ç¼“å†²åŒºæ—¶å°†é‡å¤å¤åˆ¶æ­¤æ•°æ®ã€‚æ‰€æœ‰ç«‹æ–¹ä½“éƒ½å°†åœ¨åŒä¸€ä¸ªç¼“å†²åŒºå¯¹è±¡ä¸­ç»“æŸã€‚</p><p>æ‚¨å¯ä»¥æŸ¥çœ‹è¯¾ç¨‹ä¸­çš„ä»£ç å¹¶æŸ¥çœ‹ä½¿ç”¨å’Œä¸ä½¿ç”¨VBOï¼Œä»¥åŠä½¿ç”¨å’Œä¸ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒºè¿›è¡Œæ¸²æŸ“çš„ç¤ºä¾‹ã€‚æ£€æŸ¥ä»£ç ä»¥æŸ¥çœ‹å¦‚ä½•å¤„ç†ä¸€ä¸‹æŸäº›æ“ä½œï¼š</p><ul><li>é€šè¿‡<code>runOnUiThread()</code>å°†äº‹ä»¶ä»OpenGLçº¿ç¨‹å‘å¸ƒå›UIä¸»çº¿ç¨‹</li><li>å¼‚æ­¥ç”Ÿæˆé¡¶ç‚¹æ•°æ®</li><li>å¤„ç†å†…å­˜æº¢å‡ºå¼‚å¸¸</li><li>æˆ‘ä»¬ç§»é™¤äº†<code>glEnable(GL_TEXTURE_2D)</code>çš„è°ƒç”¨ï¼Œå› ä¸ºå®ƒå®é™…åœ¨OpenGL ES 2æ˜¯ä¸€ä¸ªæ— æ•ˆæšä¸¾ã€‚è¿™æ˜¯ä»¥å‰çš„å›ºå®šå†™æ³•å»¶ç»­ä¸‹æ¥çš„ï¼Œåœ¨OpenGLES2ä¸­ï¼Œè¿™äº›ä¸œè¥¿ç”±ç€è‰²å™¨å¤„ç†ï¼Œå› æ­¤ä¸éœ€è¦ä½¿ç”¨<code>glEnable</code>æˆ–<code>glDisable</code>ã€‚</li><li>æ€æ ·ä½¿ç”¨ä¸åŒçš„æ–¹å¼è¿›è¡Œæ¸²æŸ“ï¼Œè€Œä¸æ·»åŠ å¤ªå¤šçš„ifè¯­å¥å’Œæ¡ä»¶ã€‚</li></ul><h2 id="è¿›ä¸€æ­¥ç»ƒä¹ ">è¿›ä¸€æ­¥ç»ƒä¹ <a href="post/Learn-OpenGL-Lesson-Seven#è¿›ä¸€æ­¥ç»ƒä¹ "></a></h2><p>æ‚¨ä½•æ—¶ä½¿ç”¨é¡¶ç‚¹ç¼“å†²åŒºï¼Ÿä»€ä¹ˆæ—¶å€™ä»å®¢æˆ·ç«¯å†…å­˜ä¼ è¾“æ•°æ®æ›´å¥½ï¼Ÿä½¿ç”¨é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡æœ‰å“ªäº›ç¼ºç‚¹ï¼Ÿæ‚¨å°†å¦‚ä½•æ”¹è¿›å¼‚æ­¥åŠ è½½ä»£ç ï¼Ÿ</p><h2 id="æ•™ç¨‹ç›®å½•">æ•™ç¨‹ç›®å½•<a href="post/Learn-OpenGL-Lesson-Seven#æ•™ç¨‹ç›®å½•"></a></h2><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five">OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six">OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven">OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVBOï¼‰</a></li></ul><h2 id="æ‰“åŒ…æ•™æ">æ‰“åŒ…æ•™æ<a href="post/Learn-OpenGL-Lesson-Seven#æ‰“åŒ…æ•™æ"></a></h2><p>å¯ä»¥åœ¨Githubä¸‹è½½æœ¬è¯¾ç¨‹æºä»£ç ï¼š<a href="https://github.com/learnopengles/Learn-OpenGLES-Tutorials" target="_blank" rel="noopener">ä¸‹è½½é¡¹ç›®</a><br>æœ¬è¯¾çš„ç¼–è¯‘ç‰ˆæœ¬ä¹Ÿå¯ä»¥å†Androidå¸‚åœºä¸‹ï¼š<a href="https://market.android.com/details?id=com.learnopengles.android" target="_blank" rel="noopener">google play ä¸‹è½½apk</a><br>ä¸ºäº†æ–¹ä¾¿å¤§å®¶ä¸‹è½½ï¼Œâ€œæˆ‘â€ä¹Ÿç¼–è¯‘äº†ä¸ªapkï¼Œï¼š<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">github download</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ–‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Seven: An Introduction to Vertex Buffer Objects (VBOs)&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.learnopengles.com/android-lesson-seven-an-introduction-to-vertex-buffer-objects-vbos/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.learnopengles.com/android-lesson-seven-an-introduction-to-vertex-buffer-objects-vbos/&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/categories/OpenGL/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/tags/OpenGL/"/>
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</title>
    <link href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six/index.html"/>
    <id>https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six/index.html</id>
    <published>2019-02-19T08:24:18.000Z</published>
    <updated>2019-04-08T06:56:15.793Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»è¯‘æ–‡</p></blockquote><p>åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Six: An Introduction to Texture Filtering<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.learnopengles.com/android-lesson-six-an-introduction-to-texture-filtering/" target="_blank" rel="noopener">http://www.learnopengles.com/android-lesson-six-an-introduction-to-texture-filtering/</a><br><a id="more"></a></p><hr><h1 id="ä»‹ç»çº¹ç†è¿‡æ»¤">ä»‹ç»çº¹ç†è¿‡æ»¤<a href="post/Learn-OpenGL-Lesson-Six#ä»‹ç»çº¹ç†è¿‡æ»¤"></a></h1><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°†ä»‹ç»åŸºæœ¬çº¹ç†è¿‡æ»¤çš„ä¸åŒç±»å‹å’Œæ€æ ·ä½¿ç”¨å®ƒä»¬ï¼Œ<br>åŒ…æ‹¬æœ€é‚»è¿‘ï¼ˆnearest-neighbourï¼‰è¿‡æ»¤ï¼Œ<a href="https://en.wikipedia.org/wiki/Bilinear_filtering" target="_blank" rel="noopener">åŒçº¿æ€§(bilinear)è¿‡æ»¤</a>ï¼Œ<br>å’Œä½¿ç”¨mipmapçš„<a href="https://en.wikipedia.org/wiki/Trilinear_filtering" target="_blank" rel="noopener">ä¸‰çº¿æ€§(trilinear)è¿‡æ»¤</a>ã€‚<br><br>ä½ å°†å­¦ä¹ å¦‚ä½•ä½¿çº¹ç†çœ‹èµ·æ¥æ›´å¹³æ»‘ï¼Œä»¥åŠå¹³æ»‘å¸¦æ¥çš„ç¼ºç‚¹ã€‚<br>[è¿™å„¿æœ‰æ—‹è½¬ç‰©ä½“][]çš„ä¸åŒæ–¹å¼ï¼Œæœ¬è¯¾ä½¿ç”¨äº†å…¶ä¸­ä¸€ã€‚</td><td style="text-align:center"><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190219164050.png" alt="screenshot"></td></tr></tbody></table></div></div><h2 id="å‰ææ¡ä»¶">å‰ææ¡ä»¶<a href="post/Learn-OpenGL-Lesson-Six#å‰ææ¡ä»¶"></a></h2><p>å¼ºçƒˆå»ºè®®æ‚¨å…ˆé˜…è¯»<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a>ï¼Œç†è§£çº¹ç†æ˜ å°„åœ¨OpenGLä¸­çš„åŸºæœ¬ä½¿ç”¨ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯çº¹ç†è¿‡æ»¤ï¼Ÿ">ä»€ä¹ˆæ˜¯çº¹ç†è¿‡æ»¤ï¼Ÿ<a href="post/Learn-OpenGL-Lesson-Six#ä»€ä¹ˆæ˜¯çº¹ç†è¿‡æ»¤ï¼Ÿ"></a></h2><p>OpenGLESä¸­çš„çº¹ç†ç”±å…ƒç´ æ•°ç»„ç»„æˆï¼Œè¢«ç§°ä¸ºçº¹ç´ (texels)ï¼Œå…¶ä¸­åŒ…å«é¢œè‰²å’Œalphaå€¼ã€‚è¿™ä¸æ˜¾ç¤ºå™¨ç›¸å¯¹åº”ï¼Œæ˜¾ç¤ºå™¨ç”±ä¸€å †åƒç´ ç»„æˆï¼Œå¹¶åœ¨æ¯ä¸ªç‚¹æ˜¾ç¤ºä¸åŒçš„é¢œè‰²ã€‚åœ¨OpenGLä¸­çº¹ç†è¢«ç”¨åœ¨ä¸‰è§’å½¢ä¸Šå¹¶ç»˜åˆ¶åˆ°å±å¹•ï¼Œå› æ­¤è¿™äº›çº¹ç†èƒ½ç»˜åˆ¶å‡ºå„ç§å„æ ·çš„å°ºå¯¸å’Œæ–¹å‘ã€‚OpenGLä¸­çš„çº¹ç†è¿‡æ»¤é€‰é¡¹å‘Šè¯‰å®ƒå¦‚ä½•æ ¹æ®å…·ä½“æƒ…å†µå°†çº¹ç†åƒç´ è¿‡æ»¤åˆ°è®¾å¤‡çš„åƒç´ ä¸Šã€‚</p><blockquote><p>æœ‰ä¸‰ç§æƒ…å†µï¼š</p></blockquote><ul><li>æ¯ä¸ªçº¹ç´ æ˜ å°„åˆ°å¤šä¸ªåƒç´ ï¼Œè¿™è¢«ç§°ä¸ºæ”¾å¤§(magnification)</li><li>æ¯ä¸ªçº¹ç´ ç²¾ç¡®çš„æ˜ å°„åˆ°ä¸€ä¸ªåƒç´ ï¼Œè¿‡æ»¤ä¸é€‚åˆè¿™ç§æƒ…å†µ</li><li>æ¯ä¸ªçº¹ç´ æ˜ å°„å°‘äºä¸€ä¸ªåƒç´ ï¼Œè¿™è¢«ç§°ä¸ºç¼©å°(minification)</li></ul><p>OpenGLå…è®¸æˆ‘ä»¬ä¸ºæ”¾å¤§å’Œç¼©å°åˆ†é…è¿‡æ»¤å™¨ï¼Œå¹¶å…è®¸æˆ‘ä»¬ä½¿ç”¨æœ€é‚»è¿‘ã€åŒçº¿æ€§å’Œä¸‰çº¿æ€§è¿‡æ»¤ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹é¢è§£é‡Šè¿™äº›æ„æ€ã€‚</p><h2 id="æ”¾å¤§å’Œç¼©å°">æ”¾å¤§å’Œç¼©å°<a href="post/Learn-OpenGL-Lesson-Six#æ”¾å¤§å’Œç¼©å°"></a></h2><p>è¿™é‡Œæ˜¯æ”¾å¤§å’Œç¼©å°çš„æœ€é‚»è¿‘æ¸²æŸ“çš„å¯è§†åŒ–ï¼Œå½“æ‚¨ç”¨USBè¿æ¥ä½ çš„Androidè®¾å¤‡æ—¶ä½¿ç”¨è¿™ä¸ªå¯çˆ±çš„Androidæ˜¾ç¤ºæˆåŠŸè¿æ¥ã€‚</p><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190221100843.png" alt="cute android" class="article-img"></p><h3 id="æ”¾å¤§">æ”¾å¤§<a href="post/Learn-OpenGL-Lesson-Six#æ”¾å¤§"></a></h3><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190221100936.png" alt="magnification android" class="article-img"></p><p>æ­£å¦‚æ‚¨æ‰€è§ï¼Œçº¹ç´ ç°åœ¨å¾ˆå®¹æ˜“çœ‹åˆ°ï¼Œå› ä¸ºå½“å‰ä¸€ä¸ªçº¹ç´ è¦†ç›–äº†å¾ˆå¤šåƒç´ å±•ç¤ºå‡ºæ¥ã€‚</p><h3 id="ç¼©å°">ç¼©å°<a href="post/Learn-OpenGL-Lesson-Six#ç¼©å°"></a></h3><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190221101211.png" alt="minification android" class="article-img"></p><p>éšç€ç¼©å°ï¼Œè®¸å¤šçº¹ç´ ä¸èƒ½æ¸²æŸ“åˆ°æœ‰é™çš„åƒç´ ä¸Šï¼Œè®¸å¤šç»†èŠ‚å°†ä¼šä¸¢å¤±ã€‚</p><h2 id="çº¹ç†è¿‡æ»¤æ¨¡å¼">çº¹ç†è¿‡æ»¤æ¨¡å¼<a href="post/Learn-OpenGL-Lesson-Six#çº¹ç†è¿‡æ»¤æ¨¡å¼"></a></h2><h3 id="åŒçº¿æ€§æ’å€¼ï¼ˆBilinear-interpolationï¼‰">åŒçº¿æ€§æ’å€¼ï¼ˆBilinear interpolationï¼‰<a href="post/Learn-OpenGL-Lesson-Six#åŒçº¿æ€§æ’å€¼ï¼ˆBilinear-interpolationï¼‰"></a></h3><p>å½“çº¹ç´ å€¼ä¹‹é—´æ²¡æœ‰æ’å€¼æ—¶ï¼Œåœ¨æ”¾å¤§ç¤ºä¾‹ä¸­ï¼Œçº¹ç†çš„çº¹ç´ æ¸…æ™°å¯è§ä¸ºå¤§æ­£æ–¹å½¢ã€‚å½“ä½¿ç”¨æœ€é‚»è¿‘æ–¹å¼æ—¶ï¼Œåƒç´ å°†ä¼šåˆ†é…åˆ°æœ€é‚»è¿‘çš„åƒç´ ã€‚</p><p>é€šè¿‡åˆ‡æ¢åˆ°åŒçº¿æ€§æ’å€¼ï¼Œæ¸²æŸ“è´¨é‡æ˜¾è‘—æé«˜ã€‚è¿™äº›å€¼å°†ä¼šåœ¨é‚»è¿‘çš„å››ä¸ªåƒç´ ä¹‹é—´çº¿æ€§æ’å€¼ï¼Œè€Œä¸æ˜¯å°†ä¸€ç»„åƒç´ åˆ†é…ç»™é‚»è¿‘ç›¸åŒçš„çº¹ç´ å€¼ã€‚æ¯ä¸ªåƒç´ è¢«å¹³æ»‘åŒ–ï¼Œä½¿å¾—æœ€åçš„å›¾ç‰‡çœ‹èµ·æ¥ä¹Ÿæ›´å¹³æ»‘ï¼š</p><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190221103115.png" alt="smoother android" class="article-img"></p><p>ä¸€äº›å—æ•ˆæœä»ç„¶å¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯è¿™ä¸ªå›¾ç‰‡çœ‹èµ·æ¥æ¯”ä¹‹å‰æ›´åŠ å¹³æ»‘ã€‚é‚£äº›åœ¨3DåŠ é€Ÿå¡å‡ºç°å‰ç©è¿‡3Dæ¸¸æˆçš„äººå°†ä¼šè®°å¾—è½¯ä»¶æ¸²æŸ“æ¸¸æˆå’Œç¡¬ä»¶åŠ é€Ÿæ¸¸æˆä¹‹é—´çš„ç‰¹æ€§ï¼šè½¯ä»¶æ¸²æŸ“æ¸¸æˆæ ¹æœ¬æ²¡æœ‰è¿›è¡Œé¢„è®¡ç®—å¤„ç†ï¼Œæ‰€ä»¥ä¸€åˆ‡éƒ½æ˜¾ç¤ºå¾—å—çŠ¶å’Œé”¯é½¿çŠ¶ã€‚ä¸€æ—¦äººä»¬å¼€å§‹ä½¿ç”¨å›¾å½¢åŠ é€Ÿï¼Œè¿™äº›ä¸œè¥¿éƒ½å°†å˜å¾—å¹³æ»‘ã€‚</p><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190221104453.png" alt="smooth" class="article-img"></p><p>åŒçº¿æ€§æ’å€¼å¤§å¤šä½¿ç”¨åœ¨æ”¾å¤§ã€‚å®ƒä¹Ÿèƒ½ä½¿ç”¨åœ¨ç¼©å°ï¼Œä½†æ˜¯è¶…è¿‡æŸä¸ªåº¦ï¼Œæˆ‘ä»¬å°†ä¼šé‡åˆ°åŒæ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨å°è¯•å°†å¤ªå¤šçš„çº¹ç´ æ”¾åˆ°ç›¸åŒçš„åƒç´ ä¸Šã€‚OpenGLä»…ä½¿ç”¨æœ€å¤š4ä¸ªçº¹ç´ æ¸²æŸ“ä¸€ä¸ªåƒç´ ï¼Œå› æ­¤è®¸å¤šä¿¡æ¯ä»ç„¶ä¼šä¸¢å¤±ã€‚</p><p>å¦‚æœæˆ‘ä»¬çœ‹åº”ç”¨äº†åŒçº¿æ€§æ’å€¼çš„çº¹ç†ï¼Œå½“æˆ‘ä»¬åœ¨è¿œå¤„çœ‹å®ƒç§»åŠ¨æ—¶çœ‹èµ·æ¥ä¼šå¾ˆå˜ˆæ‚ï¼Œå› ä¸ºæ¯å¸§éƒ½ä¼šé€‰æ‹©ä¸åŒçš„çº¹ç´ ã€‚</p><h3 id="çº¹ç†æ˜ å°„ï¼ˆMipmappingï¼‰">çº¹ç†æ˜ å°„ï¼ˆMipmappingï¼‰<a href="post/Learn-OpenGL-Lesson-Six#çº¹ç†æ˜ å°„ï¼ˆMipmappingï¼‰"></a></h3><p>æˆ‘ä»¬å¦‚ä½•æ‰èƒ½åœ¨ç¼©å°çº¹ç†æ—¶ä¸å¼•ç”¨å˜ˆæ‚å¹¶ä½¿ç”¨ä¸Šæ‰€æœ‰çº¹ç´ å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”Ÿæˆä¸€ç»„ä¼˜åŒ–åçš„ä¸åŒå°ºå¯¸çš„çº¹ç†ï¼Œç„¶ååœ¨æˆ‘ä»¬è¿è¡Œçš„æ—¶å€™ä½¿ç”¨å®ƒä»¬ã€‚ç”±äºè¿™äº›çº¹ç†å·²é¢„å…ˆç”Ÿæˆï¼Œå®ƒä»¬èƒ½ä½¿ç”¨æ›´å¤šé«˜æ˜‚çš„æŠ€æœ¯å»è¿‡æ»¤æ‰€æœ‰çº¹ç´ ï¼Œå¹¶ä¸”åœ¨è¿è¡Œæ—¶OpenGLä¼šæ ¹æ®çº¹ç†åœ¨å±å¹•ä¸Šçš„æœ€ç»ˆå¤§å°é€‰æ‹©æœ€åˆé€‚çš„å±‚ã€‚</p><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190221143838.png" alt="textures set" class="article-img"></p><p>ç”Ÿæˆçš„å›¾ç‰‡å¯ä»¥å…·æœ‰æ›´å¤šç»†èŠ‚ï¼Œæ›´å°‘å™ªç‚¹ï¼Œå¹¶ä¸”æ•´ä½“ä¸Šçœ‹èµ·æ¥æ›´å¥½ã€‚å°½ç®¡éœ€è¦æ›´å¤šçš„å†…å­˜ï¼Œä½†æ¸²æŸ“é€Ÿåº¦ä¹Ÿä¼šæ›´å¿«ï¼Œå› ä¸ºè¾ƒå°çš„å±‚çº§èƒ½æ›´å®¹æ˜“ä¿å­˜åœ¨GPUçš„çº¹ç†ç¼“å­˜ä¸­ã€‚è®©æˆ‘ä»¬æ¥ä»”ç»†ç ”ç©¶ä¸€ä¸‹åŸå°ºå¯¸çš„1/8å€çš„å›¾ç‰‡ï¼Œåœ¨ä½¿ç”¨äº†åŒçº¿æ€§è¿‡æ»¤ä½¿ç”¨çº¹ç†æ˜ å°„å’ŒåŒçº¿æ€§è¿‡æ»¤æ²¡æœ‰ä½¿ç”¨æ˜ å°„ã€‚ä¸ºäº†æ¸…æ¥šå›¾ç‰‡å·²è¢«æ‰©å¤§ï¼š</p><h4 id="åŒçº¿æ€§è¿‡æ»¤æ²¡æœ‰mipmap">åŒçº¿æ€§è¿‡æ»¤æ²¡æœ‰mipmap<a href="post/Learn-OpenGL-Lesson-Six#åŒçº¿æ€§è¿‡æ»¤æ²¡æœ‰mipmap"></a></h4><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190221145134.png" alt="without mipmaps" class="article-img"></p><h4 id="åŒçº¿æ€§è¿‡æ»¤-mipmap">åŒçº¿æ€§è¿‡æ»¤+mipmap<a href="post/Learn-OpenGL-Lesson-Six#åŒçº¿æ€§è¿‡æ»¤-mipmap"></a></h4><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190221145249.png" alt="with mipmaps" class="article-img"></p><p>ä½¿ç”¨mipmapçš„ç‰ˆæœ¬æ‹¥æœ‰æ›´å¤šç»†èŠ‚ï¼Œç”±äºå›¾åƒé¢„å¤„ç†åˆ°å•ç‹¬çš„å±‚çº§ï¼Œæ‰€æœ‰çº¹ç´ æœ€ç»ˆéƒ½ä¼šåœ¨æœ€ç»ˆçš„å›¾åƒä¸­ä½¿ç”¨ã€‚</p><h3 id="ä¸‰çº¿æ€§è¿‡æ»¤ï¼ˆTrilinear-filteringï¼‰">ä¸‰çº¿æ€§è¿‡æ»¤ï¼ˆTrilinear filteringï¼‰<a href="post/Learn-OpenGL-Lesson-Six#ä¸‰çº¿æ€§è¿‡æ»¤ï¼ˆTrilinear-filteringï¼‰"></a></h3><p>å½“ä½¿ç”¨åŒçº¿æ€§è¿‡æ»¤çš„mipmapæ—¶ï¼Œæœ‰æ—¶åœ¨æ¸²æŸ“åœºæ™¯ä¸­å¯ä»¥çœ‹åˆ°æ˜æ˜¾çš„è·³è·ƒæˆ–çº¿ï¼Œç”±äºOpenGLåœ¨çº¹ç†çš„ä¸åŒmipmapå±‚çº§ä¹‹é—´åˆ‡æ¢ã€‚æ¯”è¾ƒä¸åŒçš„OpenGLçº¹ç†çš„è¿‡æ»¤æ¨¡å¼å°†åœ¨ä¸‹é¢è¿›ä¸€æ­¥æŒ‡å‡ºã€‚</p><p>ä¸‰çº¿æ€§æ’å€¼é€šè¿‡åœ¨ä¸åŒmipmapå±‚çº§ä¹‹é—´æ’å€¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™æ ·æ€»å…±8ä¸ªçº¹ç´ å°†ç”¨äºæ’å€¼å¾—åˆ°æœ€ç»ˆçš„åƒç´ å€¼ï¼Œä½¿å¾—å›¾åƒæ›´å¹³æ»‘ã€‚</p><h2 id="OpenGL-çº¹ç†è¿‡æ»¤æ¨¡å¼">OpenGL çº¹ç†è¿‡æ»¤æ¨¡å¼<a href="post/Learn-OpenGL-Lesson-Six#OpenGL-çº¹ç†è¿‡æ»¤æ¨¡å¼"></a></h2><p>OpenGLæœ‰ä¸¤ä¸ªå¯è¢«è®¾ç½®çš„å‚æ•°ï¼š</p><ul><li><code>GL_TEXTURE_MIN_FILTER</code> çº¹ç†ç¼©å°æ—¶çš„è¿‡æ»¤æ¨¡å¼</li><li><code>GL_TEXTURE_MAG_FILTER</code> çº¹ç†æ”¾å¤§æ—¶çš„è¿‡æ»¤æ¨¡å¼</li></ul><p>è¿™äº›ç›¸å¯¹åº”äºä¸Šé¢çš„ç¼©å°å’Œæ”¾å¤§æè¿°ã€‚  </p><ul><li><code>GL_TEXTURE_MIN_FILTER</code>æ¥å—ä»¥ä¸‹é€‰é¡¹ï¼š<ul><li><code>GL_NEAREST</code></li><li><code>GL_LINEAR</code></li><li><code>GL_NEAREST_MIPMAP_NEAREST</code></li><li><code>GL_NEAREST_MIPMAP_LINEAR</code></li><li><code>GL_LINEAR_MIPMAP_NEAREST</code></li><li><code>GL_LINEAR_MIPMAP_LINEAR</code></li></ul></li><li><code>GL_TEXTURE_MAG_FILTER</code>æ¥å—ä»¥ä¸‹é€‰é¡¹ï¼š<ul><li><code>GL_NEAREST</code></li><li><code>GL_LINEAR</code></li></ul></li></ul><p><code>GL_NEAREST</code> å¯¹åº”æœ€é‚»è¿‘æ¸²æŸ“ï¼›<br><code>GL_LINEAR</code> å¯¹åº”åŒçº¿æ€§è¿‡æ»¤ï¼›<br><code>GL_LINEAR_MIPMAP_NEAREST</code> å¯¹åº”åŒçº¿æ€§è¿‡æ»¤+mipmapï¼›<br><code>GL_LINEAR_MIPMAP_LINEAR</code> å¯¹åº”ä¸‰çº¿æ€§è¿‡æ»¤ï¼›<br>æœ¬è¯¾ä¸­å°†è¿›ä¸€æ­¥ä»‹ç»å›¾å½¢ç¤ºä¾‹å’Œæœ€å¸¸è§é€‰é¡¹çš„è¿›ä¸€æ­¥è¯´æ˜ã€‚</p><h3 id="æ€æ ·è®¾ç½®çº¹ç†è¿‡æ»¤æ¨¡å¼">æ€æ ·è®¾ç½®çº¹ç†è¿‡æ»¤æ¨¡å¼<a href="post/Learn-OpenGL-Lesson-Six#æ€æ ·è®¾ç½®çº¹ç†è¿‡æ»¤æ¨¡å¼"></a></h3><p>æˆ‘ä»¬é¦–å…ˆéœ€è¦ç»‘å®šçº¹ç†ï¼Œç„¶åæˆ‘ä»¬åœ¨è¿™ä¸ªçº¹ç†ä¸Šè®¾ç½®åˆé€‚çš„è¿‡æ»¤å‚æ•°ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, mTextureHandle);</span><br><span class="line">GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, filter);</span><br></pre></td></tr></table></div></figure><h3 id="æ€æ ·ç”Ÿæˆmipmap">æ€æ ·ç”Ÿæˆmipmap<a href="post/Learn-OpenGL-Lesson-Six#æ€æ ·ç”Ÿæˆmipmap"></a></h3><p>è¿™çœŸçš„å¾ˆå®¹æ˜“ï¼åœ¨åŠ è½½çº¹ç†åˆ°OpenGLä¸­åï¼Œçº¹ç†ä»ç„¶æ˜¯ç»‘å®šçš„ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„è°ƒç”¨ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GLES20.glGenerateMipmap(GLES20.GL_TEXTURE_2D);</span><br></pre></td></tr></table></div></figure><p>å®ƒå°†ä¸ºæˆ‘ä»¬ç”Ÿæˆæ‰€æœ‰çš„mipmapå±‚çº§ï¼Œå¹¶ä¸”è¿™äº›å±‚çº§ä¼šæ ¹æ®çº¹ç†è¿‡æ»¤è‡ªåŠ¨ä½¿ç”¨ã€‚</p><h2 id="å®ƒçœ‹èµ·æ¥æ€ä¹ˆæ ·ï¼Ÿ">å®ƒçœ‹èµ·æ¥æ€ä¹ˆæ ·ï¼Ÿ<a href="post/Learn-OpenGL-Lesson-Six#å®ƒçœ‹èµ·æ¥æ€ä¹ˆæ ·ï¼Ÿ"></a></h2><p>ä»¥ä¸‹æ˜¯å¯ç”¨çš„æœ€å¸¸è§çš„ç»„åˆçš„å±å¹•æˆªå›¾ï¼Œå½“ä½ çœ‹åˆ°å®ƒè¿åŠ¨ä¸­æ—¶ï¼Œæ•ˆæœæ›´åŠ å¼•äººæ³¨ç›®ï¼Œå› æ­¤æˆ‘å»ºè®®ä¸‹è½½<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">è¿™ä¸ªApp</a>å¹¶è¯•ä¸€è¯•ã€‚</p><h3 id="æœ€é‚»è¿‘æ¸²æŸ“">æœ€é‚»è¿‘æ¸²æŸ“<a href="post/Learn-OpenGL-Lesson-Six#æœ€é‚»è¿‘æ¸²æŸ“"></a></h3><p>è¿™ä¸ªæ¨¡å¼è®©äººæƒ³èµ·æ—§ç‰ˆ3Dæ¸¸æˆè½¯ä»¶çš„æ¸²æŸ“ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GL_TEXTURE_MIN_FILTER = GL_NEAREST</span><br><span class="line">GL_TEXTURE_MAG_FILTER = GL_NEAREST</span><br></pre></td></tr></table></div></figure><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190221163746.png" alt="nearest nearest" class="article-img"></p><h3 id="åŒçº¿æ€§è¿‡æ»¤ï¼Œmipmap">åŒçº¿æ€§è¿‡æ»¤ï¼Œmipmap<a href="post/Learn-OpenGL-Lesson-Six#åŒçº¿æ€§è¿‡æ»¤ï¼Œmipmap"></a></h3><p>è®¸å¤šæ”¯æŒ3DåŠ é€Ÿçš„é¦–æ‰¹æ¸¸æˆéƒ½ä½¿ç”¨æ­¤æ¨¡å¼ï¼Œè¿™æ˜¯ä»Šå¤©åœ¨Androidæ‰‹æœºä¸Šå¹³æ»‘çº¹ç†çš„æœ‰æ•ˆæ–¹å¼ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GL_TEXTURE_MIN_FILTER = GL_LINEAR_MIPMAP_NEAREST</span><br><span class="line">GL_TEXTURE_MAG_FILTER = GL_LINEAR</span><br></pre></td></tr></table></div></figure><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190221164349.png" alt="linear mipmap" class="article-img"></p><p>é™æ€å›¾ä¸Šå¾ˆéš¾çœ‹å›¾é—®é¢˜ï¼Œä½†æ˜¯å½“ç‰©ä½“è¿åŠ¨æ—¶ï¼Œæ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°æ¸²æŸ“çš„åƒç´ åœ¨mipmapå±‚çº§ä¹‹é—´åˆ‡æ¢çš„æ°´å¹³æ¡å¸¦ã€‚</p><h3 id="ä¸‰çº¿æ€§è¿‡æ»¤">ä¸‰çº¿æ€§è¿‡æ»¤<a href="post/Learn-OpenGL-Lesson-Six#ä¸‰çº¿æ€§è¿‡æ»¤"></a></h3><p>æ­¤æ¨¡å¼é€šè¿‡åœ¨mipmapå±‚çº§ä¹‹é—´è¿›è¡Œæ’å€¼ï¼Œæ”¹è¿›äº†ä½¿ç”¨mipmapçš„åŒçº¿æ€§è¿‡æ»¤çš„æ¸²æŸ“è´¨é‡ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GL_TEXTURE_MIN_FILTER = GL_LINEAR_MIPMAP_LINEAR</span><br><span class="line">GL_TEXTURE_MAG_FILTER = GL_LINEAR</span><br></pre></td></tr></table></div></figure><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190221165703.png" alt="trilinear" class="article-img"></p><p>åƒç´ åœ¨è¿‘è·ç¦»å’Œè¿œè·ç¦»ä¹‹é—´å®Œå…¨å¹³æ»‘ï¼›äº‹å®ä¸Šï¼Œçº¹ç†ç°åœ¨å¯èƒ½åœ¨å€¾æ–œè§’åº¦ä¸‹æ˜¾ç¤ºçš„è¿‡äºå¹³æ»‘ã€‚<br><a href="https://en.wikipedia.org/wiki/Anisotropic_filtering" target="_blank" rel="noopener">å„å‘å¼‚æ€§è¿‡æ»¤ï¼ˆAnisotropic filteringï¼‰</a>æ˜¯ä¸€ç§æ›´å…ˆè¿›çš„æŠ€æœ¯ï¼Œå—åˆ°æŸäº›ç§»åŠ¨GPUçš„æ”¯æŒï¼Œå¯ç”¨äºæ”¹å–„æœ€ç»ˆç»“æœï¼Œè¶…å‡ºä¸‰çº¿æ€§è¿‡æ»¤æ‰€èƒ½æä¾›çš„æ•ˆæœã€‚</p><h3 id="è¿›ä¸€æ­¥ç»ƒä¹ ">è¿›ä¸€æ­¥ç»ƒä¹ <a href="post/Learn-OpenGL-Lesson-Six#è¿›ä¸€æ­¥ç»ƒä¹ "></a></h3><p>ä½¿ç”¨å…¶ä»–æ¨¡å¼å¯ä»¥è¾¾åˆ°ä»€ä¹ˆæ ·çš„æ•ˆæœï¼Ÿä¾‹å¦‚ï¼Œæ‚¨ä½•æ—¶ä¼šä½¿ç”¨åƒ<code>GL_NEAREST_MIPMAP_LINEAR</code>è¿™æ ·çš„ä¸œè¥¿ï¼Ÿ</p><h2 id="æ•™ç¨‹ç›®å½•">æ•™ç¨‹ç›®å½•<a href="post/Learn-OpenGL-Lesson-Six#æ•™ç¨‹ç›®å½•"></a></h2><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five">OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six">OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven">OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVOBï¼‰</a></li></ul><h2 id="æ‰“åŒ…æ•™æ">æ‰“åŒ…æ•™æ<a href="post/Learn-OpenGL-Lesson-Six#æ‰“åŒ…æ•™æ"></a></h2><p>å¯ä»¥åœ¨Githubä¸‹è½½æœ¬è¯¾ç¨‹æºä»£ç ï¼š<a href="https://github.com/learnopengles/Learn-OpenGLES-Tutorials" target="_blank" rel="noopener">ä¸‹è½½é¡¹ç›®</a><br>æœ¬è¯¾çš„ç¼–è¯‘ç‰ˆæœ¬ä¹Ÿå¯ä»¥å†Androidå¸‚åœºä¸‹ï¼š<a href="https://market.android.com/details?id=com.learnopengles.android" target="_blank" rel="noopener">google play ä¸‹è½½apk</a><br>â€œæˆ‘â€ä¹Ÿç¼–è¯‘äº†ä¸ªapkï¼Œæ–¹ä¾¿å¤§å®¶ä¸‹è½½ï¼š<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">github download</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ–‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Six: An Introduction to Texture Filtering&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.learnopengles.com/android-lesson-six-an-introduction-to-texture-filtering/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.learnopengles.com/android-lesson-six-an-introduction-to-texture-filtering/&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/categories/OpenGL/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/tags/OpenGL/"/>
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</title>
    <link href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five/index.html"/>
    <id>https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five/index.html</id>
    <published>2019-02-12T08:37:00.000Z</published>
    <updated>2019-04-08T06:55:57.729Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»è¯‘æ–‡</p></blockquote><p>åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Five: An Introduction to Blending<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.learnopengles.com/android-lesson-five-an-introduction-to-blending/" target="_blank" rel="noopener">http://www.learnopengles.com/android-lesson-five-an-introduction-to-blending/</a><br><a id="more"></a></p><hr><h1 id="ä»‹ç»æ··åˆï¼ˆBlendingï¼‰">ä»‹ç»æ··åˆï¼ˆBlendingï¼‰<a href="post/Learn-OpenGL-Lesson-Five#ä»‹ç»æ··åˆï¼ˆBlendingï¼‰"></a></h1><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬æ¥å­¦ä¹ æ··åˆ(blending)åœ¨OpenGLä¸­çš„<br>åŸºæœ¬ä½¿ç”¨ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•æ‰“å¼€æˆ–å…³é—­æ··åˆï¼Œæ€æ ·è®¾ç½®<br>ä¸åŒçš„æ··åˆæ¨¡å¼ï¼Œä»¥åŠä¸åŒçš„æ··åˆæ¨¡å¼å¦‚ä½•æ¨¡ä»¿æ˜¾ç¤ºç”Ÿ<br>æ´»ä¸­çš„æ•ˆæœã€‚åœ¨åé¢çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿˜å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨<br>alphaé€šé“ï¼Œå¦‚ä½•ä½¿ç”¨æ·±åº¦ç¼“å†²åŒºåœ¨åŒä¸€ä¸ªåœºæ™¯ä¸­æ¸²æŸ“<br>åŠé€æ˜å’Œä¸é€æ˜çš„ç‰©ä½“ï¼Œä»¥åŠä»€ä¹ˆæ—¶å€™æŒ‰æ·±åº¦æ’åºå¯¹è±¡ï¼Œ<br>ä»¥åŠä¸ºä»€ä¹ˆã€‚<br><br>æˆ‘ä»¬è¿˜å°†ç ”ç©¶å¦‚ä½•ç›‘å¬è§¦æ‘¸äº‹ä»¶ï¼Œç„¶ååŸºäºæ­¤æ›´æ”¹æ¸²æŸ“<br>çŠ¶æ€ã€‚</td><td style="text-align:center"><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190212163914.png" alt="display"><br><em>åŸºæœ¬æ··åˆ</em></td></tr></tbody></table></div></div><h2 id="å‰ææ¡ä»¶">å‰ææ¡ä»¶<a href="post/Learn-OpenGL-Lesson-Five#å‰ææ¡ä»¶"></a></h2><p>æœ¬ç³»åˆ—æ¯ä¸ªè¯¾ç¨‹æ„å»ºéƒ½æ˜¯ä»¥å‰ä¸€ä¸ªè¯¾ç¨‹ä¸ºåŸºç¡€ã€‚ç„¶è€Œï¼Œå¯¹äºè¿™èŠ‚è¯¾ï¼Œå¦‚æœæ‚¨ç†è§£äº†<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a>å°±è¶³å¤Ÿäº†ã€‚å°½ç®¡ä»£ç åŸºæœ¬ä¸Šæ˜¯å‰ä¸€è¯¾çš„ï¼Œç…§æ˜å’Œçº¹ç†éƒ¨åˆ†å·²åœ¨æœ¬è¯¾ä¸­ç§»é™¤ï¼Œå› æ­¤æˆ‘ä»¬ä»…å…³æ³¨æ··åˆã€‚</p><h2 id="æ··åˆï¼ˆBlendingï¼‰">æ··åˆï¼ˆBlendingï¼‰<a href="post/Learn-OpenGL-Lesson-Five#æ··åˆï¼ˆBlendingï¼‰"></a></h2><p>æ··åˆæ˜¯å°†ä¸€ç§é¢œè‰²ä¸å¦ä¸€ç§é¢œè‰²ç»„åˆä»¥è·å¾—ç¬¬ä¸‰ç§é¢œè‰²çš„è¡Œä¸ºã€‚æˆ‘ä»¬åœ¨ç°å®ä¸–ç•Œä»»ä½•æ—¶å€™éƒ½èƒ½çœ‹åˆ°æ··åˆï¼šå½“å…‰ç©¿è¿‡ç»ç’ƒæ—¶ï¼Œå½“å®ƒä»è¡¨é¢åå°„æ—¶ï¼Œå½“å…‰æºæœ¬èº«å åŠ åœ¨èƒŒæ™¯ä¸Šæ—¶ï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨æ™šä¸Šçœ‹åˆ°ä¸€ç›æ˜äº®çš„è·¯ç¯å‘¨å›´çš„è€€æ–‘ã€‚</p><p>OpenGLæœ‰ä¸åŒçš„æ··åˆæ¨¡å¼ï¼Œæˆ‘ä»¬èƒ½ä½¿ç”¨å®ƒæ¨¡æ‹Ÿè¿™ç§æ•ˆæœã€‚åœ¨OpenGLä¸­ï¼Œæ··åˆå‘ç”Ÿåœ¨æ¸²æŸ“è¿‡ç¨‹çš„åæœŸï¼šä¸€æ—¦ç‰‡æ®µç€è‰²å™¨è®¡ç®—å‡ºç‰‡æ®µçš„æœ€ç»ˆè¾“å‡ºé¢œè‰²å¹¶ä¸”å®ƒå³å°†è¢«å†™å…¥å¸§ç¼“å†²åŒºï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™ç‰‡æ®µä¼šè¦†ç›–ä¹‹å‰æ‰€æœ‰å†…å®¹ï¼Œä½†å¦‚æœå¯ç”¨äº†æ··åˆï¼Œé‚£ä¹ˆè¯¥ç‰‡æ®µå°†ä¸ä¹‹å‰çš„ç‰‡æ®µæ··åˆã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“<code>glBlendEquation()</code>è®¾ç½®ä¸ºé»˜è®¤å€¼<code>GL_FUNC_ADD</code>æ—¶OpenGLçš„é»˜è®¤æ··åˆæ–¹ç¨‹å¼ä¸ºï¼š</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¾“å‡º = ï¼ˆæºå› å­ * æºç‰‡æ®µï¼‰ + ï¼ˆç›®æ ‡å› å­ * ç›®æ ‡ç‰‡æ®µï¼‰</span></span><br><span class="line">output = (source factor * source fragment) + (destination factor * destination fragment)</span><br></pre></td></tr></table></div></figure><p>OpenGL ES 2 ä¸­è¿˜æœ‰å¦å¤–ä¸¤ç§æ¨¡å¼<code>GL_FUNC_SUBTRACT</code>å’Œ<code>GL_FUNC_REVERSE_SUBTRACT</code>ã€‚<br>è¿™äº›å¯èƒ½åœ¨ä»¥åçš„æ•™ç¨‹ä¸­ä»‹ç»ï¼Œç„¶è€Œï¼Œå½“æˆ‘å°è¯•è°ƒç”¨æ­¤å‡½æ•°æ—¶ï¼Œæˆ‘åœ¨Nexus Sä¸Šé‡åˆ°äº†<br><code>UnsupportedOperationException</code>ï¼Œå› æ­¤Androidå®ç°å¯èƒ½å®é™…ä¸Šä¸æ”¯æŒæ­¤åŠŸèƒ½ã€‚<br>è¿™ä¸æ˜¯ä¸–ç•Œæœ«æ—¥ï¼Œå› ä¸ºä½ å¯ä»¥ç”¨<code>GL_FUNC_ADD</code>åšå¾ˆå¤šäº‹æƒ…ã€‚</p><p>ä½¿ç”¨å‡½æ•°<code>glBlendFunc()</code>è®¾ç½®æºå› å­å’Œç›®æ ‡å› å­ã€‚ä¸‹é¢å°†ç»™å‡ºå‡ ä¸ªå¸¸è§æ··åˆå› å­çš„æ¦‚è¿°ï¼›æ›´å¤šä¿¡æ¯ä»¥åŠä¸åŒå¯èƒ½çš„å› ç´ çš„åˆ—ä¸¾ï¼Œè¯·å‚é˜…<a href="http://www.khronos.org/opengles/sdk/docs/man/" target="_blank" rel="noopener">Khronosåœ¨çº¿æ‰‹å†Œ</a>ï¼š</p><ul><li><a href="https://www.khronos.org/registry/OpenGL-Refpages/es2.0/xhtml/glBlendFunc.xml" target="_blank" rel="noopener">glBlendFunc()</a></li><li><a href="https://www.khronos.org/registry/OpenGL-Refpages/es2.0/xhtml/glBlendEquation.xml" target="_blank" rel="noopener">glBlendEquation()</a></li></ul><h3 id="æˆªå–ï¼ˆClampingï¼‰">æˆªå–ï¼ˆClampingï¼‰<a href="post/Learn-OpenGL-Lesson-Five#æˆªå–ï¼ˆClampingï¼‰"></a></h3><p>OpenGLé¢„æœŸçš„è¾“å…¥è¢«é™åˆ¶åœ¨[0,1]çš„èŒƒå›´å†…ï¼Œå¹¶ä¸”è¾“å…¥ä¹Ÿè¢«é™åˆ¶åœ¨[0,1]ã€‚è¿™åœ¨å®è·µä¸­æ„å‘³ç€å½“æ‚¨è¿›è¡Œæ··åˆæ—¶ï¼Œé¢œè‰²å¯ä»¥åœ¨è‰²è°ƒä¸­ç§»åŠ¨ã€‚<br>å¦‚æœç»§ç»­æƒ³å¸§ç¼“å†²åŒºæ·»åŠ çº¢è‰²ï¼ˆRGB = 1ï¼Œ0ï¼Œ0ï¼‰ï¼Œæœ€ç»ˆé¢œè‰²ä¼šæ˜¯çº¢è‰²ã€‚å¦‚æœæƒ³æ·»åŠ ä¸€ç‚¹å„¿ç»¿è‰²ï¼Œæ‚¨è¦æ·»åŠ ï¼ˆRGB = 1ï¼Œ0.1ï¼Œ0ï¼‰åˆ°ç¼“å†²åŒºï¼Œå³ä½¿æ‚¨å¼€å§‹å¸¦çº¢è‰²çš„è‰²è°ƒï¼Œæœ€åä¹Ÿä¼šå¾—åˆ°é»„è‰²ï¼<br>æ‰“å¼€æ··åˆæ—¶ï¼Œæ‚¨å¯ä»¥åœ¨æœ¬è¯¾ç¨‹çš„Demoä¸­çœ‹åˆ°æ­¤æ•ˆæœï¼šä¸åŒé¢œè‰²çš„é‡å çš„é¢œè‰²å˜å¾—è¿‡é¥±å’Œã€‚</p><h2 id="ä¸åŒç±»å‹çš„æ··åˆä»¥åŠå®ƒä»¬æœ‰æ€æ ·ä¸åŒçš„æ•ˆæœ">ä¸åŒç±»å‹çš„æ··åˆä»¥åŠå®ƒä»¬æœ‰æ€æ ·ä¸åŒçš„æ•ˆæœ<a href="post/Learn-OpenGL-Lesson-Five#ä¸åŒç±»å‹çš„æ··åˆä»¥åŠå®ƒä»¬æœ‰æ€æ ·ä¸åŒçš„æ•ˆæœ"></a></h2><h3 id="ç›¸åŠ æ··åˆï¼ˆAdditive-blendingï¼‰">ç›¸åŠ æ··åˆï¼ˆAdditive blendingï¼‰<a href="post/Learn-OpenGL-Lesson-Five#ç›¸åŠ æ··åˆï¼ˆAdditive-blendingï¼‰"></a></h3><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:center"><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190213200752.png" alt="rgb"></th></tr></thead><tbody><tr><td style="text-align:center"><em>RGBé¢œè‰²ç›¸åŠ æ¨¡å‹ï¼› æ¥æºï¼šWikipedia</em></td></tr></tbody></table></div></div><p>ç›¸åŠ æ··åˆæ˜¯å½“æˆ‘ä»¬æ·»åŠ ä¸åŒé¢œè‰²åœ¨ä¸€èµ·çš„æ··åˆï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„è§†è§‰ä¸å…‰ä¸€èµ·å·¥ä½œçš„æ¨¡å¼ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å¦‚ä½•åœ¨æˆ‘ä»¬çš„æ˜¾ç¤ºå™¨ä¸Šæ„ŸçŸ¥æ•°ç™¾ä¸‡ç§ä¸åŒçš„é¢œè‰²â€”â€”å®ƒä»¬å®é™…ä¸Šåªæ˜¯å°†ä¸‰ç§ä¸åŒçš„åŸè‰²æ··åˆåœ¨ä¸€èµ·ã€‚</p><p>è¿™ç§æ··åˆåœ¨3Dæ··åˆä¸­å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚åœ¨ç²’å­æ•ˆæœä¸­ï¼Œå®ƒä»¬ä¼¼ä¹å‘å‡ºå…‰çº¿å’Œè¦†ç›–ç‰©ï¼Œä¾‹å¦‚ç¯å…‰å‘¨å›´çš„å…‰æ™•ï¼Œæˆ–å…‰å‰‘å‘¨å›´çš„å‘å…‰æ•ˆæœã€‚</p><p>ç›¸åŠ æ··åˆèƒ½é€šè¿‡è°ƒç”¨<code>glBlendFunc(GL_ONE, GL_ONE)</code>æŒ‡å®šï¼Œ<br>æ··åˆçš„ç»“æœç­‰å¼<code>è¾“å‡º=ï¼ˆ1 * æºç‰‡æ®µï¼‰ + ï¼ˆ1 * ç›®æ ‡ç‰‡æ®µï¼‰</code>ï¼Œè¿ç®—åï¼š<code>è¾“å‡º=æºç‰‡æ®µ + ç›®æ ‡ç‰‡æ®µ</code></p><h3 id="ç›¸ä¹˜æ··åˆï¼ˆMultiplicative-blendingï¼‰">ç›¸ä¹˜æ··åˆï¼ˆMultiplicative blendingï¼‰<a href="post/Learn-OpenGL-Lesson-Five#ç›¸ä¹˜æ··åˆï¼ˆMultiplicative-blendingï¼‰"></a></h3><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:center"><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190213202603.png" alt="rg"></th></tr></thead><tbody><tr><td style="text-align:center"><em>å…‰ç…§è´´å›¾çš„ä¸€ä¸ªä¾‹å­</em></td></tr></tbody></table></div></div><p>ç›¸ä¹˜æ··åˆï¼ˆä¹Ÿç§°ä¸ºè°ƒåˆ¶ï¼‰æ˜¯å¦ä¸€ç§æœ‰ç”¨çš„æ··åˆæ¨¡å¼ï¼Œå®ƒè¡¨ç¤ºå…‰åœ¨é€šè¿‡è¿‡æ»¤å™¨æ—¶çš„è¡Œä¸ºæ–¹å¼ï¼Œæˆ–ä»è¢«ç‚¹ç‡ƒçš„ç‰©ä½“åå°„å¹¶è¿›å…¥æˆ‘ä»¬çš„çœ¼ç›ã€‚ä¸€ä¸ªçº¢è‰²çš„ç‰©ä½“çœ‹ä¸Šå»æ˜¯çº¢è‰²æ˜¯å› ä¸ºç™½å…‰ç…§å°„åˆ°è¿™ä¸ªç‰©ä½“ä¸Šï¼Œè“å…‰å’Œç»¿å…‰è¢«å¸æ”¶ï¼Œåªæœ‰çº¢å…‰åå°„å›æˆ‘ä»¬çš„çœ¼ç›ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°ä¸€äº›çº¢è‰²å’Œç»¿è‰²ï¼Œä½†æ˜¯å¾ˆå°‘ä¼šæœ‰ä¸€ç‚¹è“è‰²ã€‚</p><p>å½“å¤šçº¹ç†ä¸å¯ç”¨æ—¶ï¼Œä¹˜æ³•æ··åˆç”¨äºåœ¨æ¸¸æˆä¸­å®ç°å…‰ç…§è´´å›¾ã€‚çº¹ç†ä¸å…‰ç…§è´´å›¾ç›¸ä¹˜ï¼Œä»¥å¡«å……åœ¨æ˜äº®å’Œé˜´å½±çš„åŒºåŸŸã€‚</p><p>ç›¸ä¹˜æ··åˆèƒ½é€šè¿‡è°ƒç”¨<code>glBlendFunc(GL_DST_COLOR, GL_ZERO)</code>æŒ‡å®šï¼Œ<br>å…¶æ··åˆçš„ç»“æœç­‰å¼<code>è¾“å‡º=ï¼ˆç›®æ ‡ç‰‡æ®µ * æºç‰‡æ®µï¼‰+ ï¼ˆ0 * ç›®æ ‡ç‰‡æ®µï¼‰</code>ï¼Œå†™ä½œï¼š<code>è¾“å‡º=ç›®æ ‡ç‰‡æ®µ * æºç‰‡æ®µ</code>ã€‚</p><h3 id="æ’å€¼æ··åˆï¼ˆInterpolative-blendingï¼‰">æ’å€¼æ··åˆï¼ˆInterpolative blendingï¼‰<a href="post/Learn-OpenGL-Lesson-Five#æ’å€¼æ··åˆï¼ˆInterpolative-blendingï¼‰"></a></h3><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:center"><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190213205158.png" alt="textures"></th></tr></thead><tbody><tr><td style="text-align:center"><em>ä¸€ä¸ªä¸¤ä¸ªçº¹ç†ä¸€èµ·æ’å€¼çš„æ¡ˆä¾‹</em></td></tr></tbody></table></div></div><p>æ’å€¼æ··åˆç»“åˆäº†ä¹˜æ³•å’ŒåŠ æ³•ï¼Œä»¥æä¾›æ’å€¼æ•ˆæœã€‚ä¸æ·»åŠ å’Œè°ƒåˆ¶æœ¬èº«ä¸åŒï¼Œæ­¤æ··åˆæ¨¡å¼ä¹Ÿå¯æ˜¯ä¾èµ–ç»˜åˆ¶é¡ºåºçš„ã€‚å› æ­¤åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœæ‚¨å…ˆç”»å‡ºæœ€è¿œçš„åŠé€æ˜ç‰©ä½“ï¼Œç„¶åç»˜åˆ¶æ›´è¿‘çš„ç‰©ä½“ï¼Œç»“æœæ‰ä¼šæ˜¯æ­£ç¡®ã€‚å³ä½¿æ’åºä¹Ÿä¸æ˜¯å®Œç¾ï¼Œå› ä¸ºä¸‰è§’å½¢å¯èƒ½é‡å å¹¶ç›¸äº¤ï¼Œä½†äº§ç”Ÿçš„ä¼ªåƒå¯èƒ½æ˜¯å¯æ¥å—çš„ã€‚</p><p>æ’å€¼é€šå¸¸æ˜¯å°†ç›¸é‚»çš„è¡¨é¢æ··åˆåœ¨ä¸€èµ·ï¼Œä»¥åŠåšæœ‰è‰²ç»ç’ƒæˆ–æ·¡å…¥æ·¡å‡ºçš„æ•ˆæœã€‚ä¸Šé¢è¿™ä¸ªå›¾ç‰‡æ˜¾ç¤ºäº†ä¸¤ä¸ªçº¹ç†ï¼ˆçº¹ç†æ¥è‡ª<a href="http://pdtextures.blogspot.com/" target="_blank" rel="noopener">å…¬å…±é¢†åŸŸçº¹ç†</a>ï¼‰ä½¿ç”¨æ’å€¼æ··åˆåœ¨ä¸€èµ·ã€‚</p><p>æ’å€¼æ··åˆèƒ½é€šè¿‡è°ƒç”¨<code>glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA)</code>æŒ‡å®šï¼Œ<br>å…¶æ··åˆç»“æœç­‰å¼<code>è¾“å‡º = ï¼ˆæºalpha * æºç‰‡æ®µï¼‰ + ï¼ˆï¼ˆ1 - æºalphaï¼‰ * ç›®æ ‡ç‰‡æ®µï¼‰</code>ã€‚è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æ­£åœ¨ç»˜åˆ¶ä¸€ä¸ªåªæœ‰25%ä¸é€æ˜çš„ç»¿è‰²ï¼ˆ0ï¼Œ1ï¼Œ0ï¼‰ï¼Œå½“å‰å±å¹•ä¸Šçš„ç‰©ä½“æ—¶çº¢è‰²ï¼ˆ1ï¼Œ0ï¼Œ0ï¼‰ã€‚</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è¾“å‡º = ï¼ˆæºå› å­ * æºç‰‡æ®µï¼‰ + ï¼ˆç›®æ ‡å› å­ * ç›®æ ‡ç‰‡æ®µï¼‰</span><br><span class="line">è¾“å‡º = ï¼ˆæºalpha * æºç‰‡æ®µï¼‰ + ï¼ˆï¼ˆ<span class="number">1</span> - æºalphaï¼‰ * ç›®æ ‡ç‰‡æ®µï¼‰</span><br><span class="line"></span><br><span class="line">è¾“å‡º = (<span class="number">0.25</span> * (<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>)) + (<span class="number">0.72</span> * (<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">è¾“å‡º = (<span class="number">0</span>, <span class="number">0.25</span>, <span class="number">0</span>) + (<span class="number">0.75</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">è¾“å‡º = (<span class="number">0.75</span>, <span class="number">0.25</span>, <span class="number">0</span>)</span><br></pre></td></tr></table></div></figure><p>æ³¨æ„ï¼Œæˆ‘ä»¬ä¸éœ€è¦å¯¹ç›®æ ‡alphaåšä»»ä½•æ¶‰åŠï¼Œå› ä¸ºè¿™ä¸ªå¸§ç¼“å†²åŒºæœ¬èº«ä¸éœ€è¦alphaé€šé“ï¼Œè¿™ä¸ºæˆ‘ä»¬æä¾›äº†æ›´å¤šçš„é¢œè‰²é€šé“ä½ã€‚</p><h2 id="ä½¿ç”¨æ··åˆ">ä½¿ç”¨æ··åˆ<a href="post/Learn-OpenGL-Lesson-Five#ä½¿ç”¨æ··åˆ"></a></h2><p>åœ¨æˆ‘ä»¬çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬çš„Demoå°†ä½¿ç”¨ç›¸åŠ æ··åˆå°†ç«‹æ–¹ä½“æ˜¾ç¤ºä¸ºå…‰çš„å‘å°„å™¨ã€‚å‘å…‰çš„ä¸œè¥¿ä¸éœ€è¦å…¶ä»–å…‰æºç…§äº®ï¼Œå› æ­¤è¿™ä¸ªDemoä¸­æ²¡æœ‰ç¯å…‰ã€‚æˆ‘ä¹Ÿåˆ é™¤äº†çº¹ç†ï¼Œè™½ç„¶å®ƒå¯ä»¥å¾ˆå¥½åœ°ä½¿ç”¨ã€‚æœ¬è¯¾ç¨‹çš„ç€è‰²å™¨ç¨‹åºå¾ˆç®€å•ï¼›æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªå¯ä¼ é€’é¢œè‰²çš„ç€è‰²å™¨ã€‚</p><h3 id="é¡¶ç‚¹ç€è‰²å™¨">é¡¶ç‚¹ç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Five#é¡¶ç‚¹ç€è‰²å™¨"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVPMatrix;</span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Position;</span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Color;</span><br><span class="line"></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    v_Color = a_Color;</span><br><span class="line">    <span class="built_in">gl_Position</span> = u_MVPMatrix * a_Position;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="ç‰‡æ®µç€è‰²å™¨">ç‰‡æ®µç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Five#ç‰‡æ®µç€è‰²å™¨"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">precision</span> <span class="keyword">mediump</span> <span class="type">float</span>;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">gl_FragColor</span> = v_Color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="æ‰“å¼€æ··åˆ">æ‰“å¼€æ··åˆ<a href="post/Learn-OpenGL-Lesson-Five#æ‰“å¼€æ··åˆ"></a></h3><p>æ‰“å¼€æ··åˆå°±åƒæ˜¯åšä¸€äº›æ–¹æ³•è°ƒç”¨é‚£ä¹ˆç®€å•ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…³é—­å‰”é™¤å»æ‰èƒŒé¢</span></span><br><span class="line">GLES20.glDisable(GLES20.GL_CULL_FACE);</span><br><span class="line"><span class="comment">// å…³é—­æ·±åº¦æµ‹è¯•</span></span><br><span class="line">GLES20.glDisable(GLES20.GL_DEPTH_TEST);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨æ··åˆ</span></span><br><span class="line">GLES20.glEnable(GLES20.GL_BLEND);</span><br><span class="line">GLES20.glBlendFunc(GLES20.GL_ONE, GLES20.GL_ONE);</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬å…³é—­èƒŒé¢å‰”é™¤ï¼Œæ˜¯å› ä¸ºå¦‚æœç«‹æ–¹ä½“æ˜¯åŠé€æ˜çš„ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬èƒ½çœ‹åˆ°ç«‹æ–¹ä½“çš„èƒŒé¢ã€‚æˆ‘ä»¬éœ€è¦ç»˜åˆ¶å®ƒä»¬ï¼Œå¦åˆ™å¯èƒ½çœ‹èµ·æ¥ä¼šå¾ˆå¥‡æ€ªã€‚å‡ºäºåŒæ ·çš„åŸå› æˆ‘ä»¬å…³é—­äº†æ·±åº¦æµ‹è¯•ã€‚</p><h2 id="å­¦ä¹ è§¦æ‘¸äº‹ä»¶å¹¶è¿›è¡Œæ“ä½œ">å­¦ä¹ è§¦æ‘¸äº‹ä»¶å¹¶è¿›è¡Œæ“ä½œ<a href="post/Learn-OpenGL-Lesson-Five#å­¦ä¹ è§¦æ‘¸äº‹ä»¶å¹¶è¿›è¡Œæ“ä½œ"></a></h2><p>ä½ å°†æ³¨æ„åˆ°ï¼Œå½“æ‚¨è¿è¡ŒDemoæ—¶ï¼Œå¯ä»¥é€šè¿‡ç‚¹å‡»å±å¹•æ¥æ‰“å¼€å’Œå…³é—­æ··åˆã€‚</p><p>ç°å®è§¦æ‘¸äº‹ä»¶ï¼Œæ‚¨é¦–å…ˆéœ€è¦åˆ›å»ºæ‚¨çš„<code>GLSurfaceView</code>è‡ªå®šä¹‰viewã€‚åœ¨è¿™ä¸ªviewä¸­ï¼Œåˆ›å»ºä¸€ä¸ªé»˜è®¤æ„é€ ç”¨æ¥è°ƒç”¨çˆ¶ç±»ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ–¹æ³•æ¥æ¥æ”¶ç‰¹å®šçš„æ¸²æŸ“å™¨æ›¿æ¢å¸¸ç”¨æ¥å£ï¼Œå¹¶è¦†å†™<code>onTouchEvent()</code>ã€‚æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªå…·ä½“çš„æ¸²æŸ“å™¨ç±»ï¼Œå› ä¸ºæˆ‘ä»¬å°†è¦åœ¨<code>onTouchEvent()</code>æ–¹æ³•ä¸­è°ƒç”¨è¿™ä¸ªç±»çš„ç‰¹å®šæ–¹æ³•ã€‚</p><p>åœ¨Androidä¸­ï¼ŒOpenGLæ¸²æŸ“å™¨åœ¨ç‹¬ç«‹çš„çº¿ç¨‹ä¸­å®Œæˆï¼Œå› æ­¤æˆ‘ä»¬è¿˜å°†çœ‹çœ‹å¦‚ä½•å®‰å…¨çš„ä»æ­£åœ¨ç›‘å¬è§¦æ‘¸äº‹ä»¶çš„ä¸»çº¿ç¨‹è°ƒåº¦åˆ°å•ç‹¬çš„æ¸²æŸ“å™¨çº¿ç¨‹ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LessonFiveGLSurfaceView</span> <span class="keyword">extends</span> <span class="title">GLSurfaceView</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LessonFiveRenderer mRenderer;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LessonFiveGLSurfaceView</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">                event == <span class="keyword">null</span></span><br><span class="line">                || event.getAction() != MotionEvent.ACTION_DOWN</span><br><span class="line">                || mRenderer == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.onTouchEvent(event);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç¡®ä¿æˆ‘ä»¬åœ¨OpenGLçº¿ç¨‹ä¸Šè°ƒç”¨switchMode()</span></span><br><span class="line">        <span class="comment">// queueEvent() æ˜¯GLSurfaceViewçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå°†ä¸ºæˆ‘ä»¬åšåˆ°è¿™ç‚¹</span></span><br><span class="line">        queueEvent(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                mRenderer.switchMode();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRenderer</span><span class="params">(LessonFiveRenderer renderer)</span> </span>&#123;</span><br><span class="line">        mRenderer = renderer;</span><br><span class="line">        <span class="keyword">super</span>.setRenderer(renderer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>åœ¨<code>LessonFiveRenderer</code>ä¸­å®ç°<code>switchMode()</code></p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">switchMode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mBlending = !mBlending;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mBlending) &#123;</span><br><span class="line">        <span class="comment">// å…³é—­å‰”é™¤å»æ‰èƒŒé¢</span></span><br><span class="line">        GLES20.glDisable(GLES20.GL_CULL_FACE);</span><br><span class="line">        <span class="comment">// å…³é—­æ·±åº¦æµ‹è¯•</span></span><br><span class="line">        GLES20.glDisable(GLES20.GL_DEPTH_TEST);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯åŠ¨æ··åˆ</span></span><br><span class="line">        GLES20.glEnable(GLES20.GL_BLEND);</span><br><span class="line">        GLES20.glBlendFunc(GLES20.GL_ONE, GLES20.GL_ONE);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        GLES20.glEnable(GLES20.GL_CULL_FACE);</span><br><span class="line">        GLES20.glEnable(GLES20.GL_DEPTH_TEST);</span><br><span class="line">        GLES20.glDisable(GLES20.GL_BLEND);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>ä»”ç»†çœ‹<code>LessonFiveGLSurfaceView::onTouchEvent()</code>ï¼Œä¸»è¦è®°ä½è§¦æ‘¸äº‹ä»¶éƒ½æ˜¯åœ¨UIä¸»çº¿ç¨‹ä¸­<br>ï¼Œè€Œ<code>GLSurfaceView</code>åœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ä¸­åˆ›å»ºOpenGL ESä¸Šä¸‹æ–‡ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„æ¸²æŸ“å™¨çš„å›è°ƒä¹Ÿåœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ä¸­è¿è¡Œã€‚è¿™æ˜¯ä¸€ä¸ªéœ€è¦è®°ä½çš„é‡ç‚¹ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½å†å…¶ä»–çº¿ç¨‹è°ƒç”¨OpenGLå¹¶å¸Œæœ›å…¶å·¥ä½œã€‚</p><p>è¾›è¿çš„æ˜¯ï¼Œç¼–å†™<code>GLSurfaceView</code>çš„äººä¹Ÿæƒ³åˆ°äº†è¿™ç‚¹ï¼Œå¹¶æä¾›äº†ä¸€ä¸ª<code>queueEvent()</code>æ–¹æ³•ï¼Œè¿™ä½¿å¾—ä½ å¯ä»¥è°ƒç”¨OpenGLçº¿ç¨‹ä¸Šçš„ä¸œè¥¿ã€‚å› æ­¤ï¼Œå½“æˆ‘ä»¬æƒ³é€šè¿‡ç‚¹å‡»å±å¹•æ‰“å¼€å’Œå…³é—­æ··åˆæ—¶ï¼Œæˆ‘ä»¬ç¡®ä¿é€šè¿‡åœ¨UIçº¿ç¨‹ä¸­ä½¿ç”¨<code>queueEvent()</code>æ¥æ­£ç¡®è°ƒç”¨OpenGLçº¿ç¨‹ä¸­çš„å†…å®¹ã€‚</p><h3 id="è¿›ä¸€æ­¥ç»ƒä¹ ">è¿›ä¸€æ­¥ç»ƒä¹ <a href="post/Learn-OpenGL-Lesson-Five#è¿›ä¸€æ­¥ç»ƒä¹ "></a></h3><p>è¿™ä¸ªDemoç›®å‰ä»…ä½¿ç”¨ç›¸åŠ æ··åˆï¼Œå°è¯•æ”¹å˜å…¶ä¸ºæ’å€¼æ··åˆå¹¶é‡æ–°æ·»åŠ ç¯å…‰å’Œçº¹ç†ã€‚å¦‚æœæ‚¨åªåœ¨é»‘è‰²èƒŒæ™¯ä¸Šç»˜åˆ¶ä¸¤ä¸ªåŠé€æ˜çº¹ç†ï¼Œç»˜åˆ¶é¡ºåºæ˜¯å¦é‡è¦ï¼Ÿä»€ä¹ˆæ—¶å€™é‡è¦ï¼Ÿ</p><h2 id="æ•™ç¨‹ç›®å½•">æ•™ç¨‹ç›®å½•<a href="post/Learn-OpenGL-Lesson-Five#æ•™ç¨‹ç›®å½•"></a></h2><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five">OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six">OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven">OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVOBï¼‰</a></li></ul><h2 id="æ‰“åŒ…æ•™æ">æ‰“åŒ…æ•™æ<a href="post/Learn-OpenGL-Lesson-Five#æ‰“åŒ…æ•™æ"></a></h2><p>å¯ä»¥åœ¨Githubä¸‹è½½æœ¬è¯¾ç¨‹æºä»£ç ï¼š<a href="https://github.com/learnopengles/Learn-OpenGLES-Tutorials" target="_blank" rel="noopener">ä¸‹è½½é¡¹ç›®</a><br>æœ¬è¯¾çš„ç¼–è¯‘ç‰ˆæœ¬ä¹Ÿå¯ä»¥å†Androidå¸‚åœºä¸‹ï¼š<a href="https://market.android.com/details?id=com.learnopengles.android" target="_blank" rel="noopener">google play ä¸‹è½½apk</a><br>â€œæˆ‘â€ä¹Ÿç¼–è¯‘äº†ä¸ªapkï¼Œæ–¹ä¾¿å¤§å®¶ä¸‹è½½ï¼š<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">github download</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ–‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Five: An Introduction to Blending&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.learnopengles.com/android-lesson-five-an-introduction-to-blending/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.learnopengles.com/android-lesson-five-an-introduction-to-blending/&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/categories/OpenGL/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/tags/OpenGL/"/>
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</title>
    <link href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four/index.html"/>
    <id>https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four/index.html</id>
    <published>2019-02-08T11:26:29.000Z</published>
    <updated>2019-04-08T06:56:03.158Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»è¯‘æ–‡</p></blockquote><p>åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Four: Introducing Basic Texturing<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.learnopengles.com/android-lesson-four-introducing-basic-texturing/" target="_blank" rel="noopener">http://www.learnopengles.com/android-lesson-four-introducing-basic-texturing/</a><br><a id="more"></a></p><hr><h1 id="ä»‹ç»çº¹ç†åŸºç¡€">ä»‹ç»çº¹ç†åŸºç¡€<a href="post/Learn-OpenGL-Lesson-Four#ä»‹ç»çº¹ç†åŸºç¡€"></a></h1><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>è¿™æ˜¯æˆ‘ä»¬Androidç³»åˆ—çš„ç¬¬å››ä¸ªè¯¾ç¨‹ã€‚<br>åœ¨æœ¬è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†æ·»åŠ æˆ‘ä»¬åœ¨<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">ç¬¬ä¸‰è¯¾</a><br>ä¸­å­¦åˆ°çš„å†…å®¹ï¼Œå¹¶å­¦ä¹ å¦‚ä½•æ·»åŠ çº¹ç†ã€‚<br>æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä»åº”ç”¨èµ„æºä¸­è·å–ä¸€å¼ <br>å›¾ç‰‡åŠ è½½åˆ°OpenGLESä¸­ï¼Œå¹¶å±•ç¤ºåˆ°<br>å±å¹•ä¸Šã€‚<br><br>è·Ÿç€æˆ‘ä¸€èµ·æ¥ï¼Œä½ å°†é©¬ä¸Šæ˜ç™½çº¹ç†çš„<br>åŸºæœ¬ä½¿ç”¨æ–¹å¼ã€‚</td><td><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190208193740.png" alt="screenshot"></td></tr></tbody></table></div></div><h2 id="å‰ææ¡ä»¶">å‰ææ¡ä»¶<a href="post/Learn-OpenGL-Lesson-Four#å‰ææ¡ä»¶"></a></h2><p>æœ¬ç³»åˆ—æ¯ä¸ªè¯¾ç¨‹æ„å»ºéƒ½æ˜¯ä»¥å‰ä¸€ä¸ªè¯¾ç¨‹ä¸ºåŸºç¡€ï¼Œè¿™èŠ‚è¯¾æ˜¯<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">ç¬¬ä¸‰è¯¾</a>çš„æ‰©å±•ï¼Œå› æ­¤è¯·åŠ¡å¿…åœ¨ç»§ç»­ä¹‹å‰å¤ä¹ è¯¥è¯¾ç¨‹ã€‚</p><blockquote><p>å·²ä¸‹æ˜¯æœ¬ç³»åˆ—è¯¾ç¨‹çš„å‰å‡ è¯¾ï¼š</p></blockquote><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li></ul><h2 id="çº¹ç†åŸºç¡€">çº¹ç†åŸºç¡€<a href="post/Learn-OpenGL-Lesson-Four#çº¹ç†åŸºç¡€"></a></h2><p>çº¹ç†æ˜ å°„çš„è‰ºæœ¯ï¼ˆä»¥åŠç…§æ˜ï¼‰æ˜¯æ„å»ºé€¼çœŸçš„3Dä¸–ç•Œæœ€é‡è¦çš„éƒ¨åˆ†ã€‚æ²¡æœ‰çº¹ç†æ˜ å°„ï¼Œä¸€åˆ‡éƒ½æ˜¯å¹³æ»‘çš„é˜´å½±ï¼Œçœ‹èµ·æ¥å¾ˆäººå·¥ï¼Œå°±åƒæ˜¯90å¹´ä»£çš„è€å¼æ§åˆ¶å°æ¸¸æˆã€‚</p><p>ç¬¬ä¸€ä¸ªå¼€å§‹å¤§é‡ä½¿ç”¨çº¹ç†çš„æ¸¸æˆï¼Œå¦‚Doomå’ŒDuke Nukem 3Dï¼Œé€šè¿‡å¢åŠ è§†è§‰å†²å‡»åŠ›ï¼Œå¤§å¤§æå‡äº†æ¸¸æˆçš„çœŸå®æ„Ÿâ€”â€”å¦‚æœåœ¨æ™šä¸Šç©å¯èƒ½ä¼šçœŸçš„å“å”¬åˆ°æˆ‘ä»¬ã€‚</p><blockquote><p>è¿™é‡Œæˆ‘ä»¬æ¥çœ‹æœ‰çº¹ç†å’Œæ²¡æœ‰çº¹ç†çš„åœºæ™¯</p></blockquote><div class="article-bounded"><div class="article-table"><table><tbody><tr><td style="text-align:center"><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190208215006.png" alt="pre-fragment lighting"><br><em>æ¯ç‰‡æ®µç…§æ˜ï¼›<br>æ­£æ–¹å½¢å››ä¸ªé¡¶ç‚¹ä¸­å¿ƒä½ç½®</em></td><td style="text-align:center"><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190208215108.png" alt="added texture"><br><em>æ·»åŠ äº†çº¹ç†ï¼›<br>æ­£æ–¹å½¢å››ä¸ªé¡¶ç‚¹ä¸­å¿ƒä½ç½®</em></td><td>çœ‹å·¦è¾¹çš„å›¾ç‰‡ï¼Œè¿™ä¸ªåœºæ™¯é€šè¿‡æ¯åƒ<br>ç´ ç…§æ˜å’Œç€è‰²ç‚¹äº®ã€‚è¿™ä¸ªåœºæ™¯çœ‹èµ·<br>æ¥éå¸¸å¹³æ»‘ï¼Œç°å®ç”Ÿæ´»ä¸­æˆ‘ä»¬èµ°è¿›<br>ä¸€ä¸ªæˆ¿é—´æœ‰å……æ»¡äº†å…‰æ»‘é˜´å½±çš„ä¸œè¥¿<br>å°±åƒæ˜¯è¿™ä¸ªç«‹æ–¹ä½“ã€‚<br><br>åœ¨çœ‹å³è¾¹çš„å›¾ç‰‡ï¼ŒåŒæ ·çš„åœºæ™¯ç°åœ¨<br>çº¹ç†åŒ–äº†ã€‚ç¯å¢ƒå…‰ä¹Ÿå¢åŠ äº†ï¼Œå› ä¸º<br>çº¹ç†çš„ä½¿ç”¨ä½¿æ•´ä¸ªåœºæ™¯å˜æš—ï¼Œä¹Ÿå¯<br>ä»¥çœ‹åˆ°çº¹ç†å¯¹ä¾§é¢ç«‹æ–¹ä½“çš„å½±å“ã€‚<br>ç«‹æ–¹ä½“å…·æœ‰å’Œä»¥å‰ç›¸åŒæ•°é‡çš„å¤šè¾¹<br>å½¢ï¼Œä½†å®ƒä»¬æœ‰æ–°çº¹ç†çœ‹èµ·æ¥æ›´åŠ è¯¦<br>ç»†ã€‚<br><br>æ»¡è¶³äºé‚£äº›å¥½å¥‡çš„äººï¼Œè¿™ä¸ªçº¹ç†çš„<br>èµ„æºæ¥è‡ªäº<a href="http://pdtextures.blogspot.com/2008/03/first-set.html" target="_blank" rel="noopener">å…¬å…±é¢†åŸŸçš„èµ„æº</a></td></tr></tbody></table></div></div><h2 id="çº¹ç†åæ ‡">çº¹ç†åæ ‡<a href="post/Learn-OpenGL-Lesson-Four#çº¹ç†åæ ‡"></a></h2><p>åœ¨OpengGLä¸­ï¼Œçº¹ç†åæ ‡æ—¶å¸¸ä½¿ç”¨åæ ‡(s,t)ä»£æ›¿(x,y)ã€‚(s,t)è¡¨ç¤ºçº¹ç†ä¸Šçš„ä¸€ä¸ªçº¹ç†å…ƒç´ ï¼Œç„¶åæ˜ å°„åˆ°å¤šè¾¹å½¢ã€‚å¦å¤–éœ€è¦æ³¨æ„è¿™äº›çº¹ç†åæ ‡å’Œå…¶ä»–OpengGLåæ ‡ç›¸ä¼¼ï¼št(æˆ–y)è½´æŒ‡å‘ä¸Šæ–¹ï¼Œæ‰€ä»¥å€¼è¶Šé«˜æ‚¨èµ°çš„è¶Šè¿œã€‚</p><p>å¤§å¤šæ•°è®¡ç®—æœºå›¾å½¢ï¼Œyè½´æŒ‡å‘ä¸‹æ–¹ã€‚è¿™æ„å‘³ç€å·¦ä¸Šè§’æ˜¯å›¾ç‰‡çš„åŸç‚¹(0,0)ï¼Œå¹¶ä¸”yå€¼å‘ä¸‹é€’å¢ã€‚æ¢å¥è¯è¯´ï¼ŒOpenGLçš„åæ ‡ç³»å’Œå¤§å¤šæ•°è®¡ç®—æœºå›¾å½¢ç›¸åï¼Œè¿™æ˜¯æ‚¨éœ€è¦è€ƒè™‘åˆ°çš„ã€‚</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:center"><em>OpenGLçš„çº¹ç†åæ ‡ç³»</em></th></tr></thead><tbody><tr><td style="text-align:center"><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190208225905.png" alt="coordiante"></td></tr></tbody></table></div></div><h2 id="çº¹ç†æ˜ å°„åŸºç¡€">çº¹ç†æ˜ å°„åŸºç¡€<a href="post/Learn-OpenGL-Lesson-Four#çº¹ç†æ˜ å°„åŸºç¡€"></a></h2><p>åœ¨æœ¬è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†æ¥çœ‹çœ‹å¸¸è§„2Dçº¹ç†ï¼ˆ<code>GL_TEXTURE_2D</code>ï¼‰å’Œçº¢ï¼Œç»¿ï¼Œè“é¢œè‰²ä¿¡æ¯ï¼ˆ<code>GL_RGB</code>ï¼‰ã€‚OpenGL ES ä¹Ÿæä¾›å…¶ä»–çº¹ç†æ¨¡å¼è®©ä½ åšæ›´å¤šä¸åŒçš„ç‰¹æ®Šæ•ˆæœã€‚æˆ‘ä»¬å°†ä½¿ç”¨<code>GL_NEAREST</code>æŸ¥çœ‹ç‚¹é‡‡æ ·ï¼Œ<code>GL_LINEAR</code>å’ŒMIP-æ˜ å°„å°†åœ¨åé¢çš„è¯¾ç¨‹ä¸­è®²è§£ã€‚</p><p>è®©æˆ‘ä»¬ä¸€èµ·æ¥åˆ°ä»£ç éƒ¨åˆ†ï¼Œçœ‹çœ‹æ€æ ·å¼€å§‹åœ¨Androidä¸­ä½¿ç”¨åŸºæœ¬çš„çº¹ç†ã€‚</p><h3 id="é¡¶ç‚¹ç€è‰²å™¨">é¡¶ç‚¹ç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Four#é¡¶ç‚¹ç€è‰²å™¨"></a></h3><p>æˆ‘ä»¬å°†é‡‡ç”¨ä¸ŠèŠ‚è¯¾ä¸­çš„æ¯åƒç´ ç…§æ˜ç€è‰²å™¨ï¼Œå¹¶æ·»åŠ çº¹ç†æ”¯æŒã€‚</p><blockquote><p>è¿™å„¿æ˜¯æ–°çš„å˜åŒ–ï¼š</p></blockquote><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">attribute</span> <span class="type">vec2</span> a_TexCoordinate;<span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„çº¹ç†åæ ‡ä¿¡æ¯</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec2</span> v_TexCoordinate;  <span class="comment">// è¿™å°†ä¼šä¼ å…¥åˆ°ç‰‡æ®µç€è‰²å™¨</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// ä¼ å…¥çº¹ç†åæ ‡</span></span><br><span class="line">   v_TexCoordinate = a_TexCoordinate;</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæ–°çš„å±æ€§ç±»å‹<code>vec2</code>ï¼ˆä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå…ƒç´ çš„æ•°ç»„ï¼‰ï¼Œå°†ç”¨æ¥æ”¾å…¥çº¹ç†åæ ‡ä¿¡æ¯ã€‚è¿™å°†æ˜¯æ¯ä¸ªé¡¶ç‚¹éƒ½æœ‰ï¼ŒåŒä½ç½®ï¼Œé¢œè‰²ï¼Œæ³•çº¿æ•°æ®ä¸€æ ·ã€‚æˆ‘ä»¬ä¹Ÿæ·»åŠ äº†ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œå®ƒå°†é€šè¿‡ä¸‰è§’å½¢è¡¨é¢ä¸Šçš„çº¿æ€§æ’å€¼å°†æ•°æ®ä¼ å…¥ç‰‡æ®µç€è‰²å™¨ã€‚</p><h3 id="ç‰‡æ®µç€è‰²å™¨">ç‰‡æ®µç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Four#ç‰‡æ®µç€è‰²å™¨"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">uniform sampler2D u_Texture;" +  // ä¼ å…¥çº¹ç†</span><br><span class="line">...</span><br><span class="line">varying vec2 v_TexCoordinate;" + // æ’å…¥çš„çº¹ç†åæ ‡</span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">   ...</span><br><span class="line">   <span class="comment">// è®¡ç®—å…‰çº¿çŸ¢é‡å’Œé¡¶ç‚¹æ³•çº¿çš„ç‚¹ç§¯ï¼Œå¦‚æœæ³•çº¿å’Œå…‰çº¿çŸ¢é‡æŒ‡å‘ç›¸åŒçš„æ–¹å‘ï¼Œé‚£ä¹ˆå®ƒå°†è·å¾—æœ€å¤§çš„ç…§æ˜</span></span><br><span class="line">   float diffuse = max(dot(v_Normal, lightVector), 0.1);" +</span><br><span class="line">   <span class="comment">// æ ¹æ®è·ç¦»å“€å‡å…‰çº¿</span></span><br><span class="line">   diffuse = diffuse * (1.0 / (1.0 + (0.10 * distance * distance)));" +</span><br><span class="line">   <span class="comment">// æ·»åŠ ç¯å¢ƒç…§æ˜</span></span><br><span class="line">   diffuse = diffuse + 0.3;" +</span><br><span class="line">   <span class="comment">// é¢œè‰²ä¹˜ä»¥äº®åº¦å“€å‡å’Œçº¹ç†å€¼å¾—åˆ°æœ€ç»ˆçš„é¢œè‰²</span></span><br><span class="line">   gl_FragColor = v_Color * diffuse * texture2D(u_Texture, v_TexCoordinate);" +</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªæ–°çš„å¸¸é‡ç±»å‹<code>sampler2D</code>æ¥è¡¨ç¤ºå®é™…çº¹ç†æ•°æ®ï¼ˆä¸çº¹ç†åæ ‡å¯¹åº”ï¼‰ï¼Œ<br>ç”±å®šç‚¹ç€è‰²å™¨æ’å€¼ä¼ å…¥çº¹ç†åæ ‡ï¼Œæˆ‘ä»¬å†è°ƒç”¨<code>texture2D(texture, textureCoordinate)</code><br>å¾—åˆ°çº¹ç†åœ¨å½“å‰åæ ‡çš„å€¼ï¼Œæˆ‘ä»¬å¾—åˆ°è¿™ä¸ªå€¼åå†ä¹˜ä»¥å…¶ä»–é¡¹å¾—åˆ°æœ€ç»ˆè¾“å‡ºçš„é¢œè‰²ã€‚</p><p>è¿™ç§æ–¹å¼æ·»åŠ çº¹ç†ä¼šä½¿æ•´ä¸ªåœºæ™¯å˜æš—ï¼Œå› æ­¤æˆ‘ä»¬è¿˜ä¼šç¨å¾®å¢å¼ºç¯å¢ƒå…‰ç…§å¹¶å‡å°‘å…‰ç…§å“€å‡ã€‚</p><h3 id="å°†ä¸€ä¸ªå›¾ç‰‡åŠ è½½åˆ°çº¹ç†">å°†ä¸€ä¸ªå›¾ç‰‡åŠ è½½åˆ°çº¹ç†<a href="post/Learn-OpenGL-Lesson-Four#å°†ä¸€ä¸ªå›¾ç‰‡åŠ è½½åˆ°çº¹ç†"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">loadTexture</span><span class="params">(<span class="keyword">final</span> Context context, <span class="keyword">final</span> <span class="keyword">int</span> resourceId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span>[] textureHandle = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    GLES20.glGenTextures(<span class="number">1</span>, textureHandle, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (textureHandle[<span class="number">0</span>] != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">final</span> BitmapFactory.Options options = <span class="keyword">new</span> BitmapFactory.Options();</span><br><span class="line">        options.inScaled = <span class="keyword">false</span>; <span class="comment">// æ²¡æœ‰é¢„å…ˆç¼©æ”¾</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¾—åˆ°å›¾ç‰‡èµ„æº</span></span><br><span class="line">        <span class="keyword">final</span> Bitmap bitmap = BitmapFactory.decodeResource(context.getResources(), resourceId, options);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åœ¨OpenGLä¸­ç»‘å®šçº¹ç†</span></span><br><span class="line">        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textureHandle[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®è¿‡æ»¤</span></span><br><span class="line">        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST);</span><br><span class="line">        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_NEAREST);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†ä½å›¾åŠ è½½åˆ°å·²ç»‘å®šçš„çº¹ç†ä¸­</span></span><br><span class="line">        GLUtils.texImage2D(GLES20.GL_TEXTURE_2D, <span class="number">0</span>, bitmap, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å›æ”¶ä½å›¾ï¼Œå› ä¸ºå®ƒçš„æ•°æ®å·²åŠ è½½åˆ°OpenGLä¸­</span></span><br><span class="line">        bitmap.recycle();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (textureHandle[<span class="number">0</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Error loading texture."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> textureHandle[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>è¿™æ®µä»£ç å°†Android<code>res</code>æ–‡ä»¶å¤¹ä¸­çš„å›¾å½¢æ–‡ä»¶è¯»å–å¹¶åŠ è½½åˆ°OpenGLä¸­ï¼Œæˆ‘ä¼šè§£é‡Šæ¯ä¸€éƒ¨åˆ†çš„ä½œç”¨ã€‚</p><p>æˆ‘ä»¬é¦–å…ˆéœ€è¦å‘Šè¯‰OpenGLå»ä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„<code>handle</code>ï¼Œè¿™ä¸ª<code>handle</code>ä½œä¸ºä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œæˆ‘ä»¬æƒ³åœ¨OpenGLä¸­å¼•ç”¨çº¹ç†æ—¶å°±ä¼šä½¿ç”¨å®ƒã€‚</p><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">final <span class="type">int</span>[] textureHandle = new <span class="type">int</span>[<span class="number">1</span>];</span><br><span class="line">GLES20.glGenTextures(<span class="number">1</span>, textureHandle, <span class="number">0</span>);</span><br></pre></td></tr></table></div></figure><p>è¿™ä¸ªOpenGLæ–¹æ³•å¯ä»¥ç”¨æ¥åŒæ—¶ç”Ÿæˆå¤šä¸ª<code>handle</code>ï¼Œè¿™é‡Œæˆ‘ä»¬ä»…ç”Ÿæˆä¸€ä¸ªã€‚</p><p>å› ä¸ºæˆ‘ä»¬è¿™é‡Œåªéœ€è¦ä¸€ä¸ªhandleå»åŠ è½½çº¹ç†ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¾—åˆ°OpenGLèƒ½ç†è§£çš„çº¹ç†æ ¼å¼ã€‚<br>æˆ‘ä»¬ä¸èƒ½åªä»PNGæˆ–JPGæä¾›åŸå§‹æ•°æ®ï¼Œå› ä¸ºå®ƒä¸ä¼šç†è§£ã€‚æˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€æ­¥æ˜¯å°†å›¾åƒæ–‡ä»¶è§£ç ä¸ºAndroid Bitmapå¯¹è±¡ï¼š</p><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">final BitmapFactory.Options options = new BitmapFactory.Options();</span><br><span class="line">options.inScaled = <span class="literal">false</span>; <span class="comment">// æ²¡æœ‰é¢„å…ˆç¼©æ”¾</span></span><br><span class="line"><span class="comment">// å¾—åˆ°å›¾ç‰‡èµ„æº</span></span><br><span class="line">final Bitmap bitmap = BitmapFactory.decodeResource(context.getResources(), resourceId, options);</span><br></pre></td></tr></table></div></figure><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒAndroidä¼šæ ¹æ®è®¾å¤‡çš„åˆ†è¾¨ç‡å’Œä½ æ”¾ç½®å›¾ç‰‡çš„èµ„æºæ–‡ä»¶ç›®å½•è€Œé¢„å…ˆç¼©æ”¾ä½å›¾ã€‚æˆ‘ä»¬ä¸å¸Œæœ›Androidæ ¹æ®æˆ‘ä»¬çš„æƒ…å†µå¯¹ä½å›¾è¿›è¡Œç¼©æ”¾ï¼Œå› æ­¤æˆ‘ä»¬å°†<code>inScaled</code>è®¾ç½®ä¸º<code>false</code></p><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨OpenGLä¸­ç»‘å®šçº¹ç†</span></span><br><span class="line">GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textureHandle[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®è¿‡æ»¤</span></span><br><span class="line">GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST);</span><br><span class="line">GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_NEAREST);</span><br></pre></td></tr></table></div></figure><p>ç„¶åæˆ‘ä»¬ç»‘å®šçº¹ç†ï¼Œå¹¶è®¾ç½®å‡ ä¸ªå‚æ•°ï¼Œç»‘å®šä¸€ä¸ªçº¹ç†ï¼Œå¹¶å‘Šè¯‰OpenGLåç»­OpenGLè°ƒç”¨éœ€è¦è¿™æ ·è¿‡æ»¤è¿™ä¸ªçº¹ç†ã€‚æˆ‘ä»¬å°†é»˜è®¤è¿‡æ»¤å™¨è®¾ç½®ä¸º<code>GL_NEAREST</code>ï¼Œè¿™æ˜¯æœ€å¿«ï¼Œä¹Ÿæ˜¯æœ€ç²—ç³™çš„è¿‡æ»¤å½¢å¼ã€‚å®ƒæ‰€åšçš„å°±æ˜¯åœ¨å±å¹•çš„æ¯ä¸ªç‚¹é€‰æ‹©æœ€è¿‘çš„çº¹ç´ ï¼Œè¿™å¯èƒ½å¯¼è‡´å›¾åƒä¼ªåƒå’Œé”¯é½¿ã€‚</p><ul><li><code>GL_TEXTURE_MIN_FILTER</code> è¿™æ˜¯å‘Šè¯‰OpenGLåœ¨ç»˜åˆ¶å°äºåŸå§‹å¤§å°ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰çš„çº¹ç†æ—¶è¦åº”ç”¨å“ªç§ç±»å‹çš„è¿‡æ»¤ã€‚</li><li><code>GL_TEXTURE_MAG_FILTER</code> è¿™æ˜¯å‘Šè¯‰OpenGLåœ¨æ”¾å¤§çº¹ç†åˆ°åŸå§‹å¤§å°æ—¶è¦åº”ç”¨å“ªç§ç±»å‹çš„è¿‡æ»¤ã€‚</li></ul><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†ä½å›¾åŠ è½½åˆ°å·²ç»‘å®šçš„çº¹ç†ä¸­</span></span><br><span class="line">GLUtils.texImage2D(GLES20.GL_TEXTURE_2D, <span class="number">0</span>, bitmap, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å›æ”¶ä½å›¾ï¼Œå› ä¸ºå®ƒçš„æ•°æ®å·²åŠ è½½åˆ°OpenGLä¸­</span></span><br><span class="line">bitmap.recycle();</span><br></pre></td></tr></table></div></figure><p>å®‰å“æœ‰ä¸€ä¸ªéå¸¸å®ç”¨çš„åŠŸèƒ½å¯ä»¥ç›´æ¥å°†ä½å›¾åŠ è½½åˆ°OpenGLä¸­ã€‚ä¸€æ—¦æ‚¨å°†èµ„æºè¯»å…¥Bitmapå¯¹è±¡<code>GLUtils.texImage2D()</code>å°†è´Ÿè´£å…¶ä»–äº‹æƒ…ï¼Œè¿™ä¸ªæ–¹æ³•çš„ç­¾åï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">texImage2D</span> <span class="params">(<span class="keyword">int</span> target, <span class="keyword">int</span> level, Bitmap bitmap, <span class="keyword">int</span> border)</span></span></span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬æƒ³è¦ä¸€ä¸ªå¸¸è§„çš„2Dä½å›¾ï¼Œå› æ­¤æˆ‘ä»¬ä¼ å…¥<code>GL_TEXTURE_2D</code>ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚ç¬¬äºŒä¸ªå‚æ•°ç”¨äºMIP-æ˜ å°„ï¼Œå¹¶å…è®¸æ‚¨æŒ‡å®šè¦åœ¨å“ªä¸ªçº§åˆ«ä½¿ç”¨çš„å›¾åƒã€‚æˆ‘ä»¬è¿™é‡Œæ²¡æœ‰ä½¿ç”¨MIP-æ˜ å°„ï¼Œå› æ­¤æˆ‘ä»¬å°†ä¼ å…¥0è®¾ç½®ä¸ºé»˜è®¤çº§åˆ«ã€‚æˆ‘ä»¬ä¼ å…¥ä½å›¾ï¼Œç”±äºæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨è¾¹æ¡†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ å…¥0ã€‚</p><p>ç„¶ååŸå§‹ä½å›¾å¯¹è±¡è°ƒç”¨<code>recycle()</code>ï¼Œè¿™æé†’Androidå¯ä»¥å›æ”¶è¿™éƒ¨åˆ†å†…å­˜ã€‚ç”±äºçº¹ç†å·²è¢«åŠ è½½åˆ°OpenGLï¼Œæˆ‘ä»¬ä¸éœ€è¦ç»§ç»­ä¿ç•™è¿™ä¸ªå‰¯æœ¬ã€‚<br>æ˜¯çš„ï¼ŒAndroidåº”ç”¨ç¨‹åºåœ¨æ‰§è¡Œåƒåœ¾æ”¶é›†çš„Dalvik VMä¸‹è¿è¡Œï¼Œä½†Bitmapå¯¹è±¡åŒ…å«é©»ç•™åœ¨nativeå†…å­˜ä¸­çš„æ•°æ®ï¼Œå¦‚æœä½ ä¸æ˜ç¡®çš„å›æ”¶å®ƒä»¬ï¼Œå®ƒä»¬éœ€è¦å‡ ä¸ªå‘¨æœŸæ¥è¿›è¡Œåƒåœ¾æ”¶é›†ã€‚<br>è¿™æ„å‘³ç€å¦‚æœæ‚¨å¿˜è®°æ‰§è¡Œæ­¤æ“ä½œï¼Œå®é™…ä¸Šå¯èƒ½ä¼šå› å†…å­˜ä¸è¶³é”™è¯¯è€Œå´©æºƒï¼Œå³ä½¿æ‚¨ä¸å†æŒæœ‰å¯¹ä½å›¾çš„ä»»ä½•å¼•ç”¨ã€‚</p><h3 id="å°†çº¹ç†åº”ç”¨åˆ°æˆ‘ä»¬çš„åœºæ™¯">å°†çº¹ç†åº”ç”¨åˆ°æˆ‘ä»¬çš„åœºæ™¯<a href="post/Learn-OpenGL-Lesson-Four#å°†çº¹ç†åº”ç”¨åˆ°æˆ‘ä»¬çš„åœºæ™¯"></a></h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ å„ç§æˆå‘˜å˜é‡æ¥æŒæœ‰æˆ‘ä»¬çº¹ç†æ‰€éœ€è¦çš„ä¸œè¥¿ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å­˜æ”¾æˆ‘ä»¬çš„æ¨¡å‹æ•°æ®åœ¨æµ®ç‚¹ç¼“å†²åŒº</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> FloatBuffer mCubeTextureCoordinates;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨æ¥ä¼ å…¥çº¹ç†</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mTextureUniformHandle;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨æ¥ä¼ å…¥æ¨¡å‹çº¹ç†åæ ‡</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mTextureCoordinateHandle;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¯ä¸ªæ•°æ®å…ƒç´ çš„çº¹ç†åæ ‡å¤§å°</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mTextureCoordinateDataSize = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¹ç†æ•°æ®</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mTextureDataHandle;</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬åŸºæœ¬ä¸Šæ˜¯éœ€è¦æ·»åŠ æ–°æˆå‘˜å˜é‡æ¥è·Ÿè¸ªæˆ‘ä»¬æ·»åŠ åˆ°ç€è‰²å™¨çš„å†…å®¹ï¼Œä»¥åŠä¿æŒå¯¹çº¹ç†çš„å¼•ç”¨ã€‚</p><h3 id="å®šä¹‰çº¹ç†åæ ‡">å®šä¹‰çº¹ç†åæ ‡<a href="post/Learn-OpenGL-Lesson-Four#å®šä¹‰çº¹ç†åæ ‡"></a></h3><p>æˆ‘ä»¬åœ¨æ„é€ æ–¹æ³•ä¸­å®šä¹‰æˆ‘ä»¬çš„çº¹ç†åæ ‡</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// S, T ï¼ˆæˆ– Xï¼Œ Yï¼‰</span></span><br><span class="line"><span class="comment">// çº¹ç†åæ ‡æ•°æ®</span></span><br><span class="line"><span class="comment">// å› ä¸ºå›¾åƒYè½´æŒ‡å‘ä¸‹æ–¹ï¼ˆå‘ä¸‹ç§»åŠ¨å›¾ç‰‡æ—¶å€¼ä¼šå¢åŠ ï¼‰ï¼ŒOpenGLçš„Yè½´æŒ‡å‘ä¸Šæ–¹</span></span><br><span class="line"><span class="comment">// æˆ‘ä»¬é€šè¿‡ç¿»è½¬Yè½´æ¥è°ƒæ•´å®ƒ</span></span><br><span class="line"><span class="comment">// æ¯ä¸ªé¢çš„çº¹ç†åæ ‡éƒ½æ˜¯ç›¸åŒçš„</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">float</span>[] cubeTextureCoordinateData =</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="comment">// æ­£é¢</span></span><br><span class="line">                <span class="number">0.0F</span>, <span class="number">0.0F</span>,</span><br><span class="line">                <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">                <span class="number">1.0F</span>, <span class="number">0.0F</span>,</span><br><span class="line">                <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">                <span class="number">1.0F</span>, <span class="number">1.1F</span>,</span><br><span class="line">                <span class="number">1.0F</span>, <span class="number">0.0F</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">...</span><br></pre></td></tr></table></div></figure><p>è¿™åæ ‡æ•°æ®çœ‹èµ·æ¥å¯èƒ½æœ‰ç‚¹æ··ä¹±ã€‚å¦‚æœæ‚¨è¿”å›å»çœ‹ç¬¬ä¸‰è¯¾ä¸­ç‚¹çš„ä½ç½®æ˜¯å¦‚ä½•å®šä¹‰çš„ï¼Œæ‚¨å°†ä¼šå‘ç°æˆ‘ä»¬ä¸ºæ­£æ–¹ä½“æ¯ä¸ªé¢éƒ½å®šä¹‰äº†ä¸¤ä¸ªä¸‰è§’å½¢ã€‚ç‚¹çš„å®šä¹‰æ–¹å¼åƒä¸‹é¢è¿™æ ·ï¼š</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ï¼ˆä¸‰è§’å½¢<span class="number">1</span>ï¼‰</span><br><span class="line">å·¦ä¸Šï¼Œ</span><br><span class="line">å·¦ä¸‹ï¼Œ</span><br><span class="line">å³ä¸Š</span><br><span class="line">ï¼ˆä¸‰è§’å½¢<span class="number">2</span>ï¼‰</span><br><span class="line">å·¦ä¸‹ï¼Œ</span><br><span class="line">å³ä¸‹ï¼Œ</span><br><span class="line">å³ä¸Š</span><br></pre></td></tr></table></div></figure><p>çº¹ç†åæ ‡å’Œæ­£é¢çš„ä½ç½®åæ ‡å¯¹åº”ï¼Œä½†æ˜¯ç”±äºYè½´ç¿»è½¬ï¼ŒYè½´æŒ‡å‘å’ŒOpenGLçš„Yè½´ç›¸åçš„æ–¹å‘ã€‚</p><blockquote><p>çœ‹ä¸‹å›¾ï¼Œå®çº¿åæ ‡è¡¨ç¤ºåœ¨OpenGLä¸­æ­£æ–¹ä½“æ­£é¢Xï¼ŒYåæ ‡ã€‚è™šçº¿è¡¨ç¤ºç¿»è½¬åçš„åæ ‡ï¼Œå¯ä»¥çœ‹å‡ºå’Œä¸Šé¢å®šä¹‰çš„çº¹ç†åæ ‡æ˜¯ä¸€ä¸€å¯¹åº”çš„</p></blockquote><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190211153435.jpg" alt="çº¹ç†åæ ‡å¯¹åº”" class="article-img"></p><h3 id="è®¾ç½®çº¹ç†">è®¾ç½®çº¹ç†<a href="post/Learn-OpenGL-Lesson-Four#è®¾ç½®çº¹ç†"></a></h3><p>æˆ‘ä»¬åœ¨<code>onSurfaceCreated()</code>æ–¹æ³•ä¸­åŠ è½½çº¹ç†</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSurfaceCreated</span><span class="params">(GL10 gl, EGLConfig config)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    mProgramHandle = ShaderHelper.createAndLinkProgram(vertexShaderHandle, fragmentShaderHandle, <span class="string">"a_Position"</span>, <span class="string">"a_Color"</span>, <span class="string">"a_Normal"</span>, <span class="string">"a_TexCoordinate"</span>);</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// åŠ è½½çº¹ç†</span></span><br><span class="line">    mTextureDataHandle = TextureHelper.loadTexture(mActivityContext, R.drawable.bumpy_bricks_public_domain);</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªæ–°çš„å±æ€§<code>a_TexCoordinate</code>ç»‘å®šåˆ°æˆ‘ä»¬çš„ç€è‰²å™¨ä¸­ï¼Œå¹¶ä¸”æˆ‘ä»¬é€šè¿‡ä¹‹å‰åˆ›å»ºçš„<code>loadTexture()</code>æ–¹æ³•åŠ è½½ç€è‰²å™¨ã€‚</p><h3 id="ä½¿ç”¨çº¹ç†">ä½¿ç”¨çº¹ç†<a href="post/Learn-OpenGL-Lesson-Four#ä½¿ç”¨çº¹ç†"></a></h3><p>æˆ‘ä»¬ä¹Ÿéœ€è¦åœ¨<code>onDrawFrame(GL10 gl)</code>æ–¹æ³•ä¸­æ·»åŠ ä¸€äº›ä»£ç ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDrawFrame</span><span class="params">(GL10 gl)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    mTextureUniformHandle = GLES20.glGetUniformLocation(mProgramHandle, <span class="string">"u_Texture"</span>);</span><br><span class="line">    mTextureCoordinateHandle = GLES20.glGetAttribLocation(mProgramHandle, <span class="string">"a_TexCoordinate"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†çº¹ç†å•å…ƒè®¾ç½®ä¸ºçº¹ç†å•å…ƒ0</span></span><br><span class="line">    GLES20.glActiveTexture(GLES20.GL_TEXTURE0);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†çº¹ç†ç»‘å®šåˆ°è¿™ä¸ªå•å…ƒ</span></span><br><span class="line">    GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, mTextureDataHandle);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡ç»‘å®šåˆ°çº¹ç†å•å…ƒ0ï¼Œå‘Šè¯‰çº¹ç†æ ‡å‡†é‡‡æ ·å™¨åœ¨ç€è‰²å™¨ä¸­ä½¿ç”¨æ­¤çº¹ç†</span></span><br><span class="line">    GLES20.glUniform1i(mTextureUniformHandle, <span class="number">0</span>);</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬å¾—åˆ°ç€è‰²å™¨ä¸­çš„çº¹ç†æ•°æ®å’Œçº¹ç†åæ ‡å¥æŸ„ã€‚åœ¨OpenGLä¸­ï¼Œçº¹ç†èƒ½åœ¨ç€è‰²ä¹‹å‰ï¼Œéœ€è¦ç»‘å®šåˆ°çº¹ç†å•å…ƒã€‚çº¹ç†å•å…ƒæ˜¯è¯»å–çº¹ç†å¹¶å®é™…å°†å®ƒä¼ å…¥ç€è‰²å™¨çš„ä¸­ï¼Œå› æ­¤å¯ä»¥å†å±å¹•ä¸Šæ˜¾ç¤ºã€‚ä¸åŒçš„å›¾å½¢èŠ¯ç‰‡æœ‰ä¸åŒæ•°é‡çš„çº¹ç†å•å…ƒï¼Œå› æ­¤åœ¨ä½¿ç”¨å®ƒä»¬ä¹‹å‰ï¼Œæ‚¨éœ€è¦æ£€æŸ¥æ˜¯å¦å­˜åœ¨å…¶ä»–çº¹ç†å•å…ƒã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å‘Šè¯‰OpenGLæˆ‘ä»¬æƒ³è®¾ç½®ä½¿ç”¨çš„çº¹ç†å•å…ƒåˆ°ç¬¬ä¸€ä¸ªå•å…ƒï¼Œçº¹ç†å•å…ƒ0ã€‚ç„¶åè‡ªåŠ¨ç»‘å®šçº¹ç†åˆ°ç¬¬ä¸€ä¸ªå•å…ƒï¼Œé€šè¿‡è°ƒç”¨<code>glBindTexture()</code>ã€‚æœ€åï¼Œæˆ‘ä»¬å‘Šè¯‰OpenGLï¼Œæˆ‘ä»¬æƒ³å°†<code>mTextureUniformHandle</code>ç»‘å®šåˆ°ç¬¬ä¸€ä¸ªçº¹ç†å•å…ƒï¼Œå®ƒå¼•ç”¨äº†ç‰‡æ®µç€è‰²å™¨ä¸­<code>u_Texture</code>å±æ€§ã€‚</p><p>ç®€è€Œè¨€ä¹‹ï¼š</p><ol><li>è®¾ç½®çº¹ç†å•å…ƒ</li><li>ç»‘å®šçº¹ç†åˆ°è¿™ä¸ªå•å…ƒ</li><li>å°†æ­¤å•å…ƒæŒ‡å®šç»™ç‰‡æ®µç€è‰²å™¨ä¸­çš„çº¹ç†æ ‡å‡†</li></ol><p>æ ¹æ®éœ€è¦é‡å¤å¤šä¸ªçº¹ç†ã€‚</p><h3 id="è¿›ä¸€æ­¥ç»ƒä¹ ">è¿›ä¸€æ­¥ç»ƒä¹ <a href="post/Learn-OpenGL-Lesson-Four#è¿›ä¸€æ­¥ç»ƒä¹ "></a></h3><p>ä¸€æ—¦æ‚¨åšåˆ°è¿™å„¿ï¼Œæ‚¨å°±å®Œæˆçš„å·®ä¸å¤šäº†ï¼å½“ç„¶è¿™è¿™å¹¶æ²¡æœ‰æ‚¨é¢„æœŸçš„é‚£ä¹ˆç³Ÿç³•â€¦æˆ–è€…ç¡®å®ç³Ÿç³•ï¼ŸğŸ˜‰ä½œä¸ºä¸‹ä¸€ä¸ªç»ƒä¹ ï¼Œå°è¯•é€šè¿‡åŠ è½½å¦ä¸€ä¸ªçº¹ç†ï¼Œå°†å…¶ç»‘å®šåˆ°å¦ä¸€ä¸ªå•å…ƒï¼Œå¹¶åœ¨ç€è‰²å™¨ä¸­ä½¿ç”¨å®ƒã€‚</p><h2 id="å›é¡¾">å›é¡¾<a href="post/Learn-OpenGL-Lesson-Four#å›é¡¾"></a></h2><p>ç°åœ¨æˆ‘ä»¬å›é¡¾ä¸€ä¸‹æ‰€æœ‰çš„ç€è‰²å™¨ä»£ç ï¼Œä»¥åŠæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªæ–°çš„å¸®åŠ©åŠŸèƒ½ç”¨æ¥ä»èµ„æºç›®å½•è¯»å–ç€è‰²å™¨ä»£ç ï¼Œè€Œä¸æ˜¯å­˜å‚¨åœ¨javaå­—ç¬¦ä¸²ä¸­ï¼š</p><h3 id="é¡¶ç‚¹ç€è‰²å™¨-all">é¡¶ç‚¹ç€è‰²å™¨ all<a href="post/Learn-OpenGL-Lesson-Four#é¡¶ç‚¹ç€è‰²å™¨-all"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVPMatrix;                      <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewã€projectionçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVMatrix;                       <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Position;                     <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Color;                        <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„é¢œè‰²ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec3</span> a_Normal;                       <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„æ³•çº¿ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec2</span> a_TexCoordinate;                <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„çº¹ç†åæ ‡ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Position;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Normal;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec2</span> v_TexCoordinate;                  <span class="comment">// è¿™å°†ä¼šä¼ å…¥åˆ°ç‰‡æ®µç€è‰²å™¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é¡¶ç‚¹ç€è‰²å™¨å…¥å£ç‚¹</span></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// ä¼ å…¥çº¹ç†åæ ‡</span></span><br><span class="line">   v_TexCoordinate = a_TexCoordinate;</span><br><span class="line">   <span class="comment">// å°†é¡¶ç‚¹ä½ç½®è½¬æ¢æˆçœ¼ç›ç©ºé—´çš„ä½ç½®</span></span><br><span class="line">   v_Position = <span class="type">vec3</span>(u_MVMatrix * a_Position);</span><br><span class="line">   <span class="comment">// ä¼ å…¥é¢œè‰²</span></span><br><span class="line">   v_Color = a_Color;</span><br><span class="line">   <span class="comment">// å°†æ³•çº¿çš„æ–¹å‘è½¬æ¢åœ¨çœ¼ç›ç©ºé—´</span></span><br><span class="line">   v_Normal = <span class="type">vec3</span>(u_MVMatrix * <span class="type">vec4</span>(a_Normal, <span class="number">0.0</span>));</span><br><span class="line">   <span class="comment">// gl_Positionæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ç”¨æ¥å­˜å‚¨æœ€ç»ˆçš„ä½ç½®</span></span><br><span class="line">   <span class="comment">// å°†é¡¶ç‚¹ä¹˜ä»¥çŸ©é˜µå¾—åˆ°æ ‡å‡†åŒ–å±å¹•åæ ‡çš„æœ€ç»ˆç‚¹</span></span><br><span class="line">   <span class="built_in">gl_Position</span> = u_MVPMatrix * a_Position;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="ç‰‡æ®µç€è‰²å™¨-all">ç‰‡æ®µç€è‰²å™¨ all<a href="post/Learn-OpenGL-Lesson-Four#ç‰‡æ®µç€è‰²å™¨-all"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">precision</span> <span class="keyword">mediump</span> <span class="type">float</span>; <span class="comment">//æˆ‘ä»¬å°†é»˜è®¤ç²¾åº¦è®¾ç½®ä¸ºä¸­ç­‰ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç‰‡æ®µç€è‰²å™¨ä¸­çš„é«˜ç²¾åº¦</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">sampler2D</span> u_Texture;  <span class="comment">// ä¼ å…¥çº¹ç†</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">vec3</span> u_LightPos; <span class="comment">// å…‰æºåœ¨çœ¼ç›ç©ºé—´çš„ä½ç½®</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Position; <span class="comment">// æ’å…¥çš„ä½ç½®</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color; <span class="comment">// æ’å…¥çš„ä½ç½®é¢œè‰²</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Normal; <span class="comment">// æ’å…¥çš„ä½ç½®æ³•çº¿</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec2</span> v_TexCoordinate; <span class="comment">// æ’å…¥çš„çº¹ç†åæ ‡</span></span><br><span class="line"><span class="type">void</span> main()  <span class="comment">// ç‰‡æ®µç€è‰²å™¨å…¥å£</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// å°†ç”¨äºå“€å‡</span></span><br><span class="line">   <span class="type">float</span> <span class="built_in">distance</span> = <span class="built_in">length</span>(u_LightPos - v_Position);</span><br><span class="line">   <span class="comment">// è·å–ä»å…‰æºåˆ°é¡¶ç‚¹æ–¹å‘çš„å…‰çº¿å‘é‡</span></span><br><span class="line">   <span class="type">vec3</span> lightVector = <span class="built_in">normalize</span>(u_LightPos - v_Position);</span><br><span class="line">   <span class="comment">// è®¡ç®—å…‰çº¿çŸ¢é‡å’Œé¡¶ç‚¹æ³•çº¿çš„ç‚¹ç§¯ï¼Œå¦‚æœæ³•çº¿å’Œå…‰çº¿çŸ¢é‡æŒ‡å‘ç›¸åŒçš„æ–¹å‘ï¼Œé‚£ä¹ˆå®ƒå°†è·å¾—æœ€å¤§çš„ç…§æ˜</span></span><br><span class="line">   <span class="type">float</span> diffuse = <span class="built_in">max</span>(<span class="built_in">dot</span>(v_Normal, lightVector), <span class="number">0.1</span>);</span><br><span class="line">   <span class="comment">// æ ¹æ®è·ç¦»å“€å‡å…‰çº¿</span></span><br><span class="line">   diffuse = diffuse * (<span class="number">1.0</span> / (<span class="number">1.0</span> + (<span class="number">0.25</span> * <span class="built_in">distance</span> * <span class="built_in">distance</span>)));</span><br><span class="line">   <span class="comment">// æ·»åŠ ç¯å¢ƒç…§æ˜</span></span><br><span class="line">   diffuse = diffuse + <span class="number">0.3</span>;</span><br><span class="line">   <span class="comment">// é¢œè‰²ä¹˜ä»¥äº®åº¦å“€å‡å’Œçº¹ç†å€¼å¾—åˆ°æœ€ç»ˆçš„é¢œè‰²</span></span><br><span class="line">   <span class="built_in">gl_FragColor</span> = v_Color * diffuse * <span class="built_in">texture2D</span>(u_Texture, v_TexCoordinate);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="æ€æ ·ä»rawèµ„æºç›®å½•ä¸­è¯»å–æ–‡æœ¬ï¼Ÿ">æ€æ ·ä»rawèµ„æºç›®å½•ä¸­è¯»å–æ–‡æœ¬ï¼Ÿ<a href="post/Learn-OpenGL-Lesson-Four#æ€æ ·ä»rawèµ„æºç›®å½•ä¸­è¯»å–æ–‡æœ¬ï¼Ÿ"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RawResourceReader</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">readTextFileFromRawResource</span><span class="params">(<span class="keyword">final</span> Context context, <span class="keyword">final</span> <span class="keyword">int</span> resurceId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> InputStream inputStream = context.getResources().openRawResource(resurceId);</span><br><span class="line">        <span class="keyword">final</span> InputStreamReader inputStreamReader = <span class="keyword">new</span> InputStreamReader(inputStream);</span><br><span class="line">        <span class="keyword">final</span> BufferedReader bufferedReader = <span class="keyword">new</span> BufferedReader(inputStreamReader);</span><br><span class="line"></span><br><span class="line">        String nextLine;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> StringBuilder body = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> ((nextLine = bufferedReader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                body.append(nextLine).append(<span class="string">'\n'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                bufferedReader.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> body.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="æ•™ç¨‹ç›®å½•">æ•™ç¨‹ç›®å½•<a href="post/Learn-OpenGL-Lesson-Four#æ•™ç¨‹ç›®å½•"></a></h2><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five">OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six">OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven">OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVOBï¼‰</a></li></ul><h2 id="æ‰“åŒ…æ•™æ">æ‰“åŒ…æ•™æ<a href="post/Learn-OpenGL-Lesson-Four#æ‰“åŒ…æ•™æ"></a></h2><p>å¯ä»¥åœ¨Githubä¸‹è½½æœ¬è¯¾ç¨‹æºä»£ç ï¼š<a href="https://github.com/learnopengles/Learn-OpenGLES-Tutorials" target="_blank" rel="noopener">ä¸‹è½½é¡¹ç›®</a><br>æœ¬è¯¾çš„ç¼–è¯‘ç‰ˆæœ¬ä¹Ÿå¯ä»¥å†Androidå¸‚åœºä¸‹ï¼š<a href="https://market.android.com/details?id=com.learnopengles.android" target="_blank" rel="noopener">google play ä¸‹è½½apk</a><br>â€œæˆ‘â€ä¹Ÿç¼–è¯‘äº†ä¸ªapkï¼Œæ–¹ä¾¿å¤§å®¶ä¸‹è½½ï¼š<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">github download</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ–‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Four: Introducing Basic Texturing&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.learnopengles.com/android-lesson-four-introducing-basic-texturing/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.learnopengles.com/android-lesson-four-introducing-basic-texturing/&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/categories/OpenGL/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/tags/OpenGL/"/>
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</title>
    <link href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three/index.html"/>
    <id>https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three/index.html</id>
    <published>2019-01-26T09:55:49.000Z</published>
    <updated>2019-04-08T08:32:50.360Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»è¯‘æ–‡</p></blockquote><p>åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Three: Moving to Per-Fragment Lighting<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.learnopengles.com/android-lesson-three-moving-to-per-fragment-lighting/" target="_blank" rel="noopener">http://www.learnopengles.com/android-lesson-three-moving-to-per-fragment-lighting/</a><br><a id="more"></a></p><hr><h1 id="ä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜">ä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜<a href="post/Learn-OpenGL-Lesson-Three#ä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜"></a></h1><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>æ¬¢è¿æ¥åˆ°ç¬¬ä¸‰è¯¾ï¼è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°†ä¼šåœ¨<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">ç¬¬äºŒè¯¾</a>çš„åŸºç¡€ä¸Šï¼Œ<br>å­¦ä¹ å¦‚ä½•ä½¿ç”¨æ¯åƒç´ æŠ€æœ¯æ¥è¾¾åˆ°ç›¸åŒçš„ç…§æ˜ã€‚<br>ç®€å•çš„æ­£æ–¹ä½“å³ä½¿ä½¿ç”¨æ ‡å‡†çš„æ¼«å°„ç…§æ˜æˆ‘ä»¬ä¹Ÿèƒ½çœ‹åˆ°å·®å¼‚ã€‚</td><td><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190126183929.png" alt="screenshot"></td></tr></tbody></table></div></div><h2 id="å‰ææ¡ä»¶">å‰ææ¡ä»¶<a href="post/Learn-OpenGL-Lesson-Three#å‰ææ¡ä»¶"></a></h2><p>æœ¬ç³»åˆ—çš„æ¯èŠ‚è¯¾éƒ½ä»¥å‰é¢çš„è¯¾ç¨‹ä¸ºåŸºç¡€ï¼Œæœ¬èŠ‚è¯¾æ˜¯<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">ç¬¬äºŒè¯¾</a>çš„è¡¥å……ï¼Œå› æ­¤è¯·åŠ¡åœ¨é˜…è¯»äº†ä¹‹å‰çš„è¯¾ç¨‹åå†æ¥å›é¡¾ã€‚</p><blockquote><p>ä¸‹é¢æ˜¯æœ¬ç³»åˆ—è¯¾ç¨‹çš„å‰å‡ è¯¾ï¼š</p></blockquote><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li></ul><h2 id="ä»€ä¹ˆæ˜¯æ¯åƒç´ ç…§æ˜">ä»€ä¹ˆæ˜¯æ¯åƒç´ ç…§æ˜<a href="post/Learn-OpenGL-Lesson-Three#ä»€ä¹ˆæ˜¯æ¯åƒç´ ç…§æ˜"></a></h2><p>éšç€ç€è‰²å™¨çš„ä½¿ç”¨ï¼Œæ¯åƒç´ ç…§æ˜åœ¨æ¸¸æˆä¸­æ˜¯ä¸€ç§ç›¸å¯¹è¾ƒæ–°çš„ç°è±¡ã€‚è®¸å¤šæœ‰åçš„æ—§æ¸¸æˆï¼Œä¾‹å¦‚åŸç‰ˆçš„<a href="https://en.wikipedia.org/wiki/Half-Life_(video_game)" target="_blank" rel="noopener">åŠæ¡å‘½</a>ï¼Œéƒ½æ˜¯åœ¨ç€è‰²å™¨ä¹‹å‰å¼€å‘å‡ºæ¥çš„ï¼Œä¸»è¦ä½¿ç”¨é™æ€ç…§æ˜ï¼Œé€šè¿‡ä¸€äº›æŠ€å·§æ¨¡æ‹ŸåŠ¨æ€ç…§æ˜ï¼Œä½¿ç”¨æ¯é¡¶ç‚¹ï¼ˆä¹Ÿç§°ä¸º<a href="http://en.wikipedia.org/wiki/Gouraud_shading" target="_blank" rel="noopener">Gouraudé˜´å½±</a>ï¼‰ç…§æ˜æˆ–å…¶ä»–æŠ€æœ¯ï¼Œå¦‚åŠ¨æ€<a href="https://en.wikipedia.org/wiki/Lightmap" target="_blank" rel="noopener">å…‰ç…§è´´å›¾</a>ã€‚</p><p>å…‰ç…§è´´å›¾å¯ä»¥æä¾›éå¸¸å¥½çš„æ•ˆæœï¼Œæœ‰æ—¶å¯ä»¥æ¯”å•ç‹¬çš„ç€è‰²å™¨æä¾›æ›´å¥½çš„æ•ˆæœï¼Œå› ä¸ºå¯ä»¥é¢„å…ˆè®¡ç®—æ˜‚è´µçš„å…‰çº¿è®¡ç®—ã€‚ä½†ç¼ºç‚¹æ˜¯å®ƒä»¬å ç”¨äº†å¤§é‡å†…å­˜å¹¶ä½¿ç”¨å®ƒä»¬è¿›è¡ŒåŠ¨æ€ç…§æ˜ä»…é™äºç®€å•çš„è®¡ç®—ã€‚</p><p>ä½¿ç”¨ç€è‰²å™¨ï¼Œç°åœ¨å¾ˆå¤šè¿™äº›è®¡ç®—è½¬ç»™GPUï¼Œè¿™å¯ä»¥å®Œæˆæ›´å¤šå®æ—¶çš„æ•ˆæœã€‚</p><h2 id="ä»æ¯é¡¶ç‚¹ç…§æ˜è½¬ç§»åˆ°æ¯ç‰‡æ®µç…§æ˜">ä»æ¯é¡¶ç‚¹ç…§æ˜è½¬ç§»åˆ°æ¯ç‰‡æ®µç…§æ˜<a href="post/Learn-OpenGL-Lesson-Three#ä»æ¯é¡¶ç‚¹ç…§æ˜è½¬ç§»åˆ°æ¯ç‰‡æ®µç…§æ˜"></a></h2><p>è¿™æœ¬è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†é’ˆå¯¹æ¯é¡¶ç‚¹è§£å†³æ–¹æ¡ˆå’Œæ¯ç‰‡æ®µè§£å†³æ–¹æ¡ˆæŸ¥çœ‹ç›¸åŒçš„ç…§æ˜ä»£ç ã€‚å°½ç®¡æˆ‘å°†è¿™ç§ç±»å‹ç§°ä¸ºæ¯åƒç´ ï¼Œä½†åœ¨OpenGL ESä¸­æˆ‘ä»¬å®é™…ä¸Šä½¿ç”¨ç‰‡æ®µï¼Œå¹¶ä¸”å‡ ä¸ªç‰‡æ®µå¯ä»¥è´¡çŒ®ä¸€ä¸ªåƒç´ çš„æœ€ç»ˆå€¼ã€‚</p><p>æ‰‹æœºçš„GPUå˜å¾—è¶Šæ¥è¶Šå¿«ï¼Œä½†æ˜¯æ€§èƒ½ä»ç„¶æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚å¯¹äºâ€œè½¯â€ç…§æ˜ä¾‹å¦‚åœ°å½¢ï¼Œæ¯é¡¶ç‚¹ç…§æ˜å¯èƒ½è¶³å¤Ÿå¥½ã€‚ç¡®ä¿æ‚¨åœ¨è´¨é‡å’Œé€Ÿåº¦ä¹‹é—´å–å¾—é€‚å½“çš„å¹³è¡¡ã€‚</p><p>åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥çœ‹åˆ°ä¸¤ç§ç±»å‹çš„ç…§æ˜ä¹‹é—´çš„æ˜¾è‘—å·®å¼‚ã€‚çœ‹çœ‹ä¸‹é¢çš„å±å¹•æˆªå›¾ï¼š</p><div class="article-bounded"><div class="article-table"><table><tbody><tr><td><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190127004415.png" alt="Per vertex lighting"><br>æ¯é¡¶ç‚¹ç…§æ˜ï¼›<br>åœ¨æ­£æ–¹å½¢å››ä¸ªé¡¶ç‚¹ä¸ºä¸­å¿ƒ</td><td><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190127004455.png" alt="Per fragment lighting"><br>æ¯ç‰‡æ®µç…§æ˜ï¼›<br>åœ¨æ­£æ–¹å½¢å››ä¸ªé¡¶ç‚¹ä¸ºä¸­å¿ƒ</td><td>åœ¨å·¦å›¾çš„æ¯é¡¶ç‚¹ç…§æ˜ä¸­æ­£æ–¹ä½“çš„<br>æ­£é¢çœ‹èµ·æ¥åƒæ˜¯å¹³é¢é˜´å½±ï¼Œä¸èƒ½<br>è¡¨æ˜é™„è¿‘æœ‰å…‰æºã€‚è¿™æ˜¯å› ä¸ºæ­£é¢<br>çš„å››ä¸ªé¡¶ç‚¹å’Œå…‰æºè·ç¦»å·®ä¸å¤šç›¸<br>ç­‰ï¼Œå¹¶ä¸”å››ä¸ªç‚¹çš„ä½å…‰å¼ºåº¦è¢«ç®€<br>å•çš„æ’å…¥ä¸¤ä¸ªä¸‰è§’å½¢æ„æˆçš„æ­£é¢ã€‚<hr>ç›¸å¯¹æ¯”ï¼Œæ¯ç‰‡æ®µç…§æ˜å¾ˆå¥½çš„<br>æ˜¾ç¤ºäº†äº®ç‚¹ç‰¹æ€§</td></tr><tr><td><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190127004542.png" alt="Per vertex lighting"><br>æ¯é¡¶ç‚¹ç…§æ˜ï¼›<br>åœ¨æ­£æ–¹å½¢è§’è½</td><td><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190127004615.png" alt="Per fragment lighting"><br>æ¯ç‰‡æ®µç…§æ˜ï¼›<br>åœ¨æ­£æ–¹å½¢è§’è½</td><td>å·¦å›¾æ˜¾ç¤ºäº†ä¸€ä¸ª<a href="http://en.wikipedia.org/wiki/Gouraud_shading" target="_blank" rel="noopener">Gouraudé˜´å½±</a><br>ç«‹æ–¹ä½“ã€‚å½“å…‰æºç§»åŠ¨åˆ°ç«‹æ–¹ä½“æ­£<br>é¢è§’è½æ—¶ï¼Œå¯ä»¥çœ‹åˆ°ç±»ä¼¼ä¸‰è§’å½¢<br>çš„æ•ˆæœã€‚è¿™æ˜¯å› ä¸ºæ­£é¢å®é™…ä¸Šæ˜¯<br>ç”±ä¸¤ä¸ªä¸‰è§’å½¢ç»„æˆï¼Œå¹¶ä¸”åœ¨æ¯ä¸ª<br>ä¸‰è§’å½¢ä¸åŒæ–¹å‘æ’å€¼ï¼Œæˆ‘ä»¬èƒ½çœ‹<br>åˆ°æ„æˆç«‹æ–¹ä½“çš„åŸºç¡€å‡ ä½•å›¾å½¢ã€‚<hr>æ¯ç‰‡æ®µçš„ç‰ˆæœ¬æ˜¾ç¤ºä¸Šæ²¡æœ‰æ­¤ç±»æ’<br>å€¼çš„é—®é¢˜å¹¶ä¸”å®ƒåœ¨è¾¹ç¼˜é™„è¿‘æ˜¾ç¤º<br>äº†ä¸€ä¸ªæ¼‚äº®çš„åœ†å½¢é«˜å…‰ã€‚</td></tr></tbody></table></div></div><h3 id="æ¯é¡¶ç‚¹ç…§æ˜æ¦‚è¿°">æ¯é¡¶ç‚¹ç…§æ˜æ¦‚è¿°<a href="post/Learn-OpenGL-Lesson-Three#æ¯é¡¶ç‚¹ç…§æ˜æ¦‚è¿°"></a></h3><p>æˆ‘ä»¬æ¥çœ‹çœ‹<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">ç¬¬äºŒè¯¾</a>è®²çš„ç€è‰²å™¨ï¼›åœ¨è¯¥è¯¾ç¨‹ä¸­å¯ä»¥æ‰¾åˆ°è¯¦ç»†çš„ç€è‰²å™¨è¯´æ˜ã€‚</p><h3 id="é¡¶ç‚¹ç€è‰²å™¨">é¡¶ç‚¹ç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Three#é¡¶ç‚¹ç€è‰²å™¨"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVPMatrix;      <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewã€projectionçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVMatrix;       <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">vec3</span> u_LightPos;       <span class="comment">// å…‰æºåœ¨çœ¼ç›ç©ºé—´çš„ä½ç½®</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Position;     <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Color;        <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„é¢œè‰²ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec3</span> a_Normal;       <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„æ³•çº¿ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color;          <span class="comment">// è¿™å°†è¢«ä¼ å…¥ç‰‡æ®µç€è‰²å™¨</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()                    <span class="comment">// é¡¶ç‚¹ç€è‰²å™¨å…¥å£</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// å°†é¡¶ç‚¹è½¬æ¢æˆçœ¼ç›ç©ºé—´</span></span><br><span class="line">   <span class="type">vec3</span> modelViewVertex = <span class="type">vec3</span>(u_MVMatrix * a_Position);</span><br><span class="line"><span class="comment">// å°†æ³•çº¿çš„æ–¹å‘è½¬æ¢æˆçœ¼ç›ç©ºé—´</span></span><br><span class="line">   <span class="type">vec3</span> modelViewNormal = <span class="type">vec3</span>(u_MVMatrix * <span class="type">vec4</span>(a_Normal, <span class="number">0.0</span>));</span><br><span class="line"><span class="comment">// å°†ç”¨äºå“€å‡</span></span><br><span class="line">   <span class="type">float</span> <span class="built_in">distance</span> = <span class="built_in">length</span>(u_LightPos - modelViewVertex);</span><br><span class="line"><span class="comment">// è·å–ä»å…‰æºåˆ°é¡¶ç‚¹æ–¹å‘çš„å…‰çº¿å‘é‡</span></span><br><span class="line">   <span class="type">vec3</span> lightVector = <span class="built_in">normalize</span>(u_LightPos - modelViewVertex);</span><br><span class="line"><span class="comment">// è®¡ç®—å…‰çº¿çŸ¢é‡å’Œé¡¶ç‚¹æ³•çº¿çš„ç‚¹ç§¯ï¼Œå¦‚æœæ³•çº¿å’Œå…‰çº¿çŸ¢é‡æŒ‡å‘ç›¸åŒçš„æ–¹å‘ï¼Œé‚£ä¹ˆå®ƒå°†è·å¾—æœ€å¤§çš„ç…§æ˜</span></span><br><span class="line">   <span class="type">float</span> diffuse = <span class="built_in">max</span>(<span class="built_in">dot</span>(modelViewNormal, lightVector), <span class="number">0.1</span>);</span><br><span class="line"><span class="comment">// æ ¹æ®è·ç¦»å“€å‡å…‰çº¿</span></span><br><span class="line">   diffuse = diffuse * (<span class="number">1.0</span> / (<span class="number">1.0</span> + (<span class="number">0.25</span> * <span class="built_in">distance</span> * <span class="built_in">distance</span>)));</span><br><span class="line"><span class="comment">// å°†é¢œè‰²ä¹˜ä»¥äº®åº¦ï¼Œå®ƒå°†è¢«æ’å…¥ä¸‰è§’å½¢ä¸­</span></span><br><span class="line">   v_Color = a_Color * diffuse;</span><br><span class="line"><span class="comment">// gl_Positionæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ç”¨æ¥å­˜å‚¨æœ€ç»ˆçš„ä½ç½®</span></span><br><span class="line"><span class="comment">// å°†é¡¶ç‚¹ä¹˜ä»¥çŸ©é˜µå¾—åˆ°æ ‡å‡†åŒ–å±å¹•åæ ‡çš„æœ€ç»ˆç‚¹</span></span><br><span class="line">   <span class="built_in">gl_Position</span> = u_MVPMatrix * a_Position;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="ç‰‡æ®µç€è‰²å™¨">ç‰‡æ®µç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Three#ç‰‡æ®µç€è‰²å™¨"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">precision</span> <span class="keyword">mediump</span> <span class="type">float</span>;     <span class="comment">// æˆ‘ä»¬å°†é»˜è®¤ç²¾åº¦è®¾ç½®ä¸ºä¸­ç­‰ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç‰‡æ®µç€è‰²å™¨ä¸­çš„é«˜ç²¾åº¦</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color;        <span class="comment">// è¿™æ˜¯ä»ä¸‰è§’å½¢æ¯ä¸ªç‰‡æ®µå†…æ’çš„é¡¶ç‚¹ç€è‰²å™¨çš„é¢œè‰²</span></span><br><span class="line"><span class="type">void</span> main()                  <span class="comment">// ç‰‡æ®µç€è‰²å™¨å…¥å£</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">gl_FragColor</span> = v_Color;   <span class="comment">// ç›´æ¥å°†é¢œè‰²ä¼ é€’</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æ­£å¦‚æ‚¨æ‰€è§ï¼Œå¤§éƒ¨åˆ†å·¥ä½œéƒ½åœ¨æˆ‘ä»¬çš„ç€è‰²å™¨ä¸­åšçš„ã€‚è½¬ç§»åˆ°æ¯ç‰‡æ®µç€è‰²ç…§æ˜æ„å‘³ç€ï¼Œæˆ‘ä»¬çš„ç‰‡æ®µç€è‰²å™¨è¿˜æœ‰æ›´å¤šçš„å·¥ä½œè¦åšã€‚</p><h3 id="å®ç°æ¯ç‰‡æ®µç…§æ˜">å®ç°æ¯ç‰‡æ®µç…§æ˜<a href="post/Learn-OpenGL-Lesson-Three#å®ç°æ¯ç‰‡æ®µç…§æ˜"></a></h3><p>ä»¥ä¸‹æ˜¯ç§»åŠ¨åˆ°æ¯ç‰‡æ®µç…§æ˜åçš„ä»£ç çš„æ ·å­ã€‚</p><h3 id="é¡¶ç‚¹ç€è‰²å™¨-new">é¡¶ç‚¹ç€è‰²å™¨ new<a href="post/Learn-OpenGL-Lesson-Three#é¡¶ç‚¹ç€è‰²å™¨-new"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVPMatrix;    <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewã€projectionçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVMatrix;     <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Position;   <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Color;      <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„é¢œè‰²ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec3</span> a_Normal;     <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„æ³•çº¿ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Position;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Normal;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¡¶ç‚¹ç€è‰²å™¨å…¥å£ç‚¹</span></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// å°†é¡¶ç‚¹ä½ç½®è½¬æ¢æˆçœ¼ç›ç©ºé—´çš„ä½ç½®</span></span><br><span class="line">   v_Position = <span class="type">vec3</span>(u_MVMatrix * a_Position);</span><br><span class="line">   <span class="comment">// ä¼ å…¥é¢œè‰²</span></span><br><span class="line">   v_Color = a_Color;</span><br><span class="line">   <span class="comment">// å°†æ³•çº¿çš„æ–¹å‘è½¬æ¢åœ¨çœ¼ç›ç©ºé—´</span></span><br><span class="line">   v_Normal = <span class="type">vec3</span>(u_MVMatrix * <span class="type">vec4</span>(a_Normal, <span class="number">0.0</span>));</span><br><span class="line">   <span class="comment">// gl_Positionæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ç”¨æ¥å­˜å‚¨æœ€ç»ˆçš„ä½ç½®</span></span><br><span class="line">   <span class="comment">// å°†é¡¶ç‚¹ä¹˜ä»¥çŸ©é˜µå¾—åˆ°æ ‡å‡†åŒ–å±å¹•åæ ‡çš„æœ€ç»ˆç‚¹</span></span><br><span class="line">   <span class="built_in">gl_Position</span> = u_MVPMatrix * a_Position;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>é¡¶ç‚¹ç€è‰²å™¨æ¯”ä¹‹å‰æ›´åŠ çš„ç®€å•ã€‚æˆ‘ä»¬æ·»åŠ äº†ä¸¤ä¸ªçº¿æ€§æ’å€¼å˜é‡ç”¨æ¥ä¼ å…¥åˆ°ç‰‡æ®µç€è‰²å™¨ï¼šé¡¶ç‚¹ä½ç½®å’Œé¡¶ç‚¹æ³•çº¿ã€‚å®ƒä»¬å°†åœ¨ç‰‡æ®µç€è‰²å™¨è®¡ç®—å…‰äº®çš„æ—¶å€™è¢«ä½¿ç”¨ã€‚</p><h3 id="ç‰‡æ®µç€è‰²å™¨-new">ç‰‡æ®µç€è‰²å™¨ new<a href="post/Learn-OpenGL-Lesson-Three#ç‰‡æ®µç€è‰²å™¨-new"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">precision</span> <span class="keyword">mediump</span> <span class="type">float</span>; <span class="comment">//æˆ‘ä»¬å°†é»˜è®¤ç²¾åº¦è®¾ç½®ä¸ºä¸­ç­‰ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç‰‡æ®µç€è‰²å™¨ä¸­çš„é«˜ç²¾åº¦</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">vec3</span> u_LightPos; <span class="comment">// å…‰æºåœ¨çœ¼ç›ç©ºé—´çš„ä½ç½®</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Position; <span class="comment">// æ’å…¥çš„ä½ç½®</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color;    <span class="comment">// æ’å…¥çš„ä½ç½®é¢œè‰²</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Normal;   <span class="comment">// æ’å…¥çš„ä½ç½®æ³•çº¿</span></span><br><span class="line"><span class="type">void</span> main()              <span class="comment">// ç‰‡æ®µç€è‰²å™¨å…¥å£</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// å°†ç”¨äºå“€å‡</span></span><br><span class="line">   <span class="type">float</span> <span class="built_in">distance</span> = <span class="built_in">length</span>(u_LightPos - v_Position);</span><br><span class="line">   <span class="comment">// è·å–ä»å…‰æºåˆ°é¡¶ç‚¹æ–¹å‘çš„å…‰çº¿å‘é‡</span></span><br><span class="line">   <span class="type">vec3</span> lightVector = <span class="built_in">normalize</span>(u_LightPos - v_Position);</span><br><span class="line">   <span class="comment">// è®¡ç®—å…‰çº¿çŸ¢é‡å’Œé¡¶ç‚¹æ³•çº¿çš„ç‚¹ç§¯ï¼Œå¦‚æœæ³•çº¿å’Œå…‰çº¿çŸ¢é‡æŒ‡å‘ç›¸åŒçš„æ–¹å‘ï¼Œé‚£ä¹ˆå®ƒå°†è·å¾—æœ€å¤§çš„ç…§æ˜</span></span><br><span class="line">   <span class="type">float</span> diffuse = <span class="built_in">max</span>(<span class="built_in">dot</span>(v_Normal, lightVector), <span class="number">0.1</span>);</span><br><span class="line">   <span class="comment">// æ ¹æ®è·ç¦»å“€å‡å…‰çº¿</span></span><br><span class="line">   diffuse = diffuse * (<span class="number">1.0</span> / (<span class="number">1.0</span> + (<span class="number">0.25</span> * <span class="built_in">distance</span> * <span class="built_in">distance</span>)));</span><br><span class="line">   <span class="comment">// é¢œè‰²ä¹˜ä»¥äº®åº¦å“€å‡å¾—åˆ°æœ€ç»ˆçš„é¢œè‰²</span></span><br><span class="line">   <span class="built_in">gl_FragColor</span> = v_Color * diffuse;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>ä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜ï¼Œæˆ‘ä»¬çš„ç‰‡æ®µç€è‰²å™¨è¿˜æœ‰æ›´å¤šçš„å·¥ä½œè¦åšã€‚æˆ‘ä»¬åŸºæœ¬ä¸Šå°†<a href="https://en.wikipedia.org/wiki/Lambert%27s_cosine_law" target="_blank" rel="noopener">æœ—ä¼¯è®¡ç®—</a>å’Œå“€å‡ç§»åˆ°äº†æ¯åƒç´ çº§åˆ«ï¼Œè¿™ä¸ºæˆ‘ä»¬æä¾›äº†æ›´é€¼çœŸçš„ç…§æ˜ï¼Œè€Œæ— éœ€æ·»åŠ æ›´å¤šé¡¶ç‚¹ã€‚</p><h2 id="è¿›ä¸€æ­¥ç»ƒä¹ ">è¿›ä¸€æ­¥ç»ƒä¹ <a href="post/Learn-OpenGL-Lesson-Three#è¿›ä¸€æ­¥ç»ƒä¹ "></a></h2><p>æˆ‘ä»¬å¯ä»¥åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­è®¡ç®—è·ç¦»ï¼Œç„¶åèµ‹å€¼ç»™å˜é‡é€šè¿‡çº¿æ€§æ’å€¼ä¼ å…¥ç‰‡æ®µç€è‰²å™¨å—ï¼Ÿ</p><h2 id="æ•™ç¨‹ç›®å½•">æ•™ç¨‹ç›®å½•<a href="post/Learn-OpenGL-Lesson-Three#æ•™ç¨‹ç›®å½•"></a></h2><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five">OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six">OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven">OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVOBï¼‰</a></li></ul><h2 id="æ‰“åŒ…æ•™æ">æ‰“åŒ…æ•™æ<a href="post/Learn-OpenGL-Lesson-Three#æ‰“åŒ…æ•™æ"></a></h2><p>å¯ä»¥åœ¨Githubä¸‹è½½æœ¬è¯¾ç¨‹æºä»£ç ï¼š<a href="https://github.com/learnopengles/Learn-OpenGLES-Tutorials" target="_blank" rel="noopener">ä¸‹è½½é¡¹ç›®</a><br>æœ¬è¯¾çš„ç¼–è¯‘ç‰ˆæœ¬ä¹Ÿå¯ä»¥å†Androidå¸‚åœºä¸‹ï¼š<a href="https://market.android.com/details?id=com.learnopengles.android" target="_blank" rel="noopener">google play ä¸‹è½½apk</a><br>â€œæˆ‘â€ä¹Ÿç¼–è¯‘äº†ä¸ªapkï¼Œæ–¹ä¾¿å¤§å®¶ä¸‹è½½ï¼š<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">github download</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ–‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Three: Moving to Per-Fragment Lighting&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.learnopengles.com/android-lesson-three-moving-to-per-fragment-lighting/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.learnopengles.com/android-lesson-three-moving-to-per-fragment-lighting/&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/categories/OpenGL/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/tags/OpenGL/"/>
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</title>
    <link href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two/index.html"/>
    <id>https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two/index.html</id>
    <published>2019-01-23T07:50:51.000Z</published>
    <updated>2019-04-08T06:56:23.990Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»è¯‘æ–‡</p></blockquote><p>åŸæ–‡æ ‡é¢˜ï¼šOpenGL Android Lesson One: Getting Started<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.learnopengles.com/android-lesson-two-ambient-and-diffuse-lighting/" target="_blank" rel="noopener">http://www.learnopengles.com/android-lesson-two-ambient-and-diffuse-lighting/</a><br><a id="more"></a></p><hr><h1 id="ç¯å¢ƒå…‰å’Œæ¼«å°„å…‰">ç¯å¢ƒå…‰å’Œæ¼«å°„å…‰<a href="post/Learn-OpenGL-Lesson-Two#ç¯å¢ƒå…‰å’Œæ¼«å°„å…‰"></a></h1><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>æ¬¢è¿æ¥åˆ°ç¬¬äºŒè¯¾ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨<br>ç€è‰²å™¨å®ç°<a href="https://en.wikipedia.org/wiki/Lambertian_reflectance" target="_blank" rel="noopener">æœ—ä¼¯åå°„ï¼ˆ Lambertian reflectance ï¼‰</a>ï¼Œä¹Ÿç§°ä¸ºæ ‡å‡†æ¼«å°„ç…§æ˜ã€‚<br><br>åœ¨OpengGLES2ï¼Œæˆ‘ä»¬éœ€è¦å®ç°æˆ‘ä»¬è‡ªå·±çš„ç…§æ˜ç®—æ³•ï¼Œ<br>å› æ­¤æˆ‘ä»¬è¦å­¦ä¼šæ•°å­¦å¦‚ä½•å·¥ä½œä»¥åŠå¦‚ä½•åº”ç”¨åˆ°æˆ‘ä»¬çš„åœºæ™¯ä¸­ã€‚</td><td><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190123163828.png" alt="screenshot"></td></tr></tbody></table></div></div><h2 id="é˜…è¯»æœ¬æ–‡å‰ææ¡ä»¶">é˜…è¯»æœ¬æ–‡å‰ææ¡ä»¶<a href="post/Learn-OpenGL-Lesson-Two#é˜…è¯»æœ¬æ–‡å‰ææ¡ä»¶"></a></h2><p>æœ¬ç³»åˆ—çš„æ¯èŠ‚è¯¾éƒ½ä»¥å‰é¢çš„è¯¾ç¨‹ä¸ºåŸºç¡€ã€‚åœ¨å¼€å§‹å‰ï¼Œ<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">è¯·çœ‹ç¬¬ä¸€è¯¾</a>ï¼Œå› ä¸ºæœ¬è¯¾ç¨‹å°†ä»¥æ­¤ä¸ºåŸºç¡€æ¦‚å¿µä»‹ç»ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯å…‰">ä»€ä¹ˆæ˜¯å…‰<a href="post/Learn-OpenGL-Lesson-Two#ä»€ä¹ˆæ˜¯å…‰"></a></h2><p>æ²¡é”™ï¼ä¸€ä¸ªæ²¡æœ‰å…‰çš„ä¸–ç•Œæ˜¯æ˜æš—çš„ã€‚æ²¡æœ‰[å…‰]ï¼Œæˆ‘ä»¬ç”šè‡³ä¸èƒ½æ„ŸçŸ¥ä¸–ç•Œæˆ–æˆ‘ä»¬å‘¨å›´çš„ç‰©ä½“ï¼Œé™¤äº†å£°éŸ³å’Œè§¦æ‘¸ç­‰å…¶ä»–æ„Ÿå®˜ã€‚<br>å…‰å‘æˆ‘ä»¬å±•ç¤ºäº†ç‰©ä½“æ˜¯æ˜äº®è¿˜æ˜¯æ˜æš—ï¼Œæ˜¯è¿œè¿˜æ˜¯è¿‘ï¼Œå®ƒçš„è§’åº¦æ˜¯ä»€ä¹ˆã€‚</p><p>åœ¨ç°å®ä¸–ç•Œï¼Œæˆ‘ä»¬æ‰€æ„ŸçŸ¥çš„å…‰å®é™…æ˜¯æ•°ä¸‡äº¿å¾®å°ç²’å­çš„èšé›†ï¼Œç§°ä¸ºå…‰å­ã€‚å®ƒä»å…‰æºé£å‡ºï¼Œåå¼¹æ•°åƒæˆ–æ•°ç™¾ä¸‡æ¬¡ï¼Œæœ€ç»ˆåˆ°è¾¾æˆ‘ä»¬çš„çœ¼é•œæˆ‘ä»¬ç§°ä¹‹ä¸ºå…‰ã€‚</p><p>æˆ‘ä»¬å¦‚ä½•é€šè¿‡è®¡ç®—æœºå›¾å½¢æ¨¡æ‹Ÿå…‰çš„å½±å“ï¼Ÿ<br>æœ‰ä¸¤ç§æµè¡Œçš„æ–¹æ³•ï¼š<a href="http://en.wikipedia.org/wiki/Ray_tracing_(graphics)" target="_blank" rel="noopener">å…‰çº¿è¿½è¸ª</a>å’Œ<a href="http://en.wikipedia.org/wiki/Rasterisation" target="_blank" rel="noopener">å…‰æ …åŒ–</a><br>å…‰çº¿è·Ÿè¸ªçš„å·¥ä½œåŸç†æ˜¯é€šè¿‡æ•°å­¦è®¡ç®—è·Ÿè¸ªå®é™…å…‰çº¿å¹¶æŸ¥çœ‹å®ƒä»¬çš„æœ€ç»ˆä½ç½®ã€‚è¯¥æŠ€æœ¯å¯ä»¥å¾—åˆ°éå¸¸ç²¾å‡†å’Œé€¼çœŸçš„ç»“æœï¼Œä½†ç¼ºç‚¹æ˜¯æ¨¡æ‹Ÿæ‰€æœ‰è¿™äº›å…‰çº¿çš„è®¡ç®—æˆæœ¬éå¸¸é«˜ï¼Œå¹¶ä¸”é€šå¸¸å¯¹äºå®æ—¶æ¸²æŸ“æ¥è¯´å¤ªæ…¢äº†ã€‚<br>ç”±äºè¿™ä¸ªé™åˆ¶ï¼Œå¤§å¤šæ•°å®æ—¶å›¾å½¢è®¡ç®—ä½¿ç”¨å…‰æ …åŒ–ï¼Œå®ƒé€šè¿‡è¿‘ä¼¼å€¼æ¨¡æ‹Ÿå…‰ç…§ã€‚é‰´äºå½“å‰æ¸¸æˆçš„çœŸå®æ€§ï¼Œå…‰æ …åŒ–çœ‹èµ·æ¥éå¸¸å¥½ï¼Œå³ä½¿åœ¨æ‰‹æœºä¸Šä¹Ÿå¯ä»¥å¿«é€Ÿå®ç°å®æ—¶å›¾å½¢ã€‚OpengGL ESä¸»è¦æ˜¯ä¸€ä¸ªå…‰æ …åŒ–åº“ï¼Œå› æ­¤æˆ‘ä»¬ä¸»è¦å…³æ³¨è¿™ä¸ªã€‚</p><h3 id="ä¸åŒç§ç±»çš„å…‰">ä¸åŒç§ç±»çš„å…‰<a href="post/Learn-OpenGL-Lesson-Two#ä¸åŒç§ç±»çš„å…‰"></a></h3><p>äº‹å®è¯æ˜ï¼Œæˆ‘ä»¬å¯ä»¥æŠ½è±¡å‡ºå…‰çš„å·¥ä½œæ–¹å¼ï¼Œå¹¶æå‡ºä¸‰ç§åŸºæœ¬çš„å…‰ç…§æ–¹å¼</p><div class="article-bounded"><div class="article-table"><table><tbody><tr><td><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190123234400.png" alt="Ambient"><br>ç¯å¢ƒå…‰</td><td><strong>ç¯å¢ƒå…‰</strong><br>è¿™æ˜¯åŸºæœ¬çš„ç…§æ˜æ°´å¹³ï¼Œä¼¼ä¹éå¸ƒæ•´ä¸ªåœºæ™¯ã€‚å®ƒä¼¼ä¹ä¸æ˜¯æ¥è‡ªä»»ä½•<br>å…‰æºçš„å…‰ï¼Œå› ä¸ºå®ƒåœ¨åˆ°è¾¾ä½ ä¹‹å‰å·²ç»åå¼¹äº†å¾ˆå¤šæ¬¡ã€‚è¿™ç§ç±»å‹çš„å…‰<br>åœ¨æˆ·å¤–çš„é˜´å¤©å¯ä»¥ä½“éªŒï¼Œæˆ–è€…åœ¨æˆ·å†…ä½œä¸ºè®¸å¤šä¸åŒå…‰æºçš„ç§¯ç´¯å½±å“ã€‚<br>æˆ‘ä»¬å¯ä»¥ä¸ºç‰©ä½“æˆ–åœºæ™¯è®¾ç½®ä¸€ä¸ªåŸºæœ¬çš„äº®åº¦ï¼Œè€Œä¸æ˜¯ä¸ºæ‰€æœ‰çš„<br>å…‰å•ç‹¬è®¡ç®—ã€‚</td></tr><tr><td><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190124093759.png" alt="diffuse"><br>ç¯å¢ƒç…§æ˜å’Œæ¼«å°„ç…§æ˜<br>çš„ä¾‹å­</td><td><strong>æ¼«å°„ç…§æ˜</strong><br>è¿™æ˜¯ç›´æ¥ä»ä¸€ä¸ªç‰©ä½“ä¸Šè·³å¼¹ååˆ°è¾¾æ‚¨çœ¼ç›ä¸­çš„å…‰ï¼Œç‰©ä½“çš„äº®åº¦<br>éšç€å®ƒä¸ç…§æ˜çš„è§’åº¦è€Œå˜åŒ–ï¼Œé¢å‘ç¯å…‰çš„æ–¹å‘æ¯”å…¶ä»–è§’åº¦æ›´åŠ æ˜äº®<br>æ­¤å¤–ï¼Œæ— è®ºæˆ‘ä»¬ç›¸å¯¹äºç‰©ä½“çš„è§’åº¦æ€æ ·ï¼Œæˆ‘ä»¬éƒ½è§‰å¾—ç‰©ä½“æ˜¯ç›¸åŒçš„<br>äº®åº¦ï¼Œè¿™ä¹Ÿè¢«ç§°ä¸º<a href="https://en.wikipedia.org/wiki/Lambert%27s_cosine_law" target="_blank" rel="noopener">Lambertçš„ä½™å¼¦å®šå¾‹</a>ã€‚æ¼«å°„ç…§æ˜æˆ–æœ—ä¼¯åå°„ç‡åœ¨<br>æ—¥å¸¸ç”Ÿæ´»ä¸­å¾ˆå¸¸è§ï¼Œæ‚¨å¯ä»¥åœ¨å®¤å†…ç¯å…‰ç…§æ˜çš„ç™½å¢™ä¸Šè½»æ¾çœ‹åˆ°ã€‚</td></tr><tr><td><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190124105013.png" alt="specular"><br>é•œé¢é«˜å…‰çš„ä¸€ä¸ªä¾‹å­</td><td><strong>é•œé¢ç…§æ˜</strong><br>ä¸æ¼«å°„ç…§æ˜ä¸åŒï¼Œå½“æˆ‘ä»¬ç›¸å¯¹äºç‰©ä½“ç§»åŠ¨æ—¶ï¼Œé•œé¢å…‰ç…§ä¹Ÿä¼š<br>å‘ç”Ÿæ”¹å˜ã€‚è¿™ç»™ç‰©ä½“å¸¦æ¥â€œå…‰æ³½â€ï¼Œå¹¶ä¸”å¯ä»¥åœ¨â€œæ›´å…‰æ»‘â€çš„è¡¨é¢<br>ä¸Šçœ‹åˆ°ï¼Œä¾‹å¦‚ç»ç’ƒå’Œå…¶ä»–æœ‰å…‰æ³½çš„ç‰©ä½“ã€‚</td></tr></tbody></table></div></div><h3 id="æ¨¡æ‹Ÿå…‰">æ¨¡æ‹Ÿå…‰<a href="post/Learn-OpenGL-Lesson-Two#æ¨¡æ‹Ÿå…‰"></a></h3><p>æ­£å¦‚3Dåœºæ™¯ä¸­çš„3ä¸­ä¸»è¦ç±»å‹çš„å…‰ç…§ä¸€æ ·ï¼Œè¿˜æœ‰ä¸‰ç§ä¸»è¦ç±»å‹çš„å…‰æºï¼šå®šå‘å…‰æºï¼Œç‚¹å…‰æºï¼Œèšå…‰ç¯ï¼Œè¿™äº›ä¹Ÿå¯ä»¥åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­è½»æ¾çœ‹åˆ°ã€‚</p><div class="article-bounded"><div class="article-table"><table><tbody><tr><td><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190124112017.png" alt="Directional lighting"><br>ä¸€ä¸ªæ˜äº®çš„é£æ™¯</td><td><strong>å®šå‘å…‰æº</strong><br>å®šå‘å…‰ç…§é€šå¸¸æ¥è‡ªäºä¸€ä¸ªå¾ˆè¿œçš„å…‰æºï¼Œå®ƒå¯ä»¥å‡åŒ€çš„ç…§äº®æ•´ä¸ª<br>åœºæ™¯è¾¾åˆ°ç›¸åŒçš„äº®åº¦ã€‚è¿™ç§å…‰æºæ˜¯æœ€ç®€å•çš„ç±»å‹ï¼Œæ— è®ºæ‚¨å¤„åœ¨<br>åœºæ™¯å“ªé‡Œï¼Œå…‰ç…§éƒ½å…·æœ‰ç›¸åŒçš„å¼ºåº¦å’Œæ–¹å‘ã€‚</td></tr><tr><td><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190124112915.png" alt="Point lighting"><br>ä¸€ä¸ªç‚¹å…‰æºçš„ä¾‹å­</td><td><strong>ç‚¹å…‰æº</strong><br>ç‚¹å…‰æºå¯ä»¥æ·»åŠ åˆ°åœºæ™¯ä¸­ï¼Œä»¥æä¾›æ›´å¤šæ ·åŒ–å’Œé€¼çœŸçš„ç…§æ˜ã€‚<br>ç‚¹å…‰çš„ç…§å°„<a href="https://en.wikipedia.org/wiki/Inverse-square_law" target="_blank" rel="noopener">éšç€è·ç¦»è€Œä¸‹é™</a>ï¼Œå¹¶ä¸”å®ƒçš„å…‰çº¿åœ¨æ‰€æœ‰æ–¹å‘ä¸Š<br>å‘å¤–ä¼ æ’­ï¼Œå…‰æºä½äºä¸­å¿ƒã€‚</td></tr><tr><td><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190124113930.png" alt="Spot lighting"><br>èšå…‰ç¯</td><td><strong>èšå…‰ç¯</strong><br>é™¤äº†å…·æœ‰ç‚¹å…‰æºçš„ç‰¹æ€§å¤–ï¼Œèšå…‰ç¯ä¹Ÿæœ‰å…‰å“€å‡çš„æ–¹å‘ï¼Œ<br>é€šå¸¸å‘ˆé”¥å½¢ã€‚</td></tr></tbody></table></div></div><h3 id="æ•°å­¦">æ•°å­¦<a href="post/Learn-OpenGL-Lesson-Two#æ•°å­¦"></a></h3><p>æœ¬èŠ‚è¯¾ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ¥è‡ªä¸€ä¸ªç‚¹å…‰æºçš„ç¯å¢ƒç…§æ˜å’Œæ¼«å°„ç…§æ˜ã€‚</p><h3 id="ç¯å¢ƒç…§æ˜">ç¯å¢ƒç…§æ˜<a href="post/Learn-OpenGL-Lesson-Two#ç¯å¢ƒç…§æ˜"></a></h3><p>ç¯å¢ƒç…§æ˜å…¶å®æ˜¯<a href="https://en.wikipedia.org/wiki/Radiosity_(computer_graphics)" target="_blank" rel="noopener">é—´æ¥æ¼«å°„ç…§æ˜</a>ï¼Œä½†å®ƒä¹Ÿå¯ä»¥è¢«è®¤ä¸ºæ˜¯éå¸ƒæ•´ä¸ªåœºæ™¯çš„ä½çº§å…‰ã€‚å¦‚æœæˆ‘ä»¬è¿™ä¹ˆæƒ³ï¼Œé‚£ä¹ˆå®ƒå°†éå¸¸å¥½è®¡ç®—ï¼š</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ€ç»ˆé¢œè‰² = æè´¨é¢œè‰² * ç¯å¢ƒå…‰é¢œè‰²</span></span><br><span class="line">final color = material color * ambient light color</span><br></pre></td></tr></table></div></figure><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸ªçº¢è‰²çš„ç‰©ä½“å’Œä¸€ä¸ªæš—ç™½è‰²çš„ç¯å¢ƒç…§æ˜ã€‚æˆ‘ä»¬å‡è®¾ä¸‰ä¸ªé¢œè‰²ï¼ˆçº¢ï¼Œç»¿ï¼Œè“ï¼‰çš„æ•°ç»„å­˜å‚¨é¢œè‰²ï¼Œä½¿ç”¨<a href="https://en.wikipedia.org/wiki/RGB_color_model" target="_blank" rel="noopener">RGBé¢œè‰²æ¨¡å‹</a>ï¼š</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ€ç»ˆé¢œè‰² = çº¢è‰² * æš—ç™½è‰² = æš—çº¢è‰²</span></span><br><span class="line">final color = &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125; * &#123;<span class="number">0.1</span>, <span class="number">0.1</span>, <span class="number">0.1</span>&#125; = &#123;<span class="number">0.1</span>, <span class="number">0.0</span>, <span class="number">0.0</span>&#125;</span><br></pre></td></tr></table></div></figure><p>ç‰©ä½“çš„æœ€ç»ˆé¢œè‰²å°†æ˜¯æš—çº¢è‰²ï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ªè¢«æ˜æš—çš„ç™½å…‰ç…§æ˜çš„çº¢è‰²ç‰©ä½“ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯æ‚¨çš„é¢„æœŸã€‚åŸºæœ¬çš„ç¯å¢ƒå…‰çœŸçš„æ²¡æœ‰æ¯”è¿™æ›´å¤šçš„äº†ï¼Œé™¤éæ‚¨æƒ³åŠ å…¥æ›´å…ˆè¿›çš„ç…§æ˜æŠ€æœ¯ï¼Œå¦‚å…‰èƒ½ä¼ é€’ã€‚</p><h3 id="æ¼«å°„ç…§æ˜-ç‚¹å…‰æº">æ¼«å°„ç…§æ˜-ç‚¹å…‰æº<a href="post/Learn-OpenGL-Lesson-Two#æ¼«å°„ç…§æ˜-ç‚¹å…‰æº"></a></h3><p>å¯¹äºæ¼«å°„ç…§æ˜ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ å“€å‡å’Œå…‰æºä½ç½®ã€‚å…‰æºä½ç½®å°†ç”¨æ¥è®¡ç®—å…‰çº¿å’Œè¡¨é¢çš„è§’åº¦ï¼Œå®ƒå°†å½±å“è¡¨é¢çš„æ•´ä½“å…‰ç…§æ°´å¹³ã€‚å®ƒè¿˜å°†ç”¨äºè®¡ç®—å…‰æºåˆ°è¡¨é¢çš„è·ç¦»ï¼Œè¿™å†³å®šäº†å…‰åœ¨è¿™ä¸ªç‚¹ä¸Šçš„å¼ºåº¦ã€‚</p><h4 id="ç¬¬ä¸€æ­¥ï¼šè®¡ç®—æœ—ä¼¯å› å­ï¼ˆlambert-factorï¼‰">ç¬¬ä¸€æ­¥ï¼šè®¡ç®—æœ—ä¼¯å› å­ï¼ˆlambert factorï¼‰<a href="post/Learn-OpenGL-Lesson-Two#ç¬¬ä¸€æ­¥ï¼šè®¡ç®—æœ—ä¼¯å› å­ï¼ˆlambert-factorï¼‰"></a></h4><p>æˆ‘ä»¬æœ€é‡è¦çš„æ˜¯éœ€è¦å¼„æ¸…æ¥šè¡¨é¢å’Œå…‰çº¿ä¹‹é—´çš„è§’åº¦ã€‚é¢å‘å…‰ç›´å°„çš„è¡¨é¢å› è¯¥å…¨å¼ºåº¦ç…§å°„ï¼Œè€Œå€¾æ–œçš„è¡¨é¢å› è¯¥å¾—åˆ°è¾ƒå°‘çš„ç…§å°„ï¼Œæ¯”è¾ƒåˆé€‚çš„è®¡ç®—æ–¹å¼æ˜¯ä½¿ç”¨<a href="https://en.wikipedia.org/wiki/Lambert%27s_cosine_law" target="_blank" rel="noopener">Lambertçš„ä½™å¼¦å®šå¾‹</a>ã€‚<br>æœæˆ‘ä»¬æœ‰ä¸¤ä¸ªå‘é‡ï¼Œä¸€ä¸ªæ˜¯ä»å…‰åˆ°è¡¨é¢ä¸Šçš„ä¸€ä¸ªç‚¹ï¼Œç¬¬äºŒä¸ªæ˜¯<a href="https://en.wikipedia.org/wiki/Normal_(geometry)" target="_blank" rel="noopener">è¡¨é¢çš„æ³•çº¿</a>ï¼ˆå¦‚æœè¡¨é¢æ˜¯å¹³é¢ï¼Œåˆ™è¡¨é¢æ³•çº¿æ˜¯æŒ‡å‘ä¸Šæˆ–å‚ç›´äºè¯¥è¡¨é¢çš„çŸ¢é‡ï¼‰ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹æ¯ä¸ªå‘é‡è¿›è¡Œå½’ä¸€åŒ–æ¥è®¡ç®—ä½™å¼¦ï¼Œä½¿å…¶é•¿åº¦ä¸º1ï¼Œç„¶åé€šè¿‡è®¡ç®—ä¸¤ä¸ªå‘é‡çš„<a href="https://en.wikipedia.org/wiki/Dot_product" target="_blank" rel="noopener">ç‚¹ç§¯ï¼ˆæ•°é‡ç§¯ï¼‰</a>ã€‚<br>è¿™ä¸ªæ“ä½œå¯ä»¥ç”±OpenGL ES 2è½»æ¾å®Œæˆã€‚</p><p>æˆ‘ä»¬ç§°è¿™ä½æœ—ä¼¯å› å­ï¼Œå®ƒçš„å–å€¼èŒƒå›´åœ¨0~1ä¹‹é—´</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…‰çº¿å‘é‡ = å…‰æºä½ç½® - ç‰©ä½“ä½ç½®</span></span><br><span class="line">light <span class="built_in">vector</span> = light position - object position</span><br><span class="line"><span class="comment">// ä½™å¼¦ = ç‰©ä½“æ³•çº¿å’Œå½’ä¸€åŒ–åçš„å…‰çº¿å‘é‡çš„ç‚¹ç§¯</span></span><br><span class="line">cosine = dot product(object normal, normalize(light <span class="built_in">vector</span>))</span><br><span class="line"><span class="comment">// æœ—ä¼¯å› å­ = å–ä½™å¼¦å’Œ0ä¸­æœ€å¤§çš„</span></span><br><span class="line">lambert factor = max(cosine, <span class="number">0</span>)</span><br></pre></td></tr></table></div></figure><p>é¦–å…ˆæˆ‘ä»¬é€šè¿‡å…‰æºä½ç½®å‡å»ç‰©ä½“ä½ç½®å¾—åˆ°å…‰çº¿å‘é‡ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡ç‰©ä½“æ³•çº¿å’Œå…‰å‘é‡çš„ç‚¹ç§¯å¾—åˆ°ä½™å¼¦ã€‚æˆ‘ä»¬æ ‡å‡†åŒ–å…‰å‘é‡ï¼Œè¿™æ„å‘³ç€æ”¹å˜å®ƒçš„é•¿åº¦ï¼Œé•¿åº¦ä¸º1ï¼Œè¿™ä¸ªç‰©ä½“çš„æ³•çº¿é•¿åº¦ä¹Ÿæ˜¯1ï¼Œä¸¤ä¸ªå½’ä¸€åŒ–å‘é‡çš„ç‚¹ç§¯å¾—åˆ°ä»–ä»¬ä¹‹é—´çš„ä½™å¼¦ã€‚å› ä¸ºç‚¹ç§¯çš„å–å€¼èŒƒå›´æ˜¯-1~1ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å…¶é™åˆ¶åˆ°0~1ã€‚</p><p>è¿™å„¿æœ‰ä¸ªå¤„åœ¨åŸç‚¹çš„å¹³é¢ï¼Œå…¶è¡¨é¢æ³•çº¿æŒ‡å‘å¤©ç©ºçš„ä¾‹å­ã€‚</p><blockquote><p>å…‰çš„ä½ç½®åœ¨{0, 10, -10}ï¼Œæˆ‘ä»¬æƒ³è¦è®¡ç®—åœ¨åŸç‚¹çš„å…‰ã€‚</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…‰çº¿å‘é‡</span></span><br><span class="line">light <span class="built_in">vector</span> = &#123;<span class="number">0</span>, <span class="number">10</span>, <span class="number">-10</span>&#125; - &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125; = &#123;<span class="number">0</span>, <span class="number">10</span>, <span class="number">-10</span>&#125;</span><br><span class="line"><span class="comment">// ç‰©ä½“æ³•çº¿</span></span><br><span class="line">object normal = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ç®€æ´çš„è¯´ï¼Œå¦‚æœä»¬æ²¿ç€å…‰çº¿çŸ¢é‡èµ°ï¼Œæˆ‘ä»¬åˆ°è¾¾å…‰æºçš„ä½ç½®ã€‚ä¸ºäº†å½’ä¸€åŒ–çŸ¢é‡ï¼Œæˆ‘ä»¬å°†æ¯ä¸ªåˆ†é‡é™¤ä»¥çŸ¢é‡é•¿åº¦ï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…‰çº¿å‘é‡é•¿åº¦ = å¹³æ–¹æ ¹(0*0 + 10*10 + (-10 * -10)) = å¹³æ–¹æ ¹(200) = 14.14</span></span><br><span class="line">light <span class="built_in">vector</span> length = square root(<span class="number">0</span>*<span class="number">0</span> + <span class="number">10</span>*<span class="number">10</span> + (<span class="number">-10</span> * <span class="number">-10</span>)) = square root(<span class="number">200</span>) = <span class="number">14.14</span></span><br><span class="line"><span class="comment">// å½’ä¸€åŒ–å…‰çº¿å‘é‡</span></span><br><span class="line">normalize light <span class="built_in">vector</span> = &#123;<span class="number">0</span>, <span class="number">10</span>/<span class="number">14.14</span>, <span class="number">-10</span>/<span class="number">14.14</span>&#125; = &#123;<span class="number">0</span>, <span class="number">0.707</span>, <span class="number">-0.707</span>&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ç„¶åæˆ‘ä»¬è®¡ç®—ç‚¹ç§¯ï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç‚¹ç§¯</span></span><br><span class="line"><span class="function">dot <span class="title">product</span><span class="params">(&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">0.707</span>, <span class="number">-0.707</span>&#125;)</span> </span>= (<span class="number">0</span> * <span class="number">0</span>) + (<span class="number">1</span> * <span class="number">0.707</span>) + (<span class="number">0</span> * <span class="number">-0.707</span>) = <span class="number">0.707</span></span><br></pre></td></tr></table></div></figure><p><a href="http://programmedlessons.org/VectorLessons/vch07/vch07_5.html" target="_blank" rel="noopener">è¿™é‡Œæœ‰ä¸ªä¸€å¯¹ç‚¹ç§¯è®¡ç®—å¾ˆå¥½çš„è§£é‡Š</a></p><blockquote><p>æœ€åæˆ‘ä»¬é™åˆ¶èŒƒå›´ï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ—ä¼¯å› å­</span></span><br><span class="line">lambert factor = max(<span class="number">0.707</span>, <span class="number">0</span>) = <span class="number">0.707</span></span><br></pre></td></tr></table></div></figure><p>OpenGL ES 2çš„ç€è‰²å™¨è¯­è¨€å†…ç½®äº†å¯¹å…¶ä¸­ä¸€äº›å‡½æ•°çš„æ”¯æŒï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦æ‰‹åŠ¨å®Œæˆæ‰€æœ‰æ•°å­¦è¿ç®—ï¼Œä½†å®ƒä»ç„¶æœ‰åŠ©äºç†è§£æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚</p><h4 id="ç¬¬äºŒæ­¥ï¼šè®¡ç®—å“€å‡ç³»æ•°">ç¬¬äºŒæ­¥ï¼šè®¡ç®—å“€å‡ç³»æ•°<a href="post/Learn-OpenGL-Lesson-Two#ç¬¬äºŒæ­¥ï¼šè®¡ç®—å“€å‡ç³»æ•°"></a></h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—å“€å‡ã€‚æ¥è‡ªå…‰æºçš„å®é™…å…‰å“€å‡éµå¾ª<a href="https://en.wikipedia.org/wiki/Inverse-square_law" target="_blank" rel="noopener">åå¹³æ–¹å®šå¾‹</a></p><blockquote><p>ä¹Ÿå¯ä»¥è¿™æ ·è¡¨ç¤ºï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// äº®åº¦ = 1 / è·ç¦»çš„å¹³æ–¹</span></span><br><span class="line">luminosity = <span class="number">1</span> / (distance * distance)</span><br></pre></td></tr></table></div></figure><blockquote><p>å›åˆ°æˆ‘ä»¬çš„åˆ—å­ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰å…‰çº¿é•¿åº¦ä¸º14.14ï¼Œè¿™å„¿æˆ‘ä»¬æœ€ç»ˆçš„äº®åº¦ï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">luminosity = <span class="number">1</span> / (<span class="number">14.14</span> * <span class="number">14.14</span>) = <span class="number">1</span> / <span class="number">200</span> = <span class="number">0.005</span></span><br></pre></td></tr></table></div></figure><p>æ­£å¦‚æ‚¨æ‰€è§ï¼Œåå¹³æ–¹å®šå¾‹ä¼šå¯¼è‡´è·ç¦»çš„å¼ºçƒˆå“€å‡ã€‚è¿™å°±æ˜¯ç‚¹å…‰æºçš„å…‰åœ¨ç°å®ä¸–ç•Œä¸­çš„ä½œç”¨ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬å›¾å½¢å±•ç¤ºèŒƒå›´æœ‰é™ï¼Œæ§åˆ¶è¿™ä¸ªå“€å‡ç³»æ•°æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œå› æ­¤æˆ‘ä»¬ä»ç„¶èƒ½è·å¾—é€¼çœŸçš„ç…§æ˜è€Œä¸ä¼šè®©å…¶çœ‹èµ·æ¥å¾ˆæ˜æš—ã€‚</p><h4 id="ç¬¬ä¸‰æ­¥ï¼šè®¡ç®—æœ€ç»ˆé¢œè‰²">ç¬¬ä¸‰æ­¥ï¼šè®¡ç®—æœ€ç»ˆé¢œè‰²<a href="post/Learn-OpenGL-Lesson-Two#ç¬¬ä¸‰æ­¥ï¼šè®¡ç®—æœ€ç»ˆé¢œè‰²"></a></h4><blockquote><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ä½™å¼¦å’Œå“€å‡åº¦ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æˆ‘ä»¬æœ€ç»ˆçš„äº®åº¦ï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ€ç»ˆé¢œè‰² = æè´¨é¢œè‰² * ï¼ˆå…‰çš„é¢œè‰² * æœ—ä¼¯å› å­ * äº®åº¦ï¼‰</span></span><br><span class="line">final color = material color * (light color * lambert factor * luminosity)</span><br></pre></td></tr></table></div></figure><blockquote><p>ç»§ç»­æˆ‘ä»¬ä¹‹å‰çš„çº¢è‰²ç‰©ä½“å’Œç™½å…‰æºçš„ä¾‹å­ï¼Œè¿™å„¿è®¡ç®—æœ€ç»ˆé¢œè‰²ï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">final color = &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125; * (&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125; * <span class="number">0.707</span> * <span class="number">0.005</span>) = &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125; * &#123;<span class="number">0.0035</span>, <span class="number">0.0035</span>, <span class="number">0.0035</span>&#125; = &#123;<span class="number">0.0035</span>, <span class="number">0</span>, <span class="number">0</span>&#125;</span><br></pre></td></tr></table></div></figure><p>å›é¡¾ä¸€ä¸‹ï¼Œå¯¹äºæ¼«å°„ç…§æ˜ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨è¡¨é¢å’Œå…‰çº¿ä¹‹é—´çš„è§’åº¦ä»¥åŠè·ç¦»ï¼Œç”¨æ¥è®¡ç®—æœ€ç»ˆçš„æ•´ä½“æ¼«å°„äº®åº¦ã€‚</p><blockquote><p>ä»¥ä¸‹æ˜¯æ­¥éª¤ï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¬¬ä¸€æ­¥</span></span><br><span class="line">light <span class="built_in">vector</span> = light position - object position</span><br><span class="line">cosine = dot product(object normal, normalize(light <span class="built_in">vector</span>))</span><br><span class="line">lambert factor = mac(cosine, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬äºŒæ­¥</span></span><br><span class="line">luminosity = <span class="number">1</span> / (distance * distance)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸‰æ­¥</span></span><br><span class="line">final color = material color * (light color * lambert factor * luminosity)</span><br></pre></td></tr></table></div></figure><h3 id="å°†è¿™ä¸€åˆ‡æ”¾åˆ°OpenGL-ES-2ç€è‰²å™¨ä¸­">å°†è¿™ä¸€åˆ‡æ”¾åˆ°OpenGL ES 2ç€è‰²å™¨ä¸­<a href="post/Learn-OpenGL-Lesson-Two#å°†è¿™ä¸€åˆ‡æ”¾åˆ°OpenGL-ES-2ç€è‰²å™¨ä¸­"></a></h3><h4 id="é¡¶ç‚¹ç€è‰²å™¨">é¡¶ç‚¹ç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Two#é¡¶ç‚¹ç€è‰²å™¨"></a></h4><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> String vertexShader =</span><br><span class="line">        <span class="string">"uniform mat4 u_MVPMatrix;      \n"</span> + <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewã€projectionçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line">        <span class="string">"uniform mat4 u_MVMatrix;       \n"</span> + <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line">        <span class="string">"uniform vec3 u_LightPos;       \n"</span> + <span class="comment">// å…‰æºåœ¨çœ¼ç›ç©ºé—´ï¼ˆç›¸å¯¹äºç›¸æœºè§†è§’ï¼‰çš„ä½ç½®</span></span><br><span class="line"></span><br><span class="line">        <span class="string">"attribute vec4 a_Position;     \n"</span> + <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®ä¿¡æ¯</span></span><br><span class="line">        <span class="string">"attribute vec4 a_Color;        \n"</span> + <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„é¢œè‰²ä¿¡æ¯</span></span><br><span class="line">        <span class="string">"attribute vec3 a_Normal;       \n"</span> + <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„æ³•çº¿ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">        <span class="string">"varying vec4 v_Color;          \n"</span> + <span class="comment">// è¿™å°†è¢«ä¼ å…¥ç‰‡æ®µç€è‰²å™¨</span></span><br><span class="line"></span><br><span class="line">        <span class="string">"void main()                    \n"</span> + <span class="comment">// é¡¶ç‚¹ç€è‰²å™¨å…¥å£</span></span><br><span class="line">        <span class="string">"&#123;                              \n"</span> +</span><br><span class="line">        <span class="comment">// å°†é¡¶ç‚¹è½¬æ¢æˆçœ¼ç›ç©ºé—´ï¼ˆç›¸å¯¹äºç›¸æœºè§†è§’ï¼‰</span></span><br><span class="line">        <span class="string">"   vec3 modelViewVertex = vec3(u_MVMatrix * a_Position);                \n"</span> +</span><br><span class="line">        <span class="comment">// å°†æ³•çº¿çš„æ–¹å‘è½¬æ¢æˆçœ¼ç›ç©ºé—´ï¼ˆç›¸å¯¹äºç›¸æœºè§†è§’ï¼‰</span></span><br><span class="line">        <span class="string">"   vec3 modelViewNormal = vec3(u_MVMatrix * vec4(a_Normal, 0.0));       \n"</span> +</span><br><span class="line">        <span class="comment">// å°†ç”¨äºå“€å‡</span></span><br><span class="line">        <span class="string">"   float distance = length(u_LightPos - modelViewVertex);               \n"</span> +</span><br><span class="line">        <span class="comment">// è·å–ä»å…‰æºåˆ°é¡¶ç‚¹æ–¹å‘çš„å…‰çº¿å‘é‡</span></span><br><span class="line">        <span class="string">"   vec3 lightVector = normalize(u_LightPos - modelViewVertex);          \n"</span> +</span><br><span class="line">        <span class="comment">// è®¡ç®—å…‰çº¿çŸ¢é‡å’Œé¡¶ç‚¹æ³•çº¿çš„ç‚¹ç§¯ï¼Œå¦‚æœæ³•çº¿å’Œå…‰çº¿çŸ¢é‡æŒ‡å‘ç›¸åŒçš„æ–¹å‘ï¼Œé‚£ä¹ˆå®ƒå°†è·å¾—æœ€å¤§çš„ç…§æ˜</span></span><br><span class="line">        <span class="string">"   float diffuse = max(dot(modelViewNormal, lightVector), 0.1);         \n"</span> +</span><br><span class="line">        <span class="comment">// æ ¹æ®è·ç¦»å“€å‡å…‰çº¿</span></span><br><span class="line">        <span class="string">"   diffuse = diffuse * (1.0 / (1.0 + (0.25 * distance * distance)));    \n"</span> +</span><br><span class="line">        <span class="comment">// å°†é¢œè‰²ä¹˜ä»¥äº®åº¦ï¼Œå®ƒå°†è¢«æ’å…¥ä¸‰è§’å½¢ä¸­</span></span><br><span class="line">        <span class="string">"   v_Color = a_Color * diffuse;                                         \n"</span> +</span><br><span class="line">        <span class="comment">// gl_Positionæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ç”¨æ¥å­˜å‚¨æœ€ç»ˆçš„ä½ç½®</span></span><br><span class="line">        <span class="comment">// å°†é¡¶ç‚¹ä¹˜ä»¥çŸ©é˜µå¾—åˆ°æ ‡å‡†åŒ–å±å¹•åæ ‡çš„æœ€ç»ˆç‚¹</span></span><br><span class="line">        <span class="string">"   gl_Position = u_MVPMatrix * a_Position;                              \n"</span> +</span><br><span class="line">        <span class="string">"&#125;                                                                       \n"</span>;</span><br></pre></td></tr></table></div></figure><p>è¿™é‡Œæœ‰ç›¸å½“å¤šçš„äº‹æƒ…è¦åšã€‚æˆ‘ä»¬åœ¨<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">ç¬¬ä¸€è¯¾</a>è®²åˆ°è¿‡æˆ‘ä»¬è¦æœ‰ä¸€ä¸ªmodel/view/projectionçš„ç»„åˆçŸ©é˜µï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜è¦æ·»åŠ äº†ä¸€ä¸ªmodel/viewçŸ©é˜µã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºæˆ‘ä»¬å°†éœ€è¦è¿™ä¸ªçŸ©é˜µå»è®¡ç®—å…‰æºä½ç½®åˆ°å½“å‰é¡¶ç‚¹ä½ç½®ä¹‹é—´çš„è·ç¦»ã€‚å¯¹äºæ¼«å°„ç…§æ˜ï¼Œæ— è®ºæ‚¨ä½¿ç”¨ä¸–ç•Œç©ºé—´ï¼ˆmodelçŸ©é˜µï¼‰æˆ–çœ¼ç›ç©ºé—´ï¼ˆmodel/viewçŸ©é˜µï¼‰åªè¦ä½ èƒ½è®¡ç®—å‡ºåˆé€‚çš„è·ç¦»å’Œè§’åº¦å®é™…ä¸Šéƒ½æ²¡æœ‰é—®é¢˜ã€‚</p><p>æˆ‘ä»¬ä¼ å…¥é¡¶ç‚¹çš„é¢œè‰²å’Œä½ç½®ä¿¡æ¯ï¼Œä»¥åŠå®ƒçš„<a href="https://en.wikipedia.org/wiki/Normal_(geometry)" target="_blank" rel="noopener">æ³•çº¿</a>ã€‚æˆ‘ä»¬ä¼šå°†æœ€ç»ˆçš„é¢œè‰²ä¼ å…¥ç‰‡æ®µç€è‰²å™¨ï¼Œå®ƒå°†åœ¨é¡¶ç‚¹ä¹‹é—´æ’å€¼ï¼Œè¿™ä¹Ÿè¢«ç§°ä¸º<a href="https://en.wikipedia.org/wiki/Gouraud_shading" target="_blank" rel="noopener">Gouraudç€è‰²æ³•</a>ã€‚</p><p>è®©æˆ‘ä»¬æ¥çœ‹çœ‹ç€è‰²å™¨æ¯ä¸€éƒ¨åˆ†çš„æ„ä¹‰ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†é¡¶ç‚¹è½¬æ¢æˆçœ¼ç›ç©ºé—´ï¼ˆç›¸å¯¹äºç›¸æœºè§†è§’ï¼‰</span></span><br><span class="line"><span class="string">"   vec3 modelViewVertex = vec3(u_MVMatrix * a_Position);                \n"</span></span><br></pre></td></tr></table></div></figure><p>å› ä¸ºæˆ‘ä»¬æ˜¯åœ¨çœ¼ç›ç©ºé—´è§‚å¯Ÿå…‰æºä½ç½®ï¼Œæˆ‘ä»¬è½¬æ¢å½“å‰çš„é¡¶ç‚¹ä½ç½®åˆ°çœ¼ç›ç©ºé—´çš„åæ ‡ç³»ä¸­ï¼Œå› æ­¤æˆ‘ä»¬èƒ½è®¡ç®—å‡ºå¯¹åº”çš„è·ç¦»å’Œè§’åº¦ã€‚</p><hr><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†æ³•çº¿çš„æ–¹å‘è½¬æ¢æˆçœ¼ç›ç©ºé—´ï¼ˆç›¸å¯¹äºç›¸æœºè§†è§’ï¼‰</span></span><br><span class="line"><span class="string">"   vec3 modelViewNormal = vec3(u_MVMatrix * vec4(a_Normal, 0.0));       \n"</span> +</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬ä¹Ÿéœ€è¦è½¬æ¢æ³•çº¿çš„æ–¹å‘ã€‚è¿™é‡Œæˆ‘ä»¬åªæ˜¯æƒ³ä¸Šé¢ä½ç½®ä¸€æ ·åšäº†ä¸ªå¸¸è§„ä¹˜æ³•ï¼Œä½†æ˜¯å¦‚æœmodelæˆ–viewçŸ©é˜µåšè¿‡æ—‹è½¬æˆ–å€¾æ–œï¼Œé‚£ä¹ˆå°†ä¸èƒ½å·¥ä½œï¼šæˆ‘ä»¬å®é™…ä¸Šéœ€è¦é€šè¿‡å°†æ³•çº¿ä¹˜ä»¥åŸå§‹çŸ©é˜µçš„åè½¬æ¥æ¶ˆé™¤å€¾æ–œæˆ–ç¼©æ”¾çš„å½±å“ã€‚<a href="https://web.archive.org/web/20150101061328/http://www.arcsynthesis.org/gltut/Illumination/Tut09%20Normal%20Transformation.html" target="_blank" rel="noopener">è¿™ä¸ªç½‘ç«™å¾ˆå¥½çš„è§£é‡Šäº†ä¸ºä»€ä¹ˆæˆ‘ä»¬å¿…é¡»è¿™ä¹ˆåš</a></p><hr><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†ç”¨äºå“€å‡</span></span><br><span class="line"><span class="string">"   float distance = length(u_LightPos - modelViewVertex);               \n"</span></span><br></pre></td></tr></table></div></figure><p>å¦‚å‰é¢æ•°å­¦éƒ¨åˆ†æ‰€ç¤ºï¼Œæˆ‘ä»¬éœ€è¦è¿™ä¸ªè·ç¦»å»è®¡ç®—å“€å‡ç³»æ•°</p><hr><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–ä»å…‰æºåˆ°é¡¶ç‚¹æ–¹å‘çš„å…‰çº¿å‘é‡</span></span><br><span class="line"><span class="string">"   vec3 lightVector = normalize(u_LightPos - modelViewVertex);          \n"</span></span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬ä¹Ÿéœ€è¦å…‰çº¿å‘é‡å»è®¡ç®—æœ—ä¼¯åå°„å› å­</p><hr><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¡ç®—å…‰çº¿çŸ¢é‡å’Œé¡¶ç‚¹æ³•çº¿çš„ç‚¹ç§¯ï¼Œå¦‚æœæ³•çº¿å’Œå…‰çº¿çŸ¢é‡æŒ‡å‘ç›¸åŒçš„æ–¹å‘ï¼Œé‚£ä¹ˆå®ƒå°†è·å¾—æœ€å¤§çš„ç…§æ˜</span></span><br><span class="line"><span class="string">"   float diffuse = max(dot(modelViewNormal, lightVector), 0.1);         \n"</span></span><br></pre></td></tr></table></div></figure><p>è¿™ä¸ä¸Šé¢çš„æ•°å­¦éƒ¨åˆ†ç›¸åŒï¼Œåªæ˜¯åœ¨OpenGL ES 2ç€è‰²å™¨ä¸­å®Œæˆã€‚åé¢çš„0.1æ˜¯ä¸€ç§éå¸¸ä¾¿å®œçš„ç¯å¢ƒç…§æ˜æ–¹å¼ï¼ˆæœ€å°å€¼å°†è¢«é™åˆ¶åœ¨0.1ï¼‰ã€‚</p><hr><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ®è·ç¦»å“€å‡å…‰çº¿</span></span><br><span class="line"><span class="string">"   diffuse = diffuse * (1.0 / (1.0 + (0.25 * distance * distance)));    \n"</span></span><br></pre></td></tr></table></div></figure><p>è¿™é‡Œå’Œä¸Šé¢çš„æ•°å­¦éƒ¨åˆ†ç•¥æœ‰ä¸åŒã€‚æˆ‘ä»¬å°†è·ç¦»çš„å¹³æ–¹ç¼©æ”¾0.25ä»¥æŠ‘åˆ¶è¡°å‡çš„æ•ˆåº”ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜å°†ä¿®æ”¹çš„è·ç¦»åŠ 1ï¼Œè¿™æ ·å½“å…‰æºéå¸¸æ¥è¿‘ç‰©ä½“æ—¶æˆ‘ä»¬å°±ä¸ä¼šè¿‡é¥±å’Œï¼ˆå¦åˆ™ï¼Œå½“è·ç¦»å°äº1æ—¶ï¼Œè¯¥ç­‰å¼å®é™…ä¸Šå›ç…§äº®å…‰æºè€Œä¸æ˜¯å“€å‡å®ƒï¼‰ã€‚</p><hr><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†é¢œè‰²ä¹˜ä»¥äº®åº¦ï¼Œå®ƒå°†è¢«æ’å…¥ä¸‰è§’å½¢ä¸­</span></span><br><span class="line"><span class="string">"   v_Color = a_Color * diffuse;                                         \n"</span> +</span><br><span class="line"><span class="comment">// gl_Positionæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ç”¨æ¥å­˜å‚¨æœ€ç»ˆçš„ä½ç½®</span></span><br><span class="line"><span class="comment">// å°†é¡¶ç‚¹ä¹˜ä»¥çŸ©é˜µå¾—åˆ°æ ‡å‡†åŒ–å±å¹•åæ ‡çš„æœ€ç»ˆç‚¹</span></span><br><span class="line"><span class="string">"   gl_Position = u_MVPMatrix * a_Position;                              \n"</span></span><br></pre></td></tr></table></div></figure><p>å½“æˆ‘ä»¬æœ‰äº†æœ€ç»ˆçš„å…‰è‰²ï¼Œæˆ‘ä»¬å°†å®ƒä¹˜ä»¥é¡¶ç‚¹çš„é¢œè‰²å¾—åˆ°æœ€ç»ˆè¾“å‡ºçš„é¢œè‰²ï¼Œç„¶åæˆ‘ä»¬å°†è¿™ä¸ªé¡¶ç‚¹çš„ä½ç½®æŠ•å½±åˆ°å±å¹•ä¸Šã€‚</p><h4 id="åƒç´ ç€è‰²å™¨">åƒç´ ç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Two#åƒç´ ç€è‰²å™¨"></a></h4><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> String fragmentShader =</span><br><span class="line">        <span class="string">"precision mediump float;       \n"</span> + <span class="comment">// æˆ‘ä»¬å°†é»˜è®¤ç²¾åº¦è®¾ç½®ä¸ºä¸­ç­‰ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç‰‡æ®µç€è‰²å™¨ä¸­çš„é«˜ç²¾åº¦</span></span><br><span class="line">                <span class="string">"varying vec4 v_Color;          \n"</span> + <span class="comment">// è¿™æ˜¯ä»ä¸‰è§’å½¢æ¯ä¸ªç‰‡æ®µå†…æ’çš„é¡¶ç‚¹ç€è‰²å™¨çš„é¢œè‰²</span></span><br><span class="line">                <span class="string">"void main()                    \n"</span> + <span class="comment">// ç‰‡æ®µç€è‰²å™¨å…¥å£</span></span><br><span class="line">                <span class="string">"&#123;                              \n"</span> +</span><br><span class="line">                <span class="string">"   gl_FragColor = v_Color;     \n"</span> + <span class="comment">// ç›´æ¥å°†é¢œè‰²ä¼ é€’</span></span><br><span class="line">                <span class="string">"&#125;                              \n"</span>;</span><br></pre></td></tr></table></div></figure><p>å› ä¸ºæˆ‘ä»¬æ˜¯åœ¨æ¯ä¸ªé¡¶ç‚¹çš„åŸºç¡€ä¸Šè®¡ç®—å…‰ï¼Œæˆ‘ä»¬çš„ç‰‡æ®µç€è‰²å™¨å’Œ<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">ä¸ŠèŠ‚è¯¾</a>ä¸€æ ·ï¼Œæˆ‘ä»¬æ‰€åšçš„æ˜¯å°†é¢œè‰²ç›´æ¥ä¼ è¿‡å»ã€‚åœ¨ä¸‹èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ æ¯åƒç´ ç…§æ˜ã€‚</p><h2 id="æ¯é¡¶ç‚¹ç…§æ˜å’Œæ¯åƒç´ ç…§æ˜">æ¯é¡¶ç‚¹ç…§æ˜å’Œæ¯åƒç´ ç…§æ˜<a href="post/Learn-OpenGL-Lesson-Two#æ¯é¡¶ç‚¹ç…§æ˜å’Œæ¯åƒç´ ç…§æ˜"></a></h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬çš„å…³æ³¨ç‚¹åœ¨å®ç°æ¯é¡¶ç‚¹ç…§æ˜ã€‚å¯¹äºå…·æœ‰å…‰æ»‘è¡¨é¢çš„ç‰©ä½“ï¼ˆå¦‚åœ°å½¢ï¼‰ï¼Œæˆ–å…·æœ‰è®¸å¤šä¸‰è§’å½¢çš„ç‰©ä½“çš„æ¼«åå°„ï¼Œè¿™é€šå¸¸æ˜¯è¶³å¤Ÿäº†ã€‚ç„¶è€Œï¼Œå½“æ‚¨çš„ç‰©ä½“æ²¡æœ‰åŒ…å«è®¸å¤šé¡¶ç‚¹æ—¶ï¼ˆä¾‹å¦‚æˆ‘ä»¬çš„åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­çš„æ­£æ–¹ä½“ï¼‰ï¼Œæˆ–è€…æœ‰å°–è§’ï¼Œé¡¶ç‚¹å…‰ç…§å¯èƒ½ä¼šå¯¼è‡´ä¼ªå½±ï¼Œå› ä¸ºäº®åº¦åœ¨å¤šè¾¹å½¢ä¸Šçº¿æ€§æ’å€¼ï¼›å½“é•œé¢é«˜å…‰æ·»åŠ åˆ°å›¾åƒæ—¶ï¼Œè¿™äº›ä¼ªå½±ä¹Ÿä¼šå˜å¾—æ›´åŠ æ˜æ˜¾ã€‚æ›´å¤šå…³äº<a href="https://en.wikipedia.org/wiki/Gouraud_shading" target="_blank" rel="noopener">Gouraudç€è‰²æ³•</a>çš„Wikiæ–‡ç« </p><h2 id="æ­£æ–¹ä½“çš„æ„é€ ">æ­£æ–¹ä½“çš„æ„é€ <a href="post/Learn-OpenGL-Lesson-Two#æ­£æ–¹ä½“çš„æ„é€ "></a></h2><p>åœ¨ç¬¬ä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†ä½ç½®å’Œé¢œè‰²å±æ€§æ‰“åŒ…åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œä½†æ˜¯OpengGL ES 2ä¹Ÿå…è®¸è®©æˆ‘ä»¬å°†å±æ€§å•ç‹¬å­˜æ”¾ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//X, Y, Z</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">float</span>[] cubePositionData = &#123;</span><br><span class="line">        <span class="comment">// åœ¨OpenGLï¼Œé€†æ—¶é’ˆç»•ç»„ï¼ˆä¸‹é¢çš„ç‚¹äº‹é€†æ—¶é’ˆé¡ºåºï¼‰æ˜¯é»˜è®¤çš„ã€‚</span></span><br><span class="line">        <span class="comment">// è¿™æ„å‘³ç€å½“æˆ‘ä»¬åœ¨è§‚å¯Ÿä¸€ä¸ªä¸‰è§’å½¢æ—¶ï¼Œå¦‚æœè¿™äº›ç”µè§†é€†æ—¶é’ˆçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ­£åœ¨çœ‹"å‰é¢"ï¼Œå¦‚æœä¸æ˜¯æˆ‘ä»¬åˆ™æ­£åœ¨çœ‹èƒŒé¢</span></span><br><span class="line">        <span class="comment">// OpenGLæœ‰ä¸€ä¸ªä¼˜åŒ–ï¼Œæ‰€æœ‰èƒŒé¢çš„ä¸‰è§’å½¢éƒ½ä¼šè¢«å‰”é™¤ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸ä»£è¡¨ä¸€ä¸ªç‰©ä½“çš„èƒŒé¢ï¼Œæ— è®ºå¦‚ä½•éƒ½ä¸å¯è§</span></span><br><span class="line">        <span class="comment">// æ­£é¢</span></span><br><span class="line">        -<span class="number">1.0F</span>, <span class="number">1.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        -<span class="number">1.0F</span>, -<span class="number">1.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">1.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        -<span class="number">1.0F</span>, -<span class="number">1.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, -<span class="number">1.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">1.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Rï¼ŒGï¼ŒBï¼ŒA</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">float</span>[] cubeColorData = &#123;</span><br><span class="line">        <span class="comment">// æ­£é¢çº¢è‰²</span></span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure><h2 id="æ–°çš„OpenGL-flag">æ–°çš„OpenGL flag<a href="post/Learn-OpenGL-Lesson-Two#æ–°çš„OpenGL-flag"></a></h2><p>æˆ‘ä»¬è¿˜ä½¿ç”¨äº†<code>glEnable()</code>è°ƒç”¨å¯ç”¨äº†å‰”é™¤å’Œæ·±åº¦ç¼“å†²ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨å‰”é™¤å»æ‰èƒŒé¢</span></span><br><span class="line">GLES20.glEnable(GLES20.GL_CULL_FACE);</span><br><span class="line"><span class="comment">// å¯ç”¨æ·±åº¦æµ‹è¯•</span></span><br><span class="line">GLES20.glEnable(GLES20.GL_DEPTH_TEST);</span><br></pre></td></tr></table></div></figure><p>ä½œä¸ºä¼˜åŒ–ï¼Œæ‚¨å¯ä»¥å‘Šè¯‰OpenGLå‰”é™¤ç‰©ä½“èƒŒé¢çš„ä¸‰è§’å½¢ã€‚å½“æˆ‘ä»¬å®šä¹‰æ­£æ–¹ä½“æ—¶ï¼Œæˆ‘ä»¬è¿˜å®šä¹‰äº†æ¯ä¸ªä¸‰è§’å½¢çš„ä¸‰ä¸ªç‚¹ï¼Œä»¥ä¾¿å½“æˆ‘ä»¬åœ¨æŸ¥çœ‹æ­£é¢çš„æ—¶å€™æ˜¯é€†æ—¶é’ˆçš„ã€‚å½“æˆ‘ä»¬ç¿»è½¬ä¸‰è§’å½¢ä»¥ä¾¿æˆ‘ä»¬åˆ°èƒŒé¢æ—¶ï¼Œè¿™äº›ç‚¹å°†ä¼šé¡ºæ—¶é’ˆå±•ç¤ºã€‚<br>æ‚¨åªèƒ½åŒæ—¶çœ‹åˆ°ä¸€ä¸ªæ­£æ–¹ä½“çš„ä¸‰ä¸ªé¢ï¼Œæ‰€ä»¥è¿™ä¸ªä¼˜åŒ–å‘Šè¯‰OpenGLä¸è¦æµªè´¹æ—¶é—´å»ç»˜åˆ¶èƒŒé¢çš„ä¸‰è§’å½¢ã€‚</p><p>ä¹‹åå½“æˆ‘ä»¬ç»˜åˆ¶é€æ˜çš„ç‰©ä½“æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å…³é—­å‰”é™¤ï¼Œç„¶åç‰©ä½“èƒŒé¢å°†ä¼šå˜å¾—å¯è§ã€‚</p><p>æˆ‘ä»¬è¿˜å¼€å¯äº†<a href="https://en.wikipedia.org/wiki/Z-buffering" target="_blank" rel="noopener">æ·±åº¦æµ‹è¯•</a>ã€‚å¦‚æœä½ æ€»æ˜¯ä»åé¢å‘å‰é¢ç»˜åˆ¶ç‰©ä½“ï¼Œé‚£ä¹ˆæ·±åº¦æµ‹è¯•ç»éå¿…è¦ï¼Œä½†æ˜¯é€šè¿‡å¯ç”¨å®ƒæ‚¨ä¸ä»…ä¸éœ€è¦æ‹…å¿ƒç»˜åˆ¶é¡ºåºï¼ˆå°½ç®¡å¦‚æœä½ å…ˆç”»æœ€è¿‘çš„ç‰©ä½“æ¸²æŸ“ä¼šæ›´å¿«ï¼‰ï¼Œä¸€äº›æ˜¾å¡ä¹Ÿå°†è¿›è¡Œä¼˜åŒ–ï¼Œé€šè¿‡èŠ±è´¹æ›´å°‘çš„æ—¶é—´ç»˜åˆ¶åƒç´ æ¥åŠ é€Ÿæ¸²æŸ“ã€‚</p><h2 id="åŠ è½½ç€è‰²å™¨ç¨‹åºçš„ä¿®æ”¹">åŠ è½½ç€è‰²å™¨ç¨‹åºçš„ä¿®æ”¹<a href="post/Learn-OpenGL-Lesson-Two#åŠ è½½ç€è‰²å™¨ç¨‹åºçš„ä¿®æ”¹"></a></h2><p>å› ä¸ºåœ¨OpenGLä¸­åŠ è½½ç€è‰²å™¨ç¨‹åºçš„æ­¥éª¤å¤§è‡´ç›¸åŒï¼Œè¿™äº›æ­¥éª¤å¯ä»¥å¾ˆå®¹æ˜“çš„é‡æ„ä¸ºä¸€ä¸ªå•ç‹¬çš„æ–¹æ³•ã€‚æˆ‘ä»¬è¿˜æ·»åŠ äº†ä»¥ä¸‹è°ƒç”¨æ¥æ£€ç´¢è°ƒè¯•ä¿¡æ¯ï¼Œä»¥é˜²ç¼–è¯‘/é“¾æ¥å¤±è´¥ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GLES20.glGetProgramInfoLog(programHandle);</span><br><span class="line">GLES20.glGetShaderInfoLog(shaderHandle);</span><br></pre></td></tr></table></div></figure><h2 id="å…‰ç‚¹çš„é¡¶ç‚¹å’Œç€è‰²ç¨‹åº">å…‰ç‚¹çš„é¡¶ç‚¹å’Œç€è‰²ç¨‹åº<a href="post/Learn-OpenGL-Lesson-Two#å…‰ç‚¹çš„é¡¶ç‚¹å’Œç€è‰²ç¨‹åº"></a></h2><p>è¿™ä¸ªæ–°çš„é¡¶ç‚¹å’Œç€è‰²å™¨ç¨‹åºç»˜åˆ¶åœ¨å±å¹•ä¸Šä»£è¡¨å½“å‰å…‰æºçš„ä½ç½®ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªç®€å•çš„ç€è‰²ç¨‹åº</span></span><br><span class="line"><span class="keyword">final</span> String pointVertexShader =</span><br><span class="line">        <span class="string">"uniform mat4 u_MVPMatrix;                  \n"</span> +</span><br><span class="line">        <span class="string">"attribute vec4 a_Position;                 \n"</span> +</span><br><span class="line">        <span class="string">"void main()                                \n"</span> +</span><br><span class="line">        <span class="string">"&#123;                                          \n"</span> +</span><br><span class="line">        <span class="string">"   gl_Position = u_MVPMatrix * a_Position; \n"</span> +</span><br><span class="line">        <span class="string">"   gl_PointSize = 5.0;                     \n"</span> +</span><br><span class="line">        <span class="string">"&#125;                                          \n"</span>;</span><br><span class="line"><span class="keyword">final</span> String pointFragmentShader =</span><br><span class="line">        <span class="string">"precision mediump float;                   \n"</span> +</span><br><span class="line">        <span class="string">"void main()                                \n"</span> +</span><br><span class="line">        <span class="string">"&#123;                                          \n"</span> +</span><br><span class="line">        <span class="string">"   gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0) \n"</span> +</span><br><span class="line">        <span class="string">"&#125;                                          \n"</span>;</span><br></pre></td></tr></table></div></figure><p>è¿™ä¸ªç€è‰²å™¨ç±»ä¼¼äºç¬¬ä¸€è¯¾çš„ç®€å•ç€è‰²å™¨ï¼Œè¿™é‡Œæœ‰ä¸ªæ–°çš„æˆå‘˜<code>gl_PointSize</code>ï¼Œç›´æ¥å›ºå®šå®ƒçš„å€¼ä¸º5.0ï¼Œè¿™æ˜¯ç‚¹çš„åƒç´ å°ºå¯¸ã€‚å½“æˆ‘ä»¬ä½¿ç”¨<code>GLES20.GL_POINTS</code>æ¨¡å¼ç»˜åˆ¶è¿™ä¸ªç‚¹çš„æ—¶å€™å®ƒä¼šè¢«ä½¿ç”¨ã€‚æˆ‘ä»¬ä¹Ÿç›´æ¥è®¾ç½®äº†å®ƒçš„æ˜¾ç¤ºé¢œè‰²ä¸ºç™½è‰²ã€‚</p><h2 id="è¿›ä¸€æ­¥ç»ƒä¹ ">è¿›ä¸€æ­¥ç»ƒä¹ <a href="post/Learn-OpenGL-Lesson-Two#è¿›ä¸€æ­¥ç»ƒä¹ "></a></h2><ul><li>å°è¯•åˆ é™¤â€œè¿‡æ¸¡é¥±å’Œâ€çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆ</li><li>è¿™é‡Œçš„ç…§æ˜æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä½ èƒ½å‘ç°æ˜¯ä»€ä¹ˆå—ï¼Ÿæç¤ºï¼šæˆ‘ä»¬åšç¯å¢ƒç…§æ˜çš„æ–¹å¼çš„ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Œä»¥åŠalphaä¼šæ”¾ç”Ÿä»€ä¹ˆï¼Ÿ</li><li>å¦‚æœå°†<code>gl_PointSize</code>æ·»åŠ åˆ°æ­£æ–¹ä½“ç€è‰²å™¨å¹¶ä½¿ç”¨<code>GL_POINTS</code>ç»˜åˆ¶å®ƒä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</li></ul><h2 id="è¿›ä¸€æ­¥é˜…è¯»">è¿›ä¸€æ­¥é˜…è¯»<a href="post/Learn-OpenGL-Lesson-Two#è¿›ä¸€æ­¥é˜…è¯»"></a></h2><ul><li><a href="https://www.opengl.org/sdk/docs/tutorials/ClockworkCoders/lighting.php" target="_blank" rel="noopener">Clockworkcodersæ•™ç¨‹ï¼šæ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="http://www.lighthouse3d.com/tutorials/glsl-12-tutorial/the-normal-matrix/" target="_blank" rel="noopener">Lighthouse3d.comï¼šæ³•çº¿çŸ©é˜µ</a></li><li><a href="https://web.archive.org/web/20150101061328/http://www.arcsynthesis.org/gltut/Illumination/Tut09%20Normal%20Transformation.html" target="_blank" rel="noopener">arcsynthesis.org: OpenGLæ•™ç¨‹ï¼šæ³•çº¿è½¬æ¢</a></li><li><a href="http://glprogramming.com/red/chapter05.html" target="_blank" rel="noopener">OpenGLç¼–ç¨‹æŒ‡å—ï¼š5ç«  ç…§æ˜</a></li></ul><p>åœ¨ç¼–å†™æœ¬æ•™ç¨‹æ—¶ï¼Œä¸Šé¢çš„è¿›ä¸€æ­¥é˜…è¯»éƒ¨åˆ†å¯¹æˆ‘æ¥è¯´æ˜¯éå¸¸å®è´µçš„èµ„æºï¼Œå› æ­¤æˆ‘å¼ºçƒˆå»ºè®®æ‚¨é˜…è¯»å®ƒä»¬ä»¥è·å¾—æ›´å¤šçš„ä¿¡æ¯å’Œè§£é‡Šã€‚</p><h2 id="æ•™ç¨‹ç›®å½•">æ•™ç¨‹ç›®å½•<a href="post/Learn-OpenGL-Lesson-Two#æ•™ç¨‹ç›®å½•"></a></h2><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five">OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six">OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven">OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVOBï¼‰</a></li></ul><h2 id="æ‰“åŒ…æ•™æ">æ‰“åŒ…æ•™æ<a href="post/Learn-OpenGL-Lesson-Two#æ‰“åŒ…æ•™æ"></a></h2><p>å¯ä»¥åœ¨Githubä¸‹è½½æœ¬è¯¾ç¨‹æºä»£ç ï¼š<a href="https://github.com/learnopengles/Learn-OpenGLES-Tutorials" target="_blank" rel="noopener">ä¸‹è½½é¡¹ç›®</a><br>æœ¬è¯¾çš„ç¼–è¯‘ç‰ˆæœ¬ä¹Ÿå¯ä»¥å†Androidå¸‚åœºä¸‹ï¼š<a href="https://market.android.com/details?id=com.learnopengles.android" target="_blank" rel="noopener">google play ä¸‹è½½apk</a><br>â€œæˆ‘â€ä¹Ÿç¼–è¯‘äº†ä¸ªapkï¼Œæ–¹ä¾¿å¤§å®¶ä¸‹è½½ï¼š<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">github download</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ–‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡æ ‡é¢˜ï¼šOpenGL Android Lesson One: Getting Started&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.learnopengles.com/android-lesson-two-ambient-and-diffuse-lighting/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.learnopengles.com/android-lesson-two-ambient-and-diffuse-lighting/&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/categories/OpenGL/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/tags/OpenGL/"/>
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</title>
    <link href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One/index.html"/>
    <id>https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One/index.html</id>
    <published>2019-01-21T08:10:46.000Z</published>
    <updated>2019-08-09T16:28:55.133Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»è¯‘æ–‡</p></blockquote><p>åŸæ–‡æ ‡é¢˜ï¼šOpenGL Android Lesson One: Getting Started<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.learnopengles.com/android-lesson-one-getting-started/" target="_blank" rel="noopener">http://www.learnopengles.com/android-lesson-one-getting-started/</a><br><a id="more"></a></p><hr><p>è¿™æ˜¯åœ¨Androidä¸­ä½¿ç”¨OpenGL ES2çš„ç¬¬ä¸€ä¸ªæ•™ç¨‹ã€‚è¿™ä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†ä¸€æ­¥ä¸€æ­¥è·Ÿéšä»£ç ï¼Œå­¦ä¹ å¦‚ä½•åˆ›å»ºä¸€ä¸ªOpenGL ES 2å¹¶ç»˜åˆ¶åˆ°å±å¹•ä¸Šã€‚<br>æˆ‘ä»¬è¿˜å°†äº†è§£ä»€ä¹ˆæ˜¯ç€è‰²å™¨ï¼Œå®ƒä»¬å¦‚ä½•å·¥ä½œï¼Œä»¥åŠæ€æ ·ä½¿ç”¨çŸ©é˜µå°†åœºæ™¯è½¬æ¢ä¸ºæ‚¨åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„å›¾åƒã€‚æœ€åï¼Œæ‚¨éœ€è¦åœ¨æ¸…å•æ–‡ä»¶ä¸­æ·»åŠ æ‚¨æ­£åœ¨ä½¿ç”¨OpenGL ES 2çš„è¯´æ˜ï¼Œä»¥å‘ŠçŸ¥Androidåº”ç”¨å¸‚åœºæ”¯æŒçš„è®¾å¤‡å¯è§ã€‚</p><h1 id="å…¥é—¨">å…¥é—¨<a href="post/Learn-OpenGL-Lesson-One#å…¥é—¨"></a></h1><p>æˆ‘ä»¬å°†è¿‡ä¸€é“ä¸‹é¢æ‰€æœ‰çš„ä»£ç å¹¶ä¸”è§£é‡Šæ¯ä¸€éƒ¨åˆ†çš„ä½œç”¨ã€‚æ‚¨å¯ä»¥è·Ÿç€æ‹·è´æ¯ä¸€å¤„çš„ä»£ç ç‰‡æ®µæ¥åˆ›å»ºæ‚¨è‡ªå·±çš„é¡¹ç›®ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨æ–‡ç« æœ«å°¾ä¸‹è½½è¿™ä¸ªå·²å®Œæˆçš„é¡¹ç›®ã€‚<br>åœ¨å¼€å‘å·¥å…·ï¼ˆå¦‚ï¼šAndroid Studioï¼‰ä¸­åˆ›å»ºæ‚¨çš„Androidé¡¹ç›®ï¼Œåå­—ä¸é‡è¦ï¼Œè¿™é‡Œç”±äºè¿™ä¸ªè¯¾ç¨‹æˆ‘å°†<code>MainActivity</code>æ›´åä¸º<code>LessonOneActivity</code>ã€‚</p><blockquote><p>æˆ‘ä»¬æ¥çœ‹è¿™æ®µä»£ç ï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** ä¿ç•™å¯¹GLSurfaceViewçš„å¼•ç”¨*/</span></span><br><span class="line"><span class="keyword">private</span> GLSurfaceView mGLSurfaceView;</span><br></pre></td></tr></table></div></figure><p>è¿™ä¸ª<a href="http://developer.android.com/reference/android/opengl/GLSurfaceView.html" target="_blank" rel="noopener">GLSurfaceView</a>æ˜¯ä¸€ä¸ªç‰¹åˆ«çš„Viewï¼Œå®ƒä¸ºæˆ‘ä»¬ç®¡ç†OpenGLç•Œé¢å¹¶ä¸”å°†å®ƒç»˜åˆ¶åœ¨Android Viewç³»ç»Ÿã€‚å®ƒè¿˜æ·»åŠ äº†è®¸å¤šåŠŸèƒ½ï¼Œä½¿å…¶æ›´æ˜“äºä½¿ç”¨OpenGLï¼ŒåŒ…æ‹¬ä¸‹é¢ç­‰ç­‰ï¼š</p><ul><li>å®ƒä¸ºOpenGLæä¾›ä¸€ä¸ªä¸“ç”¨çš„ç€è‰²çº¿ç¨‹ï¼Œå› æ­¤ä¸»çº¿ç¨‹ä¸ä¼šåœæ‡ˆ</li><li>å®ƒæ”¯æŒè¿ç»­æˆ–æŒ‰éœ€æ¸²æŸ“</li><li>å®ƒä½¿ç”¨<a href="https://en.wikipedia.org/wiki/EGL_(API)" target="_blank" rel="noopener">EGL</a> (OpenGLå’Œåº•å±‚ç³»ç»Ÿçª—å£ä¹‹é—´çš„æ¥å£)æ¥å¤„ç†å±å¹•è®¾ç½®</li></ul><blockquote><p><code>GLSurfaceView</code>ä½¿å¾—åœ¨Androidä¸­è®¾ç½®å’Œä½¿ç”¨OpenGLç›¸å¯¹è½»æ¾</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    mGLSurfaceView = <span class="keyword">new</span> GLSurfaceView(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//æ£€æµ‹ç³»ç»Ÿæ˜¯å¦æ”¯æŒOpenGL ES 2.0</span></span><br><span class="line">    <span class="keyword">final</span> ActivityManager activityManager = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);</span><br><span class="line">    <span class="keyword">final</span> ConfigurationInfo configurationInfo = activityManager.getDeviceConfigurationInfo();</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">boolean</span> supportsEs2 = configurationInfo.reqGlEsVersion &gt;= <span class="number">0x20000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (supportsEs2) &#123;</span><br><span class="line">        <span class="comment">// è¯·æ±‚ä¸€ä¸ªOpenGL ES 2.0å…¼å®¹çš„ä¸Šä¸‹æ–‡</span></span><br><span class="line">        mGLSurfaceView.setEGLContextClientVersion(<span class="number">2</span>);</span><br><span class="line">        <span class="comment">// è®¾ç½®æˆ‘ä»¬çš„Demoæ¸²æŸ“å™¨ï¼Œå®šä¹‰åœ¨åé¢è®²</span></span><br><span class="line">        mGLSurfaceView.setRenderer(<span class="keyword">new</span> LessonOneRenderer());</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ‚¨æƒ³åŒæ—¶æ”¯æŒES 1.0å’Œ2.0çš„è¯ï¼Œè¿™é‡Œæ‚¨å¯ä»¥åˆ›å»ºå…¼å®¹OpenGL ES 1.0çš„æ¸²æŸ“å™¨</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    setContentView(mGLSurfaceView);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>åœ¨<code>onCreate()</code>æ–¹æ³•ä¸­æ˜¯æˆ‘ä»¬åˆ›å»ºOpenGLä¸Šä¸‹æ–‡ä»¥åŠä¸€åˆ‡å¼€å§‹å‘ç”Ÿçš„é‡è¦éƒ¨åˆ†ã€‚<br>åœ¨æˆ‘ä»¬çš„<code>onCreate()</code>æ–¹æ³•ä¸­,åœ¨è°ƒç”¨<code>super.onCreate()</code>åæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†<code>GLSurfaceView</code>å®ä¾‹ã€‚<br>ç„¶åæˆ‘ä»¬éœ€è¦å¼„æ¸…æ¥šç³»ç»Ÿæ˜¯å¦æ”¯æŒOpenGL ES 2.ä¸ºæ­¤ï¼Œæˆ‘ä»¬è·å¾—ä¸€ä¸ª<code>ActivityManager</code>å®ä¾‹ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä¸å…¨å±€ç³»ç»ŸçŠ¶æ€è¿›è¡Œäº¤äº’ã€‚<br>ç„¶åæˆ‘ä»¬ä½¿ç”¨å®ƒè·å–è®¾å¤‡é…ç½®ä¿¡æ¯ï¼Œå®ƒå°†å‘Šè¯‰æˆ‘ä»¬è®¾å¤‡æ˜¯å¦æ”¯æŒOpenGL ES 2ã€‚<br>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¼ å…¥ä¸åŒçš„æ¸²æŸ“å™¨æ¥æ”¯æŒOpenGL ES 1.xï¼Œå°½ç®¡å› ä¸ºAPIä¸åŒï¼Œæˆ‘ä»¬éœ€è¦ç¼–å†™ä¸åŒçš„ä»£ç ã€‚å¯¹äºæœ¬è¯¾æˆ‘ä»¬ä»…ä»…å…³æ³¨æ”¯æŒOpenGL ES 2ã€‚</p><p>ä¸€æ—¦æˆ‘ä»¬çŸ¥é“è®¾å¤‡æ˜¯å¦æ”¯æŒOpenGL ES 2ï¼Œæˆ‘ä»¬å‘Šè¯‰<code>GLSurfaceView</code>å…¼å®¹OpenGL ES 2ï¼Œç„¶åä¼ å…¥æˆ‘ä»¬çš„è‡ªå®šä¹‰æ¸²æŸ“å™¨ã€‚æ— è®ºä½•æ—¶è°ƒæ•´ç•Œé¢æˆ–ç»˜åˆ¶æ–°å¸§ï¼Œç³»ç»Ÿéƒ½ä¼šè°ƒç”¨æ­¤æ¸²æŸ“å™¨ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬è°ƒç”¨<code>setContentView()</code>è®¾ç½®GLSurfaceViewä¸ºæ˜¾ç¤ºå†…å®¹ï¼Œå®ƒå‘Šè¯‰Androidè¿™ä¸ªæ´»åŠ¨å†…å®¹å› è¯¥è¢«æˆ‘ä»¬çš„OpenGLç•Œé¢å¡«å……ã€‚è¦å…¥é—¨OpenGLï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onResume();</span><br><span class="line">    <span class="comment">//Activity å¿…é¡»åœ¨onResumeä¸­è°ƒç”¨GLSurfaceViewçš„onResumeæ–¹æ³•</span></span><br><span class="line">    mGLSurfaceView.onResume();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onPause();</span><br><span class="line">    <span class="comment">//Activity å¿…é¡»åœ¨onPauseä¸­è°ƒç”¨GLSurfaceViewçš„onPauseæ–¹æ³•</span></span><br><span class="line">    mGLSurfaceView.onPause();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><code>GLSurfaceView</code>è¦æ±‚æˆ‘ä»¬åœ¨Activity<code>onResume()</code>å’Œ<code>onPause()</code>çš„çˆ¶æ–¹æ³•è¢«è°ƒç”¨ååˆ†åˆ«è°ƒç”¨å®ƒçš„<code>onResume()</code>å’Œ<code>onPause()</code>æ–¹æ³•ã€‚æˆ‘ä»¬åœ¨æ­¤æ·»åŠ è°ƒç”¨ä»¥å®Œå–„æˆ‘ä»¬çš„Activityã€‚</p><h2 id="å¯è§†åŒ–3Dä¸–ç•Œ">å¯è§†åŒ–3Dä¸–ç•Œ<a href="post/Learn-OpenGL-Lesson-One#å¯è§†åŒ–3Dä¸–ç•Œ"></a></h2><p>åœ¨è¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ¥çœ‹æ€æ ·è®©OpenGL ES 2å·¥ä½œï¼Œä»¥åŠæˆ‘ä»¬å¦‚ä½•åœ¨å±å¹•ä¸Šç»˜åˆ¶ä¸œè¥¿ã€‚<br>åœ¨Activityä¸­æˆ‘ä»¬ä¼ å…¥è‡ªå®šä¹‰çš„<a href="http://developer.android.com/reference/android/opengl/GLSurfaceView.Renderer.html" target="_blank" rel="noopener">GLSurfaceView.Renderer</a>åˆ°<code>GLSurfaceView</code>ï¼Œå®ƒå°†åœ¨è¿™é‡Œå®šä¹‰ã€‚<br>è¿™ä¸ªæ¸²æŸ“å™¨æœ‰ä¸‰ä¸ªé‡è¦çš„æ–¹æ³•ï¼Œæ¯å½“ç³»ç»Ÿäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå®ƒä»¬å°†ä¼šè‡ªåŠ¨è¢«è°ƒç”¨ï¼š</p><blockquote><p><em>public void onSurfaceCreated(GL10 gl, EGLConfig config)</em></p></blockquote><p>å½“ç•Œé¢ç¬¬ä¸€æ¬¡è¢«åˆ›å»ºæ—¶è°ƒç”¨ï¼Œå¦‚æœæˆ‘ä»¬å¤±å»ç•Œé¢ä¸Šä¸‹æ–‡å¹¶ä¸”ä¹‹åç”±ç³»ç»Ÿé‡å»ºï¼Œä¹Ÿä¼šè¢«è°ƒç”¨ã€‚</p><blockquote><p><em>public void onSurfaceChanged(GL10 gl, int width, int height)</em></p></blockquote><p>æ¯å½“ç•Œé¢æ”¹å˜æ—¶è¢«è°ƒç”¨ï¼›ä¾‹å¦‚ï¼Œä»çºµå±åˆ‡æ¢åˆ°æ¨ªå±ï¼Œåœ¨åˆ›å»ºç•Œé¢åä¹Ÿä¼šè¢«è°ƒç”¨ã€‚</p><blockquote><p><em>public void onDrawFrame(GL10 gl)</em></p></blockquote><p>æ¯å½“ç»˜åˆ¶æ–°å¸§æ—¶è¢«è°ƒç”¨ã€‚</p><p>æ‚¨å¯èƒ½æ³¨æ„åˆ°<code>GL10</code>çš„å®ä¾‹è¢«ä¼ å…¥åå­—æ˜¯<code>gl</code>ã€‚å½“ä½¿ç”¨OpengGL ES 2ç»˜åˆ¶æ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨å®ƒï¼›<br>æˆ‘ä»¬ä½¿ç”¨<code>GLES20</code>ç±»çš„é™æ€æ–¹æ³•æ¥ä»£æ›¿ã€‚è¿™ä¸ª<code>GL10</code>å‚æ•°ä»…ä»…æ˜¯åœ¨è¿™é‡Œï¼Œå› ä¸ºç›¸åŒçš„æ¥å£è¢«ä½¿ç”¨åœ¨OpenGL ES 1.xã€‚</p><blockquote><p>åœ¨æˆ‘ä»¬çš„æ¸²æŸ“å™¨å¯ä»¥æ˜¾ç¤ºä»»ä½•å†…å®¹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æœ‰äº›ä¸œè¥¿å»æ˜¾ç¤ºã€‚åœ¨OpenGL ES 2ï¼Œæˆ‘ä»¬é€šè¿‡åˆ¶å®šæ•°å­—æ•°ç»„ä¼ é€’å†…å®¹ã€‚è¿™äº›æ•°å­—å¯ä»¥è¡¨ç¤ºä½ç½®ã€é¢œè‰²æˆ–ä»»ä½•æˆ‘ä»¬éœ€è¦çš„ã€‚åœ¨è¿™ä¸ªDemoä¸­ï¼Œæˆ‘ä»¬å°†æ˜¾ç¤ºä¸‰ä¸ªä¸‰è§’å½¢ã€‚</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°ç±»æˆå‘˜</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> FloatBuffer mTriangle1Verticels;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> FloatBuffer mTriangle2Verticels;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> FloatBuffer mTriangle3Verticels;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** æ¯ä¸ªFloatå¤šå°‘å­—èŠ‚*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mBytePerFloat = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆå§‹Modelæ•°æ®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LessonOneRenderer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¿™ä¸ªä¸‰è§’å½¢æ˜¯çº¢è‰²ï¼Œè“è‰²å’Œç»¿è‰²ç»„æˆ</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span>[] triangle1VerticesData = &#123;</span><br><span class="line">        <span class="comment">// X, Y, Z,</span></span><br><span class="line">        <span class="comment">// R, G, B, A</span></span><br><span class="line">        -<span class="number">0.5F</span>, -<span class="number">0.25F</span>, <span class="number">0.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line"></span><br><span class="line">        <span class="number">0.5F</span>, -<span class="number">0.25F</span>, <span class="number">0.0F</span>,</span><br><span class="line">        <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line"></span><br><span class="line">        <span class="number">0.0F</span>, <span class="number">0.559016994F</span>, <span class="number">0.0F</span>,</span><br><span class="line">        <span class="number">0.0F</span>, <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span></span><br><span class="line">    &#125;;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ç¼“å†²åŒº</span></span><br><span class="line">    mTriangle1Verticels = ByteBuffer.allocateDirect(triangle1VerticesData.length * mBytePerFloat).order(ByteOrder.nativeOrder()).asFloatBuffer();</span><br><span class="line">    ...</span><br><span class="line">    mTriangle1Verticels.put(triangle1VerticesData).position(<span class="number">0</span>);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>é‚£ä¹ˆï¼Œè¿™äº›æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿå¦‚æœæ‚¨æ›¾ç»ä½¿ç”¨è¿‡OpenGL 1ï¼Œ æ‚¨å¯èƒ½ä¼šä¹ æƒ¯è¿™æ ·åšï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">glBegin(GL_TRIANGLES);</span><br><span class="line">glVertex3f(-<span class="number">0.5f</span>, -<span class="number">0.25f</span>, <span class="number">0.0f</span>);</span><br><span class="line">glColor3f(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">...</span><br><span class="line">glEnd();</span><br></pre></td></tr></table></div></figure><p>è¿™ç§æ–¹æ³•åœ¨OpenGL ES 2ä¸­ä¸èµ·ä½œç”¨ã€‚æˆ‘ä»¬ä¸æ˜¯é€šè¿‡ä¸€å †æ–¹æ³•è°ƒç”¨æ¥å®šä¹‰ç‚¹ï¼Œè€Œæ˜¯å®šä¹‰ä¸€ä¸ªæ•°ç»„ã€‚è®©æˆ‘ä»¬å†æ¥çœ‹çœ‹æˆ‘ä»¬è¿™ä¸ªæ•°ç»„ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">float</span>[] triangle1VerticesData = &#123;</span><br><span class="line">                <span class="comment">// X, Y, Z,</span></span><br><span class="line">                <span class="comment">// R, G, B, A</span></span><br><span class="line">                -<span class="number">0.5f</span>, -<span class="number">0.25f</span>, <span class="number">0.0f</span>,</span><br><span class="line">                <span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">                ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure><p>ä¸Šé¢å±•ç¤ºçš„ä»£è¡¨ä¸‰è§’å½¢çš„ä¸€ä¸ªç‚¹ã€‚æˆ‘ä»¬å·²è®¾ç½®å¥½å‰ä¸‰ä¸ªæ•°å­—ä»£è¡¨ä½ç½®ï¼ˆX,Y,Zï¼‰ï¼Œéšåçš„å››ä¸ªæ•°å­—ä»£è¡¨é¢œè‰²ï¼ˆçº¢ï¼Œç»¿ï¼Œè“ï¼Œé€æ˜åº¦ï¼‰ã€‚<br>æ‚¨ä¸å¿…å¤ªæ‹…å¿ƒå¦‚ä½•å®šä¹‰è¿™ä¸ªæ•°ç»„ï¼›åªè¦è®°ä½å½“æˆ‘ä»¬æƒ³ç»˜åˆ¶ä¸œè¥¿åœ¨OpenGL ES 2æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä»¥å—çš„å½¢å¼ä¼ é€’æ•°æ®ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡ä¼ é€’ä¸€ä¸ªã€‚</p><h3 id="äº†è§£ç¼“å†²åŒº">äº†è§£ç¼“å†²åŒº<a href="post/Learn-OpenGL-Lesson-One#äº†è§£ç¼“å†²åŒº"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆå§‹åŒ–ç¼“å†²åŒº</span></span><br><span class="line">mTriangle1Verticels = ByteBuffer.allocateDirect(triangle1VerticesData.length * mBytePerFloat).order(ByteOrder.nativeOrder()).asFloatBuffer();</span><br><span class="line">...</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬åœ¨Androidä¸Šä½¿ç”¨Javaè¿›è¡Œç¼–ç ï¼Œä½†OpengGL ES 2åº•å±‚å®ç°å…¶å®ä½¿ç”¨Cè¯­è¨€ç¼–å†™çš„ã€‚<br>åœ¨æˆ‘ä»¬å°†æ•°æ®ä¼ é€’ç»™OpenGLä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶è½¬æ¢æˆå®ƒèƒ½ç†è§£çš„å½¢å¼ã€‚<br>Javaå’Œnativeç³»ç»Ÿå¯èƒ½ä¸ä¼šä»¥ç›¸åŒçš„é¡ºåºå­˜å‚¨å®ƒä»¬çš„å­—èŠ‚ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„ç¼“å†²ç±»å¹¶åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„<code>ByteBuffer</code>æ¥ä¿å­˜æˆ‘ä»¬çš„æ•°æ®ï¼Œå¹¶å‘Šè¯‰å®ƒä½¿ç”¨nativeå­—èŠ‚é¡ºåºå­˜å‚¨æ•°æ®ã€‚<br>ç„¶åæˆ‘ä»¬å°†å®ƒè½¬æ¢æˆ<code>FloatBuffer</code>ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥ä¿å­˜æµ®ç‚¹æ•°æ®ã€‚<br>æœ€åï¼Œæˆ‘ä»¬å°†æ•°ç»„å¤åˆ¶åˆ°ç¼“å†²åŒºã€‚</p><p>è¿™ä¸ªç¼“å†²åŒºçš„ä¸œè¥¿çœ‹èµ·æ¥å¯èƒ½å¾ˆæ··ä¹±ï¼Œå•è¯·è®°ä½ï¼Œåœ¨å°†æ•°æ®ä¼ é€’ç»™OpenGLä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€ä¸ªé¢å¤–çš„æ­¥éª¤ã€‚æˆ‘ä»¬ç°åœ¨çš„ç¼“å†²åŒºå·²å‡†å¤‡å¥½å¯ä»¥ç”¨äºå°†æ•°æ®ä¼ å…¥OpenGLã€‚</p><p><strong>å¦å¤–ï¼Œ<a href="https://issuetracker.google.com/issues/36921128" target="_blank" rel="noopener">floatç¼“å†²åŒºåœ¨Froyoä¸Šå¾ˆæ…¢</a>,åœ¨Gingerbreadä¸Šç¼“æ…¢ï¼Œå› æ­¤æ‚¨å¯èƒ½ä¸å¸Œæœ›ç»å¸¸æ›´æ¢å®ƒä»¬ã€‚</strong></p><h3 id="ç†è§£çŸ©é˜µ">ç†è§£çŸ©é˜µ<a href="post/Learn-OpenGL-Lesson-One#ç†è§£çŸ©é˜µ"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// new class å®šä¹‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å­˜å‚¨viewçŸ©é˜µã€‚å¯ä»¥è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªç›¸æœºï¼Œæˆ‘ä»¬é€šè¿‡ç›¸æœºå°†ä¸–ç•Œç©ºé—´è½¬æ¢ä¸ºçœ¼ç›ç©ºé—´</span></span><br><span class="line"><span class="comment"> * å®ƒå®šä½ç›¸å¯¹äºæˆ‘ä»¬çœ¼ç›çš„ä¸œè¥¿</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">float</span>[] mViewMatrix = <span class="keyword">new</span> <span class="keyword">float</span>[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSurfaceCreated</span><span class="params">(GL10 gl, EGLConfig config)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è®¾ç½®èƒŒæ™¯æ¸…ç†é¢œè‰²ä¸ºç°è‰²</span></span><br><span class="line">    GLES20.glClearColor(<span class="number">0.5F</span>, <span class="number">0.5F</span>, <span class="number">0.5F</span>, <span class="number">0.5F</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†çœ¼ç›æ”¾åˆ°åŸç‚¹ä¹‹å</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> eyeX = <span class="number">0.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> eyeY = <span class="number">0.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> eyeZ = <span class="number">1.5F</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æˆ‘ä»¬çš„çœ¼ç›æœ›å‘å“ª</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> lookX = <span class="number">0.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> lookY = <span class="number">0.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> lookZ = -<span class="number">5.0F</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®æˆ‘ä»¬çš„å‘é‡ï¼Œè¿™æ˜¯æˆ‘ä»¬æ‹¿ç€ç›¸æœºæ—¶å¤´æŒ‡å‘çš„æ–¹å‘</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> upX = <span class="number">0.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> upY = <span class="number">1.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> upZ = <span class="number">0.0F</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å…·ä½“åœºæ™¯ï¼šæŠŠæ‰‹æœºæ­£æ”¾æ¡Œé¢ä¸Šï¼Œç„¶åæˆ‘ä»¬å»çœ‹å±å¹•é‡Œé¢çš„ä¸œè¥¿</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®viewçŸ©é˜µï¼Œå¯ä»¥è¯´è¿™ä¸ªçŸ©é˜µä»£è¡¨ç›¸æœºçš„ä½ç½®</span></span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šåœ¨OpenGL 1ä¸­ä½¿ç”¨ModelView matrixï¼Œè¿™æ˜¯ä¸€ä¸ªmodelå’ŒviewçŸ©é˜µçš„ç»„åˆã€‚</span></span><br><span class="line">    <span class="comment">//åœ¨OpenGL2ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©åˆ†åˆ«è·Ÿè¸ªè¿™äº›çŸ©é˜µ</span></span><br><span class="line">    Matrix.setLookAtM(mViewMatrix, <span class="number">0</span>, eyeX, eyeY, eyeZ, lookX, lookY, lookZ, upX, upY, upZ);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>å¦ä¸€ä¸ªæœ‰è¶£çš„è¯é¢˜æ˜¯çŸ©é˜µï¼æ— è®ºæ‚¨ä½•æ—¶è¿›è¡Œ3Dç¼–ç¨‹ï¼Œè¿™äº›éƒ½å°†æˆä¸ºæ‚¨æœ€å¥½çš„æœ‹å‹ã€‚å› æ­¤ï¼Œæ‚¨éœ€è¦å¾ˆå¥½çš„äº†è§£ä»–ä»¬ã€‚</p><p>å½“æˆ‘ä»¬çš„ç•Œé¢è¢«åˆ›å»ºï¼Œæˆ‘ä»¬ç¬¬ä¸€ä»¶äº‹æƒ…æ˜¯è®¾ç½®æ¸…ç†é¢œè‰²ä¸ºç°è‰²ã€‚alphaéƒ¨åˆ†ä¹Ÿè®¾ç½®ä¸ºç°è‰²ï¼Œä½†åœ¨æˆ‘ä»¬æœ¬è¯¾ç¨‹ä¸­æ²¡æœ‰è¿›è¡Œalphaæ··åˆï¼Œå› æ­¤è¯¥å€¼æœªä½¿ç”¨ã€‚æˆ‘ä»¬åªéœ€è¦è®¾ç½®ä¸€æ¬¡æ¸…ç†é¢œè‰²ï¼Œä¹‹åæˆ‘ä»¬ä¸ä¼šæ›´æ”¹å®ƒã€‚</p><p>æˆ‘ä»¬ç¬¬äºŒä»¶äº‹æƒ…æ˜¯è®¾ç½®viewçŸ©é˜µã€‚æˆ‘ä»¬ä½¿ç”¨äº†å‡ ä¸ªä¸åŒç§ç±»çš„çŸ©é˜µï¼Œå®ƒä»¬éƒ½åšäº†äº›é‡è¦çš„äº‹æƒ…ï¼š</p><ol><li>modelï¼ˆæ¨¡å‹ï¼‰çŸ©é˜µï¼Œè¯¥çŸ©é˜µç”¨äºåœ¨â€œä¸–ç•Œâ€ä¸­çš„æŸå¤„æ”¾ç½®æ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œæ‚¨æœ‰ä¸€ä¸ªæ¨¡å‹è½¦ï¼Œä½ æƒ³å°†å®ƒæ”¾ç½®åœ¨ä¸œè¾¹ä¸€åƒç±³å¤„ï¼Œæ‚¨å°†ä½¿ç”¨çŸ©é˜µæ¨¡å‹æ¥åšè¿™ä»¶äº‹ã€‚</li><li>view ï¼ˆè§†å›¾)çŸ©é˜µï¼Œè¯¥çŸ©é˜µä»£è¡¨ç›¸æœºã€‚å¦‚æœæˆ‘ä»¬æƒ³æŸ¥çœ‹ä½äºä¸œè¾¹ä¸€åƒç±³å¤„çš„è½¦ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦å‘ä¸œç§»åŠ¨ä¸€åƒç±³ï¼ˆå¦ä¸€ç§æ€è€ƒæ–¹å¼æ˜¯æˆ‘ä»¬ä¿æŒé™æ­¢ï¼Œä¸–ç•Œå‘è¥¿ç§»åŠ¨ä¸€åƒç±³ï¼‰ã€‚æˆ‘ä»¬ä½¿ç”¨è§†å›¾çŸ©é˜µæ¥åšåˆ°è¿™ç‚¹ã€‚</li><li>projectionï¼ˆæŠ•å½±)çŸ©é˜µã€‚ç”±äºæˆ‘ä»¬çš„å±å¹•æ˜¯å¹³é¢çš„ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæœ€åçš„è½¬æ¢ï¼Œå°†æˆ‘ä»¬çš„è§†å›¾â€œæŠ•å½±â€åˆ°æˆ‘ä»¬çš„å±å¹•ä¸Šå¹¶è·å¾—æ¼‚äº®çš„3Dè§†è§’ã€‚è¿™å°±æ˜¯æŠ•å½±çŸ©é˜µçš„ç”¨é€”</li></ol><p>å¯ä»¥åœ¨<a href="http://www.songho.ca/opengl/gl_transform.html" target="_blank" rel="noopener">SongHoçš„OpenGLæ•™ç¨‹</a>ä¸­æ‰¾åˆ°å¾ˆå¥½çš„è§£é‡Šã€‚æˆ‘å»ºè®®æ‚¨é˜…è¯»å‡ æ¬¡ç›´åˆ°æ‚¨æŠŠæ¡å¥½è¿™ä¸ªæƒ³æ³•ä¸ºæ­¢ï¼›åˆ«æ‹…å¿ƒï¼Œæˆ‘ä¹Ÿé˜…è¯»äº†å®ƒå¥½å‡ æ¬¡ï¼</p><p>åœ¨OpenGL 1ä¸­ï¼Œæ¨¡å‹å’Œè§†å›¾çŸ©é˜µè¢«ç»„åˆå¹¶ä¸”å‡è®¾äº†æ‘„åƒæœºå¤„äº(0,0,0)åæ ‡å¹¶é¢å‘Zè½´æ–¹å‘ã€‚</p><p>æˆ‘ä»¬ä¸éœ€è¦æ‰‹åŠ¨æ„å»ºè¿™äº›çŸ©é˜µï¼ŒAndroidæœ‰ä¸€ä¸ªMatrixå¸®åŠ©ç±»ï¼Œå®ƒèƒ½ä¸ºæˆ‘ä»¬åšç¹é‡çš„å·¥ä½œã€‚è¿™é‡Œï¼Œæˆ‘ä¸ºæ‘„åƒæœºåˆ›å»ºäº†ä¸€ä¸ªè§†å›¾çŸ©é˜µï¼Œå®ƒä½äºåŸç‚¹åï¼Œæœå‘è¿œå¤„ã€‚</p><h3 id="å®šä¹‰vertexï¼ˆé¡¶ç‚¹ï¼‰å’Œfragmentï¼ˆç‰‡æ®µï¼‰ç€è‰²å™¨">å®šä¹‰vertexï¼ˆé¡¶ç‚¹ï¼‰å’Œfragmentï¼ˆç‰‡æ®µï¼‰ç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-One#å®šä¹‰vertexï¼ˆé¡¶ç‚¹ï¼‰å’Œfragmentï¼ˆç‰‡æ®µï¼‰ç€è‰²å™¨"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> String vertexShader =</span><br><span class="line">        <span class="string">"uniform mat4 u_MVPMatrix;    \n"</span> + <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewã€projectionçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line">        <span class="string">"attribute vec4 a_Position;   \n"</span> + <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®ä¿¡æ¯</span></span><br><span class="line">        <span class="string">"attribute vec4 a_Color;      \n"</span> + <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„é¢œè‰²ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">        <span class="string">"varying vec4 v_Color;        \n"</span> + <span class="comment">// ä»–å°†è¢«ä¼ å…¥ç‰‡æ®µç€è‰²å™¨</span></span><br><span class="line"></span><br><span class="line">        <span class="string">"void main()                  \n"</span> + <span class="comment">// é¡¶ç‚¹ç€è‰²å™¨å…¥å£</span></span><br><span class="line">        <span class="string">"&#123;                            \n"</span> +</span><br><span class="line">        <span class="string">"   v_Color = a_Color;        \n"</span> + <span class="comment">// å°†é¢œè‰²ä¼ é€’ç»™ç‰‡æ®µç€è‰²å™¨</span></span><br><span class="line">                                            <span class="comment">// å®ƒå°†åœ¨ä¸‰è§’å½¢å†…æ’å€¼</span></span><br><span class="line">        <span class="string">"   gl_Position = u_MVPMatrix \n"</span> + <span class="comment">// gl_Positionæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ç”¨æ¥å­˜å‚¨æœ€ç»ˆçš„ä½ç½®</span></span><br><span class="line">        <span class="string">"               * a_Position  \n"</span> + <span class="comment">// å°†é¡¶ç‚¹ä¹˜ä»¥çŸ©é˜µå¾—åˆ°æ ‡å‡†åŒ–å±å¹•åæ ‡çš„æœ€ç»ˆç‚¹</span></span><br><span class="line">        <span class="string">"&#125;                            \n"</span>;</span><br></pre></td></tr></table></div></figure><p>åœ¨OpenGL ES 2ä¸­ä»»ä½•æˆ‘ä»¬æƒ³å±•ç¤ºåœ¨å±å¹•ä¸­çš„ä¸œè¥¿éƒ½å¿…é¡»å…ˆç»è¿‡é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨ï¼Œè¿˜å¥½è¿™äº›ç€è‰²å™¨å¹¶ä¸åƒä»–ä»¬çœ‹èµ·æ¥çš„é‚£ä¹ˆå¤æ‚ã€‚é¡¶ç‚¹ç€è‰²å™¨åœ¨æ¯ä¸ªé¡¶ç‚¹æ‰§è¡Œæ“ä½œï¼Œå¹¶æŠŠè¿™äº›æ“ä½œçš„ç»“æœä½¿ç”¨åœ¨ç‰‡æ®µç€è‰²å™¨åšé¢å¤–çš„æ¯åƒç´ è®¡ç®—ã€‚</p><p>æ¯ä¸ªç€è‰²å™¨åŸºæœ¬ç”±è¾“å…¥ï¼ˆinputï¼‰ã€è¾“å‡ºï¼ˆoutputï¼‰å’Œä¸€ä¸ªç¨‹åºï¼ˆprogramï¼‰ç»„æˆã€‚<br>é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç»Ÿä¸€ï¼ˆuniformï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰å˜æ¢çš„ç»„åˆçŸ©é˜µã€‚å®ƒæ˜¯æ‰€æœ‰é¡¶ç‚¹çš„å¸¸é‡ï¼Œç”¨äºå°†å®ƒä»¬æŠ•å½±åˆ°å±å¹•ä¸Šã€‚<br>ç„¶åæˆ‘ä»¬å®šä¹‰äº†ä½ç½®å’Œé¢œè‰²å±æ€§ï¼ˆattributeï¼‰ï¼Œè¿™äº›å±æ€§å°†ä»æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„ç¼“å­˜åŒºä¸­è¯»å…¥ï¼Œå¹¶æŒ‡å®šæ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®å’Œé¢œè‰²ã€‚<br>æ¥ç€æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå˜é‡ï¼ˆvaryingï¼‰ï¼Œå®ƒè´Ÿè´£åœ¨ä¸‰è§’å½¢ä¸­æ’å€¼å¹¶ä¼ é€’åˆ°ç‰‡æ®µç€è‰²å™¨ã€‚å½“å®ƒè¿è¡Œåˆ°ç‰‡æ®µç€è‰²å™¨ï¼Œå®ƒå°†ä¸ºæ¯ä¸ªåƒç´ æŒæœ‰ä¸€ä¸ªæ’å€¼ã€‚</p><p>å‡è®¾æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªä¸‰è§’å½¢æ¯ä¸ªç‚¹éƒ½æ˜¯çº¢è‰²ã€ç»¿è‰²å’Œè“è‰²ï¼Œæˆ‘ä»¬è°ƒæ•´å®ƒçš„å¤§å°è®©å®ƒå ç”¨10åƒç´ å±å¹•ã€‚å½“ç‰‡æ®µç€è‰²å™¨è¿è¡Œæ—¶ï¼Œå®ƒå°†ä¸ºæ¯åƒç´ åŒ…å«ä¸€ä¸ªä¸åŒçš„å˜é‡ï¼ˆvaryingï¼‰é¢œè‰²ã€‚åœ¨æŸä¸€ç‚¹ä¸Šï¼Œå˜é‡ï¼ˆvaryingï¼‰å°†æ˜¯çº¢è‰²ï¼Œä½†æ˜¯åœ¨çº¢è‰²å’Œè“è‰²ä¹‹é—´å®ƒå¯èƒ½æ˜¯æ›´ç´«çš„é¢œè‰²ã€‚</p><p>é™¤äº†è®¾ç½®é¢œè‰²ï¼Œæˆ‘ä»¬è¿˜å‘Šè¯‰OpenGLé¡¶ç‚¹åœ¨å±å¹•ä¸Šçš„æœ€ç»ˆä½ç½®ã€‚ç„¶åæˆ‘ä»¬å®šä¹‰ç‰‡æ®µç€è‰²å™¨ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> String fragmentShader =</span><br><span class="line">        <span class="string">"precision mediump float;       \n"</span> + <span class="comment">// æˆ‘ä»¬å°†é»˜è®¤ç²¾åº¦è®¾ç½®ä¸ºä¸­ç­‰ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç‰‡æ®µç€è‰²å™¨ä¸­çš„é«˜ç²¾åº¦</span></span><br><span class="line">        <span class="string">"varying vec4 v_Color;          \n"</span> + <span class="comment">// è¿™æ˜¯ä»ä¸‰è§’å½¢æ¯ä¸ªç‰‡æ®µå†…æ’çš„é¡¶ç‚¹ç€è‰²å™¨çš„é¢œè‰²</span></span><br><span class="line">        <span class="string">"void main()                    \n"</span> + <span class="comment">// ç‰‡æ®µç€è‰²å™¨å…¥å£</span></span><br><span class="line">        <span class="string">"&#123;                              \n"</span> +</span><br><span class="line">        <span class="string">"   gl_FragColor = v_Color;     \n"</span> + <span class="comment">// ç›´æ¥å°†é¢œè‰²ä¼ é€’</span></span><br><span class="line">        <span class="string">"&#125;                              \n"</span>;</span><br></pre></td></tr></table></div></figure><p>è¿™æ˜¯ä¸ªç‰‡æ®µç€è‰²å™¨ï¼Œå®ƒä¼šå°†ä¸œè¥¿æ”¾åˆ°å±å¹•ä¸Šã€‚åœ¨è¿™ä¸ªç€è‰²å™¨ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°çš„å˜é‡ï¼ˆvaryingï¼‰é¢œè‰²æ¥è‡ªé¡¶ç‚¹ç€è‰²å™¨ï¼Œç„¶åå°†å®ƒç›´æ¥ä¼ é€’ç»™OpenGLã€‚è¯¥ç‚¹å·²æŒ‰åƒç´ æ’å€¼ï¼Œå› ä¸ºç‰‡æ®µç€è‰²å™¨å°†é’ˆå¯¹æ¯ä¸ªå°†è¦ç»˜åˆ¶çš„åƒç´ ç‚¹è¿è¡Œã€‚</p><p>æ›´å¤šä¿¡æ¯ï¼š<a href="http://www.khronos.org/opengles/sdk/docs/reference_cards/OpenGL-ES-2_0-Reference-card.pdf" target="_blank" rel="noopener">OpenGL ES 2 APIå¿«é€Ÿå‚è€ƒå¡</a></p><h3 id="å°†ç€è‰²å™¨åŠ è½½åˆ°OpenGL">å°†ç€è‰²å™¨åŠ è½½åˆ°OpenGL<a href="post/Learn-OpenGL-Lesson-One#å°†ç€è‰²å™¨åŠ è½½åˆ°OpenGL"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŠ è½½é¡¶ç‚¹ç€è‰²å™¨</span></span><br><span class="line"><span class="keyword">int</span> vertexShaderHandle = GLES20.glCreateShader(GLES20.GL_VERTEX_SHADER);</span><br><span class="line"><span class="keyword">if</span> (vertexShaderHandle != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// ä¼ å…¥é¡¶ç‚¹ç€è‰²å™¨æºä»£ç </span></span><br><span class="line">    GLES20.glShaderSource(vertexShaderHandle, vertexShader);</span><br><span class="line">    <span class="comment">// ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨</span></span><br><span class="line">    GLES20.glCompileShader(vertexShaderHandle);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–ç¼–è¯‘çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span>[] compileStatus = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">1</span>];</span><br><span class="line">    GLES20.glGetShaderiv(vertexShaderHandle, GLES20.GL_COMPILE_STATUS, compileStatus, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœç¼–è¯‘å¤±è´¥åˆ™åˆ é™¤ç€è‰²å™¨</span></span><br><span class="line">    <span class="keyword">if</span> (compileStatus[<span class="number">0</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">        GLES20.glDeleteShader(vertexShaderHandle);</span><br><span class="line">        vertexShaderHandle = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (vertexShaderHandle == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Error creating vertex shader."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç€è‰²å™¨å¯¹è±¡ã€‚å¦‚æœæˆåŠŸï¼Œæˆ‘ä»¬å°†å¾—åˆ°è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚<br>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªå¼•ç”¨ä¼ å…¥ç€è‰²å™¨æºç ç„¶åç¼–è¯‘å®ƒã€‚<br>æˆ‘ä»¬å¯ä»¥ä»OpenGLè·å–ç¼–è¯‘æ˜¯å¦æˆåŠŸçš„çŠ¶æ€ï¼Œå¦‚æœå¤±è´¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>GLES20.glGetShaderInfoLog(shader)</code>æ‰¾åˆ°åŸå› ã€‚æˆ‘ä»¬æŒ‰ç…§ç›¸åŒçš„æ­¥éª¤åŠ è½½ç‰‡æ®µç€è‰²å™¨ã€‚</p><h3 id="å°†é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨é“¾æ¥åˆ°ä¸€ä¸ªç¨‹åºä¸­">å°†é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨é“¾æ¥åˆ°ä¸€ä¸ªç¨‹åºä¸­<a href="post/Learn-OpenGL-Lesson-One#å°†é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨é“¾æ¥åˆ°ä¸€ä¸ªç¨‹åºä¸­"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªç¨‹åºå¯¹è±¡å¹¶å°†å¼•ç”¨æ”¾è¿›å»</span></span><br><span class="line"><span class="keyword">int</span> programHandle = GLES20.glCreateProgram();</span><br><span class="line"><span class="keyword">if</span> (programHandle != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// ç»‘å®šé¡¶ç‚¹ç€è‰²å™¨åˆ°ç¨‹åºå¯¹è±¡ä¸­</span></span><br><span class="line">    GLES20.glAttachShader(programHandle, vertexShaderHandle);</span><br><span class="line">    <span class="comment">// ç»‘å®šç‰‡æ®µç€è‰²å™¨åˆ°ç¨‹åºå¯¹è±¡ä¸­</span></span><br><span class="line">    GLES20.glAttachShader(programHandle, fragmentShaderHandle);</span><br><span class="line">    <span class="comment">// ç»‘å®šå±æ€§</span></span><br><span class="line">    GLES20.glBindAttribLocation(programHandle, <span class="number">0</span>, <span class="string">"a_Position"</span>);</span><br><span class="line">    GLES20.glBindAttribLocation(programHandle, <span class="number">1</span>, <span class="string">"a_Color"</span>);</span><br><span class="line">    <span class="comment">// å°†ä¸¤ä¸ªç€è‰²å™¨è¿æ¥åˆ°ç¨‹åº</span></span><br><span class="line">    GLES20.glLinkProgram(programHandle);</span><br><span class="line">    <span class="comment">// è·å–è¿æ¥çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span>[] linkStatus = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">1</span>];</span><br><span class="line">    GLES20.glGetProgramiv(programHandle, GLES20.GL_LINK_STATUS, linkStatus, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// å¦‚æœè¿æ¥å¤±è´¥ï¼Œåˆ é™¤è¿™ç¨‹åº</span></span><br><span class="line">    <span class="keyword">if</span> (linkStatus[<span class="number">0</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">        GLES20.glDeleteProgram(programHandle);</span><br><span class="line">        programHandle = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (programHandle == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Error creating program."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>åœ¨æˆ‘ä»¬ä½¿ç”¨é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒä»¬ç»‘å®šåˆ°ä¸€ä¸ªç¨‹åºä¸­ï¼Œå®ƒè¿æ¥äº†é¡¶ç‚¹ç€è‰²å™¨çš„è¾“å‡ºå’Œç‰‡æ®µç€è‰²å™¨çš„è¾“å…¥ã€‚è¿™ä¹Ÿæ˜¯è®©æˆ‘ä»¬ä»ç¨‹åºä¼ é€’è¾“å…¥å¹¶ä½¿ç”¨ç€è‰²å™¨ç»˜åˆ¶å½¢çŠ¶çš„åŸå› ã€‚</p><p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç¨‹åºå¯¹è±¡ï¼Œå¦‚æœæˆåŠŸç»‘å®šç€è‰²å™¨ã€‚æˆ‘ä»¬æƒ³è¦å°†ä½ç½®å’Œé¢œè‰²ä½œä¸ºå±æ€§ä¼ é€’è¿›å»ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç»‘å®šè¿™äº›å±æ€§ã€‚ç„¶åæˆ‘ä»¬å°†ç€è‰²å™¨è¿æ¥åˆ°ä¸€èµ·ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°ç±»æˆå‘˜</span></span><br><span class="line"><span class="comment">/** è¿™å°†ç”¨äºä¼ é€’å˜æ¢çŸ©é˜µ*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mMVPMatrixHandle;</span><br><span class="line"><span class="comment">/** ç”¨äºä¼ é€’modelä½ç½®ä¿¡æ¯*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mPositionHandle;</span><br><span class="line"><span class="comment">/** ç”¨äºä¼ é€’æ¨¡å‹é¢œè‰²ä¿¡æ¯*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mColorHandle;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSurfaceCreated</span><span class="params">(GL10 gl, EGLConfig config)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// è®¾ç½®ç¨‹åºå¼•ç”¨ï¼Œè¿™å°†åœ¨ä¹‹åä¼ é€’å€¼åˆ°ç¨‹åºæ—¶ä½¿ç”¨</span></span><br><span class="line">    mMVPMatrixHandle = GLES20.glGetUniformLocation(programHandle, <span class="string">"u_MVPMatrix"</span>);</span><br><span class="line">    mPositionHandle = GLES20.glGetAttribLocation(programHandle, <span class="string">"a_Position"</span>);</span><br><span class="line">    mColorHandle = GLES20.glGetAttribLocation(programHandle, <span class="string">"a_Color"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘Šè¯‰OpenGLæ¸²æŸ“çš„æ—¶å€™ä½¿ç”¨è¿™ä¸ªç¨‹åº</span></span><br><span class="line">    GLES20.glUseProgram(programHandle);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>åœ¨æˆ‘ä»¬æˆåŠŸè¿æ¥ç¨‹åºåï¼Œæˆ‘ä»¬è¿˜è¦å®Œæˆå‡ ä¸ªä»»åŠ¡ï¼Œä»¥ä¾¿æˆ‘ä»¬èƒ½å®é™…ä½¿ç”¨å®ƒã€‚<br>ç¬¬ä¸€ä¸ªä»»åŠ¡æ˜¯è·å–å¼•ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬è¦ä¼ é€’æ•°æ®åˆ°ç¨‹åºä¸­ã€‚<br>ç„¶åæˆ‘ä»¬è¦å‘Šè¯‰OpenGLåœ¨ç»˜åˆ¶æ—¶ä½¿ç”¨æˆ‘ä»¬è¿™ä¸ªç¨‹åºã€‚<br>ç”±äºæœ¬è¯¾æˆ‘ä»¬ä»…ä½¿ç”¨äº†ä¸€ä¸ªç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒæ”¾åˆ°<code>onSurfaceCreated()</code>æ–¹æ³•ä¸­è€Œä¸æ˜¯<code>onDrawFrame()</code></p><h3 id="è®¾ç½®é€è§†æŠ•å½±">è®¾ç½®é€è§†æŠ•å½±<a href="post/Learn-OpenGL-Lesson-One#è®¾ç½®é€è§†æŠ•å½±"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°ç±»æˆå‘˜</span></span><br><span class="line"><span class="comment">// å­˜æ”¾æŠ•å½±çŸ©é˜µï¼Œç”¨äºå°†åœºæ™¯æŠ•å½±åˆ°2Dè§†è§’</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">float</span>[] mProjectionMatrix = <span class="keyword">new</span> <span class="keyword">float</span>[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSurfaceChanged</span><span class="params">(GL10 gl, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è®¾ç½®OpenGLç•Œé¢å’Œå½“å‰è§†å›¾ç›¸åŒçš„å°ºå¯¸</span></span><br><span class="line">    GLES20.glViewport(<span class="number">0</span>, <span class="number">0</span>, width, height);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„é€è§†æŠ•å½±çŸ©é˜µï¼Œé«˜åº¦ä¿æŒä¸å˜ï¼Œè€Œé«˜åº¦æ ¹æ®çºµæ¨ªæ¯”è€Œå˜æ¢</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> ratio = (<span class="keyword">float</span>) width / height;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> left = -ratio;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> right = ratio;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> bottom = -<span class="number">1.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> top = <span class="number">1.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> near = <span class="number">1.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> far = <span class="number">10.0F</span>;</span><br><span class="line"></span><br><span class="line">    Matrix.frustumM(mProjectionMatrix, <span class="number">0</span>, left, right, bottom, top, near, far);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><code>onSurfaceChanged()</code>æ–¹æ³•è‡³å°‘è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œæ¯å½“ç•Œé¢æ”¹å˜ä¹Ÿä¼šè¢«è°ƒç”¨ã€‚å› ä¸ºæˆ‘ä»¬éœ€è¦æ¯å½“ç•Œé¢æ”¹å˜çš„æ—¶å€™é‡ç½®æŠ•å½±çŸ©é˜µï¼Œé‚£ä¹ˆ<code>onSurfaceChanged()</code>æ–¹æ³•ä¸­æ˜¯ä¸ªç†æƒ³çš„åœ°æ–¹ã€‚</p><h3 id="ç»˜åˆ¶ä¸œè¥¿åˆ°å±å¹•ä¸Šï¼">ç»˜åˆ¶ä¸œè¥¿åˆ°å±å¹•ä¸Šï¼<a href="post/Learn-OpenGL-Lesson-One#ç»˜åˆ¶ä¸œè¥¿åˆ°å±å¹•ä¸Šï¼"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°ç±»æˆå‘˜</span></span><br><span class="line"><span class="comment">// å­˜æ”¾æ¨¡å‹çŸ©é˜µï¼Œè¯¥çŸ©é˜µç”¨äºå°†æ¨¡å‹ä»å¯¹è±¡ç©ºé—´ï¼ˆå¯ä»¥è®¤ä¸ºæ¯ä¸ªæ¨¡å‹å¼€å§‹éƒ½ä½äºå®‡å®™çš„ä¸­å¿ƒï¼‰ç§»åŠ¨åˆ°ä¸–ç•Œç©ºé—´</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">float</span>[] mModelMatrix = <span class="keyword">new</span> <span class="keyword">float</span>[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDrawFrame</span><span class="params">(GL10 gl)</span> </span>&#123;</span><br><span class="line">    GLES20.glClear(GLES20.GL_DEPTH_BUFFER_BIT | GLES20.GL_COLOR_BUFFER_BIT);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¯10så®Œæˆä¸€æ¬¡æ—‹è½¬</span></span><br><span class="line">    <span class="keyword">long</span> time = SystemClock.uptimeMillis() % <span class="number">10000L</span>;</span><br><span class="line">    <span class="keyword">float</span> angleDegrees = (<span class="number">360.0F</span> / <span class="number">10000.0F</span>) * ((<span class="keyword">int</span>)time);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”»ä¸‰è§’å½¢</span></span><br><span class="line">    Matrix.setIdentityM(mModelMatrix, <span class="number">0</span>);</span><br><span class="line">    Matrix.rotateM(mModelMatrix, <span class="number">0</span>, angleDegrees, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>);</span><br><span class="line">    drawTriangle(mTriangle1Verticels);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>è¿™æ˜¯å®é™…æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„å†…å®¹ã€‚æˆ‘ä»¬æ¸…ç†å±å¹•ï¼Œå› æ­¤ä¸ä¼šå¾—åˆ°ä»»ä½•å¥‡æ€ªçš„<a href="https://en.wikipedia.org/wiki/Noclip_mode#.22Hall_of_mirrors.22_effect" target="_blank" rel="noopener">é•œåƒæ•ˆåº”</a>å½±å“ï¼Œæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„ä¸‰è§’å½¢åœ¨å±å¹•ä¸Šèƒ½æœ‰å¹³æ»‘çš„åŠ¨ç”»ï¼Œé€šå¸¸ä½¿ç”¨æ—¶é—´è€Œä¸æ˜¯å¸§ç‡æ›´å¥½ã€‚</p><blockquote><p>å®é™…ç»˜åˆ¶åœ¨<code>drawTriangle()</code>æ–¹æ³•ä¸­å®Œæˆ</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°çš„ç±»æˆå‘˜</span></span><br><span class="line"><span class="comment">/** ä¸ºæœ€ç»ˆçš„ç»„åˆçŸ©é˜µåˆ†é…å­˜å‚¨ç©ºé—´ï¼Œè¿™å°†ç”¨æ¥ä¼ å…¥ç€è‰²å™¨ç¨‹åº*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">float</span>[] mMVPMatrix = <span class="keyword">new</span> <span class="keyword">float</span>[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">/** æ¯ä¸ªé¡¶ç‚¹æœ‰å¤šå°‘å­—èŠ‚ç»„æˆï¼Œæ¯æ¬¡éœ€è¦è¿ˆè¿‡è¿™ä¹ˆä¸€å¤§æ­¥ï¼ˆæ¯ä¸ªé¡¶ç‚¹æœ‰7ä¸ªå…ƒç´ ï¼Œ3ä¸ªè¡¨ç¤ºä½ç½®ï¼Œ4ä¸ªè¡¨ç¤ºé¢œè‰²ï¼Œ7 * 4 = 28ä¸ªå­—èŠ‚ï¼‰*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mStrideBytes = <span class="number">7</span> * mBytePerFloat;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** ä½ç½®æ•°æ®åç§»é‡*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mPositionOffset = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** ä¸€ä¸ªå…ƒç´ çš„ä½ç½®æ•°æ®å¤§å°*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mPositionDataSize = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** é¢œè‰²æ•°æ®åç§»é‡*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mColorOffset = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** ä¸€ä¸ªå…ƒç´ çš„é¢œè‰²æ•°æ®å¤§å°*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mColorDataSize = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä»ç»™å®šçš„é¡¶ç‚¹æ•°æ®ä¸­ç»˜åˆ¶ä¸€ä¸ªä¸‰è§’å½¢</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> aTriangleBuffer åŒ…å«é¡¶ç‚¹æ•°æ®çš„ç¼“å†²åŒº</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawTriangle</span><span class="params">(FloatBuffer aTriangleBuffer)</span> </span>&#123;</span><br><span class="line">    aTriangleBuffer.position(mPositionOffset);</span><br><span class="line">    GLES20.glVertexAttribPointer(</span><br><span class="line">            mPositionHandle, mPositionDataSize, GLES20.GL_FLOAT, <span class="keyword">false</span>,</span><br><span class="line">            mStrideBytes, aTriangleBuffer);</span><br><span class="line"></span><br><span class="line">    GLES20.glEnableVertexAttribArray(mPositionHandle);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¼ å…¥é¢œè‰²ä¿¡æ¯</span></span><br><span class="line">    aTriangleBuffer.position(mColorOffset);</span><br><span class="line">    GLES20.glVertexAttribPointer(mColorHandle, mColorDataSize, GLES20.GL_FLOAT, <span class="keyword">false</span>,</span><br><span class="line">            mStrideBytes, aTriangleBuffer);</span><br><span class="line"></span><br><span class="line">    GLES20.glEnableVertexAttribArray(mColorHandle);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†è§†å›¾çŸ©é˜µä¹˜ä»¥æ¨¡å‹çŸ©é˜µï¼Œå¹¶å°†ç»“æœå­˜æ”¾åˆ°MVP Matrixï¼ˆmodel * viewï¼‰</span></span><br><span class="line">    Matrix.multiplyMM(mMVPMatrix, <span class="number">0</span>, mViewMatrix, <span class="number">0</span>, mModelMatrix, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†ä¸Šé¢è®¡ç®—å¥½çš„è§†å›¾æ¨¡å‹çŸ©é˜µä¹˜ä»¥æŠ•å½±çŸ©é˜µï¼Œå¹¶å°†ç»“æœå­˜æ”¾åˆ°MVP Matrixï¼ˆmodel * view * projectionï¼‰</span></span><br><span class="line">    Matrix.multiplyMM(mMVPMatrix, <span class="number">0</span>, mProjectionMatrix, <span class="number">0</span>, mMVPMatrix, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    GLES20.glUniformMatrix4fv(mMVPMatrixHandle, <span class="number">1</span>, <span class="keyword">false</span>, mMVPMatrix, <span class="number">0</span>);</span><br><span class="line">    GLES20.glDrawArrays(GLES20.GL_TRIANGLES, <span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æ‚¨è¿˜è®°å¾—æˆ‘ä»¬æœ€åˆåˆ›å»ºæ¸²æŸ“å™¨æ—¶å®šä¹‰çš„é‚£äº›ç¼“å†²åŒºå—ï¼Ÿæˆ‘ä»¬ç»ˆäºå¯ä»¥ä½¿ç”¨å®ƒä»¬äº†ã€‚<br>æˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>GLES20.glVertexAttribPointer()</code>æ¥å‘Šè¯‰OpenGLæ€æ ·ä½¿ç”¨è¿™äº›æ•°æ®ã€‚</p><blockquote><p>æˆ‘ä»¬æ¥çœ‹ç¬¬ä¸€ä¸ªä½¿ç”¨</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">aTriangleBuffer.position(mPositionOffset);</span><br><span class="line">GLES20.glVertexAttribPointer(</span><br><span class="line">        mPositionHandle, mPositionDataSize, GLES20.GL_FLOAT, <span class="keyword">false</span>,</span><br><span class="line">        mStrideBytes, aTriangleBuffer);</span><br><span class="line">GLES20.glEnableVertexAttribArray(mPositionHandle);</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬è®¾ç½®ç¼“å†²åŒºçš„ä½ç½®åç§»ï¼Œå®ƒä½äºç¼“å†²åŒºçš„å¼€å¤´ã€‚ç„¶åæˆ‘ä»¬å‘Šè¯‰OpenGLä½¿ç”¨è¿™äº›æ•°æ®å¹¶å°†å…¶æä¾›ç»™é¡¶ç‚¹ç€è‰²å™¨å¹¶å°†å…¶åº”ç”¨åˆ°ä½ç½®å±æ€§ï¼ˆa_Positionï¼‰ã€‚æˆ‘ä»¬ä¹Ÿéœ€è¦å‘Šè¯‰OpenGLæ¯ä¸ªé¡¶ç‚¹æˆ–è¿ˆå¹…ä¹‹é—´æœ‰å¤šå°‘ä¸ªå…ƒç´ ã€‚</p><blockquote><p>æ³¨æ„ï¼šè¿ˆå¹…ï¼ˆStrideï¼‰éœ€è¦å®šä¹‰ä¸ºå­—èŠ‚ï¼ˆbyteï¼‰ï¼Œå°½ç®¡æ¯ä¸ªé¡¶ç‚¹ä¹‹é—´æˆ‘ä»¬æœ‰7ä¸ªå…ƒç´ ï¼ˆ3ä¸ªæ˜¯ä½ç½®ï¼Œ4ä¸ªæ˜¯é¢œè‰²ï¼‰ï¼Œä½†æˆ‘ä»¬äº‹å®ä¸Šæœ‰28ä¸ªå­—èŠ‚ï¼Œå› ä¸ºæ¯ä¸ªæµ®ç‚¹æ•°ï¼ˆfloatï¼‰å°±æ˜¯4ä¸ªå­—èŠ‚ï¼ˆbyteï¼‰ã€‚å¿˜è®°æ­¤æ­¥éª¤æ‚¨å¯èƒ½æ²¡æœ‰ä»»ä½•é”™è¯¯ï¼Œä½†æ˜¯ä½ ä¼šæƒ³çŸ¥é“ä¸ºä»€ä¹ˆæ‚¨çš„å±å¹•ä¸Šçœ‹ä¸åˆ°ä»»ä½•å†…å®¹ã€‚</p></blockquote><p>æœ€ç»ˆï¼Œæˆ‘ä»¬ä½¿ç”¨äº†é¡¶ç‚¹å±æ€§ï¼Œå¾€ä¸‹æˆ‘ä»¬ä½¿ç”¨äº†ä¸‹ä¸€ä¸ªå±æ€§ã€‚å†å¾€åç‚¹æˆ‘ä»¬æ„å»ºä¸€ä¸ªç»„åˆçŸ©é˜µï¼Œå°†ç‚¹æŠ•å½±åˆ°å±å¹•ä¸Šã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­æ‰§è¡Œæ­¤æ“ä½œï¼Œä½†æ˜¯ç”±äºå®ƒåªéœ€è¦æ‰§è¡Œä¸€æ¬¡æˆ‘ä»¬ä¹Ÿå¯ä»¥åªç¼“å­˜ç»“æœã€‚<br>æˆ‘ä»¬ä½¿ç”¨<code>GLES20.glUniformMatrix4fv()</code>æ–¹æ³•å°†æœ€ç»ˆçš„çŸ©é˜µä¼ å…¥é¡¶ç‚¹ç€è‰²å™¨ã€‚<br><code>GLES20.glDrawArrays()</code>å°†æˆ‘ä»¬çš„ç‚¹è½¬æ¢ä¸ºä¸‰è§’å½¢å¹¶å°†å…¶ç»˜åˆ¶åœ¨å±å¹•ä¸Šã€‚</p><h2 id="æ€»ç»“">æ€»ç»“<a href="post/Learn-OpenGL-Lesson-One#æ€»ç»“"></a></h2><p>å‘¼å‘¼ï¼è¿™æ˜¯é‡è¦çš„ä¸€è¯¾ï¼Œå¦‚æœæ‚¨å®Œæˆäº†æœ¬è¯¾ï¼Œæ„Ÿè°¢æ‚¨ï¼<br>æˆ‘ä»¬å­¦ä¹ äº†æ€æ ·åˆ›å»ºOpenGLä¸Šä¸‹æ–‡ï¼Œä¼ å…¥å½¢çŠ¶æ•°æ®ï¼ŒåŠ è½½é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨ï¼Œè®¾ç½®æˆ‘ä»¬çš„è½¬æ¢çŸ©é˜µï¼Œæœ€ç»ˆæ”¾åœ¨ä¸€èµ·ã€‚<br>å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ‚¨å› è¯¥çœ‹åˆ°äº†ç±»ä¼¼ä¸‹é¢çš„æˆªå±ã€‚<br><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/learn-opengl/20190122233309.png" alt="screenshot"></p><p>è¿™ä¸€è¯¾æœ‰å¾ˆå¤šéœ€è¦æ¶ˆåŒ–çš„å†…å®¹ï¼Œæ‚¨å¯èƒ½éœ€è¦å¤šæ¬¡é˜…è¯»è¿™äº›æ­¥éª¤æ‰èƒ½ç†è§£å®ƒã€‚<br>OpenGL ES 2éœ€è¦æ›´å¤šçš„è®¾ç½®æ‰èƒ½å¼€å§‹ï¼Œä½†æ˜¯ä¸€æ—¦æ‚¨å®Œæˆäº†è¿™ä¸ªè¿‡ç¨‹å‡ æ¬¡ï¼Œæ‚¨å°±ä¼šè®°ä½è¿™ä¸ªæµç¨‹ã€‚</p><h2 id="åœ¨Androidå¸‚åœºä¸Šå‘å¸ƒ">åœ¨Androidå¸‚åœºä¸Šå‘å¸ƒ<a href="post/Learn-OpenGL-Lesson-One#åœ¨Androidå¸‚åœºä¸Šå‘å¸ƒ"></a></h2><p>å½“å¼€å‘çš„åº”ç”¨æˆ‘ä»¬ä¸æƒ³åœ¨æ— æ³•è¿è¡Œè¿™äº›åº”ç”¨ç¨‹åºçš„äººåœ¨å¸‚åœºä¸Šçœ‹åˆ°å®ƒä»¬ï¼Œå¦åˆ™å½“åº”ç”¨ç¨‹åºåœ¨å…¶è®¾å¤‡ä¸Šå´©æºƒæ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæ”¶åˆ°å¤§é‡ç³Ÿç³•çš„è¯„è®ºå’Œè¯„åˆ†ã€‚<br>è¦é˜²æ­¢OpenGL ES 2 åº”ç”¨ç¨‹åºå‡ºç°åœ¨ä¸æ”¯æŒå®ƒçš„è®¾å¤‡ä¸Šï¼Œä½ å¯ä»¥åœ¨æ¸…å•æ–‡ä»¶ä¸­æ·»åŠ ï¼š</p><figure class="highlight xml"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-feature</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:glEsVersion</span>=<span class="string">"0x00020000"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:required</span>=<span class="string">"true"</span> /&gt;</span></span><br></pre></td></tr></table></div></figure><p>è¿™å‘Šè¯‰å¸‚åœºæ‚¨çš„appéœ€è¦æœ‰OpenGL ES 2æ”¯æŒï¼Œä¸æ”¯æŒçš„è®¾å¤‡å°†ä¼šéšè—æ‚¨çš„appã€‚</p><h2 id="è¿›ä¸€æ­¥æ¢ç´¢">è¿›ä¸€æ­¥æ¢ç´¢<a href="post/Learn-OpenGL-Lesson-One#è¿›ä¸€æ­¥æ¢ç´¢"></a></h2><p>å°è¯•æ›´æ”¹åŠ¨ç”»é€Ÿåº¦ï¼Œé¡¶ç‚¹æˆ–é¢œè‰²ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼<br>å¯ä»¥åœ¨Githubä¸‹è½½æœ¬è¯¾ç¨‹æºä»£ç ï¼š<a href="https://github.com/learnopengles/Learn-OpenGLES-Tutorials" target="_blank" rel="noopener">ä¸‹è½½é¡¹ç›®</a><br>æœ¬è¯¾çš„ç¼–è¯‘ç‰ˆæœ¬ä¹Ÿå¯ä»¥å†Androidå¸‚åœºä¸‹ï¼š<a href="https://market.android.com/details?id=com.learnopengles.android" target="_blank" rel="noopener">google play ä¸‹è½½apk</a><br>â€œæˆ‘â€ä¹Ÿç¼–è¯‘äº†ä¸ªapkï¼Œæ–¹ä¾¿å¤§å®¶ä¸‹è½½ï¼š<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">github download</a></p><h2 id="æ•™ç¨‹ç›®å½•">æ•™ç¨‹ç›®å½•<a href="post/Learn-OpenGL-Lesson-One#æ•™ç¨‹ç›®å½•"></a></h2><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five">OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six">OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven">OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVOBï¼‰</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ–‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡æ ‡é¢˜ï¼šOpenGL Android Lesson One: Getting Started&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.learnopengles.com/android-lesson-one-getting-started/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.learnopengles.com/android-lesson-one-getting-started/&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/categories/OpenGL/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/tags/OpenGL/"/>
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>C å­¦ä¹ ç¬”è®°</title>
    <link href="https://blog.xujiaji.com/post/c-learn-note/index.html"/>
    <id>https://blog.xujiaji.com/post/c-learn-note/index.html</id>
    <published>2018-12-25T15:18:45.000Z</published>
    <updated>2019-05-15T08:15:04.969Z</updated>
    
    <content type="html"><![CDATA[<p>é‡å­¦ä¸€æ¬¡Cè¯­è¨€ï¼Œè®°å½•ä¸€ä¸‹å­¦ä¹ ã€ŠC Primer Plusã€‹çš„ç¬”è®°ï¼Œæ–¹ä¾¿å›å¿†ï¼</p><a id="more"></a><h2 id="ç¼–è¯‘">ç¼–è¯‘<a href="post/c-learn-note#ç¼–è¯‘"></a></h2><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -o foo.exe foo.c -lregex</span><br><span class="line">gcc foo.c -o foo.exe -lregex</span><br></pre></td></tr></table></div></figure><h2 id="å­—ç¬¦ä¸²å’Œæ ¼å¼åŒ–è¾“å…¥-è¾“å‡º">å­—ç¬¦ä¸²å’Œæ ¼å¼åŒ–è¾“å…¥/è¾“å‡º<a href="post/c-learn-note#å­—ç¬¦ä¸²å’Œæ ¼å¼åŒ–è¾“å…¥-è¾“å‡º"></a></h2><ol><li>å­—ç¬¦ä¸²ä»¥<code>char</code>æ•°ç»„æ¥å­˜å‚¨</li><li><p>å¸¸é‡ç”¨ <code>#define</code> å®šä¹‰</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DENSITY 62.4</span></span><br></pre></td></tr></table></div></figure></li><li><p><code>strlen()</code>è·å–å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œæ³¨æ„éœ€è¦<code>#include &lt;string.h&gt;</code></p></li><li><code>char</code>ç±»å‹æ•°ç»„å’Œ<code>null</code>å­—ç¬¦<ol><li>Cè¯­è¨€æ²¡æœ‰ä¸“é—¨ç”¨äºå‚¨å­˜å­—ç¬¦ä¸²çš„å˜é‡ç±»å‹ï¼Œå­—ç¬¦ä¸²éƒ½è¢«å‚¨å­˜åœ¨<code>char</code>ç±»å‹çš„æ•°ç»„ä¸­</li><li>å­—ç¬¦ä¸²ä»¥<code>\0</code>ï¼ˆç©ºå­—ç¬¦ï¼‰ç»“æŸï¼Œå®ƒæ˜¯ä¸æ‰“å°å‡ºæ¥çš„å­—ç¬¦</li><li>å¦‚æœæœ‰40å“¥å­˜å‚¨å•å•å…ƒçš„å­—ç¬¦ä¸²ï¼Œåªèƒ½å‚¨å­˜39å“¥å­—ç¬¦ï¼Œå‰©ä¸‹ä¸€ä¸ªå­—èŠ‚ç•™ç»™ç©ºå­—ç¬¦</li></ol></li><li><p>ä¸€ä¸‹ä»£ç <code>%s</code>ä½œä¸ºè½¬åŒ–è¯´æ˜ï¼Œ<code>scanf()</code>åªä¼šè¯»å–å­—ç¬¦ä¸²ä¸­çš„ä¸€ä¸ªå•è¯ã€‚å¹¶ä¸”æ²¡æœ‰åŠ <code>&amp;</code>å–åœ°å€ç¬¦ï¼Œ<code>name</code>å°±æ˜¯åœ°å€</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> name[<span class="number">40</span>];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>, name);</span><br></pre></td></tr></table></div></figure></li><li><p><code>&quot;x&quot;</code>ä¸åŒäº<code>&#39;x&#39;</code>,<code>&quot;x&quot;</code>æ˜¯å­—ç¬¦ä¸²ç”±<code>x</code>å’Œ<code>\0</code>ç»„æˆ</p></li><li><code>sizeof</code>è¿ç®—ç¬¦ï¼Œå®ƒä»¥å­—èŠ‚ä¸ºå•ä½ç»™å‡ºå¯¹è±¡çš„å¤§å°ã€‚<code>strlen()</code>åªç»™å‡ºå­—ç¬¦ä¸²é•¿åº¦ï¼Œåˆ°ç©ºå­—ç¬¦ï¼ˆä¸åŒ…æ‹¬ç©ºå­—ç¬¦ï¼‰<ol><li>C99å’ŒC11æ ‡å‡†ä¸“é—¨ä¸º<code>sizeof</code>è¿ç®—ç¬¦çš„è¿”å›ç±»å‹æ·»åŠ äº†<code>%zd</code>è½¬æ¢è¯´æ˜ï¼Œå¯¹äº<code>strlen()</code>ä¹Ÿé€‚ç”¨</li><li><code>sizeof</code>ä½¿ç”¨æ—¶ï¼Œå¯¹äºç±»å‹å¿…é¡»åŠ æ‹¬å·ã€‚å¯¹äºç‰¹å®šé‡ï¼Œå¯æœ‰å¯æ— ã€‚ç±»å‹ï¼š<code>sizeof(char)</code>, <code>sizeof(float)</code>; ç‰¹å®šé‡ï¼š<code>sizeof 6.28</code>, <code>sizeof name</code></li></ol></li></ol><h2 id="å¸¸é‡å’ŒCé¢„å¤„ç†å™¨">å¸¸é‡å’ŒCé¢„å¤„ç†å™¨<a href="post/c-learn-note#å¸¸é‡å’ŒCé¢„å¤„ç†å™¨"></a></h2><ol><li><p>Cé¢„å¤„ç†å™¨å®šä¹‰å¸¸é‡ï¼š<code>#define NAME value</code>ï¼Œå…¶ä¸­â€œNAMEâ€ä¸ºå‘½ä»¤çš„å¸¸é‡åï¼Œçº¦å®šå¤§å†™ï¼›â€œvalueâ€æ˜¯å¯¹åº”çš„å€¼</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#define <span class="type">BEEP</span> '\a'</span><br><span class="line">#define <span class="type">TEE</span> '<span class="type">T'</span></span><br><span class="line">#define <span class="type">ESC</span> '\<span class="number">033</span>'</span><br><span class="line">#define <span class="type">OOPS</span> <span class="string">"Now you have done it!"</span></span><br></pre></td></tr></table></div></figure></li><li><p><code>const</code>é™å®šç¬¦ï¼ŒC90æ ‡å‡†æ–°å¢è¯¥å…³é”®å­—ï¼Œç”¨äºé™å®šä¸€ä¸ªå˜é‡ä¸ºåªè¯»</p></li><li>æ˜ç¤ºå¸¸é‡ï¼šCå¤´æ–‡ä»¶<code>limits.h</code>å’Œ<code>float.h</code>åˆ†åˆ«æä¾›äº†ä¸æ•´æ•°ç±»å‹å’Œæµ®ç‚¹æ•°ç±»å‹å¤§å°é™åˆ¶ç›¸å…³çš„è¯¦ç»†ä¿¡æ¯<figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;limits.h&gt;</span><br><span class="line">#include &lt;float.h&gt;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    printf(<span class="string">"Some number limits for this system: \n"</span>);</span><br><span class="line">    printf(<span class="string">"Biggest int: %d\n"</span>, <span class="type">INT_MAX</span>);</span><br><span class="line">    printf(<span class="string">"Smallest long long: %lld\n"</span>, <span class="type">LLONG_MIN</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é‡å­¦ä¸€æ¬¡Cè¯­è¨€ï¼Œè®°å½•ä¸€ä¸‹å­¦ä¹ ã€ŠC Primer Plusã€‹çš„ç¬”è®°ï¼Œæ–¹ä¾¿å›å¿†ï¼&lt;/p&gt;
    
    </summary>
    
      <category term="C" scheme="https://blog.xujiaji.com/categories/C/"/>
    
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¬”è®°" scheme="https://blog.xujiaji.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="C" scheme="https://blog.xujiaji.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€ä¸ªé¡¹ç›®å¦‚ä½•ç¼–è¯‘å¤šä¸ªä¸åŒç­¾åã€åŒ…åã€èµ„æºç­‰ï¼Œçš„apkï¼Ÿ</title>
    <link href="https://blog.xujiaji.com/post/android-project-one-for-more/index.html"/>
    <id>https://blog.xujiaji.com/post/android-project-one-for-more/index.html</id>
    <published>2018-10-29T08:15:20.000Z</published>
    <updated>2019-04-08T06:54:02.208Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç®€ä»‹">ç®€ä»‹<a href="post/android-project-one-for-more#ç®€ä»‹"></a></h2><p>å¦‚é¢˜æ‰€ç¤ºï¼æœ¬ç¯‡æ–‡ç« å°±æ˜¯ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ã€‚æ–¹ä¾¿æ‰“åŒ…å’Œè¿è¡Œçš„æ—¶å€™èƒ½åšåˆ°æ— éœ€æ‰‹åŠ¨æ›¿æ¢é…ç½®ï¼Œå³å¯æ‰“åŒ…æƒ³è¦çš„apkã€‚æ‰“åŒ…çš„æ—¶å€™ï¼Œåªéœ€é€‰ä¸€ä¸‹æƒ³æ‰“å“ªç§é…ç½®çš„apkå°±OKå•¦ã€‚ (^o^)/~</p><blockquote><p>å…ˆæ¥çœ‹ï¼Œæœ‰éœ€æ±‚å¦‚ä¸‹ï¼š</p></blockquote><ol><li>åŒä¸€ä¸ªé¡¹ç›®</li><li>ä¸åŒçš„apkå›¾æ ‡</li><li>ä¸åŒçš„æœåŠ¡å™¨åŸŸå</li><li>ä¸åŒçš„åŒ…å</li><li>ä¸åŒçš„åç§°</li><li>ä¸åŒçš„ç­¾å</li><li>ä¸åŒçš„ç¬¬ä¸‰æ–¹key</li><li>ä¸åŒçš„ç‰ˆæœ¬åç‰ˆæœ¬å·</li></ol><blockquote><p>è§£å†³æ€è·¯</p></blockquote><ol><li>å½“ç„¶æœ€ç›´æ¥çš„æ–¹å¼ä¸è¿‡äºæ¯æ¬¡æ‰“ä¸åŒåŒ…çš„æ—¶å€™éƒ½å»æ›¿æ¢å¯¹åº”çš„é…ç½®ï¼Œè¿™ç§æ–¹å¼çš„éº»çƒ¦ä¹‹å¤„ä¸è¨€è€Œå–»ã€‚</li><li>å°†æ‰€æœ‰é…ç½®ï¼Œèµ„æºç­‰éƒ½é…ç½®å…¥é¡¹ç›®ä¸­ï¼Œæ‰“åŒ…çš„æ—¶å€™ï¼Œæ ¹æ®é€‰æ‹©æ¸ é“æ‰“åŒ…ä¸åŒé…ç½®çš„apkã€‚ï¼ˆæœ¬ç¯‡æ–‡ç« å°±æ˜¯è¦è®²æ€ä¹ˆè¿™ä¹ˆåšçš„ï¼‰</li><li>ç›¸ä¿¡è¿˜æœ‰å…¶ä»–çš„ã€‚ã€‚ã€‚</li></ol><h2 id="ç›¸å…³çš„å‡ ä¸ªè¦ç‚¹">ç›¸å…³çš„å‡ ä¸ªè¦ç‚¹<a href="post/android-project-one-for-more#ç›¸å…³çš„å‡ ä¸ªè¦ç‚¹"></a></h2><ol><li><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“<code>productFlavors</code>æ¥é…ç½®æ¸ é“ï¼Œè¿™é‡Œæˆ‘å°†æ¸ é“ç”¨æ¥è¡¨ç¤ºå“ªç§apkï¼Œå¦‚ä¸‹æˆ‘éœ€è¦é…ç½®å››ç§åº”ç”¨:</p><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">productFlavors &#123;</span><br><span class="line">  userquhua &#123;&#125;</span><br><span class="line">  quhua &#123;&#125;</span><br><span class="line">  cuntuba &#123;&#125;</span><br><span class="line">  xemh &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>å¦‚æœæˆ‘ä»¬é€‰æ‹©äº†æŸä¸€ä¸ªæ¸ é“ï¼Œé‚£ä¹ˆè¿è¡Œæ‰“åŒ…çš„æ—¶å€™ä¼šæ ¹æ®æ¸ é“åé€‰æ‹©èµ„æºæ–‡ä»¶ï¼ˆå¯ç»“åˆç¬¬6ç‚¹ä¸€èµ·çœ‹ï¼‰<br><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/one-for-more/20181029171053.png" alt=""></p></li><li><p>ç­¾åå¯åœ¨<code>signingConfigs</code>ä¸­é…ç½®å¤šä¸ªï¼ˆæˆ‘å°†æ‰€æœ‰ç­¾åæ–‡ä»¶æ”¾åœ¨äº†é¡¹ç›®è·Ÿç›®å½•çš„keyæ–‡ä»¶å¤¹ä¸­ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡<code>signingConfigs</code>æŒ‡å®šé¢„åˆ¶å¥½çš„ç­¾åé…ç½®ã€‚</p><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">signingConfigs &#123;</span><br><span class="line">    userquhuaRelease &#123;</span><br><span class="line">        storeFile file(<span class="string">"../key/xxx1.keystore"</span>)</span><br><span class="line">        storePassword <span class="string">"xxxxxx"</span></span><br><span class="line">        keyAlias <span class="string">"alias"</span></span><br><span class="line">        keyPassword <span class="string">"xxxxxx"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    quhuaRelease &#123;</span><br><span class="line">        storeFile file(<span class="string">"../key/xxx2.keystore"</span>)</span><br><span class="line">        storePassword <span class="string">"xxxxxx"</span></span><br><span class="line">        keyAlias <span class="string">"alias"</span></span><br><span class="line">        keyPassword <span class="string">"xxxxxx"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cuntubaRelease &#123;</span><br><span class="line">        storeFile file(<span class="string">"../key/xxx3.keystore"</span>)</span><br><span class="line">        storePassword <span class="string">"xxxxxx"</span></span><br><span class="line">        keyAlias <span class="string">"alias"</span></span><br><span class="line">        keyPassword <span class="string">"xxxxxx"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    xemhRelease &#123;</span><br><span class="line">        storeFile file(<span class="string">"../key/xxx4.keystore"</span>)</span><br><span class="line">        storePassword <span class="string">"xxxxxx"</span></span><br><span class="line">        keyAlias <span class="string">"alias"</span></span><br><span class="line">        keyPassword <span class="string">"xxxxxx"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>å¯åœ¨build.gradleä¸­é…ç½®åŠ¨æ€é…ç½®javaä»£ç è°ƒç”¨çš„å¸¸é‡æ•°æ®ï¼ˆå¦‚ï¼šé€šè¿‡è¯¥æ–¹å¼æˆ‘ä»¬å¯æ ¹æ®ä¸åŒæ¸ é“åŠ¨æ€é…ç½®ç¬¬ä¸‰æ–¹appidï¼Œæˆ–å…¶ä»–éœ€è¦æ ¹æ®æ¸ é“è€Œæ”¹å˜çš„æ•°æ®ï¼‰</p><ul><li><p>æ¯”å¦‚ï¼šæˆ‘ä»¬åœ¨<code>defaultConfig {}</code> ä¸­å®šä¹‰äº†:</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">buildConfigField &quot;String&quot;, &quot;SERVER_URL&quot;, &apos;&quot;http://xx.xxxx.com/&quot;&apos;</span><br></pre></td></tr></table></div></figure></li><li><p>æ­¤æ—¶ï¼Œæ‚¨çœ‹ä¸€ä¸‹æ¸…å•æ–‡ä»¶ä¸­<code>manifest</code>æ ‡ç­¾é‡Œçš„ï¼Œ<code>package</code>çš„å€¼ï¼Œå‡å¦‚æ˜¯ï¼š</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com.xxx.xx</span><br></pre></td></tr></table></div></figure></li><li><p>é‚£ä¹ˆï¼Œæ‚¨å°±å¯ä»¥åœ¨javaä»£ç ä¸­é€šè¿‡å¯¼å…¥æ–‡ä»¶ï¼š</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import com.xxx.xx.BuildConfig;</span><br></pre></td></tr></table></div></figure></li><li><p>ç„¶åè°ƒç”¨</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BuildConfig.SERVER_URL</span><br></pre></td></tr></table></div></figure></li></ul><p>å®ƒçš„å€¼å°±æ˜¯ä¸Šè¾¹é…ç½®çš„å­—ç¬¦ä¸²ï¼š<code>http://xx.xxxx.com/</code>ã€‚</p><ul><li>æ‚¨å¯ä»¥è¿›å…¥<code>BuildConfig</code>çœ‹ä¸€çœ‹ï¼Œé‡Œé¢è¿˜åŒ…å«äº†ä¸€äº›å½“å‰çš„åŒ…åç‰ˆæœ¬å·ç­‰ä¿¡æ¯ã€‚<br><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/one-for-more/20181030234102.png" alt=""></li></ul></li><li><p>åœ¨æ¸ é“é…ç½®é‚£é‡Œå¯ä»¥é…ç½®å¯¹åº”çš„åŒ…åç‰ˆæœ¬åç­¾åç­‰ç­‰<br>å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// çœç•¥å…¶ä»–é…ç½®...</span></span><br><span class="line">android &#123;</span><br><span class="line">  <span class="comment">// çœç•¥å…¶ä»–é…ç½®...</span></span><br><span class="line">  productFlavors &#123;</span><br><span class="line">      userquhua &#123;</span><br><span class="line">          applicationId <span class="string">"com.xxx.xx"</span></span><br><span class="line">          versionCode <span class="number">1</span></span><br><span class="line">          versionName <span class="string">"1.0.0"</span></span><br><span class="line">          signingConfig signingConfigs.userquhuaRelease <span class="comment">// é…ç½®ç­¾å</span></span><br><span class="line"></span><br><span class="line">          String qq_id = <span class="string">'"xxxxxxxxx"'</span> <span class="comment">//é…ç½®qq appid</span></span><br><span class="line">          buildConfigField <span class="string">"String"</span>,           <span class="string">"QQ_ID"</span>, qq_id</span><br><span class="line">          buildConfigField <span class="string">"String"</span>,           <span class="string">"WX_ID"</span>, <span class="string">'"wxxxxxxxxxxxxxxxxx"'</span> <span class="comment">// é…ç½®å¾®ä¿¡appid</span></span><br><span class="line">          manifestPlaceholders = [</span><br><span class="line"><span class="symbol">            qq_id:</span> qq_id,</span><br><span class="line">            <span class="string">JPUSH_PKGNAME :</span> applicationId,</span><br><span class="line">            <span class="string">JPUSH_APPKEY :</span> <span class="string">"xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>, <span class="comment">//JPush ä¸Šæ³¨å†Œçš„åŒ…åå¯¹åº”çš„ Appkey.</span></span><br><span class="line">            <span class="string">JPUSH_CHANNEL :</span> <span class="string">"developer-default"</span>,</span><br><span class="line">          ]</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  buildTypes &#123;</span><br><span class="line">    release &#123;</span><br><span class="line">      <span class="comment">// çœç•¥å…¶ä»–é…ç½®...</span></span><br><span class="line">        signingConfig <span class="literal">null</span>  <span class="comment">// ç½®ç©º</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    debug &#123;</span><br><span class="line">      <span class="comment">// çœç•¥å…¶ä»–é…ç½®...</span></span><br><span class="line">        signingConfig <span class="literal">null</span> <span class="comment">// ç½®ç©º</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><ul><li>è¿™æ ·ï¼Œå¦‚æœæˆ‘ä»¬æ‰“åŒ…userquhuaè¿™ä¸ªæ¸ é“ï¼Œçœ‹ç¬¬2ç‚¹ä¸­ä»‹ç»é€‰æ‹©userquhuaDebugã€‚</li><li>ç„¶åï¼Œæœ€å¥½cleanä¸€ä¸‹é¡¹ç›®ã€ç„¶åæˆ‘ä»¬è¿è¡Œé¡¹ç›®ã€‚</li><li>è¯¥appçš„åŒ…åå°±æ˜¯<code>com.xxx.xx</code>ï¼Œç‰ˆæœ¬å·ä¸º<code>1</code>ï¼Œç‰ˆæœ¬åä¸º<code>1.0.0</code>ã€‚</li><li>é€šè¿‡<code>BuildConfig</code>è°ƒç”¨<code>QQ_ID</code>é™æ€å¸¸é‡ï¼Œå°±æ˜¯è¯¥æ¸ é“é‡Œé…ç½®çš„å€¼ï¼Œ<code>WX_ID</code>åŒç†ã€‚</li><li><code>manifestPlaceholders</code>é…ç½®ä¹Ÿå¯ä»¥è¿™æ ·é…ç½®ã€‚</li><li>ç­¾åé—®é¢˜ç»è¿‡ä¸ªäººåå¤å°è¯•ï¼ˆç„¶ååŠå¤©å°±è¿‡å»äº†ï¿£ã¸ï¿£ï¼‰ï¼Œæœ€ç»ˆç­¾åå¦‚ä¸Šé…ç½®ã€‚<strong>éœ€è¦æ³¨æ„</strong><code>buildTypes</code>ä¸­çš„ç­¾åé…ç½®<code>signingConfig</code>å¦‚æœä¸è®¾ç½®ä¸º<code>null</code>ï¼Œé‚£ä¹ˆæ‰“åŒ…çš„æ˜¯æœ‰è¿˜æ˜¯ä»¥å†…ç½®çš„ç­¾åæ‰“åŒ…ã€‚</li></ul></li><li>èµ„æºæ–‡ä»¶æ›¿æ¢<br>å†çœ‹åˆ°ç¬¬2ç‚¹çš„ä»‹ç»ï¼Œæˆ‘ä»¬é€‰æ‹©è¿è¡Œæ¸ é“åï¼Œä¼šé»˜è®¤åŒ¹é…å¯¹åº”æ¸ é“ä¸‹çš„èµ„æºã€‚ä¸‹é¢æˆ‘å°†<code>xemh</code>æ¸ é“çš„èµ„æºç›®å½•å…¨éƒ¨å±•å¼€ä¸€ä¸‹ã€‚<br><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/one-for-more/20181029233306.png" alt=""><ul><li>å¦‚ä¸Šå›¾è¿™æ ·ï¼Œåªéœ€è¦èµ„æºåå­—å’Œappç›®å½•å¯¹åº”çš„æ–‡ä»¶åå­—ä¸€æ ·å³å¯æ›¿æ¢ã€‚</li><li>strings.xmlé‡Œçš„åº”ç”¨åï¼Œåªéœ€è¦å°†å¯¹åº”<code>app_name</code>ä¿®æ”¹æ—¢å¯æ›¿æ¢appä¸‹stringsçš„<code>app_name</code>ï¼Œå…¶ä»–ä¸ç”¨æ›¿æ¢çš„ä¸ç”¨å†™å°±è¡Œã€‚</li></ul></li><li>æ‰“æ­£å¼åŒ…çš„æ—¶å€™é€‰å¥½æ¸ é“ï¼Œå°±å¯ä»¥æ‰“åŒ…ä¸åŒé…ç½®çš„apkï¼Œå½“ç„¶æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤çš„æ–¹å¼ã€‚<br><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/one-for-more/20181029234235.png" alt=""></li></ol><h2 id="å…¶ä»–é…ç½®è®°å½•">å…¶ä»–é…ç½®è®°å½•<a href="post/android-project-one-for-more#å…¶ä»–é…ç½®è®°å½•"></a></h2><blockquote><p>è·å–å½“å‰æ—¶é—´</p></blockquote><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">def</span> releaseTime() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Date().format(<span class="string">"yyyy-MM-dd-HH.mm"</span>, TimeZone.getTimeZone(<span class="string">"GMT+8"</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>æ‰“åŒ…çš„æ—¶å€™ï¼Œä¿®æ”¹æ–‡ä»¶åï¼Œä»¥æ–¹ä¾¿åŒºåˆ«æ¸ é“å’Œç‰ˆæœ¬æ‰“åŒ…æ—¶é—´</p></blockquote><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">applicationVariants.all &#123;</span><br><span class="line">    variant -&gt;</span><br><span class="line">        variant.outputs.all &#123;</span><br><span class="line">            outputFileName = <span class="string">"$&#123;variant.productFlavors[0].name&#125;-v$&#123;variant.productFlavors[0].versionName&#125;-$&#123;releaseTime()&#125;.apk"</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><ul><li><code>${variant.productFlavors[0].name}</code>å½“å‰æ¸ é“å</li><li><code>${variant.productFlavors[0].versionName}</code>å½“å‰ç‰ˆæœ¬å</li><li><code>${releaseTime()}</code>å½“å‰æ—¶é—´</li></ul><h2 id="å…¶ä»–éœ€è¦æ³¨æ„äº‹é¡¹">å…¶ä»–éœ€è¦æ³¨æ„äº‹é¡¹<a href="post/android-project-one-for-more#å…¶ä»–éœ€è¦æ³¨æ„äº‹é¡¹"></a></h2><p>å¦‚æœæ‚¨åœ¨æ¸…å•æ–‡ä»¶<code>AndroidManifest.xml</code>ä¸­ï¼Œæœ‰é‚£ç§ä»¥åŒ…åå¼€å¤´å‘½åçš„é‚£ç§ã€‚å› ä¸ºå¦‚æœåŒ…åéƒ½æ”¹äº†ï¼Œæœ‰äº›ä¹Ÿéœ€è¦åŠ¨æ€çš„æ”¹å˜ã€‚å¯ä»¥ç”¨<code>${applicationId}</code>ä»£æ›¿ã€‚åœ¨æ‰“åŒ…çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨æ›¿æ¢æˆå½“å‰åŒ…åã€‚</p><blockquote><p>æ¯”å¦‚ï¼Œç±»ä¼¼ä¸‹é…ç½®ï¼š</p></blockquote><figure class="highlight xml"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">permission</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">"com.xxx.xx.permission.JPUSH_MESSAGE"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:protectionLevel</span>=<span class="string">"signature"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"com.xxx.xx.permission.JPUSH_MESSAGE"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">receiver</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">".push.MyJPushMessageReceiver"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:enabled</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">"false"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"cn.jpush.android.intent.RECEIVE_MESSAGE"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"com.xxx.xx"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">receiver</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">provider</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">"android.support.v4.content.FileProvider"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:authorities</span>=<span class="string">"com.xxx.xx.provider"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:replace</span>=<span class="string">"android:authorities"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:grantUriPermissions</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">"android.support.FILE_PROVIDER_PATHS"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:resource</span>=<span class="string">"@xml/file_paths"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br></pre></td></tr></table></div></figure><blockquote><p>å¯æ”¹ä¸ºï¼š</p></blockquote><figure class="highlight xml"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">permission</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">"$&#123;applicationId&#125;.permission.JPUSH_MESSAGE"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:protectionLevel</span>=<span class="string">"signature"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"$&#123;applicationId&#125;.permission.JPUSH_MESSAGE"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">receiver</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">".push.MyJPushMessageReceiver"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:enabled</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">"false"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"cn.jpush.android.intent.RECEIVE_MESSAGE"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"$&#123;applicationId&#125;"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">receiver</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">provider</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">"android.support.v4.content.FileProvider"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:authorities</span>=<span class="string">"$&#123;applicationId&#125;.provider"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:replace</span>=<span class="string">"android:authorities"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:grantUriPermissions</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">"android.support.FILE_PROVIDER_PATHS"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:resource</span>=<span class="string">"@xml/file_paths"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br></pre></td></tr></table></div></figure><blockquote><p>å½“ç„¶å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä»£ç ä¸­æˆ‘ä»¬ä¹Ÿä¸èƒ½æŠŠåŒ…åå†™æ­»äº†ï¼Œå¯é€šè¿‡<code>BuildConfig</code>å¾—åˆ°å½“å‰åŒ…å</p></blockquote><h2 id="æˆ‘çš„å®Œæ•´é…ç½®ï¼Œä¾›å‚è€ƒ">æˆ‘çš„å®Œæ•´é…ç½®ï¼Œä¾›å‚è€ƒ<a href="post/android-project-one-for-more#æˆ‘çš„å®Œæ•´é…ç½®ï¼Œä¾›å‚è€ƒ"></a></h2><blockquote><p>æœ‰å…³éšç§ä¿¡æ¯çš„éƒ½ç”¨xxxæ›¿æ¢äº†</p></blockquote><ol><li><p>é¡¹ç›®æ ¹ç›®å½•çš„<code>build.gradle</code></p><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Top-level build file where you can add configuration options common to all sub-projects/modules.</span></span><br><span class="line"></span><br><span class="line">buildscript &#123;</span><br><span class="line"></span><br><span class="line">    repositories &#123;</span><br><span class="line">        google()</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath <span class="string">'com.android.tools.build:gradle:3.0.0'</span></span><br><span class="line">        classpath <span class="string">"io.github.prototypez:save-state:0.1.7"</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// <span class="doctag">NOTE:</span> Do not place your application dependencies here; they belong</span></span><br><span class="line">        <span class="comment">// in the individual module build.gradle files</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">allprojects &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        google()</span><br><span class="line">        jcenter()</span><br><span class="line">        maven &#123; url <span class="string">"https://jitpack.io"</span> &#125;</span><br><span class="line">        maven &#123; url <span class="string">'http://oss.jfrog.org/artifactory/oss-snapshot-local/'</span> &#125;</span><br><span class="line">        flatDir &#123;</span><br><span class="line">            dirs <span class="string">'libs'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">task clean(<span class="string">type:</span> Delete) &#123;</span><br><span class="line">    delete rootProject.buildDir</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ext&#123;</span><br><span class="line">    minSdkVersion               = <span class="number">16</span></span><br><span class="line">    targetSdkVersion            = <span class="number">27</span></span><br><span class="line">    compileSdkVersion           = <span class="number">27</span></span><br><span class="line">    buildToolsVersion           = <span class="string">'27.1.1'</span></span><br><span class="line"></span><br><span class="line">    supportLibraryVersion       = <span class="string">'27.1.1'</span></span><br><span class="line">    xmvpVersion                 = <span class="string">'1.2.2'</span></span><br><span class="line">    retrofit2Version            = <span class="string">'2.3.0'</span></span><br><span class="line">    okhttp3Version              = <span class="string">'3.8.1'</span></span><br><span class="line">    butterknifeVersion          = <span class="string">'8.6.0'</span></span><br><span class="line">    rx2Version                  = <span class="string">'2.0.2'</span></span><br><span class="line">    CircleProgressDialogVersion = <span class="string">'1.0.2'</span></span><br><span class="line">    smarttabVersion             = <span class="string">'1.6.1@aar'</span></span><br><span class="line">    adapterHelperVersion        = <span class="string">'2.9.41'</span></span><br><span class="line">    glideVersion                = <span class="string">'4.7.1'</span></span><br><span class="line">    roundedimageviewVersion     = <span class="string">'2.3.0'</span></span><br><span class="line">    eventbusVersion             = <span class="string">'3.0.0'</span></span><br><span class="line">    dispatcherVersion           = <span class="string">'2.4.0'</span></span><br><span class="line">    picture_libraryVersion      = <span class="string">'v2.2.3'</span></span><br><span class="line">    statusbarutilVersion        = <span class="string">'1.5.1'</span></span><br><span class="line">    okhttpUtilsVersion          = <span class="string">'3.8.0'</span></span><br><span class="line">    constraintVersion           = <span class="string">'1.1.3'</span></span><br><span class="line">    flexboxVersion              = <span class="string">'1.0.0'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>appç›®å½•ä¸‹çš„<code>build.gradle</code></p><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">'com.android.application'</span></span><br><span class="line">apply <span class="string">plugin:</span> <span class="string">'save.state'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">def</span> releaseTime() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Date().format(<span class="string">"yyyy-MM-dd-HH.mm"</span>, TimeZone.getTimeZone(<span class="string">"GMT+8"</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion rootProject.compileSdkVersion</span><br><span class="line"><span class="comment">//    buildToolsVersion rootProject.buildToolsVersion</span></span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        minSdkVersion rootProject.minSdkVersion</span><br><span class="line">        targetSdkVersion rootProject.targetSdkVersion</span><br><span class="line"></span><br><span class="line">        testInstrumentationRunner <span class="string">"android.support.test.runner.AndroidJUnitRunner"</span></span><br><span class="line">        multiDexEnabled <span class="literal">true</span></span><br><span class="line">        <span class="comment">// config the JSON processing library</span></span><br><span class="line">        javaCompileOptions &#123;</span><br><span class="line">            annotationProcessorOptions &#123;</span><br><span class="line">                arguments = [ <span class="string">serializer :</span> <span class="string">"gson"</span> ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ndk &#123;</span><br><span class="line">            abiFilters <span class="string">"armeabi-v7a"</span></span><br><span class="line">        &#125;</span><br><span class="line">        renderscriptTargetApi <span class="number">25</span></span><br><span class="line">        renderscriptSupportModeEnabled <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    signingConfigs &#123;</span><br><span class="line">        userquhuaRelease &#123;</span><br><span class="line">            storeFile file(<span class="string">"../key/xxx.keystore"</span>)</span><br><span class="line">            storePassword <span class="string">"xxxxxx"</span></span><br><span class="line">            keyAlias <span class="string">"xxx"</span></span><br><span class="line">            keyPassword <span class="string">"xxxxxx"</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        quhuaRelease &#123;</span><br><span class="line">            storeFile file(<span class="string">"../key/xxx.keystore"</span>)</span><br><span class="line">            storePassword <span class="string">"xxxxxxx"</span></span><br><span class="line">            keyAlias <span class="string">"xxx"</span></span><br><span class="line">            keyPassword <span class="string">"xxxxxxx"</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        cuntubaRelease &#123;</span><br><span class="line">            storeFile file(<span class="string">"../key/xxx.keystore"</span>)</span><br><span class="line">            storePassword <span class="string">"xxxxxxx"</span></span><br><span class="line">            keyAlias <span class="string">"xxx"</span></span><br><span class="line">            keyPassword <span class="string">"xxxxxxx"</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        xemhRelease &#123;</span><br><span class="line">            storeFile file(<span class="string">"../key/xxx.keystore"</span>)</span><br><span class="line">            storePassword <span class="string">"xxxxxxx"</span></span><br><span class="line">            keyAlias <span class="string">"xxx"</span></span><br><span class="line">            keyPassword <span class="string">"xxxxxxx"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    flavorDimensions <span class="string">"default"</span></span><br><span class="line">    productFlavors &#123;</span><br><span class="line">        userquhua &#123;</span><br><span class="line">            applicationId <span class="string">"com.xxx.xx"</span></span><br><span class="line">            versionCode <span class="number">22</span></span><br><span class="line">            versionName <span class="string">"1.7.5"</span></span><br><span class="line">            signingConfig = signingConfigs.userquhuaRelease</span><br><span class="line"></span><br><span class="line">            String qq_id = <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"QQ_ID"</span>, qq_id <span class="comment">// qq appId</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,         <span class="string">"SINA_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// æ–°æµªappId</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"WX_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¾®ä¿¡ appId</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"UM_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å‹ç›Ÿ</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,       <span class="string">"WX_SECRET"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¾®ä¿¡ secret</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"SINA_REDIRECT"</span>, <span class="string">'"http://open.weibo.com/apps/xxxxxx/privilege/oauth"'</span> <span class="comment">// æ–°æµª</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"ADHUB_INIT_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¹¿å‘Šsdkåˆå§‹åŒ–id</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_SPLASH_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¼€å±å¹¿å‘Šid</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_BANNER_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// bannerå¹¿å‘Šid</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,      <span class="string">"SERVER_URL"</span>, <span class="string">'"http://xxx.xxx.com/"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,        <span class="string">"LOGO_URL"</span>, <span class="string">'"http://file.xxx.com/img/xxx.png"'</span></span><br><span class="line"></span><br><span class="line">            manifestPlaceholders = [</span><br><span class="line"><span class="symbol">                    qq_id:</span> qq_id,</span><br><span class="line">                    <span class="string">JPUSH_PKGNAME :</span> applicationId,</span><br><span class="line">                    <span class="string">JPUSH_APPKEY :</span> <span class="string">"xxxxxx"</span>, <span class="comment">//JPush ä¸Šæ³¨å†Œçš„åŒ…åå¯¹åº”çš„ Appkey.</span></span><br><span class="line">                    <span class="string">JPUSH_CHANNEL :</span> <span class="string">"developer-default"</span>, <span class="comment">//æš‚æ—¶å¡«å†™é»˜è®¤å€¼å³å¯.</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        quhua &#123;</span><br><span class="line">            applicationId <span class="string">"com.xxx.xx"</span></span><br><span class="line">            versionCode <span class="number">1</span></span><br><span class="line">            versionName <span class="string">"1.0.0"</span></span><br><span class="line">            signingConfig = signingConfigs.quhuaRelease</span><br><span class="line"></span><br><span class="line">            String qq_id = <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"QQ_ID"</span>, qq_id</span><br><span class="line">            buildConfigField <span class="string">"String"</span>,         <span class="string">"SINA_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"WX_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"UM_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,       <span class="string">"WX_SECRET"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"SINA_REDIRECT"</span>, <span class="string">'"http://open.weibo.com/apps/xxxxxx/privilege/oauth"'</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"ADHUB_INIT_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¹¿å‘Šsdkåˆå§‹åŒ–id</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_SPLASH_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¼€å±å¹¿å‘Šid</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_BANNER_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// bannerå¹¿å‘Šid</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,      <span class="string">"SERVER_URL"</span>, <span class="string">'"http://xx.xxx.com/"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,        <span class="string">"LOGO_URL"</span>, <span class="string">'"http://file.xxx.com/img/xxx.png"'</span></span><br><span class="line"></span><br><span class="line">            manifestPlaceholders = [</span><br><span class="line"><span class="symbol">                    qq_id:</span> qq_id,</span><br><span class="line">                    <span class="string">JPUSH_PKGNAME :</span> applicationId,</span><br><span class="line">                    <span class="string">JPUSH_APPKEY :</span> <span class="string">"xxxxxx"</span>, <span class="comment">//JPush ä¸Šæ³¨å†Œçš„åŒ…åå¯¹åº”çš„ Appkey.</span></span><br><span class="line">                    <span class="string">JPUSH_CHANNEL :</span> <span class="string">"developer-default"</span>, <span class="comment">//æš‚æ—¶å¡«å†™é»˜è®¤å€¼å³å¯.</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        cuntuba &#123;</span><br><span class="line">            applicationId <span class="string">"com.xxx.xx"</span></span><br><span class="line">            versionCode <span class="number">1</span></span><br><span class="line">            versionName <span class="string">"1.0.0"</span></span><br><span class="line">            signingConfig = signingConfigs.cuntubaRelease</span><br><span class="line"></span><br><span class="line">            String qq_id = <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"QQ_ID"</span>, qq_id</span><br><span class="line">            buildConfigField <span class="string">"String"</span>,         <span class="string">"SINA_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"WX_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"UM_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,       <span class="string">"WX_SECRET"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"SINA_REDIRECT"</span>, <span class="string">'"http://open.weibo.com/apps/xxxxxx/privilege/oauth"'</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"ADHUB_INIT_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¹¿å‘Šsdkåˆå§‹åŒ–id</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_SPLASH_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¼€å±å¹¿å‘Šid</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_BANNER_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// bannerå¹¿å‘Šid</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,      <span class="string">"SERVER_URL"</span>, <span class="string">'"http://xxx.xxxx.com/"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,        <span class="string">"LOGO_URL"</span>, <span class="string">'"http://file.xxx.com/img/xxx.png"'</span></span><br><span class="line"></span><br><span class="line">            manifestPlaceholders = [</span><br><span class="line"><span class="symbol">                    qq_id:</span> qq_id,</span><br><span class="line">                    <span class="string">JPUSH_PKGNAME :</span> applicationId,</span><br><span class="line">                    <span class="string">JPUSH_APPKEY :</span> <span class="string">"xxxxxx"</span>, <span class="comment">//JPush ä¸Šæ³¨å†Œçš„åŒ…åå¯¹åº”çš„ Appkey.</span></span><br><span class="line">                    <span class="string">JPUSH_CHANNEL :</span> <span class="string">"developer-default"</span>, <span class="comment">//æš‚æ—¶å¡«å†™é»˜è®¤å€¼å³å¯.</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        xemh &#123;</span><br><span class="line">            applicationId <span class="string">"com.xxx.xx"</span></span><br><span class="line">            versionCode <span class="number">1</span></span><br><span class="line">            versionName <span class="string">"1.0.0"</span></span><br><span class="line">            signingConfig = signingConfigs.xemhRelease</span><br><span class="line"></span><br><span class="line">            String qq_id = <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"QQ_ID"</span>, qq_id</span><br><span class="line">            buildConfigField <span class="string">"String"</span>,         <span class="string">"SINA_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"WX_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"UM_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,       <span class="string">"WX_SECRET"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"SINA_REDIRECT"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"ADHUB_INIT_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¹¿å‘Šsdkåˆå§‹åŒ–id</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_SPLASH_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¼€å±å¹¿å‘Šid</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_BANNER_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// bannerå¹¿å‘Šid</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,      <span class="string">"SERVER_URL"</span>, <span class="string">'"http://xx.xxx.com/"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,        <span class="string">"LOGO_URL"</span>, <span class="string">'"http://file.xxxxxx.com/img/xxxxxx.png"'</span></span><br><span class="line"></span><br><span class="line">            manifestPlaceholders = [</span><br><span class="line"><span class="symbol">                    qq_id:</span> qq_id,</span><br><span class="line">                    <span class="string">JPUSH_PKGNAME :</span> applicationId,</span><br><span class="line">                    <span class="string">JPUSH_APPKEY :</span> <span class="string">"xxxxxx"</span>, <span class="comment">//JPush ä¸Šæ³¨å†Œçš„åŒ…åå¯¹åº”çš„ Appkey.</span></span><br><span class="line">                    <span class="string">JPUSH_CHANNEL :</span> <span class="string">"developer-default"</span>, <span class="comment">//æš‚æ—¶å¡«å†™é»˜è®¤å€¼å³å¯.</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    applicationVariants.all &#123;</span><br><span class="line">        variant -&gt;</span><br><span class="line">            variant.outputs.all &#123;</span><br><span class="line">                outputFileName = <span class="string">"$&#123;variant.productFlavors[0].name&#125;-v$&#123;variant.productFlavors[0].versionName&#125;-$&#123;releaseTime()&#125;.apk"</span></span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            <span class="comment">// ä¸æ˜¾ç¤ºLog</span></span><br><span class="line">            buildConfigField <span class="string">"boolean"</span>, <span class="string">"LOG_DEBUG"</span>, <span class="string">"false"</span></span><br><span class="line">            signingConfig <span class="literal">null</span></span><br><span class="line">            minifyEnabled <span class="literal">true</span></span><br><span class="line">            zipAlignEnabled <span class="literal">true</span></span><br><span class="line">            <span class="comment">// ç§»é™¤æ— ç”¨çš„resourceæ–‡ä»¶</span></span><br><span class="line">            shrinkResources <span class="literal">true</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.pro'</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        debug &#123;</span><br><span class="line">            <span class="comment">// æ˜¾ç¤ºLog</span></span><br><span class="line">            buildConfigField <span class="string">"boolean"</span>, <span class="string">"LOG_DEBUG"</span>, <span class="string">"true"</span></span><br><span class="line">            signingConfig <span class="literal">null</span></span><br><span class="line">            minifyEnabled <span class="literal">false</span></span><br><span class="line">            zipAlignEnabled <span class="literal">false</span></span><br><span class="line">            shrinkResources <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    packagingOptions &#123;</span><br><span class="line">        exclude <span class="string">'META-INF/DEPENDENCIES.txt'</span></span><br><span class="line">        exclude <span class="string">'META-INF/NOTICE'</span></span><br><span class="line">        exclude <span class="string">'META-INF/NOTICE.txt'</span></span><br><span class="line">        exclude <span class="string">'META-INF/LICENSE'</span></span><br><span class="line">        exclude <span class="string">'META-INF/LICENSE.txt'</span></span><br><span class="line">    &#125;</span><br><span class="line">    compileOptions &#123;</span><br><span class="line">        targetCompatibility JavaVersion.VERSION_1_8</span><br><span class="line">        sourceCompatibility JavaVersion.VERSION_1_8</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dexOptions &#123;</span><br><span class="line"></span><br><span class="line">        javaMaxHeapSize <span class="string">"4g"</span> <span class="comment">//æ­¤å¤„å¯æ ¹æ®ç”µè„‘æœ¬èº«é…ç½® æ•°å€¼è¶Šå¤§ å½“ç„¶è¶Šå¿«</span></span><br><span class="line"></span><br><span class="line">        preDexLibraries = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">repositories &#123;</span><br><span class="line">    flatDir &#123;</span><br><span class="line">        dirs <span class="string">'libs'</span>, <span class="string">'../adpoymer/libs'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    implementation fileTree(<span class="string">include:</span> [<span class="string">'*.jar'</span>], <span class="string">dir:</span> <span class="string">'libs'</span>)</span><br><span class="line">    implementation <span class="string">"com.android.support:appcompat-v7:$supportLibraryVersion"</span></span><br><span class="line">    implementation <span class="string">"com.android.support:recyclerview-v7:$supportLibraryVersion"</span></span><br><span class="line">    implementation <span class="string">"com.android.support:support-v4:$supportLibraryVersion"</span></span><br><span class="line">    implementation <span class="string">"com.android.support:design:$supportLibraryVersion"</span></span><br><span class="line">    implementation <span class="string">"com.android.support.constraint:constraint-layout:$constraintVersion"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ·»åŠ retrofit2 çš„ä¾èµ– æ·»åŠ è¿™ä¸ªä¾èµ–å°±é»˜è®¤æ·»åŠ äº†okhttpä¾èµ–</span></span><br><span class="line">    compile <span class="string">"com.squareup.retrofit2:retrofit:$retrofit2Version"</span></span><br><span class="line">    compile <span class="string">"com.squareup.retrofit2:converter-gson:$retrofit2Version"</span></span><br><span class="line">    compile <span class="string">"com.squareup.retrofit2:adapter-rxjava2:$retrofit2Version"</span></span><br><span class="line">    compile <span class="string">"com.squareup.okhttp3:logging-interceptor:$okhttp3Version"</span></span><br><span class="line">    compile <span class="string">"com.jakewharton:butterknife:$butterknifeVersion"</span></span><br><span class="line">    annotationProcessor <span class="string">"com.jakewharton:butterknife-compiler:$butterknifeVersion"</span></span><br><span class="line">    compile <span class="string">"io.reactivex.rxjava2:rxandroid:$rx2Version"</span></span><br><span class="line">    compile <span class="string">"com.github.xujiaji:xmvp:$xmvpVersion"</span></span><br><span class="line">    implementation <span class="string">"com.github.autume:CircleProgressDialog:$CircleProgressDialogVersion"</span></span><br><span class="line">    compile <span class="string">"com.ogaclejapan.smarttablayout:library:$smarttabVersion"</span></span><br><span class="line">    compile <span class="string">"com.github.CymChad:BaseRecyclerViewAdapterHelper:$adapterHelperVersion"</span></span><br><span class="line"></span><br><span class="line">    compile <span class="string">"com.github.bumptech.glide:glide:$glideVersion"</span></span><br><span class="line">    annotationProcessor <span class="string">"com.github.bumptech.glide:compiler:$glideVersion"</span></span><br><span class="line"></span><br><span class="line">    compile <span class="string">"com.makeramen:roundedimageview:$roundedimageviewVersion"</span></span><br><span class="line">    compile <span class="string">"org.greenrobot:eventbus:$eventbusVersion"</span></span><br><span class="line">    annotationProcessor <span class="string">"com.github.hotchemi:permissionsdispatcher-processor:$dispatcherVersion"</span></span><br><span class="line">    compile <span class="string">"com.jaeger.statusbarutil:library:$statusbarutilVersion"</span></span><br><span class="line">    compile(<span class="string">"com.github.hotchemi:permissionsdispatcher:$dispatcherVersion"</span>) &#123;</span><br><span class="line">        exclude <span class="string">module:</span> <span class="string">"support-v13"</span></span><br><span class="line">    &#125;</span><br><span class="line">    implementation <span class="string">"com.github.LuckSiege.PictureSelector:picture_library:$picture_libraryVersion"</span></span><br><span class="line">    implementation <span class="string">'me.drakeet.library:crashwoodpecker:2.1.1'</span></span><br><span class="line">    implementation <span class="string">'com.github.chenupt.android:springindicator:1.0.2@aar'</span></span><br><span class="line">    debugImplementation <span class="string">'com.amitshekhar.android:debug-db:1.0.4'</span></span><br><span class="line">    implementation <span class="string">'com.umeng.sdk:common:1.5.3'</span></span><br><span class="line">    implementation <span class="string">'com.umeng.sdk:analytics:7.5.3'</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">'com.liulishuo.filedownloader:library:1.7.5'</span></span><br><span class="line"></span><br><span class="line">    implementation project(<span class="string">':banner'</span>)</span><br><span class="line">    implementation project(<span class="string">':xdialog'</span>)</span><br><span class="line">    implementation project(<span class="string">':shareutil'</span>)</span><br><span class="line">    implementation project(<span class="string">':update'</span>)</span><br><span class="line">    implementation project(<span class="string">':pay'</span>)</span><br><span class="line"><span class="comment">//    implementation project(':adhub')</span></span><br><span class="line">    implementation project(<span class="string">':imagewatcher'</span>)</span><br><span class="line">    implementation files(<span class="string">'libs/lite-orm-1.9.2.jar'</span>)</span><br><span class="line">    implementation <span class="string">'jp.wasabeef:blurry:2.1.1'</span></span><br><span class="line">    implementation <span class="string">"com.google.android:flexbox:$flexboxVersion"</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">'cn.jiguang.sdk:jpush:3.1.6'</span>  <span class="comment">// æ­¤å¤„ä»¥JPush 3.1.6 ç‰ˆæœ¬ä¸ºä¾‹ã€‚</span></span><br><span class="line">    implementation <span class="string">'cn.jiguang.sdk:jcore:1.2.5'</span>  <span class="comment">// æ­¤å¤„ä»¥JCore 1.2.5 ç‰ˆæœ¬ä¸ºä¾‹ã€‚</span></span><br><span class="line"></span><br><span class="line">    compile(<span class="string">name:</span> <span class="string">'sdk-release'</span>, <span class="string">ext:</span> <span class="string">'aar'</span>)</span><br><span class="line">    compile(<span class="string">name:</span> <span class="string">'open_ad_sdk'</span>, <span class="string">ext:</span> <span class="string">'aar'</span>)</span><br><span class="line">    compile(<span class="string">name:</span> <span class="string">'adpoymer-3.4.35'</span>, <span class="string">ext:</span> <span class="string">'aar'</span>)</span><br><span class="line">    implementation <span class="string">'pl.droidsonroids.gif:android-gif-drawable:1.0.+'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ol><h2 id="Demo-åœ°å€">Demo åœ°å€<a href="post/android-project-one-for-more#Demo-åœ°å€"></a></h2><p><a href="https://github.com/xujiaji/OneForAllApk" target="_blank" rel="noopener">https://github.com/xujiaji/OneForAllApk</a></p><h2 id="ç»“æŸ">ç»“æŸ<a href="post/android-project-one-for-more#ç»“æŸ"></a></h2><p>å°±è¿™æ ·å°±å¯ä»¥è§£æ”¾å¤§é‡åŠ³åŠ¨åŠ›å•¦ï¼æ¯æ¬¡é¡¹ç›®æ‰“åŒ…å„ç§è½¯ä»¶ï¼Œé€‰ä¸€ä¸‹å°±ojbkï¼Œå“ˆå“ˆå“ˆ~<br>å¦‚æœæœ‰äº›é…ç½®åœ¨å…¶ä»–æ¸ é“æ²¡æœ‰çš„ï¼Œä¹Ÿå¯é€šè¿‡BuildConfigåœ¨javaä¸­åˆ¤æ–­å¦‚æœæ˜¯æŸæŸæ¸ é“é‚£ä¹ˆå±è”½ã€‚<br>over</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ç®€ä»‹&quot;&gt;ç®€ä»‹&lt;a href=&quot;post/android-project-one-for-more#ç®€ä»‹&quot;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;å¦‚é¢˜æ‰€ç¤ºï¼æœ¬ç¯‡æ–‡ç« å°±æ˜¯ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ã€‚æ–¹ä¾¿æ‰“åŒ…å’Œè¿è¡Œçš„æ—¶å€™èƒ½åšåˆ°æ— éœ€æ‰‹åŠ¨æ›¿æ¢é…ç½®ï¼Œå³å¯æ‰“åŒ…æƒ³è¦çš„apkã€‚æ‰“åŒ…çš„æ—¶å€™ï¼Œåªéœ€é€‰ä¸€ä¸‹æƒ³æ‰“å“ª
      
    
    </summary>
    
      <category term="Android" scheme="https://blog.xujiaji.com/categories/Android/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="é¡¹ç›®é…ç½®" scheme="https://blog.xujiaji.com/tags/%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>XMVPï¼šä¸€ä¸ªé€šè¿‡æ³›å‹å®ç°çš„MVPæ¡†æ¶2å¹´çš„æ¼”åŒ–è·¯</title>
    <link href="https://blog.xujiaji.com/post/xmvp-framework/index.html"/>
    <id>https://blog.xujiaji.com/post/xmvp-framework/index.html</id>
    <published>2018-09-21T10:22:15.000Z</published>
    <updated>2019-04-08T06:57:05.292Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>XMVPæ¡†æ¶æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªæ¡†æ¶ï¼Œåˆšä»Androidèµ·æ­¥ç¬¬ä¸€æ¬¡äº†è§£MVPæ¨¡å¼æ—¶å†³å¿ƒå†™ä¸€ä¸ªè‡ªå·±çš„ä¸œè¥¿æ¡†æ¶ï¼Œåˆ°ç°åœ¨å·²è¿ç”¨åœ¨æˆ‘å†™çš„å¤šä¸ªé¡¹ç›®ä¸­ã€‚è™½ç„¶ä¸¤å¹´äº†ï¼Œä½†æ ¸å¿ƒçš„æ€è·¯æ²¡æœ‰æ”¹å˜ï¼Œåˆ°ç°åœ¨å˜æ¢ä¹Ÿä¸æ˜¯å¤ªå¤šï¼Œç²¾ç®€äº†ä¸€äº›ä»£ç ï¼Œæ·»åŠ äº†ä¸€äº›åŠŸèƒ½ã€‚</p></blockquote><a id="more"></a><h2 id="èµ·æ­¥2016">èµ·æ­¥2016<a href="post/xmvp-framework#èµ·æ­¥2016"></a></h2><p>è¿™æ˜¯ä¸ªåˆšå‡ºç¤¾ä¼šæ‰¾å·¥ä½œç—›è‹¦çš„æ—¶æœŸï¼Œæˆ‘ä¸ªäººä¸å¤ªå–œæ¬¢ç”Ÿæ´»ä¸­éº»çƒ¦çš„äº‹æƒ…ã€‚å®‰é™æ˜¯æˆ‘çš„æœ¬æ€§ï¼Œäºæ˜¯æƒ³å†™ä¸ªå±äºè‡ªå·±çš„æ¡†æ¶ï¼Œä¸ºæœªæ¥åšäº›é“ºå«ã€‚äºæ˜¯ï¼Œä¾¿æœ‰äº†XMVPï¼Œåå­—â€œXâ€æ˜¯è‡­ä¸è¦è„¸çš„åŠ ä¸Šäº†è‡ªå·±åå­—çš„å¼€å¤´å­—æ¯ã€‚</p><h4 id="ç›®æ ‡">ç›®æ ‡<a href="post/xmvp-framework#ç›®æ ‡"></a></h4><p><strong>è¯¥æ¡†æ¶çš„ç›®æ ‡å¾ˆç®€å•ï¼Œä¸ºäº†çœæ‰Viewã€Modelã€Presenterå±‚ä¹‹é—´çš„ä¾èµ–å®ç°è¿‡ç¨‹ï¼Œé€šè¿‡ç®€å•çš„é…ç½®ï¼Œæ¡†æ¶è‡ªåŠ¨å®ç°ä¾èµ–å…³ç³»</strong></p><p>å®ç°çš„åŸç†ï¼šè·å–é…ç½®çš„æ³›å‹ç±»å‹ï¼Œé€šè¿‡åå°„å®ä¾‹åŒ–På±‚å’ŒMå±‚ã€‚</p><h4 id="ä»£ç ">ä»£ç <a href="post/xmvp-framework#ä»£ç "></a></h4><p><strong>1.</strong> å…³é”®èƒ½è®©æˆ‘å¼€å§‹åšè¿™ä¸ªæ¡†æ¶çš„æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><blockquote><p>ä¼ å…¥å¯¹è±¡çš„Classå’Œéœ€è¦è¿‡æ»¤æ³›å‹å¾—çš„åŒ¹é…çš„å¯¹è±¡ï¼Œç„¶åéå†<code>klass</code>ä¸­é…ç½®çš„æ³›å‹åˆ¤æ–­æ˜¯ä¸æ˜¯<code>filterClass</code>çš„å­ç±»ï¼Œå¦‚æœæ˜¯åˆ™æ‰¾åˆ°äº†é…ç½®çš„æ³›å‹ç±»å‹ã€‚</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">Class&lt;T&gt; <span class="title">getGenericClass</span><span class="params">(Class&lt;?&gt; klass, Class&lt;?&gt; filterClass)</span> </span>&#123;</span><br><span class="line">    Type type = klass.getGenericSuperclass(); <span class="comment">// è·å–çˆ¶ç±»Classç±»å‹ï¼Œå®ƒåŒ…å«äº†æ‰€é…ç½®çš„æ³›å‹ç±»å‹</span></span><br><span class="line">    <span class="keyword">if</span> (type == <span class="keyword">null</span> || !(type <span class="keyword">instanceof</span> ParameterizedType)) <span class="keyword">return</span> <span class="keyword">null</span>; <span class="comment">// åˆ¤æ–­æ˜¯å¦æ˜¯æ³›å‹ç±»å‹</span></span><br><span class="line">    ParameterizedType parameterizedType = (ParameterizedType) type;</span><br><span class="line">    Type[] types = parameterizedType.getActualTypeArguments(); <span class="comment">// ç”±äºä¸€ä¸ªç±»å¯èƒ½ä¸æ­¢é…ç½®äº†ä¸€ä¸ªæ³›å‹ï¼Œè·å–è¯¥å¯¹è±¡æ‰€æœ‰æ³›å‹ç±»å‹</span></span><br><span class="line">    <span class="keyword">for</span> (Type t : types) &#123;</span><br><span class="line">        Class&lt;T&gt; tClass = (Class&lt;T&gt;) t;</span><br><span class="line">        <span class="keyword">if</span> (filterClass.isAssignableFrom(tClass)) &#123; <span class="comment">// é€šè¿‡filterClassæ‰¾åˆ°éœ€è¦çš„ç›®æ ‡ç±»å‹</span></span><br><span class="line">            <span class="keyword">return</span> tClass;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>2.</strong> ä½¿ç”¨ä¹Ÿéå¸¸ç®€å•ï¼Œç²¾ç®€ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œ4æ­¥é…ç½®å°±å®ç°äº†MVP</p><ul><li>é¦–å…ˆå®šä¹‰å¥‘çº¦ï¼ˆContractï¼‰ï¼Œå®šä¹‰Viewã€Modelã€Presenterçš„æ¥å£ï¼Œå¹¶ä¸”éƒ½éœ€è¦ç»§æ‰¿è‡ª<code>XContract</code></li><li>åˆ›å»ºModelå®ç°ç±»</li><li>åˆ›å»ºPresenterå®ç°ç±»ç»§æ‰¿<code>XBasePresenter</code>ï¼Œæ³›å‹ä¸­å…³è”Viewæ¥å£å’ŒModelå®ç°ç±»</li><li>åˆ›å»ºViewå®ç°ç±»ç»§æ‰¿<code>XBaseActivity</code>æˆ–å…¶å­ç±»ï¼Œæ³›å‹ä¸­å…³è”Presenterå®ç°ç±»</li></ul><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¥‘çº¦</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HomeContract</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Presenter</span> <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">Presenter</span></span>&#123;&#125;</span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">View</span> <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">View</span></span>&#123;&#125;</span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Model</span> <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">Model</span> </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Må±‚å®ç°</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeModel</span> <span class="keyword">implements</span> <span class="title">HomeContract</span>.<span class="title">Model</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// På±‚å®ç°</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomePresenter</span></span></span><br><span class="line"><span class="class">  <span class="keyword">extends</span> <span class="title">XBasePresenter</span>&lt;<span class="title">HomeContract</span>.<span class="title">View</span>, <span class="title">HomeModel</span>&gt;</span></span><br><span class="line"><span class="class">  <span class="keyword">implements</span> <span class="title">HomeContract</span>.<span class="title">Presenter</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Vå±‚å®ç°</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeActivity</span></span></span><br><span class="line"><span class="class">  <span class="keyword">extends</span> <span class="title">XBaseActivity</span>&lt;<span class="title">HomePresenter</span>&gt;</span></span><br><span class="line"><span class="class">  <span class="keyword">implements</span> <span class="title">HomeContract</span>.<span class="title">View</span> </span>&#123;&#125;</span><br></pre></td></tr></table></div></figure><p><strong>3.</strong> æœ€åˆXMVPæ¡†æ¶åšå‡ºæ—¶å†™çš„ä¸€ç¯‡æ–‡ç«  <a href="https://www.jianshu.com/p/7c71c0d6c150" target="_blank" rel="noopener">å°äº†ä¸€ä¸ªAndroid MVPæ¡†æ¶ï¼Œå°±å«XMVPå§ï¼</a></p><hr><blockquote><p>å°±è¿™æ ·ï¼Œç¬¬ä¸€é˜¶æ®µå®£å‘Šå®Œæ¯•ï¼Œç„¶åå°±æ˜¯ä¼˜åŒ–å’Œä¿®å¤ä¸€äº›bugï¼Œå½“ç„¶ä¸Šé¢çš„<code>getGenericClass</code>è¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯åæœŸä¼˜åŒ–è¿‡çš„ç»“æœã€‚</p></blockquote><h2 id="æƒ³å·æ‡’äº†å°±å¼€å‘äº†MVPManageræ’ä»¶ï¼Œå¿«é€Ÿç”ŸæˆXMVPä»£ç ">æƒ³å·æ‡’äº†å°±å¼€å‘äº†<code>MVPManager</code>æ’ä»¶ï¼Œå¿«é€Ÿç”Ÿæˆ<code>XMVP</code>ä»£ç <a href="post/xmvp-framework#æƒ³å·æ‡’äº†å°±å¼€å‘äº†MVPManageræ’ä»¶ï¼Œå¿«é€Ÿç”ŸæˆXMVPä»£ç "></a></h2><p><img src="https://raw.githubusercontent.com/xujiaji/MVPManager/master/display/banner.png" alt=""><br>ä¹Ÿå°±æ˜¯<code>XMVP</code>æ¡†æ¶å¼€å‘å‡ºæ¥ä¹Ÿå°±1ä¸ªæœˆä¹‹å†…çš„äº‹æƒ…å§ï¼è¿™æ—¶æ„Ÿè§‰å†™å¥‘çº¦ï¼ˆContractï¼‰ï¼Œå†™<code>XMVP</code>å„ä¸ªå®ç°ç±»ï¼Œéƒ½æ˜¯é‡å¤çš„åŠ³åŠ¨åŠ›ï¼Œæ¯ä¸€ä¸ªæ–°çš„ç•Œé¢å°±å¾—å»åˆ›å»ºè¿™ä¹ˆäº›æ–‡ä»¶å¤ªè¿‡è¾›è‹¦ã€‚ç»“æœè™½ç„¶å˜å¾—æœ‰æ¡ç†æœ‰æ¨¡å—ï¼Œä½†æ˜¯å·¥ä½œé‡æœ‰äº›é‡å¤å’Œå¢åŠ ï¼Œæœ‰äº›æ—¶å€™é…ç½®æ³›å‹å¿˜äº†è¿˜éœ€è¦çœ‹ä¹‹å‰æ˜¯æ€ä¹ˆé…ç½®çš„ã€‚</p><p>å½“æ—¶å…¶å®ä¹Ÿæœ‰åˆ›å»ºMVPæ–‡ä»¶çš„æ’ä»¶ä¹‹ç±»çš„ä¸œè¥¿ï¼Œä½†æ˜¯ä¸ç¬¦åˆ<code>XMVP</code>çš„å®æƒ…ï¼Œæ³›å‹è¿˜æ˜¯å¾—è‡ªå·±åŠ¨æ‰‹ï¼Œäºæ˜¯å†³å¿ƒè‡ªå·±å†™ä¸€ä¸ª<code>intellij</code>æ’ä»¶ï¼Œå½“ç„¶åœ¨<code>AS</code>ä¸­ä¹Ÿèƒ½ä½¿ç”¨ã€‚</p><h4 id="åˆ›å»ºMVPä»£ç æˆªå›¾ï¼Œè¿™æ˜¯æœ€æ–°çš„åˆ›å»ºä»£ç ç•Œé¢çš„æˆªå›¾">åˆ›å»ºMVPä»£ç æˆªå›¾ï¼Œè¿™æ˜¯æœ€æ–°çš„åˆ›å»ºä»£ç ç•Œé¢çš„æˆªå›¾<a href="post/xmvp-framework#åˆ›å»ºMVPä»£ç æˆªå›¾ï¼Œè¿™æ˜¯æœ€æ–°çš„åˆ›å»ºä»£ç ç•Œé¢çš„æˆªå›¾"></a></h4><blockquote><p>åœ¨1.0çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†å¯å°†åŒä¸€ä¸ªæ¨¡å—æ”¾ä¸€ä¸ªåŒ…ä¸­æˆ–å°†MVPåˆ†åœ¨å¯¹åº”çš„åŒ…ä¸­çš„é€‰é¡¹ï¼›å¢åŠ äº†å¯ä»¥ä¸æ˜¯XMVPæ¡†æ¶çš„æƒ…å†µä¸‹ä½¿ç”¨</p></blockquote><p><img src="https://github.com/xujiaji/MVPManager/raw/master/display/update_2_0_0.png" alt="" class="article-img"></p><h4 id="è¿™æ˜¯ä¸€å¼ åŠ¨æ€å›¾ï¼Œæ˜¯ä¸€å¼ æ—§ç‰ˆæœ¬çš„æ¼”ç¤ºå›¾ã€‚åªéœ€è¦å’Œä¸Šé¢çš„æˆªå›¾ç»“åˆæ¥çœ‹ä¸€ä¸‹å“¦">è¿™æ˜¯ä¸€å¼ åŠ¨æ€å›¾ï¼Œæ˜¯ä¸€å¼ æ—§ç‰ˆæœ¬çš„æ¼”ç¤ºå›¾ã€‚åªéœ€è¦å’Œä¸Šé¢çš„æˆªå›¾ç»“åˆæ¥çœ‹ä¸€ä¸‹å“¦<a href="post/xmvp-framework#è¿™æ˜¯ä¸€å¼ åŠ¨æ€å›¾ï¼Œæ˜¯ä¸€å¼ æ—§ç‰ˆæœ¬çš„æ¼”ç¤ºå›¾ã€‚åªéœ€è¦å’Œä¸Šé¢çš„æˆªå›¾ç»“åˆæ¥çœ‹ä¸€ä¸‹å“¦"></a></h4><p><img src="https://github.com/xujiaji/MVPManager/raw/master/display/edit_MVPManager.gif" alt="" class="article-img"></p><h4 id="æœ€åè¿˜æœ‰ä¸ªé€†å‘å¢åŠ æˆ–åˆ é™¤XMVPå¥‘çº¦ä¸­å®šä¹‰æ–¹æ³•çš„åŠŸèƒ½">æœ€åè¿˜æœ‰ä¸ªé€†å‘å¢åŠ æˆ–åˆ é™¤XMVPå¥‘çº¦ä¸­å®šä¹‰æ–¹æ³•çš„åŠŸèƒ½<a href="post/xmvp-framework#æœ€åè¿˜æœ‰ä¸ªé€†å‘å¢åŠ æˆ–åˆ é™¤XMVPå¥‘çº¦ä¸­å®šä¹‰æ–¹æ³•çš„åŠŸèƒ½"></a></h4><blockquote><p>ä¼šåŒæ—¶æ›´æ–°å®ç°ç±»çš„æ–¹æ³•ï¼Œæœ¬äººæ˜¯å†™å‡ºè¿™ä¸ªåŠŸèƒ½ï¼Œä½†å‡ ä¹ä¸ç”¨çš„å•¦</p></blockquote><p><img src="https://github.com/xujiaji/MVPManager/raw/master/display/open_change_MVPManager.gif" alt="" class="article-img"></p><h4 id="åˆšåˆšå¼€å‘å‡ºæ¥MVPManagerçš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿå†™äº†ç¯‡æ–‡ç« ä»‹ç»-è¿™ä¸ªASæ’ä»¶èƒ½å¸®ä½ å¿«é€Ÿç®¡ç†MVP">åˆšåˆšå¼€å‘å‡ºæ¥MVPManagerçš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿå†™äº†ç¯‡æ–‡ç« ä»‹ç» <a href="https://www.jianshu.com/p/5d528019a76b" target="_blank" rel="noopener">è¿™ä¸ªASæ’ä»¶èƒ½å¸®ä½ å¿«é€Ÿç®¡ç†MVP</a><a href="post/xmvp-framework#åˆšåˆšå¼€å‘å‡ºæ¥MVPManagerçš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿå†™äº†ç¯‡æ–‡ç« ä»‹ç»-è¿™ä¸ªASæ’ä»¶èƒ½å¸®ä½ å¿«é€Ÿç®¡ç†MVP"></a></h4><hr><blockquote><p>å°±è¿™æ ·ï¼Œç¬¬äºŒé˜¶æ®µç»“æŸäº†ã€‚å…¶ä¸»è¦ç›®çš„å°±æ˜¯ä¸ºäº†è§£å†³MVPé‡å¤é€»è¾‘çš„ä»£ç é‡é—®é¢˜</p></blockquote><h2 id="å®è·µä¸­çš„æ›´æ–°">å®è·µä¸­çš„æ›´æ–°<a href="post/xmvp-framework#å®è·µä¸­çš„æ›´æ–°"></a></h2><p>åœ¨ä¸æ–­çš„å®è·µè¿ç”¨ä¸­ä¹Ÿå‘ç°äº†å¾ˆå¤šæ²¡æœ‰è€ƒè™‘åˆ°æˆ–è€…å¿½ç•¥çš„é—®é¢˜ï¼Œå…¶ä¸­æœ€æ˜ åƒæ·±åˆ»çš„ä¸è¿‡äºæœ‰æ¬¡ä¸Šçº¿åº”ç”¨çš„æ—¶å€™ï¼Œæ··æ·†å±…ç„¶ä¼šå¯¼è‡´æ— æ³•åˆ›å»ºPresenterç†¬å¤œæ‰¾äº†å¾ˆä¹…ã€‚</p><p>è¿˜æœ‰å°±æ˜¯å¿½ç•¥äº†Fragmentæœ‰appåŒ…å’Œv4åŒ…ä¸¤ä¸ªåœ°æ–¹ï¼Œæ¡†æ¶ä¸­åªå†™äº†ä¸€ä¸ªï¼Œè€ƒè™‘çš„éƒ½æ¯”è¾ƒç‰‡é¢ã€‚</p><p>åªæœ‰åœ¨å®è·µä¸­æ‰èƒ½çœŸæ­£çš„è€ƒéªŒï¼Œä¸€ç›´ä»¥æ¥å¤§æ¦‚å°±æˆ‘å’Œå°‘æ•°çš„å°ä¼™ä¼´åœ¨ä½¿ç”¨ã€‚è™½ç„¶ç”¨çš„æ¯”è¾ƒå°‘ï¼Œä½†æ˜¯å†™å‡ºæ¥åå°±è¦å¯¹å®ƒè´Ÿè´£å˜›ï¼</p><h4 id="ä½¿ç”¨ä¸­çš„ä¸€äº›ä¸ªäººæŠ€å·§">ä½¿ç”¨ä¸­çš„ä¸€äº›ä¸ªäººæŠ€å·§<a href="post/xmvp-framework#ä½¿ç”¨ä¸­çš„ä¸€äº›ä¸ªäººæŠ€å·§"></a></h4><p><strong>1.</strong> å¾ˆå¤šæ—¶å€™ï¼ŒActivityå’ŒPresenterï¼Œæ›´æˆ–è€…Modeléƒ½æœ‰å…±ç”¨çš„åœ°æ–¹ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦ä½œå‡ºæå–æŠ½è±¡ã€‚äºæ˜¯æˆ‘ä»¬å°±éœ€è¦ç»§æ‰¿<code>XBaseActivity</code>ã€<code>XBaseFragment</code>ã€<code>XBasePresenter</code>å†åšä¸€å±‚æŠ½è±¡ï¼Œè¿™æ ·å¦‚æœä»¥åä¸æƒ³ç”¨<code>XMVP</code>æ¡†æ¶æœ‰æ›´å¥½çš„é€‰æ‹©ä¹Ÿæ›´å¥½æ›¿æ¢å“ˆã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><blockquote><p>BaseActivity.java</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseActivity</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">XBasePresenter</span>&gt; <span class="keyword">extends</span> <span class="title">XBaseActivity</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onInitCircle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onInitCircle();</span><br><span class="line">    ButterKnife.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>BasePresenter.java</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BasePresenter</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">View</span>, <span class="title">E</span> <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">Model</span>&gt; <span class="keyword">extends</span> <span class="title">XBasePresenter</span>&lt;<span class="title">T</span>, <span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> CompositeDisposable mCompositeDisposable;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">end</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.end();</span><br><span class="line">        <span class="keyword">if</span> (mCompositeDisposable != <span class="keyword">null</span>) &#123;</span><br><span class="line">            mCompositeDisposable.clear();</span><br><span class="line">            mCompositeDisposable = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>å‘ä¸Šé¢è¿™æ ·ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¸­é—´å±‚ï¼Œå¤„ç†ä¸€äº›æˆ‘ä»¬éœ€è¦ç»Ÿä¸€è°ƒç”¨çš„æˆ–å¤„ç†çš„ä¸€äº›ä¸œè¥¿</p><p><strong>2.</strong> å¯¹äºPresenterå›è°ƒModelå¤„ç†åè¿”å›çš„æ•°æ®ç›‘å¬ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªé€šç”¨ç›‘å¬æ¥å£ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">GenericListener</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">success</span><span class="params">(T t)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">error</span><span class="params">(<span class="keyword">int</span> code, String err)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>å¹¶ä¸”ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ªæ¥å£è¿›è¡Œå®ç°ï¼Œæˆ‘ä»¬å¯ä»¥ç»Ÿä¸€å¯¹é”™è¯¯ä¿¡æ¯åšäº›æç¤ºæˆ–å¤„ç†</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericListenerImp</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">GenericListener</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">GenericListenerImp</span><span class="params">(<span class="comment">/*å¯ä»¥ä¼ å…¥è¿›æ¥base viewæˆ–base presenterï¼Œå¦‚æœæœ‰é”™è¯¯å¯ä»¥è°ƒç”¨å¯¹åº”æ–¹æ³•ç»Ÿä¸€å¤„ç†*/</span>)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">error</span><span class="params">(<span class="keyword">int</span> code, String err)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¯¹é”™è¯¯åšå‡ºç»Ÿä¸€å¤„ç†</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>3.</strong> æˆ‘ä»¬æœ€å¸¸ç”¨çš„å°±æ˜¯åˆ·æ–°åŠ è½½åˆ—è¡¨äº†ï¼Œå‡ ä¹æ‰€æœ‰appä¸­éƒ½éœ€è¦ï¼Œå¹¶ä¸”åœ¨åŒä¸€ä¸ªåº”ç”¨ä¸­çš„åŠ è½½é€»è¾‘éƒ½æ˜¯ä¸€æ ·çš„ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥å°†å…¶æŠ½è±¡å‡ºæ¥ï¼Œä½¿ç”¨çš„æ—¶å€™ä¼šéå¸¸æ–¹ä¾¿ã€‚</p><blockquote><p>é¦–å…ˆå®šä¹‰ä¸€ä¸ªåŸºç¡€åˆ·æ–°å¥‘çº¦ï¼Œæ¯ä¸€ä¸ªæœ‰åˆ·æ–°çš„viewçš„æ¥å£éƒ½ç›´æ¥ä»è¿™é‡Œç»§æ‰¿</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BaseRefreshContract</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Presenter</span> <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">Presenter</span> </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * è¯·æ±‚æ•°æ®</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">requestLoadListData</span><span class="params">(<span class="keyword">int</span> page)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * è¯·æ±‚æ›´æ–°åˆ—è¡¨æ•°æ®</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">requestUpdateListData</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">View</span> &lt;<span class="title">X</span>&gt; <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">View</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ›´æ–°åˆ—è¡¨æˆåŠŸ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">updateListSuccess</span><span class="params">(List&lt;X&gt; datas, <span class="keyword">boolean</span> isEnd)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ›´æ–°å¤±è´¥</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">updateListFail</span><span class="params">(String err)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * åŠ è½½æ•°æ®æˆåŠŸ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">loadListDataSuccess</span><span class="params">(List&lt;X&gt; datas, <span class="keyword">int</span> currentPage, <span class="keyword">boolean</span> isEnd)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * åŠ è½½æ•°æ®å¤±è´¥</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> err</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">loadListDataFail</span><span class="params">(String err)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ•°æ®å·²ç»è¢«åŠ è½½å®Œ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">loadListDateOver</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ç„¶åæŠ½è±¡Viewï¼Œè¿™é‡Œä»¥Activityä¸ºä¾‹ï¼ŒFragmentä¸€è‡´ã€‚æˆ‘ä½¿ç”¨äº†<code>SwipeRefreshLayout</code>ä½œä¸ºåˆ·æ–°ï¼Œ<code>BaseRecyclerViewAdapterHelper</code>å¤„ç†å¡«å……æ•°æ®å’ŒåŠ è½½æ•°æ®</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseRefreshActivity</span>&lt;<span class="title">E</span> ,<span class="title">X</span> <span class="keyword">extends</span> <span class="title">BaseQuickAdapter</span>&lt;<span class="title">E</span>, <span class="title">BaseViewHolder</span>&gt;, <span class="title">T</span> <span class="keyword">extends</span> <span class="title">XBasePresenter</span>&gt; <span class="keyword">extends</span> <span class="title">BaseActivity</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span></span></span><br><span class="line"><span class="class">        <span class="title">BaseRefreshContract</span>.<span class="title">View</span>&lt;<span class="title">E</span>&gt;,</span></span><br><span class="line"><span class="class">        <span class="title">BaseQuickAdapter</span>.<span class="title">RequestLoadMoreListener</span>,</span></span><br><span class="line"><span class="class">        <span class="title">SwipeRefreshLayout</span>.<span class="title">OnRefreshListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> currentPage;<span class="comment">//å½“å‰çš„é¡µé¢</span></span><br><span class="line">    <span class="keyword">protected</span> X mAdapter;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">boolean</span> isEnd;</span><br><span class="line">    <span class="keyword">protected</span> SwipeRefreshLayout swipeLayout;</span><br><span class="line">    <span class="keyword">protected</span> RecyclerView mRecyclerView;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onInitCircle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onInitCircle();</span><br><span class="line">        mAdapter = getAdapter();</span><br><span class="line">        mRecyclerView = getRecyclerView();</span><br><span class="line">        swipeLayout = getSwipeLayout();</span><br><span class="line">        swipeLayout.setOnRefreshListener(<span class="keyword">this</span>);</span><br><span class="line">        mAdapter.setOnLoadMoreListener(<span class="keyword">this</span>, mRecyclerView);</span><br><span class="line">        mRecyclerView.setAdapter(mAdapter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> X <span class="title">getAdapter</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> SwipeRefreshLayout <span class="title">getSwipeLayout</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> RecyclerView <span class="title">getRecyclerView</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°åˆ—è¡¨æˆåŠŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateListSuccess</span><span class="params">(List&lt;E&gt; datas, <span class="keyword">boolean</span> isEnd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.isEnd = isEnd;</span><br><span class="line">        currentPage = <span class="number">1</span>;</span><br><span class="line">        mAdapter.setNewData(datas);</span><br><span class="line">        swipeLayout.setRefreshing(<span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (isEnd) &#123;</span><br><span class="line">            loadListDateOver();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            mAdapter.setEnableLoadMore(<span class="keyword">true</span>);</span><br><span class="line">            mAdapter.loadMoreComplete();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°å¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateListFail</span><span class="params">(String err)</span> </span>&#123;</span><br><span class="line">        swipeLayout.setRefreshing(<span class="keyword">false</span>);</span><br><span class="line">        mAdapter.setEnableLoadMore(<span class="keyword">true</span>);</span><br><span class="line">        ToastUtil.getInstance().showLongT(err);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ è½½æ•°æ®æˆåŠŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadListDataSuccess</span><span class="params">(List&lt;E&gt; datas, <span class="keyword">int</span> currentPage, <span class="keyword">boolean</span> isEnd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.currentPage = currentPage;</span><br><span class="line">        <span class="keyword">this</span>.isEnd = isEnd;</span><br><span class="line">        mAdapter.addData(datas);</span><br><span class="line">        swipeLayout.setEnabled(<span class="keyword">true</span>);</span><br><span class="line">        mAdapter.loadMoreComplete();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ è½½æ•°æ®å¤±è´¥</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> err</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadListDataFail</span><span class="params">(String err)</span> </span>&#123;</span><br><span class="line">        swipeLayout.setEnabled(<span class="keyword">true</span>);</span><br><span class="line">        mAdapter.loadMoreFail();</span><br><span class="line">        ToastUtil.getInstance().showLongT(err);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®å·²ç»è¢«åŠ è½½å®Œ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadListDateOver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mAdapter.loadMoreEnd();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRefresh</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!swipeLayout.isRefreshing())</span><br><span class="line">        &#123;</span><br><span class="line">            swipeLayout.setRefreshing(<span class="keyword">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        getPresenter().requestUpdateListData();</span><br><span class="line">        mAdapter.setEnableLoadMore(<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLoadMoreRequested</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (isEnd) &#123;</span><br><span class="line">            loadListDateOver();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        swipeLayout.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">        getPresenter().requestLoadListData(++currentPage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> BaseRefreshContract.<span class="function">Presenter <span class="title">getPresenter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (presenter <span class="keyword">instanceof</span> BaseRefreshContract.Presenter) &#123;</span><br><span class="line">            <span class="keyword">return</span>  (BaseRefreshContract.Presenter) presenter;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"presenter please extends BaseRefreshContract.Presenter"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ä½¿ç”¨ï¼šå®šä¹‰ä¸€ä¸ªåˆ—è¡¨é¡µé¢çš„å¥‘çº¦</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleDetailContract</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">View</span> <span class="keyword">extends</span> <span class="title">BaseRefreshContract</span>.<span class="title">View</span>&lt;<span class="title">CircleMsgEntity</span>.<span class="title">CommentBean</span>&gt; </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Presenter</span> <span class="keyword">extends</span> <span class="title">BaseRefreshContract</span>.<span class="title">Presenter</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Model</span> <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">Model</span> </span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">void</span> <span class="title">catArticleDetails</span><span class="params">(<span class="keyword">int</span> articleId, <span class="keyword">int</span> page, CompositeDisposable cd, NetRequestListener&lt;Result&lt;CircleMsgEntity&gt;&gt; listener)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ä½¿ç”¨ï¼šViewå®ç°å±‚ï¼Œç”±äºè¿™æ˜¯ä¸€ä¸ªå…¬å¸é¡¹ç›®ä¸­çš„ç±»ï¼Œçœç•¥çš„æ‰€æœ‰çš„æ— å…³ä»£ç <br><code>CircleMsgEntity.CommentBean</code> æ˜¯ä¸€ä¸ªAdapter(ArticleCommentAdapter)å¡«å……çš„å®ä½“ç±»<br><code>ArticleCommentAdapter</code> æ˜¯ä¸€ä¸ªç»§æ‰¿BaseRecyclerViewAdapterHelperæ¡†æ¶ä¸­çš„<code>BaseQuickAdapter</code>çš„ç±»ï¼Œå¹¶ä¸”è¯¥ç±»æ˜¯è¿™æ ·çš„ï¼š<code>public class ArticleCommentAdapter extends BaseQuickAdapter&lt;CircleMsgEntity.CommentBean, BaseViewHolder&gt;</code> å¿…é¡»ä¿è¯Activityç¬¬ä¸€ä¸ªæ³›å‹å’ŒAdapterçš„ç¬¬ä¸€ä¸ªæ³›å‹ç±»å‹ä¸€è‡´</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleDetailActivity</span> <span class="keyword">extends</span> <span class="title">BaseRefreshActivity</span>&lt;<span class="title">CircleMsgEntity</span>.<span class="title">CommentBean</span>, <span class="title">ArticleCommentAdapter</span>, <span class="title">ArticleDetailPresenter</span>&gt; <span class="keyword">implements</span> <span class="title">ArticleDetailContract</span>.<span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="meta">@BindView</span>(R.id.recycler)</span><br><span class="line">    RecyclerView recycler;</span><br><span class="line">    <span class="meta">@BindView</span>(R.id.refresh)</span><br><span class="line">    SwipeRefreshLayout refresh;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onInitCircle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onInitCircle();</span><br><span class="line">        onRefresh();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">layoutId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> R.layout.activity_article_detail;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> ArticleCommentAdapter <span class="title">getAdapter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArticleCommentAdapter(ArticleCommentAdapter.TYPE_NORMAL);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> SwipeRefreshLayout <span class="title">getSwipeLayout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        refresh.setColorSchemeResources(R.color.yellow);</span><br><span class="line">        <span class="keyword">return</span> refresh;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> RecyclerView <span class="title">getRecyclerView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        recycler.setLayoutManager(<span class="keyword">new</span> LinearLayoutManager(<span class="keyword">this</span>));</span><br><span class="line">        <span class="keyword">return</span> recycler;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ä½¿ç”¨ï¼š Presenterå®ç°å±‚</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleDetailPresenter</span> <span class="keyword">extends</span> <span class="title">BasePresenter</span>&lt;<span class="title">ArticleDetailContract</span>.<span class="title">View</span>,<span class="title">ArticleDetailModel</span>&gt; <span class="keyword">implements</span> <span class="title">ArticleDetailContract</span>.<span class="title">Presenter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.start();</span><br><span class="line">        mCompositeDisposable = <span class="keyword">new</span> CompositeDisposable();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestLoadListData</span><span class="params">(<span class="keyword">int</span> page)</span> </span>&#123;</span><br><span class="line">        model.catArticleDetails(view.getArticleId(), page, mCompositeDisposable, <span class="keyword">new</span> NetRequestListener&lt;Result&lt;CircleMsgEntity&gt;&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">success</span><span class="params">(Result&lt;CircleMsgEntity&gt; circleMsgEntityResult)</span> </span>&#123;</span><br><span class="line">                ResultListBean&lt;List&lt;CircleMsgEntity.CommentBean&gt;&gt; resultListBean = circleMsgEntityResult.getData().getCommentList();</span><br><span class="line">                view.loadListDataSuccess(resultListBean.getList(), resultListBean.getPage(), resultListBean.getPage() &gt;= resultListBean.getPagecount());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">error</span><span class="params">(String err)</span> </span>&#123;</span><br><span class="line">                view.loadListDataFail(err);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestUpdateListData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        model.catArticleDetails(view.getArticleId(), <span class="number">1</span>, mCompositeDisposable, <span class="keyword">new</span> NetRequestListener&lt;Result&lt;CircleMsgEntity&gt;&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">success</span><span class="params">(Result&lt;CircleMsgEntity&gt; circleMsgEntityResult)</span> </span>&#123;</span><br><span class="line">                ResultListBean&lt;List&lt;CircleMsgEntity.CommentBean&gt;&gt; resultListBean = circleMsgEntityResult.getData().getCommentList();</span><br><span class="line">                view.updateListSuccess(resultListBean.getList(), resultListBean.getPage() &gt;= resultListBean.getPagecount());</span><br><span class="line">                view.displayArticleDetail(circleMsgEntityResult.getData());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">error</span><span class="params">(String err)</span> </span>&#123;</span><br><span class="line">                view.updateListFail(err);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>Modelå±‚ï¼Œå»è¯·æ±‚åˆ—è¡¨æ•°æ®</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleDetailModel</span> <span class="keyword">implements</span> <span class="title">ArticleDetailContract</span>.<span class="title">Model</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">catArticleDetails</span><span class="params">(<span class="keyword">int</span> articleId, <span class="keyword">int</span> page, CompositeDisposable cd, NetRequestListener&lt;Result&lt;CircleMsgEntity&gt;&gt; listener)</span> </span>&#123;</span><br><span class="line">        Observer&lt;Result&lt;CircleMsgEntity&gt;&gt; observer = ModelHelper.getObserver(cd, listener, <span class="keyword">true</span>); <span class="comment">// å¯¹rxjavaè¿”å›çš„æ•°æ®è¿›è¡Œç»Ÿä¸€å¤„ç†</span></span><br><span class="line">        Http.getInstance().getArticleDetails(articleId, page, observer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸æ–­çš„å¤ç”¨<code>BaseRefreshActivity</code>ã€<code>ArticleDetailContract</code>æ¥è®©åˆ·æ–°åŠ è½½ç»Ÿä¸€ï¼Œå½“ç„¶åœ¨æ‚¨å®é™…çš„ä½¿ç”¨è¿‡ç¨‹ä¸­è‚¯å®šè¿˜éœ€è¦è°ƒæ•´ã€‚è¿™é‡Œåªç»™æˆ‘äº†æˆ‘è‡ªå·±çš„ä¸€äº›æ€è·¯å’Œå®ç°æ–¹å¼ã€‚</p><blockquote><p>å¦‚æœæˆ‘ä»¬éœ€è¦å…¶ä»–çš„æŠ½è±¡æ—¶ï¼Œåªéœ€è¦æ³¨æ„åƒåˆ·æ–°ä¸€æ ·å°†æ³›å‹ç»§æ‰¿å…³ç³»æ ‡å‡†ä¸Šå°±å¯ä»¥å•¦ã€‚å¦‚æœModelä¹Ÿå¯ä»¥æŠ½å–å‡ºæ¥ï¼Œå¤ç”¨æ—¶åªéœ€è¦ç»§æ‰¿æŠ½è±¡å‡ºæ¥çš„Modelã€‚</p></blockquote><h2 id="ç›®å‰">ç›®å‰<a href="post/xmvp-framework#ç›®å‰"></a></h2><p>ç›®å‰XMVPæ¡†æ¶å·²æ›´æ–°åˆ°<code>1.2.2</code>ï¼ŒåºŸå¼ƒäº†ä¸€äº›ä»¥å‰çš„æ–¹æ³•ï¼ˆå½“ç„¶ç°åœ¨è¿˜èƒ½ç”¨ï¼‰ã€‚æ·»åŠ äº†æ›´å¤šViewå±‚çš„è¾…åŠ©æ–¹æ³•ï¼Œä¸ºäº†å·ä¸ªæ‡’ï¼Œå°±ç›´æ¥å±•ç¤ºæ–°å¢çš„æ–¹æ³•ä»£ç å•¦ï¼</p><blockquote><p>åŸºæœ¬å‘¨æœŸ</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * author: xujiaji</span></span><br><span class="line"><span class="comment"> * created on: 2018/9/4 10:57</span></span><br><span class="line"><span class="comment"> * description: å®šä¹‰Viewç›¸å…³å‘¨æœŸ &lt;br /&gt; Define View related Cycle</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">XViewCycle</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨ super &#123;<span class="doctag">@link</span> android.app.Activity#onCreate(Bundle)&#125;ä¹‹å‰è¢«è°ƒç”¨              &lt;br /&gt;  will be called before super class &#123;<span class="doctag">@link</span> android.app.Activity#onCreate(Bundle)&#125; called</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onBeforeCreateCircle</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨ super &#123;<span class="doctag">@link</span> android.app.Activity#onCreate(Bundle)&#125;ä¹‹å‰è¢«è°ƒç”¨ï¼Œå¹¶ä¸”æœ‰Bundle &lt;br /&gt;  will be called before super class &#123;<span class="doctag">@link</span> android.app.Activity#onCreate(Bundle)&#125; called</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> savedInstanceState è¯¥å‚æ•°ä¸å¯èƒ½ä¸ºnull                                  &lt;br /&gt; this parameter cannot be null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onBundleHandle</span><span class="params">(@NonNull Bundle savedInstanceState)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å¸ƒå±€çš„id                                &lt;br /&gt; get layout id</span></span><br><span class="line"><span class="comment">     * åœ¨ &#123;<span class="doctag">@link</span> #onBeforeCreateCircle &#125;ä¹‹åè¢«è°ƒç”¨ &lt;br /&gt; will be called after &#123;<span class="doctag">@link</span> #onBeforeCreateCircle &#125; called</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> xmlå¸ƒå±€id                         &lt;br /&gt; xml layout id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">layoutId</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  åœ¨è¿™é‡Œé¢è¿›è¡Œåˆå§‹åŒ–                    &lt;br /&gt; initialize here</span></span><br><span class="line"><span class="comment">     *  åœ¨ &#123;<span class="doctag">@link</span> #layoutId()&#125; ä¹‹åè¢«è°ƒç”¨   &lt;br /&gt; will be called after &#123;<span class="doctag">@link</span> #layoutId()&#125; called</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onInitCircle</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿™é‡Œé¢å†™ç›‘å¬äº‹ä»¶                       &lt;br /&gt; write listens event here</span></span><br><span class="line"><span class="comment">     * åœ¨ &#123;<span class="doctag">@link</span> #onInitCircle()&#125; ä¹‹åè¢«è°ƒç”¨ &lt;br /&gt; will be called after &#123;<span class="doctag">@link</span> #onInitCircle()&#125; called</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onListenerCircle</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>Activiyä¸­</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * author: xujiaji</span></span><br><span class="line"><span class="comment"> * created on: 2018/9/11 15:05</span></span><br><span class="line"><span class="comment"> * description: å®šä¹‰Activity Viewç›¸å…³å‘¨æœŸ &lt;br /&gt; Define Activity View related Cycle</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">XActivityCycle</span> <span class="keyword">extends</span> <span class="title">XViewCycle</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤„ç†ä¸Šä¸ªé¡µé¢ä¼ é€’è¿‡æ¥çš„æ•°æ® &lt;br /&gt; Handle the data passed from the previous page</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onIntentHandle</span><span class="params">(@NonNull Intent intent)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>Fragmentä¸­</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * author: xujiaji</span></span><br><span class="line"><span class="comment"> * created on: 2018/9/4 10:57</span></span><br><span class="line"><span class="comment"> * description: å®šä¹‰Fragment Viewç›¸å…³å‘¨æœŸ &lt;br /&gt; Define Fragment View related Cycle</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">XFragViewCycle</span> <span class="keyword">extends</span> <span class="title">XViewCycle</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤„ç†&#123;<span class="doctag">@link</span> Fragment#getArguments()&#125; çš„å€¼ï¼Œå¦‚æœæœ‰æ‰ä¼šè°ƒç”¨  &lt;br /&gt; Handle the value of &#123;<span class="doctag">@link</span> Fragment#getArguments()&#125; , if it is there, it will be called</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bundle</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onArgumentsHandle</span><span class="params">(@NonNull Bundle bundle)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onVisible</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onInvisible</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onLazyLoad</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¿½ç•¥&#123;<span class="doctag">@link</span> #isFirstLoad() &#125;çš„å€¼ï¼Œå¼ºåˆ¶åˆ·æ–°æ•°æ®ï¼Œä½†ä»è¦æ»¡è¶³ &#123;<span class="doctag">@link</span> #isFragmentVisible()&#125; &amp;&amp; &#123;<span class="doctag">@link</span> #isPrepared()&#125; &lt;br /&gt;</span></span><br><span class="line"><span class="comment">     * Ignore the value of &#123;<span class="doctag">@link</span> #isFirstLoad() &#125; to force refresh data, but still satisfy &#123;<span class="doctag">@link</span> #isFragmentVisible()&#125; &amp;&amp; &#123;<span class="doctag">@link</span> #isPrepared()&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setForceLoad</span><span class="params">(<span class="keyword">boolean</span> forceLoad)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isForceLoad</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isPrepared</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isFirstLoad</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isFragmentVisible</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦æ˜¯åœ¨ViewPagerä¸­ï¼Œé»˜è®¤ä¸ºtrue</span></span><br><span class="line"><span class="comment">     * whether in ViewPager, default is true</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isInViewPager</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>å¯ä»¥çœ‹åˆ°Fragmentä¸­å®šä¹‰çš„æ–¹æ³•æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œå› ä¸ºç”±äºæ‡’åŠ è½½æ¯”è¾ƒå¸¸ç”¨ï¼Œæ–°å¢äº†æ‡’åŠ è½½ã€‚æˆ‘ä»¬å¦‚æœéœ€è¦åŠ è½½æ•°æ®ï¼Œå¯ç›´æ¥åœ¨<code>onLazyLoad()</code>æ–¹æ³•ä¸­è¿›è¡Œã€‚</p><blockquote><p>éœ€è¦æ³¨æ„ï¼šå¦‚æœFragmentä¸æ˜¯å’ŒViewPagerç»“åˆï¼Œéœ€è¦å°†<code>isInViewPager</code>è¿”å›falseï¼Œé»˜è®¤è¿”å›çš„trueã€‚å¦‚æœä¸è¿™æ ·ï¼Œå¯èƒ½ä¼šå¯¼è‡´é€šè¿‡FragmentMangeræäº¤çš„Fragmentæ— æ³•è°ƒç”¨åˆ°<code>onLazyLoad</code>æ–¹æ³•ã€‚</p></blockquote><h2 id="æœ€å">æœ€å<a href="post/xmvp-framework#æœ€å"></a></h2><p>é€šè¿‡å†™è¿™ä¸ªæ¡†æ¶å­¦åˆ°äº†æ€è€ƒå¾ˆå¤šä¸œè¥¿ï¼Œå¹¶ä¸”åæœŸä¹Ÿä¼šç»§ç»­æ›´æ–°ï¼Œæˆ‘è‡ªå·±å†™é¡¹ç›®ä¸­ä¹Ÿåœ¨ä½¿ç”¨ã€‚å¯èƒ½æœ‰äº›åœ°æ–¹è€ƒè™‘çš„ä¸å……è¶³ï¼Œè°¢è°¢å¤§å®¶ä¹Ÿå¯ä»¥æå»ºè®®ã€‚å½“ç„¶è¿™åªæ˜¯MVPçš„ä¸€ç§å®ç°æ€è·¯ï¼Œå…¶ä»–çš„è¿˜æ˜¯æœ‰å¾ˆå¤šçš„ï¼Œè¿™é‡Œå¤§å®¶ä¹Ÿè®¸éƒ½æœ‰ä¸€å®šäº†è§£å“ˆã€‚</p><p>XMVPåœ°å€ï¼š<a href="https://github.com/xujiaji/XMVP" target="_blank" rel="noopener">https://github.com/xujiaji/XMVP</a></p><p>æ¬¢è¿å¤§å®¶Starã€Forkã€PR (ã€ƒâ€™â–½â€™ã€ƒ)</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;XMVPæ¡†æ¶æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªæ¡†æ¶ï¼Œåˆšä»Androidèµ·æ­¥ç¬¬ä¸€æ¬¡äº†è§£MVPæ¨¡å¼æ—¶å†³å¿ƒå†™ä¸€ä¸ªè‡ªå·±çš„ä¸œè¥¿æ¡†æ¶ï¼Œåˆ°ç°åœ¨å·²è¿ç”¨åœ¨æˆ‘å†™çš„å¤šä¸ªé¡¹ç›®ä¸­ã€‚è™½ç„¶ä¸¤å¹´äº†ï¼Œä½†æ ¸å¿ƒçš„æ€è·¯æ²¡æœ‰æ”¹å˜ï¼Œåˆ°ç°åœ¨å˜æ¢ä¹Ÿä¸æ˜¯å¤ªå¤šï¼Œç²¾ç®€äº†ä¸€äº›ä»£ç ï¼Œæ·»åŠ äº†ä¸€äº›åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Android" scheme="https://blog.xujiaji.com/categories/Android/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="Library" scheme="https://blog.xujiaji.com/tags/Library/"/>
    
  </entry>
  
  <entry>
    <title>iOS Objective-C Learn Note</title>
    <link href="https://blog.xujiaji.com/post/iOS-Objective-C-Learn/index.html"/>
    <id>https://blog.xujiaji.com/post/iOS-Objective-C-Learn/index.html</id>
    <published>2018-09-05T10:11:24.000Z</published>
    <updated>2018-11-02T07:20:12.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æºä»£ç æ–‡ä»¶æ‰©å±•åå¯¹æ¯”">æºä»£ç æ–‡ä»¶æ‰©å±•åå¯¹æ¯”<a href="post/iOS-Objective-C-Learn#æºä»£ç æ–‡ä»¶æ‰©å±•åå¯¹æ¯”"></a></h2><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left"></th><th>å¤´æ–‡ä»¶</th><th>å®ç°æ–‡ä»¶</th></tr></thead><tbody><tr><td style="text-align:left">cè¯­è¨€</td><td>.h</td><td>.c</td></tr><tr><td style="text-align:left">c++è¯­è¨€</td><td>.h</td><td>.cpp</td></tr><tr><td style="text-align:left">ocè¯­è¨€</td><td>.h</td><td>.m</td></tr><tr><td style="text-align:left">oc&amp;c++</td><td>.h</td><td>.mm</td></tr></tbody></table></div></div><h2 id="ç±»çš„å®šä¹‰">ç±»çš„å®šä¹‰<a href="post/iOS-Objective-C-Learn#ç±»çš„å®šä¹‰"></a></h2><blockquote><p>å®šä¹‰ä¸€ä¸ª<code>SimpleClass</code>ç±»</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">SimpleClass</span>: <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><h2 id="ç±»çš„å±æ€§ç”³æ˜">ç±»çš„å±æ€§ç”³æ˜<a href="post/iOS-Objective-C-Learn#ç±»çš„å±æ€§ç”³æ˜"></a></h2><blockquote><p>é€šè¿‡<code>@property</code></p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> <span class="built_in">NSString</span> *firstName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> <span class="built_in">NSString</span> *lastName;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‡é’ˆç±»å‹ï¼Œæ˜¯ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="keyword">@property</span> <span class="built_in">NSNumber</span> *yearOfBirth;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŸºç¡€ç±»å‹ï¼Œæ˜¯ä¸€ä¸ªå€¼ç±»å‹</span></span><br><span class="line"><span class="keyword">@property</span> <span class="keyword">int</span> yearOfBirth;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸€ä¸ªåªè¯»çš„å±æ€§</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>) <span class="built_in">NSString</span> *firstName;</span><br></pre></td></tr></table></div></figure><h2 id="å‡å·æ–¹æ³•å’ŒåŠ å·æ–¹æ³•ï¼ˆæœ¬è´¨å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰">å‡å·æ–¹æ³•å’ŒåŠ å·æ–¹æ³•ï¼ˆæœ¬è´¨å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰<a href="post/iOS-Objective-C-Learn#å‡å·æ–¹æ³•å’ŒåŠ å·æ–¹æ³•ï¼ˆæœ¬è´¨å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰"></a></h2><ol><li>å‡å·æ–¹æ³•ï¼ˆæ™®é€šæ–¹æ³•åˆç§°å¯¹è±¡æ–¹æ³•ï¼‰</li><li>åŠ å·æ–¹æ³•ï¼ˆç±»æ–¹æ³•ï¼Œåˆç§°é™æ€æ–¹æ³•ï¼‰</li></ol><h2 id="å®Œæ•´çš„ä¾‹å­">å®Œæ•´çš„ä¾‹å­<a href="post/iOS-Objective-C-Learn#å®Œæ•´çš„ä¾‹å­"></a></h2><blockquote><p>æ¥å£<code>XYZPerson.h</code></p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">XYZPerson</span>: <span class="title">NSObject</span></span></span><br><span class="line">-(<span class="keyword">void</span>)sayHello;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>å®ç°<code>XYZPerson.m</code></p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"XYZPerson.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">XYZPerson</span></span></span><br><span class="line">-(<span class="keyword">void</span>)sayHello &#123;</span><br><span class="line">  <span class="comment">// åŠ äº†@ç¬¦å·ï¼Œè¡¨ç¤ºæ˜¯OCç±»å‹çš„å­—ç¬¦ä¸²ã€‚ä¸åŠ è¡¨ç¤ºæ˜¯çº¯Cè¯­è¨€çš„å­—ç¬¦æ•°ç»„</span></span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"Hello, World!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><h2 id="ç®€å•çš„ç¨‹åº">ç®€å•çš„ç¨‹åº<a href="post/iOS-Objective-C-Learn#ç®€å•çš„ç¨‹åº"></a></h2><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        <span class="comment">// insert code here...</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Hello, World!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="åŸºæœ¬æ•°æ®ç±»å‹">åŸºæœ¬æ•°æ®ç±»å‹<a href="post/iOS-Objective-C-Learn#åŸºæœ¬æ•°æ®ç±»å‹"></a></h2><div class="article-bounded"><div class="article-table"><table><thead><tr><th>ç±»å‹</th><th style="text-align:right">è¿›åˆ¶ä½</th><th style="text-align:right">ä¾‹å­</th></tr></thead><tbody><tr><td>int</td><td style="text-align:right">32ä½</td><td style="text-align:right">int a = 0;</td></tr><tr><td>float</td><td style="text-align:right">32ä½</td><td style="text-align:right">float f = 1.0;</td></tr><tr><td>double</td><td style="text-align:right">64ä½</td><td style="text-align:right">double num;</td></tr><tr><td>char</td><td style="text-align:right">8ä½</td><td style="text-align:right">char c = â€˜Aâ€™;</td></tr></tbody></table></div></div><h2 id="å…¶ä»–ç±»å‹">å…¶ä»–ç±»å‹<a href="post/iOS-Objective-C-Learn#å…¶ä»–ç±»å‹"></a></h2><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>NSString</td><td>@â€hello worldâ€</td></tr><tr><td>â€œhello worldâ€</td><td>Cè¯­è¨€å­—ç¬¦ä¸²ç±»å‹</td></tr></tbody></table></div></div><h2 id="é™å®šè¯">é™å®šè¯<a href="post/iOS-Objective-C-Learn#é™å®šè¯"></a></h2><div class="article-bounded"><div class="article-table"><table><thead><tr><th>é™å®šè¯</th><th style="text-align:right">ä¾‹å­</th><th>æè¿°</th></tr></thead><tbody><tr><td>long</td><td style="text-align:right">long a;</td><td>//å®Œæ•´å†™æ³•ä¸ºï¼šlong int a;å…¶å®ç°åœ¨intå·²ç»32ä½äº†å°±ç›¸å½“äºint a;</td></tr><tr><td>long long</td><td style="text-align:right">long long int a;</td><td></td></tr><tr><td>short</td><td style="text-align:right">short int a; short a;</td><td>// 16ä½æ•´å‹</td></tr><tr><td>unsigned</td><td style="text-align:right">unsigned int a;</td><td>// æ— ç¬¦å·</td></tr><tr><td>signed</td><td style="text-align:right">signed int a;</td><td>// æœ‰ç¬¦å·</td></tr></tbody></table></div></div><h2 id="ç®—æœ¯è¡¨è¾¾å¼ä¸è¿ç®—ç¬¦">ç®—æœ¯è¡¨è¾¾å¼ä¸è¿ç®—ç¬¦<a href="post/iOS-Objective-C-Learn#ç®—æœ¯è¡¨è¾¾å¼ä¸è¿ç®—ç¬¦"></a></h2><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:right">åç§°</th><th style="text-align:left">è¡¨ç¤º</th></tr></thead><tbody><tr><td style="text-align:right">èµ‹å€¼</td><td style="text-align:left"><code>=</code></td></tr><tr><td style="text-align:right">ä¸€å…ƒè¿ç®—ç¬¦</td><td style="text-align:left"><code>++</code> <code>--</code></td></tr><tr><td style="text-align:right">äºŒå…ƒè¿ç®—ç¬¦</td><td style="text-align:left"><code>+</code> <code>-</code> <code>*</code> <code>/</code> <code>%</code></td></tr><tr><td style="text-align:right">ä¸‰ç›®è¿ç®—ç¬¦</td><td style="text-align:left">2 &gt; 3 <code>?</code> YES <code>:</code> NO</td></tr></tbody></table></div></div><h2 id="ifè¯­å¥ï¼ˆé0å°±æ˜¯çœŸï¼‰"><code>if</code>è¯­å¥ï¼ˆé0å°±æ˜¯çœŸï¼‰<a href="post/iOS-Objective-C-Learn#ifè¯­å¥ï¼ˆé0å°±æ˜¯çœŸï¼‰"></a></h2><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:right"></th><th style="text-align:left">å€¼</th></tr></thead><tbody><tr><td style="text-align:right">çœŸ</td><td style="text-align:left"><code>YES</code> <code>æ‰€æœ‰é0çš„å€¼</code></td></tr><tr><td style="text-align:right">å‡</td><td style="text-align:left"><code>NO</code> <code>0</code></td></tr></tbody></table></div></div><blockquote><p>ç®€å•ä¾‹å­</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> a = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> b = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (a &gt; b) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"è¿™å¥è¯æ˜¯çœŸçš„"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"è¿™å¥è¯æ˜¯å‡çš„ %hhd"</span>, <span class="literal">NO</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="goto-è·³è½¬è¯­å¥ï¼Œè·³è½¬çš„å‰é¢å®šä¹‰çš„æ ‡ç­¾å¤„"><code>goto</code> è·³è½¬è¯­å¥ï¼Œè·³è½¬çš„å‰é¢å®šä¹‰çš„æ ‡ç­¾å¤„<a href="post/iOS-Objective-C-Learn#goto-è·³è½¬è¯­å¥ï¼Œè·³è½¬çš„å‰é¢å®šä¹‰çš„æ ‡ç­¾å¤„"></a></h2><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å®šä¹‰æ ‡ç­¾a</span></span><br><span class="line">    a:</span><br><span class="line">        i ++;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"içš„å€¼ä¸º%d"</span>, i);</span><br><span class="line"><span class="comment">//        if(i &lt; 5) goto a;</span></span><br><span class="line">        <span class="keyword">if</span> (i &lt; <span class="number">5</span>) &#123;</span><br><span class="line">            <span class="keyword">goto</span> a; <span class="comment">// è·³è½¬åˆ°æ ‡ç­¾a</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">goto</span> b; <span class="comment">// è·³è½¬åˆ°æ ‡ç­¾b</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"============"</span>); <span class="comment">// ç”±äºä¸Šé¢ç›´æ¥è·³è½¬åˆ°äº†bæ ‡ç­¾ï¼Œå› æ­¤è¯¥è¯­å¥å¾—ä¸åˆ°æ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line">    b:&#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"è·³åˆ°bäº†"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment">// 2018-09-05 22:23:53.800654+0800 les1[971:104767] içš„å€¼ä¸º1</span></span><br><span class="line"><span class="comment">// 2018-09-05 22:23:53.800827+0800 les1[971:104767] içš„å€¼ä¸º2</span></span><br><span class="line"><span class="comment">// 2018-09-05 22:23:53.800858+0800 les1[971:104767] içš„å€¼ä¸º3</span></span><br><span class="line"><span class="comment">// 2018-09-05 22:23:53.800876+0800 les1[971:104767] içš„å€¼ä¸º4</span></span><br><span class="line"><span class="comment">// 2018-09-05 22:23:53.800889+0800 les1[971:104767] içš„å€¼ä¸º5</span></span><br><span class="line"><span class="comment">// 2018-09-05 22:23:53.800902+0800 les1[971:104767] è·³åˆ°bäº†</span></span><br></pre></td></tr></table></div></figure><h2 id="while-å¾ªç¯è¯­å¥"><code>while</code> å¾ªç¯è¯­å¥<a href="post/iOS-Objective-C-Learn#while-å¾ªç¯è¯­å¥"></a></h2><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; <span class="number">5</span>) &#123;</span><br><span class="line">            i++;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"Hello world! i = %d"</span>, i);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">// è¾“å‡º</span></span><br><span class="line"><span class="comment">// Hello world! i = 1</span></span><br><span class="line"><span class="comment">// Hello world! i = 2</span></span><br><span class="line"><span class="comment">// Hello world! i = 3</span></span><br><span class="line"><span class="comment">// Hello world! i = 4</span></span><br><span class="line"><span class="comment">// Hello world! i = 5</span></span><br></pre></td></tr></table></div></figure><h2 id="do-while-å¾ªç¯ï¼Œè‡³å°‘æ‰§è¡Œä¸€æ¬¡"><code>do</code> <code>while</code> å¾ªç¯ï¼Œè‡³å°‘æ‰§è¡Œä¸€æ¬¡<a href="post/iOS-Objective-C-Learn#do-while-å¾ªç¯ï¼Œè‡³å°‘æ‰§è¡Œä¸€æ¬¡"></a></h2><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"hello!"</span>);</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment">// hello!</span></span><br></pre></td></tr></table></div></figure><h2 id="for-å¾ªç¯"><code>for</code> å¾ªç¯<a href="post/iOS-Objective-C-Learn#for-å¾ªç¯"></a></h2><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"i = %d"</span>, i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡º</span></span><br><span class="line"><span class="comment">// i = 1</span></span><br><span class="line"><span class="comment">// i = 2</span></span><br><span class="line"><span class="comment">// i = 3</span></span><br><span class="line"><span class="comment">// i = 4</span></span><br><span class="line"><span class="comment">// i = 5</span></span><br></pre></td></tr></table></div></figure><h2 id="å¾ªç¯æ§åˆ¶breakã€continue">å¾ªç¯æ§åˆ¶<code>break</code>ã€<code>continue</code><a href="post/iOS-Objective-C-Learn#å¾ªç¯æ§åˆ¶breakã€continue"></a></h2><ul><li>breakï¼š ç»ˆæ­¢å¾ªç¯</li><li>continue: è·³è¿‡å½“å‰å¾ªç¯</li></ul><h2 id="switchåˆ†æ”¯è¯­å¥"><code>switch</code>åˆ†æ”¯è¯­å¥<a href="post/iOS-Objective-C-Learn#switchåˆ†æ”¯è¯­å¥"></a></h2><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">switch</span> (i) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"i = 0"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"i = 1"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"i = 2"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"i = 3"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"NO"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="å‡½æ•°çš„åŸºæœ¬å†™æ³•">å‡½æ•°çš„åŸºæœ¬å†™æ³•<a href="post/iOS-Objective-C-Learn#å‡½æ•°çš„åŸºæœ¬å†™æ³•"></a></h2><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * æ±‚é¢ç§¯çš„å‡½æ•°</span></span><br><span class="line"><span class="comment"> * ä¼ å…¥å€¼ï¼Œè®¡ç®—å¹¶è¿”å›é¢ç§¯å€¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a * b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ— å‚æ— è¿”å›çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    NSLog(@<span class="string">"this is a test!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</span> </span>&#123;</span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        NSLog(@<span class="string">"value = %f"</span>, area(<span class="number">5.0</span>, <span class="number">3.0</span>));</span><br><span class="line">        show();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="mainå‡½æ•°ä¸­çš„é»˜è®¤å‚æ•°">mainå‡½æ•°ä¸­çš„é»˜è®¤å‚æ•°<a href="post/iOS-Objective-C-Learn#mainå‡½æ•°ä¸­çš„é»˜è®¤å‚æ•°"></a></h2><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"argc = %d"</span>, argc);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; argc; i++) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"%s"</span>, argv[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ç»ˆç«¯è¿è¡Œ</p></blockquote><figure class="highlight sh"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ ls -l</span><br><span class="line">total 56</span><br><span class="line">-rwxr-xr-x@ 1 username  staff  27984  9  5 23:21 les1</span><br><span class="line"></span><br><span class="line">$ ./les1</span><br><span class="line">2018-09-05 23:28:27.313 les1[1369:176584] argc = 1</span><br><span class="line">2018-09-05 23:28:27.313 les1[1369:176584] ./les1</span><br><span class="line"></span><br><span class="line">$ ./les1 -a -b -c</span><br><span class="line">2018-09-05 23:28:39.782 les1[1370:176617] argc = 4</span><br><span class="line">2018-09-05 23:28:39.782 les1[1370:176617] ./les1</span><br><span class="line">2018-09-05 23:28:39.782 les1[1370:176617] -a</span><br><span class="line">2018-09-05 23:28:39.782 les1[1370:176617] -b</span><br><span class="line">2018-09-05 23:28:39.782 les1[1370:176617] -c</span><br></pre></td></tr></table></div></figure><h2 id="åˆ›å»ºç±»">åˆ›å»ºç±»<a href="post/iOS-Objective-C-Learn#åˆ›å»ºç±»"></a></h2><blockquote><p>å¤´æ–‡ä»¶<code>People.h</code></p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">People</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>å®ç°æ–‡ä»¶<code>People.m</code></p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">People</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><h2 id="å®ä¾‹åŒ–å¯¹è±¡">å®ä¾‹åŒ–å¯¹è±¡<a href="post/iOS-Objective-C-Learn#å®ä¾‹åŒ–å¯¹è±¡"></a></h2><ol><li>å¯¼å…¥ç±»çš„å¤´æ–‡ä»¶</li><li><code>[]</code>ä¸­å†™å‡½æ•°çš„è°ƒç”¨</li><li><code>alloc</code> å‡½æ•°ä¸ºå¯¹è±¡åˆ†é…å†…å­˜ç©ºé—´</li><li><code>init</code> å‡½æ•°è¿›è¡Œåˆå§‹åŒ–æ“ä½œ</li></ol><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span> // å¯¼å…¥ç±»å¤´æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        <span class="comment">// å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">        <span class="comment">// [] å‡½æ•°çš„è°ƒç”¨</span></span><br><span class="line">        <span class="comment">// [ç±»å æ–¹æ³•å]</span></span><br><span class="line">        <span class="comment">// [å¯¹è±¡å æ–¹æ³•å]</span></span><br><span class="line">        <span class="comment">// alloc - ä¸ºå¯¹è±¡åˆ†é…å†…å­˜ç©ºé—´</span></span><br><span class="line">        <span class="comment">// init - è¿›è¡Œåˆå§‹åŒ–æ“ä½œ</span></span><br><span class="line">        People * p1 = [[People alloc] init];</span><br><span class="line">        People * p2 = [[People alloc] init];</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="å±æ€§å’Œæˆå‘˜å˜é‡">å±æ€§å’Œæˆå‘˜å˜é‡<a href="post/iOS-Objective-C-Learn#å±æ€§å’Œæˆå‘˜å˜é‡"></a></h2><ol><li>ç±»å†…ä½¿ç”¨æˆå‘˜å˜é‡ã€ç±»å¤–ä½¿ç”¨å±æ€§</li><li>å®šä¹‰æˆå‘˜å˜é‡ï¼Œæ­¤æ—¶å¤–éƒ¨æ— æ³•è®¿é—®ã€‚å¦‚æœè¦è®©å¤–éƒ¨å¯è®¿é—®éœ€è¦åŠ ä¸Šï¼ˆä¸å»ºè®®ï¼‰ï¼š@public</li><li>å±æ€§æ˜¯ä¸ºäº†è®©ç±»å¤–å¯ä»¥è®¿é—®æˆå‘˜å˜é‡</li><li>å±æ€§å°±æ˜¯æˆå‘˜å˜é‡çš„å¤–éƒ¨æ¥å£</li><li>å¯å°†å±æ€§æ‹†å¼€ï¼Œå†™æˆ<code>get</code>å’Œ<code>set</code>ä¸¤éƒ¨åˆ†</li></ol><blockquote><p>People.h</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç±»å†…ä½¿ç”¨æˆå‘˜å˜é‡ã€ç±»å¤–ä½¿ç”¨å±æ€§</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">People</span> : <span class="title">NSObject</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰æˆå‘˜å˜é‡ï¼Œæ­¤æ—¶å¤–éƒ¨æ— æ³•è®¿é—®ã€‚å¦‚æœè¦è®©å¤–éƒ¨å¯è®¿é—®éœ€è¦åŠ ä¸Šï¼š@public</span></span><br><span class="line">    <span class="comment">// @public</span></span><br><span class="line">    <span class="comment">// NSString * _peopleName; // å¦‚æœå®šä¹‰äº†è¯¥æˆå‘˜å˜é‡çš„å±æ€§ï¼Œé‚£ä¹ˆå¯ä»¥ä¸å†™ã€‚ç¼–è¯‘å™¨ä¼šä¸ºæˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå«_peopleNameçš„æˆå‘˜å˜é‡</span></span><br><span class="line">    <span class="keyword">int</span> _peopleAge;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å±æ€§æ˜¯ä¸ºäº†è®©ç±»å¤–å¯ä»¥è®¿é—®æˆå‘˜å˜é‡</span></span><br><span class="line"><span class="comment">// å±æ€§å°±æ˜¯æˆå‘˜å˜é‡çš„å¤–éƒ¨æ¥å£</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>)<span class="built_in">NSString</span> * peopleName;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†å±æ€§æ‹†å¼€</span></span><br><span class="line">- (<span class="keyword">void</span>) setAge:(<span class="keyword">int</span>) age;</span><br><span class="line">- (<span class="keyword">int</span>) getAge;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>People.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span></span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">int</span> _peopleSex; <span class="comment">// ä¹Ÿå¯ä»¥å°†æˆå‘˜å˜é‡å®šä¹‰åœ¨mæ–‡ä»¶ä¸­ï¼Œæ²¡ä»€ä¹ˆåŒºåˆ«</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">People</span></span></span><br><span class="line">- (<span class="keyword">instancetype</span>)init</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        _peopleName = <span class="string">@"å¼ ä¸‰"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>) setAge:(<span class="keyword">int</span>) age</span><br><span class="line">&#123;</span><br><span class="line">    _peopleAge = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">int</span>) getAge</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> _peopleAge;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>main.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span></span></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        People * p1 = [[People alloc] init];</span><br><span class="line">        p1.peopleName = <span class="string">@"æå››"</span>; <span class="comment">// é€šè¿‡å±æ€§è®¾ç½®åå­—</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"p1 name %@"</span>, [p1 peopleName]); <span class="comment">// é€šè¿‡å±æ€§è·å–åå­—</span></span><br><span class="line">        [p1 setAge:<span class="number">23</span>]; <span class="comment">// é€šè¿‡å‡½æ•°è®¾ç½®å¹´é¾„</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"p1 age %d"</span>, [p1 getAge]); <span class="comment">// é€šè¿‡å‡½æ•°è·å–å¹´é¾„</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="å‡½æ•°">å‡½æ•°<a href="post/iOS-Objective-C-Learn#å‡½æ•°"></a></h2><ol><li>è°ƒç”¨æ–¹æ³•æ˜¯ç”¨ä¸­æ‹¬å·</li><li><code>-</code>ã€<code>+</code> æ–¹æ³•çš„ç±»å‹ï¼ˆå‡å·ä»£è¡¨å¯¹è±¡æ–¹æ³•ï¼ŒåŠ å·ä»£è¡¨ç±»æ–¹æ³•ï¼‰</li><li>åŠ å·æ–¹æ³•å’Œå‡å·æ–¹æ³•ä¹‹é—´çš„ç›¸äº’è°ƒç”¨é€»è¾‘å’Œjavaä¸€æ ·</li><li>æ–¹æ³•åï¼šå»æ‰æ–¹æ³•ç±»å‹å’Œå‚æ•°ç±»å‹å°±æ˜¯æ–¹æ³•å</li><li><code>(int)</code> è¿”å›å€¼ç±»å‹<code>int</code></li><li><code>:(int) x</code>     ä»£è¡¨æ–¹æ³•æœ‰å‚æ•°ï¼Œå‚æ•°ç±»å‹<code>int</code>ï¼Œå‚æ•°å<code>x</code></li></ol><blockquote><p>People.h</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">People</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> ç”³æ˜æ–¹æ³•</span></span><br><span class="line"><span class="comment"> -ã€+ æ–¹æ³•çš„ç±»å‹ï¼ˆå‡å·ä»£è¡¨å¯¹è±¡æ–¹æ³•ï¼ŒåŠ å·ä»£è¡¨ç±»æ–¹æ³•ï¼‰</span></span><br><span class="line"><span class="comment"> åŠ å·æ–¹æ³•å’Œå‡å·æ–¹æ³•ä¹‹é—´çš„ç›¸äº’è°ƒç”¨é€»è¾‘å’Œjavaä¸€æ ·</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">(int) è¿”å›å€¼ç±»å‹</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> :(int) x     ä»£è¡¨æ–¹æ³•æœ‰å‚æ•°ï¼Œå‚æ•°ç±»å‹intï¼Œå‚æ•°åx</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> æ–¹æ³•åï¼šå»æ‰æ–¹æ³•ç±»å‹å’Œå‚æ•°ç±»å‹å°±æ˜¯æ–¹æ³•å</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">int</span>) report;</span><br><span class="line">+ (<span class="keyword">void</span>) report1;</span><br><span class="line">- (<span class="keyword">int</span>) showWithA:(<span class="keyword">int</span>) a;</span><br><span class="line">- (<span class="keyword">int</span>) showWithA:(<span class="keyword">int</span>) a andB:(<span class="keyword">int</span>) b;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>People.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">People</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *_name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> *_name1;</span><br><span class="line">- (<span class="keyword">int</span>)report</span><br><span class="line">&#123;</span><br><span class="line">    _name = <span class="string">@"abc"</span>;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"-å·æ–¹æ³•:report"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">22</span>;</span><br><span class="line">&#125;</span><br><span class="line">+ (<span class="keyword">void</span>)report1</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//     _name = @"abc"; ç¼–è¯‘é”™è¯¯ï¼Œ+å·æ–¹æ³•ç›¸å½“äºjavaä¸­çš„é™æ€æ–¹æ³•</span></span><br><span class="line">    _name1 = <span class="string">@"abc"</span>;<span class="comment">//é™æ€æ–¹æ³•å¯è°ƒç”¨é™æ€å˜é‡</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"+å·æ–¹æ³•ï¼šreport1"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">int</span>) showWithA:(<span class="keyword">int</span>) a</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">int</span>) showWithA:(<span class="keyword">int</span>) a andB:(<span class="keyword">int</span>) b&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>main.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        <span class="comment">// [] è°ƒç”¨æ–¹æ³•</span></span><br><span class="line">        People *p1 = [[People alloc] init];</span><br><span class="line"><span class="comment">//        NSLog(@"return value %d", [p1 report]);</span></span><br><span class="line"><span class="comment">//        [People report1];</span></span><br><span class="line">        <span class="keyword">int</span> a1 = [p1 showWithA:<span class="number">10</span>];</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"a1 = %d"</span>, a1);</span><br><span class="line">        <span class="keyword">int</span> a2 = [p1 showWithA:<span class="number">10</span> andB:<span class="number">20</span>];</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"a2 = %d"</span>, a2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="åˆå§‹åŒ–å‡½æ•°">åˆå§‹åŒ–å‡½æ•°<a href="post/iOS-Objective-C-Learn#åˆå§‹åŒ–å‡½æ•°"></a></h2><blockquote><p>People.h</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">People</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–æ–¹æ³•</span></span><br><span class="line"><span class="comment">//- (id) init;//ä»»æ„ç±»å‹</span></span><br><span class="line"><span class="comment">//è™½ç„¶ä¸Šé¢çš„ä¹Ÿå¯ä»¥ä½†æ˜¯æ¨èä¸‹é¢</span></span><br><span class="line">- (<span class="keyword">instancetype</span>) init; <span class="comment">// å½“å‰ç±»å‹ï¼Œå½“å‰æ˜¯Peopleç±»å‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è‡ªå®šä¹‰åˆå§‹åŒ–æ–¹æ³•</span></span><br><span class="line">- (<span class="keyword">instancetype</span>) initPeople:(<span class="built_in">NSString</span> *) name age:(<span class="keyword">int</span>) age;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>People.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">People</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> _age;</span><br><span class="line">    <span class="keyword">int</span> _name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é‡å†™åˆå§‹åŒ–æ–¹æ³•</span></span><br><span class="line">- (<span class="keyword">instancetype</span>)init</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        _age = <span class="number">23</span>;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"age = %d"</span>, _age);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)initPeople:(<span class="built_in">NSString</span> *)name age:(<span class="keyword">int</span>)age</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        _age = age;</span><br><span class="line">        _name = name;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"age = %d, name = %@"</span>, _age, name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>main.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        People *p1 = [[People alloc] init];</span><br><span class="line">        People * p2 = [[People alloc] initPeople:<span class="string">@"xu"</span> age:<span class="number">24</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>è¾“å‡º</p></blockquote><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age = 23</span><br><span class="line">age = 24, name = xu</span><br></pre></td></tr></table></div></figure><h2 id="å°è£…">å°è£…<a href="post/iOS-Objective-C-Learn#å°è£…"></a></h2><blockquote><p>è®¿é—®ä¿®é¥°ç¬¦</p></blockquote><div class="article-bounded"><div class="article-table"><table><thead><tr><th>å£°æ˜</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>@public</code></td><td>å…¬æœ‰çš„ï¼Œ åœ¨ç±»ä¸­å’Œç±»å¤–éƒ½å¯ä»¥ä½¿ç”¨å¹¶ä¸”å¯ä»¥è¢«ç»§æ‰¿</td></tr><tr><td><code>@private</code></td><td>ç§æœ‰çš„ï¼Œåœ¨ç±»ä¸­å¯ä»¥ä½¿ç”¨ï¼Œç±»å¤–æ— æ³•è°ƒç”¨ï¼Œä¸å¯ä»¥è¢«ç»§æ‰¿</td></tr><tr><td><code>@protected</code></td><td>å—ä¿æŠ¤çš„ï¼ˆé»˜è®¤ï¼‰ï¼Œåœ¨ç±»ä¸­å¯ä»¥ä½¿ç”¨ï¼Œç±»å¤–æ— æ³•è°ƒç”¨ï¼Œä½†æ˜¯å¯ä»¥è¢«ç»§æ‰¿</td></tr><tr><td><code>@package</code></td><td>æ¡†æ¶æƒé™ï¼Œåœ¨æ¡†æ¶å†…ç›¸å½“äºå—ä¿æŠ¤ï¼Œåœ¨æ¡†æ¶å¤–ç›¸å½“äºç§æœ‰</td></tr></tbody></table></div></div><blockquote><p>æ–¹æ³•æ˜¯æ²¡æœ‰è®¿é—®ä¿®é¥°ç¬¦çš„åŒcè¯­è¨€ä¸€æ ·ï¼Œå¦‚æœä¸æƒ³è®©å¤–éƒ¨è®¿é—®ï¼Œå»æ‰<code>.h</code>ä¸­çš„æ–¹æ³•å®šä¹‰å°±å¯ä»¥äº†ã€‚</p></blockquote><blockquote><p>MyClass.h</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyClass</span> : <span class="title">NSObject</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">@public</span></span><br><span class="line">    <span class="keyword">int</span> _classInt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> * className;</span><br><span class="line">-(<span class="keyword">void</span>) report;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>MyClass.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"MyClass.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MyClass</span></span></span><br><span class="line">- (<span class="keyword">void</span>)report</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"class name = %@"</span>, _className);</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"class name = %d"</span>, _classInt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>main.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MyClass.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        MyClass *c = [[MyClass alloc] init];</span><br><span class="line">        c.className = <span class="string">@"My Class"</span>;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨æŒ‡å‘æ¥è°ƒç”¨ç±»ä¸­çš„å…¬æœ‰æˆå‘˜å˜é‡</span></span><br><span class="line">        c-&gt;_classInt = <span class="number">22</span>;</span><br><span class="line">        [c report];</span><br><span class="line">    &#125;ÃŸ</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="ç»§æ‰¿">ç»§æ‰¿<a href="post/iOS-Objective-C-Learn#ç»§æ‰¿"></a></h2><blockquote><p>interface æ—¶å€™ å†’å· ä»£è¡¨ç»§æ‰¿</p></blockquote><blockquote><p>çˆ¶ç±»</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyClass</span> : <span class="title">NSObject</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> _claseInt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> * name;</span><br><span class="line">- (<span class="keyword">void</span>) report;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MyClass.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MyClass</span></span></span><br><span class="line">- (<span class="keyword">void</span>)report</span><br><span class="line">&#123;</span><br><span class="line">    _claseInt = <span class="number">23</span>;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"name = %@, value = %d"</span>, _name, _claseInt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>å­ç±»</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"MyClass.h"</span></span></span><br><span class="line"><span class="comment">// interface æ—¶å€™ å†’å· ä»£è¡¨ç»§æ‰¿</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MySubClass</span> : <span class="title">MyClass</span></span></span><br><span class="line">-(<span class="keyword">void</span>) show;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MySubClass.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MySubClass</span></span></span><br><span class="line">- (<span class="keyword">void</span>)show</span><br><span class="line">&#123;</span><br><span class="line">    _claseInt = <span class="number">100</span>;</span><br><span class="line">    [<span class="keyword">self</span> report];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>main.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MyClass.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MySubClass.h"</span></span></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        MyClass *c = [[MyClass alloc] init];</span><br><span class="line">        c.name = <span class="string">@"xu"</span>;</span><br><span class="line">        [c report];</span><br><span class="line"></span><br><span class="line">        MySubClass *sc = [[MySubClass alloc] init];</span><br><span class="line">        sc.name = <span class="string">@"xu"</span>;</span><br><span class="line"><span class="comment">//        [sc report];</span></span><br><span class="line">        [sc show];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>è¾“å‡º</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name = xu, value = <span class="number">23</span></span><br><span class="line">name = xu, value = <span class="number">23</span></span><br></pre></td></tr></table></div></figure><h2 id="å¤šæ€">å¤šæ€<a href="post/iOS-Objective-C-Learn#å¤šæ€"></a></h2><blockquote><p>çˆ¶ç±»<code>Printer.h</code>  <code>Printer.m</code></p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Printer</span> : <span class="title">NSObject</span></span></span><br><span class="line">- (<span class="keyword">void</span>) print;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Printer.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Printer</span></span></span><br><span class="line">- (<span class="keyword">void</span>)print</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"æˆ‘æ˜¯ä¸€ä¸ªæ‰“å°æœº"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>å­ç±»<code>ColorPrinter.h</code>  <code>ColorPrinter.m</code></p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"Printer.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ColorPrinter</span> : <span class="title">Printer</span></span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ColorPrinter.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ColorPrinter</span></span></span><br><span class="line">- (<span class="keyword">void</span>)print</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> print]; <span class="comment">// å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"æˆ‘æ˜¯ä¸€ä¸ªå½©è‰²æ‰“å°æœº"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>main.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ColorPrinter.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        ColorPrinter *cp = [[ColorPrinter alloc] init];</span><br><span class="line">        [cp print];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// çˆ¶ç±»å¯ä»¥å¼•ç”¨å­ç±»å‹</span></span><br><span class="line">        Printer * p = [[ColorPrinter alloc] init];</span><br><span class="line">        [p print];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>è¾“å‡º</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘æ˜¯ä¸€ä¸ªæ‰“å°æœº</span><br><span class="line">æˆ‘æ˜¯ä¸€ä¸ªå½©è‰²æ‰“å°æœº</span><br><span class="line">æˆ‘æ˜¯ä¸€ä¸ªæ‰“å°æœº</span><br><span class="line">æˆ‘æ˜¯ä¸€ä¸ªå½©è‰²æ‰“å°æœº</span><br></pre></td></tr></table></div></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;æºä»£ç æ–‡ä»¶æ‰©å±•åå¯¹æ¯”&quot;&gt;æºä»£ç æ–‡ä»¶æ‰©å±•åå¯¹æ¯”&lt;a href=&quot;post/iOS-Objective-C-Learn#æºä»£ç æ–‡ä»¶æ‰©å±•åå¯¹æ¯”&quot;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;div class=&quot;article-bounded&quot;&gt;&lt;div class=&quot;article-tabl
      
    
    </summary>
    
      <category term="iOS" scheme="https://blog.xujiaji.com/categories/iOS/"/>
    
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¬”è®°" scheme="https://blog.xujiaji.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="iOS" scheme="https://blog.xujiaji.com/tags/iOS/"/>
    
      <category term="Objective-C" scheme="https://blog.xujiaji.com/tags/Objective-C/"/>
    
  </entry>
  
  <entry>
    <title>Git Commit Standard</title>
    <link href="https://blog.xujiaji.com/post/Git-Commit-Standard/index.html"/>
    <id>https://blog.xujiaji.com/post/Git-Commit-Standard/index.html</id>
    <published>2018-09-05T02:21:44.000Z</published>
    <updated>2019-04-08T06:55:24.990Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€ä¸‹Gitçš„æäº¤è§„èŒƒï¼Œæ–¹ä¾¿ä»¥åæŸ¥é˜…</p><a id="more"></a><h2 id="æäº¤å‘½ä»¤">æäº¤å‘½ä»¤<a href="post/Git-Commit-Standard#æäº¤å‘½ä»¤"></a></h2><ol><li><code>git commit -m &quot;æäº¤ä¿®æ”¹ä¿¡æ¯&quot;</code>ï¼Œè¿™æ ·è¿™åªèƒ½æœ‰ä¸€è¡Œä¿¡æ¯</li><li><code>git commit</code>ï¼Œä¼šè¿›å…¥<code>vi</code>æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå¯å†™å¤šè¡Œã€‚</li></ol><h2 id="æäº¤ä¿¡æ¯çš„æ ¼å¼">æäº¤ä¿¡æ¯çš„æ ¼å¼<a href="post/Git-Commit-Standard#æäº¤ä¿¡æ¯çš„æ ¼å¼"></a></h2><blockquote><p>æ¯æ¬¡æäº¤ä¿¡æ¯éƒ½åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ï¼šHeaderã€Bodyå’ŒFooterã€‚å…¶ä¸­ï¼ŒHeader æ˜¯å¿…éœ€çš„ï¼ŒBody å’Œ Footer å¯ä»¥çœç•¥ã€‚</p></blockquote><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</span><br><span class="line">// ç©ºä¸€è¡Œ</span><br><span class="line">&lt;body&gt;</span><br><span class="line">// ç©ºä¸€è¡Œ</span><br><span class="line">&lt;footer&gt;</span><br></pre></td></tr></table></div></figure><blockquote><p>æ–‡å­—æè¿°</p></blockquote><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># æ ‡é¢˜è¡Œï¼š50ä¸ªå­—ç¬¦ä»¥å†…ï¼Œæè¿°ä¸»è¦å˜æ›´å†…å®¹</span><br><span class="line">#</span><br><span class="line"># ä¸»ä½“å†…å®¹ï¼šæ›´è¯¦ç»†çš„è¯´æ˜æ–‡æœ¬ï¼Œå»ºè®®72ä¸ªå­—ç¬¦ä»¥å†…ã€‚ éœ€è¦æè¿°çš„ä¿¡æ¯åŒ…æ‹¬:</span><br><span class="line">#</span><br><span class="line"># * ä¸ºä»€ä¹ˆè¿™ä¸ªå˜æ›´æ˜¯å¿…é¡»çš„? å®ƒå¯èƒ½æ˜¯ç”¨æ¥ä¿®å¤ä¸€ä¸ªbugï¼Œå¢åŠ ä¸€ä¸ªfeatureï¼Œæå‡æ€§èƒ½ã€å¯é æ€§ã€ç¨³å®šæ€§ç­‰ç­‰</span><br><span class="line"># * ä»–å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜? å…·ä½“æè¿°è§£å†³é—®é¢˜çš„æ­¥éª¤</span><br><span class="line"># * æ˜¯å¦å­˜åœ¨å‰¯ä½œç”¨ã€é£é™©?</span><br><span class="line">#</span><br><span class="line"># å°¾éƒ¨ï¼šå¦‚æœéœ€è¦çš„åŒ–å¯ä»¥æ·»åŠ ä¸€ä¸ªé“¾æ¥åˆ°issueåœ°å€æˆ–è€…å…¶å®ƒæ–‡æ¡£ï¼Œæˆ–è€…å…³é—­æŸä¸ªissueã€‚</span><br></pre></td></tr></table></div></figure><h2 id="lt-type-gt"><code>&lt;type&gt;</code><a href="post/Git-Commit-Standard#lt-type-gt"></a></h2><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">Value</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left">feat</td><td style="text-align:left">featureæ–°åŠŸèƒ½</td></tr><tr><td style="text-align:left">fix</td><td style="text-align:left">ä¿®å¤bug</td></tr><tr><td style="text-align:left">doc</td><td style="text-align:left">ä»…ä»…ä¿®æ”¹äº†æ–‡æ¡£ï¼Œæ¯”å¦‚README, CHANGELOG, CONTRIBUTEç­‰ç­‰</td></tr><tr><td style="text-align:left">style</td><td style="text-align:left">ä»£ç æ ¼å¼æ”¹å˜ï¼Œä¸æ”¹å˜ä»£ç é€»è¾‘</td></tr><tr><td style="text-align:left">refactor</td><td style="text-align:left">ä»£ç é‡æ„ï¼Œæ²¡æœ‰åŠ æ–°åŠŸèƒ½æˆ–è€…ä¿®å¤bug</td></tr><tr><td style="text-align:left">perf</td><td style="text-align:left">ä¼˜åŒ–ç›¸å…³ï¼Œæ¯”å¦‚æå‡æ€§èƒ½ã€ä½“éªŒ</td></tr><tr><td style="text-align:left">test</td><td style="text-align:left">æµ‹è¯•ç”¨ä¾‹ï¼ŒåŒ…æ‹¬å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ç­‰</td></tr><tr><td style="text-align:left">chore</td><td style="text-align:left">æ”¹å˜æ„å»ºæµç¨‹ã€æˆ–è€…å¢åŠ ä¾èµ–åº“ã€å·¥å…·ç­‰</td></tr><tr><td style="text-align:left">revert</td><td style="text-align:left">å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬</td></tr></tbody></table></div></div><h2 id="lt-scope-gt"><code>&lt;scope&gt;</code><a href="post/Git-Commit-Standard#lt-scope-gt"></a></h2><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">Value</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left">all</td><td style="text-align:left">è¡¨ç¤ºå½±å“é¢å¤§ ï¼Œå¦‚ä¿®æ”¹äº†ç½‘ç»œæ¡†æ¶  ä¼šå¯¹çœŸä¸ªç¨‹åºäº§ç”Ÿå½±å“</td></tr><tr><td style="text-align:left">loation</td><td style="text-align:left">è¡¨ç¤ºå½±å“å°ï¼ŒæŸä¸ªå°å°çš„åŠŸèƒ½</td></tr><tr><td style="text-align:left">module</td><td style="text-align:left">è¡¨ç¤ºä¼šå½±å“æŸä¸ªæ¨¡å— å¦‚ç™»å½•æ¨¡å—ã€é¦–é¡µæ¨¡å— ã€ç”¨æˆ·ç®¡ç†æ¨¡å—ç­‰ç­‰</td></tr></tbody></table></div></div><h2 id="lt-subject-gt"><code>&lt;subject&gt;</code><a href="post/Git-Commit-Standard#lt-subject-gt"></a></h2><ol><li>subjectæ˜¯ commit ç›®çš„çš„ç®€çŸ­æè¿°ï¼Œä¸è¶…è¿‡50ä¸ªå­—ç¬¦ã€‚</li><li>ä»¥åŠ¨è¯å¼€å¤´ï¼Œç¬¬ä¸€ä¸ªå­—æ¯å°å†™ï¼Œä½¿ç”¨ç¬¬ä¸€äººç§°ç°åœ¨æ—¶ï¼Œæ¯”å¦‚changeï¼Œè€Œä¸æ˜¯changedæˆ–changes<br>ç¬¬ä¸€ä¸ªå­—æ¯å°å†™</li><li>ç»“å°¾ä¸åŠ å¥å·â€.â€</li></ol><h2 id="lt-body-gt"><code>&lt;body&gt;</code><a href="post/Git-Commit-Standard#lt-body-gt"></a></h2><p>å¯¹æœ¬æ¬¡ commit çš„è¯¦ç»†æè¿°ï¼Œå¯ä»¥åˆ†æˆå¤šè¡Œã€‚</p><h2 id="lt-footer-gt"><code>&lt;footer&gt;</code><a href="post/Git-Commit-Standard#lt-footer-gt"></a></h2><ol><li><p>å¹¶è”Issueï¼Œæœ¬æ¬¡æäº¤å¦‚æœå’Œæ‘¸ä¸ªissueæœ‰å…³ç³»åˆ™éœ€è¦å†™ä¸Šè¿™ä¸ªï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Issue #1, #2, #3</span><br></pre></td></tr></table></div></figure></li><li><p>å…³é—­ Issueï¼Œå¦‚æœå½“å‰æäº¤ä¿¡æ¯è§£å†³äº†æŸä¸ªissueï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ Footer éƒ¨åˆ†å…³é—­è¿™ä¸ª issueï¼Œå…³é—­çš„æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Close #1, #2, #3</span><br></pre></td></tr></table></div></figure></li></ol><h2 id="å®Œæ•´ä¾‹å­">å®Œæ•´ä¾‹å­<a href="post/Git-Commit-Standard#å®Œæ•´ä¾‹å­"></a></h2><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">feat(all): add login</span><br><span class="line"></span><br><span class="line">add login in project</span><br><span class="line"></span><br><span class="line">- qq login</span><br><span class="line">- weixin login</span><br><span class="line">- sina login</span><br><span class="line"></span><br><span class="line">Issue #1, #2</span><br><span class="line">Close #1, #2</span><br></pre></td></tr></table></div></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•ä¸€ä¸‹Gitçš„æäº¤è§„èŒƒï¼Œæ–¹ä¾¿ä»¥åæŸ¥é˜…&lt;/p&gt;
    
    </summary>
    
      <category term="å·¥å…·" scheme="https://blog.xujiaji.com/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="Git" scheme="https://blog.xujiaji.com/tags/Git/"/>
    
      <category term="ç¬”è®°" scheme="https://blog.xujiaji.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>iOSç”¨UISegmentedControlè®¾è®¡ä¸€ä¸ªé¡¶éƒ¨åˆ†é¡µå¯¼èˆª-Swiftï¼ˆç¿»è¯‘æ–‡ï¼‰</title>
    <link href="https://blog.xujiaji.com/post/ios-uisegmented-design/index.html"/>
    <id>https://blog.xujiaji.com/post/ios-uisegmented-design/index.html</id>
    <published>2018-07-23T06:36:32.000Z</published>
    <updated>2019-04-08T06:55:47.295Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>åŸæ–‡ï¼šã€Š<a href="https://www.codementor.io/kevinfarst/designing-a-button-bar-style-uisegmentedcontrol-in-swift-cg6cf0dok" target="_blank" rel="noopener">Designing a Button Bar-Style UISegmentedControl in Swift</a>ã€‹</p></blockquote><a id="more"></a><p>æˆ‘æ­£åœ¨åšä¸€ä¸ªé¡¹ç›®ï¼Œé¡¹ç›®é‡Œé¢æˆ‘æƒ³ç”¨<code>UISegmentedControl</code>åšä¸€ä¸ªç®€æ´çš„â€œåº•éƒ¨æ¡å½¢æ ·å¼â€çš„è®¾è®¡ã€‚å®ƒæ²¡æœ‰è¾¹æ¡†ï¼Œæ‰€é€‰ä¸‹æ–¹æœ‰ä¸€ä¸ªå°é•¿æ¡ï¼Œå½“ä½ é€‰æ‹©ä¸€ä¸ªå…ƒç´ åä»–ä¼šç›¸åº”çš„ç§»åŠ¨è¿‡å»ã€‚æˆ‘æ‰¾åˆ°å‡ ä¸ªéå¸¸å¥½çš„ç¬¬ä¸‰æ–¹åº“æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æˆ‘åœ¨è¿™äº›ç±»åº“ä¸Šé‡åˆ°äº†ä¸€äº›éº»çƒ¦ï¼Œäºæ˜¯æˆ‘å°è¯•è‡ªå·±åšã€‚æˆ‘ä»¥è‡ªåŠ¨å¸ƒå±€çº¦æŸï¼Œä»¥swiftä»£ç æ–¹å¼æ„å»ºè§†å›¾ï¼Œå¹¶ä¸ºäº†ç®€å•èµ·è§ï¼Œå°†æ‰€æœ‰ä¸»é¢˜å†…è”å®Œæˆã€‚</p><h2 id="å‡†å¤‡å¼€å§‹">å‡†å¤‡å¼€å§‹<a href="post/ios-uisegmented-design#å‡†å¤‡å¼€å§‹"></a></h2><p>æˆ‘ä»¬åœ¨Swift playgroundä¸­åšè¿™äº›äº‹æƒ…ï¼Œå› æ­¤è®©æˆ‘ä»¬ä»åŸºæœ¬çš„ä¸œè¥¿å¼€å§‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„UIViewå¹¶ä¸”æ·»åŠ ä¸€ä¸ªå¸¦æœ‰3ä¸ªç‰‡æ®µçš„UISegmentedControlï¼Œå¦å¤–éœ€è¦æ³¨æ„ï¼Œæˆ‘æ„å»ºçº¦æŸçš„æ–¹å¼æ˜¯å‡è®¾æ‰€æœ‰ç‰‡æ®µé•¿åº¦æƒ³ç­‰çš„æƒ…å†µã€‚å¦‚æœä¸æ˜¯çš„è¯ï¼Œä¼šå¯¼è‡´åº•éƒ¨é•¿æ¡åœ¨ç›¸åº”çš„ä½ç½®ä¸Šå˜å¾—å¤ªå®½æˆ–ä¸å¤Ÿå®½ã€‚</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> PlaygroundSupport</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®¹å™¨View</span></span><br><span class="line"><span class="keyword">let</span> view = <span class="type">UIView</span>(frame: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: <span class="number">400</span>, height: <span class="number">100</span>))</span><br><span class="line">view.backgroundColor = .white</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> segmentedControl = <span class="type">UISegmentedControl</span>()</span><br><span class="line"><span class="comment">// æ·»åŠ ç‰‡æ®µ</span></span><br><span class="line">segmentedControl.insertSegment(withTitle: <span class="string">"One"</span>, at: <span class="number">0</span>, animated: <span class="literal">true</span>)</span><br><span class="line">segmentedControl.insertSegment(withTitle: <span class="string">"Two"</span>, at: <span class="number">1</span>, animated: <span class="literal">true</span>)</span><br><span class="line">segmentedControl.insertSegment(withTitle: <span class="string">"Three"</span>, at: <span class="number">2</span>, animated: <span class="literal">true</span>)</span><br><span class="line"><span class="comment">// è®©ç¬¬ä¸€ä¸ªç‰‡æ®µé»˜è®¤é€‰ä¸­</span></span><br><span class="line">segmentedControl.selectedSegmentIndex = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®ä¸ºfalseï¼Œæˆ‘ä»¬æ‰èƒ½ä½¿ç”¨è‡ªåŠ¨å¸ƒå±€çº¦æŸ</span></span><br><span class="line">segmentedControl.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ UISegmentedControlåˆ°å®¹å™¨View</span></span><br><span class="line">view.addSubview(segmentedControl)</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¦æŸåˆ°å®¹å™¨çš„é¡¶éƒ¨</span></span><br><span class="line">segmentedControl.topAnchor.constraint(equalTo: view.topAnchor).isActive = <span class="literal">true</span></span><br><span class="line"><span class="comment">// é™åˆ¶ä¸ºå®¹å™¨viewçš„å®½åº¦</span></span><br><span class="line">segmentedControl.widthAnchor.constraint(equalTo: view.widthAnchor).isActive = <span class="literal">true</span></span><br><span class="line"><span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">segmentedControl.heightAnchor.constraint(equalToConstant: <span class="number">40</span>).isActive = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="type">PlaygroundPage</span>.current.liveView = view</span><br></pre></td></tr></table></div></figure><p>æ­¤æ—¶å®æ—¶çª—å£å·²ç»ä¸ºæˆ‘ä»¬å±•ç¤ºäº†åŸºæœ¬çš„<code>UISegmentedControl</code>ã€‚ä¸è¦å¿˜è®°å°†<code>isActive</code>å±æ€§é™„åŠ åˆ°æ¯ä¸ªè‡ªåŠ¨å¸ƒå±€çº¦æŸï¼Œå…¶å€¼ä¸ºtrueï¼Œå¦åˆ™ä»–ä»¬å°†ä¸èµ·ä½œç”¨ã€‚<br><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/ios-uisegmented-design/basic-uisegmentedcontrol.png" alt="Basic UISegmentedControl"></p><h2 id="é¢œè‰²ã€å­—ä½“å’Œè¾¹æ¡†Oh-Myï¼">é¢œè‰²ã€å­—ä½“å’Œè¾¹æ¡†Oh Myï¼<a href="post/ios-uisegmented-design#é¢œè‰²ã€å­—ä½“å’Œè¾¹æ¡†Oh-Myï¼"></a></h2><p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬åˆ é™¤æ‰<code>backgroundColor</code>å’Œ<code>tintColor</code>ï¼Œåˆ é™¤åè¾¹æ¡†å’Œå·²é€‰æ‹©çš„ç‰‡æ®µèƒŒæ™¯é¢œè‰²å°†ä¼šæ¶ˆå¤±ã€‚<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ° selectedSegmentIndexä¸‹é¢</span></span><br><span class="line">segmentedControl.backgroundColor = .clear</span><br><span class="line">segmentedControl.tintColor = .clear</span><br></pre></td></tr></table></div></figure></p><p>å¦‚æœä½ çœ‹å®æ—¶çª—å£ï¼Œæˆ‘ä»¬åˆ é™¤äº†<code>tintColor</code>åï¼Œ<code>UISegmentedControl</code>å·²ç»æ¶ˆå¤±ï¼Œç°åœ¨æ²¡æœ‰é¢œè‰²äº†ã€‚è¦æ¢å¤æ ‡ç­¾ï¼Œè®©æˆ‘ä»¬æ›´æ”¹æ‰€é€‰ç‰‡æ®µå’Œæœªé€‰ç‰‡æ®µçš„å­—ä½“ã€æ–‡æœ¬é¢œè‰²å’Œå¤§å°ã€‚<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ è¿™äº›ä»£ç åˆ° segmentedControl.tintColor = .clear å</span></span><br><span class="line">segmentedControl.setTitleTextAttributes([</span><br><span class="line">    <span class="type">NSAttributedStringKey</span>.font: <span class="type">UIFont</span>(name: <span class="string">"DINCondensed-Bold"</span>, size: <span class="number">18</span>)!,</span><br><span class="line">    <span class="type">NSAttributedStringKey</span>.foregroundColor: <span class="type">UIColor</span>.lightGray</span><br><span class="line">    ], <span class="keyword">for</span>: .normal)</span><br><span class="line"></span><br><span class="line">segmentedControl.setTitleTextAttributes([</span><br><span class="line">    <span class="type">NSAttributedStringKey</span>.font : <span class="type">UIFont</span>(name: <span class="string">"DINCondensed-Bold"</span>, size: <span class="number">18</span>)!,</span><br><span class="line">    <span class="type">NSAttributedStringKey</span>.foregroundColor: <span class="type">UIColor</span>.orange</span><br><span class="line">    ], <span class="keyword">for</span>: .selected)</span><br></pre></td></tr></table></div></figure></p><p><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/ios-uisegmented-design/change-color-font.png" alt="change-color-font"><br>åˆ°è¿™å„¿å·®ä¸å¤šäº†ï¼ç°åœ¨æˆ‘ä»¬å¿…é¡»åœ¨æ‰€é€‰æ®µä¸‹æ–¹æ·»åŠ ä¸€ä¸ªé•¿æ¡æ ã€‚</p><h2 id="ä¸ºé€‰å®šç‰‡æ®µåº•éƒ¨æ·»åŠ é•¿æ¡">ä¸ºé€‰å®šç‰‡æ®µåº•éƒ¨æ·»åŠ é•¿æ¡<a href="post/ios-uisegmented-design#ä¸ºé€‰å®šç‰‡æ®µåº•éƒ¨æ·»åŠ é•¿æ¡"></a></h2><p>è¿™ä¸ªé•¿æ¡åªæ˜¯ä¸€ä¸ªç®€å•çš„UIViewï¼Œç„¶åå°†å…¶<code>backgroundColor</code>ä¸å…¶æ‰€é€‰ç‰‡æ®µå­—ä½“çš„é¢œè‰²ç›¸åŒ¹é…ã€‚æˆ‘ä»¬å°†é€‰æ‹©çš„ç‰‡æ®µå­—ä½“é¢œè‰²å’Œé•¿æ¡éƒ½è®¾ç½®ä¸ºæ©™è‰²ã€‚å¹¶ä¸”æˆ‘ä»¬è¦ä¸ºé•¿æ¡è®¾ç½®<code>translatesAutoresizingMaskIntoConstraints</code>ä¸ºfalseã€‚<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> buttonBar = <span class="type">UIView</span>()</span><br><span class="line"><span class="comment">// è®¾ç½®ä¸ºfalseï¼Œæˆ‘ä»¬æ‰èƒ½ä½¿ç”¨è‡ªåŠ¨å¸ƒå±€çº¦æŸ</span></span><br><span class="line">buttonBar.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line">buttonBar.backgroundColor = <span class="type">UIColor</span>.orange</span><br></pre></td></tr></table></div></figure></p><p>æ¥ä¸‹æ¥ï¼Œå°†<code>buttonBar</code>ä½œä¸ºå­Viewæ·»åŠ åˆ°å®¹å™¨viewä¸­<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ åˆ° view.addSubview(segmentedControl)ä¹‹å</span></span><br><span class="line">view.addSubview(buttonBar)</span><br></pre></td></tr></table></div></figure></p><p>æœ€ç»ˆï¼Œæˆ‘ä»¬éœ€è¦ç»™å®ƒä¸ªå®½åº¦ã€é«˜åº¦å’Œä½ç½®ï¼Œåœ¨<code>segmentedControl</code>ä¹‹åæ·»åŠ è¿™äº›çº¦æŸ<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// çº¦æŸå®ƒçš„é¡¶éƒ¨ä½ç½®åœ¨ç‰‡æ®µçš„åº•éƒ¨ä½ç½®</span></span><br><span class="line">buttonBar.topAnchor.constraint(equalTo: segmentedControl.bottomAnchor).isActive = <span class="literal">true</span></span><br><span class="line"><span class="comment">// è®¾ç½®é•¿æ¡çš„é«˜åº¦</span></span><br><span class="line">buttonBar.heightAnchor.constraint(equalToConstant: <span class="number">5</span>).isActive = <span class="literal">true</span></span><br><span class="line"><span class="comment">// çº¦æŸå®ƒçš„å·¦ä¾§å’Œç‰‡æ®µçš„å·¦ä¾§é‡åˆ</span></span><br><span class="line">buttonBar.leftAnchor.constraint(equalTo: segmentedControl.leftAnchor).isActive = <span class="literal">true</span></span><br><span class="line"><span class="comment">// çº¦æŸå®ƒçš„å®½åº¦ = ç‰‡æ®µå®¹å™¨å®½åº¦ / ç‰‡æ®µä¸ªæ•°</span></span><br><span class="line">buttonBar.widthAnchor.constraint(equalTo: segmentedControl.widthAnchor, multiplier: <span class="number">1</span> / <span class="type">CGFloat</span>(segmentedControl.numberOfSegments)).isActive = <span class="literal">true</span></span><br></pre></td></tr></table></div></figure></p><p>æ­£å¦‚æœ€åé‚£æ¡æ³¨é‡Šæ‰€è¯´ï¼Œæˆ‘ä»¬éœ€è¦é•¿æ¡çš„å®½åº¦ä¸º<code>segmentedControl</code>çš„å®½åº¦é™¤ä»¥ç‰‡æ®µä¸ªä¸ªæ•°ã€‚è¿™ä¿è¯äº†é•¿æ¡å®½åº¦å°†ä¸å•ä¸ªç‰‡æ®µçš„å®½åº¦å®Œå…¨åŒ¹é…ï¼ŒåŒæ ·è¿™é‡Œæ˜¯å‡è®¾æ‰€æœ‰çš„æ®µéƒ½æ˜¯æƒ³ç­‰çš„å®½åº¦ã€‚<br><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/ios-uisegmented-design/added-bar.png" alt="added-bar"><br>åˆå§‹è§†å›¾ç°åœ¨å·²å®Œæˆï¼æœ€åä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦è®©é•¿æ¡éšæ‰€é€‰çš„ç‰‡æ®µç§»åŠ¨ã€‚</p><h2 id="é•¿æ¡æ åŠ¨ç”»">é•¿æ¡æ åŠ¨ç”»<a href="post/ios-uisegmented-design#é•¿æ¡æ åŠ¨ç”»"></a></h2><p>å½“æ‰€é€‰ç‰‡æ®µå‘ç”Ÿæ”¹å˜æ—¶ï¼Œ<code>segmentedControl</code>éœ€è¦è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ¥å¤„ç†é•¿æ¡æ åœ¨xè½´ä¸Šçš„ä½ç½®è½¬æ¢ï¼Œä½¿å…¶è·‘åˆ°é€‰æ‹©çš„ç‰‡æ®µä¸‹æ–¹ã€‚å®šä¹‰ä¸ª<code>Responder</code>ç±»ï¼Œå¹¶æ·»åŠ æ–¹æ³•ï¼Œç„¶ååœ¨<code>segmentedControl</code>å˜é‡ä¸Šæ·»åŠ å›è°ƒï¼Œ<code>segmentedControl</code>çš„å€¼æ”¹å˜æ—¶ä¼šè§¦å‘ã€‚<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨importå£°æ˜ä¸‹æ–¹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Responder</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">segmentedControlValueChanged</span><span class="params">(<span class="number">_</span> sender: UISegmentedControl)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> responder = <span class="type">Responder</span>()</span><br><span class="line">...</span><br><span class="line"><span class="comment">// åœ¨PlaygroundPage.current.liveView = viewå£°æ˜çš„ä¸Šæ–¹</span></span><br><span class="line">segmentedControl.addTarget(responder, action: #selector(responder.segmentedControlValueChanged(<span class="number">_</span>:)), <span class="keyword">for</span>: <span class="type">UIControlEvents</span>.valueChanged)</span><br></pre></td></tr></table></div></figure></p><p>ä¸€å®šè¦ç¡®ä¿<code>sender</code>ä½œä¸ºæ–¹æ³•å‚æ•°ç±»å‹ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨è°ƒç”¨å‡½æ•°æ—¶è®¿é—®å®ƒã€‚æœ€åè®©æˆ‘ä»¬æ¥å®Œæˆæœ€åä¸€å—æ‹¼å›¾ï¼Œ<code>buttonBar</code>åœ¨xè½´çš„ç§»åŠ¨ï¼Œå®ƒå°†ç§»åŠ¨åˆ°è¢«é€‰ä¸­çš„ç‰‡æ®µä¸‹<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">segmentedControlValueChanged</span><span class="params">(<span class="number">_</span> sender: UISegmentedControl)</span></span> &#123;</span><br><span class="line">  <span class="type">UIView</span>.animate(withDuration: <span class="number">0.3</span>) &#123;</span><br><span class="line">      buttonBar.frame.origin.x = (segmentedControl.frame.width / <span class="type">CGFloat</span>(segmentedControl.numberOfSegments)) * <span class="type">CGFloat</span>(segmentedControl.selectedSegmentIndex)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p>é•¿æ¡å› è¯¥å»çš„xè½´ä½ç½® = (<code>segmentedControl</code>çš„å®½åº¦ / ç‰‡æ®µä¸ªæ•°) * å½“å‰ç‰‡æ®µçš„ä¸‹æ ‡</p><p>ç§ç§ï¼æˆ‘ä»¬çš„åŠ¨ç”»æŒ‰é’®æ å‡ºæ¥äº†<br><img src="https://xujiaji.oss-accelerate.aliyuncs.com/blog/ios-uisegmented-design/display.gif" alt="finished"></p><h2 id="ç»“è®º">ç»“è®º<a href="post/ios-uisegmented-design#ç»“è®º"></a></h2><p>æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« æ‰€æä¾›çš„ä¿¡æ¯ï¼Œèƒ½ä½œä¸ºä½ åœ¨çœ‹äº†è®¸å¤šç±»åº“æˆ–iOSåº”ç”¨åçš„ä¸€ä¸ªDIYè§£å†³æ–¹æ¡ˆã€‚ä½ å¯ä»¥å°†è¿™é‡Œçš„<code>UISegmentedControl</code>è¿æ¥åˆ°<code>UIPageViewController</code>æˆ–<code>UIScrollView</code>ä½œä¸ºåˆ†æ®µå†…å®¹ç›´æ¥ç§»åŠ¨çš„æ–¹å¼ã€‚ä½ è¿™å¯ä»¥åœ¨<a href="https://gist.github.com/kfarst/9f8a1eb59cce2004b15f0b682c92eeed" target="_blank" rel="noopener">è¿™é‡Œ</a>æ‰¾åˆ°playgroudä»£ç åœ¨Github Gistï¼Œç¥æ‚¨iOSå¼€å‘é¡ºåˆ©ï¼</p><hr><blockquote><p>è¡¥å……è¯´æ˜ï¼šä¸‹é¢é“¾æ¥åˆ°çš„æ˜¯æˆ‘åœ¨ç»ƒä¹ çš„æ—¶å€™å†™çš„ä»£ç ï¼Œä¾›å‚è€ƒï¼</p></blockquote><p><a href="https://github.com/xujiaji/Learn-iOS/blob/master/TabSegmentedControl.playground/Contents.swift" target="_blank" rel="noopener">https://github.com/xujiaji/Learn-iOS/blob/master/TabSegmentedControl.playground/Contents.swift</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;åŸæ–‡ï¼šã€Š&lt;a href=&quot;https://www.codementor.io/kevinfarst/designing-a-button-bar-style-uisegmentedcontrol-in-swift-cg6cf0dok&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Designing a Button Bar-Style UISegmentedControl in Swift&lt;/a&gt;ã€‹&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="iOS" scheme="https://blog.xujiaji.com/categories/iOS/"/>
    
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
      <category term="iOS" scheme="https://blog.xujiaji.com/tags/iOS/"/>
    
      <category term="UI" scheme="https://blog.xujiaji.com/tags/UI/"/>
    
      <category term="Swift" scheme="https://blog.xujiaji.com/tags/Swift/"/>
    
  </entry>
  
</feed>
