<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å¾ä½³å‰çš„åšå®¢</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.xujiaji.com/"/>
  <updated>2019-10-16T00:47:28.966Z</updated>
  <id>https://blog.xujiaji.com/</id>
  
  <author>
    <name>XuJiaji</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å¥½ç”¨çš„iOSè°ƒè¯•å·¥å…·PonyDebugger</title>
    <link href="https://blog.xujiaji.com/post/ios-ponydebuger/index.html"/>
    <id>https://blog.xujiaji.com/post/ios-ponydebuger/index.html</id>
    <published>2019-10-15T15:38:02.000Z</published>
    <updated>2019-10-16T00:47:28.966Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¥½ç”¨çš„iOSè°ƒè¯•å·¥å…·PonyDebugger">å¥½ç”¨çš„iOSè°ƒè¯•å·¥å…·PonyDebugger<a href="post/ios-ponydebuger#å¥½ç”¨çš„iOSè°ƒè¯•å·¥å…·PonyDebugger"></a></h1><p>PonyDebuggerï¼š<a href="https://github.com/square/PonyDebugger/" target="_blank" rel="noopener">https://github.com/square/PonyDebugger/</a></p><h2 id="è§†é¢‘æ¼”ç¤º">è§†é¢‘æ¼”ç¤º<a href="post/ios-ponydebuger#è§†é¢‘æ¼”ç¤º"></a></h2><iframe src="//player.bilibili.com/player.html?aid=71370834&cid=123663162&page=1" width="100%" height="480" frameborder="0" allowfullscreen></iframe><h2 id="åˆ›å»ºä¸€ä¸ªç›®å½•ponydï¼Œå¹¶è¿›å»è¯¥ç›®å½•">åˆ›å»ºä¸€ä¸ªç›®å½•<code>ponyd</code>ï¼Œå¹¶è¿›å»è¯¥ç›®å½•<a href="post/ios-ponydebuger#åˆ›å»ºä¸€ä¸ªç›®å½•ponydï¼Œå¹¶è¿›å»è¯¥ç›®å½•"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir ponyd</span><br><span class="line">cd ponyd</span><br></pre></td></tr></table></div></figure><h2 id="å°†å¿…è¦çš„ä¾èµ–ä¸‹è½½è¿™ä¸ªç›®å½•ä¸­ponyd">å°†å¿…è¦çš„ä¾èµ–ä¸‹è½½è¿™ä¸ªç›®å½•ä¸­<code>ponyd</code><a href="post/ios-ponydebuger#å°†å¿…è¦çš„ä¾èµ–ä¸‹è½½è¿™ä¸ªç›®å½•ä¸­ponyd"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl -O -L https://pypi.python.org/packages/11/b6/abcb525026a4be042b486df43905d6893fb04f05aac21c32c638e939e447/pip-9.0.1.tar.gz</span><br><span class="line"></span><br><span class="line">curl -O -L https://pypi.python.org/packages/25/5d/cc55d39ac39383dd6e04ae80501b9af3cc455be64740ad68a4e12ec81b00/setuptools-0.6c11-py2.7.egg</span><br><span class="line"></span><br><span class="line">curl -O -L https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/pybonjour/pybonjour-1.1.1.tar.gz</span><br><span class="line"></span><br><span class="line">tar xvf pybonjour-1.1.1.tar.gz</span><br><span class="line">mv pybonjour-1.1.1 pybonjour</span><br></pre></td></tr></table></div></figure><h2 id="ä¸‹è½½bootstrap-ponyd-py">ä¸‹è½½<code>bootstrap-ponyd.py</code><a href="post/ios-ponydebuger#ä¸‹è½½bootstrap-ponyd-py"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -O -L https://github.com/downloads/square/PonyDebugger/bootstrap-ponyd.py</span><br></pre></td></tr></table></div></figure><h2 id="åœ¨bootstrap-ponyd-pyæ·»åŠ å®‰è£…pybonjourçš„å‘½ä»¤">åœ¨<code>bootstrap-ponyd.py</code>æ·»åŠ å®‰è£…<code>pybonjour</code>çš„å‘½ä»¤<a href="post/ios-ponydebuger#åœ¨bootstrap-ponyd-pyæ·»åŠ å®‰è£…pybonjourçš„å‘½ä»¤"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subprocess.check_call([join(home_dir, 'bin', 'python'),  join('pybonjour', 'setup.py'), 'install'])</span><br></pre></td></tr></table></div></figure><blockquote><p>æ·»åŠ åœ¨å¦‚ä¸‹çš„ä½ç½®ä¸Š</p></blockquote><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def after_install(options, home_dir):</span><br><span class="line">    subprocess.check_call([join(home_dir, 'bin', 'python'),  join('pybonjour', 'setup.py'), 'install'])</span><br><span class="line"></span><br><span class="line">    subprocess.check_call([join(home_dir, 'bin', 'pip'),</span><br><span class="line">                     'install', '-U', '-e', 'git+https://github.com/square/PonyDebugger.git#egg=ponydebugger'])</span><br></pre></td></tr></table></div></figure><h2 id="é€šè¿‡è¿è¡Œbootstrapå®‰è£…">é€šè¿‡è¿è¡Œbootstrapå®‰è£…<a href="post/ios-ponydebuger#é€šè¿‡è¿è¡Œbootstrapå®‰è£…"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat ./bootstrap-ponyd.py | python - --never-download --ponyd-symlink=/usr/local/bin/ponyd ~/Library/PonyDebugger</span><br></pre></td></tr></table></div></figure><h2 id="ä¸Šé¢çš„å®‰è£…ä¼šå‡ºé”™ï¼Œå› ä¸ºä¸€äº›åŒ…æ— æ³•æ‰¾åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å»ä¿®å¤">ä¸Šé¢çš„å®‰è£…ä¼šå‡ºé”™ï¼Œå› ä¸ºä¸€äº›åŒ…æ— æ³•æ‰¾åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å»ä¿®å¤<a href="post/ios-ponydebuger#ä¸Šé¢çš„å®‰è£…ä¼šå‡ºé”™ï¼Œå› ä¸ºä¸€äº›åŒ…æ— æ³•æ‰¾åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å»ä¿®å¤"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">~/Library/PonyDebugger/bin/easy_install --find-links https://pypi.python.org/simple/singledispatch/ -U singledispatch</span><br><span class="line">~/Library/PonyDebugger/bin/easy_install --find-links https://pypi.python.org/simple/backports-abc/ -U backports_abc</span><br><span class="line">~/Library/PonyDebugger/bin/easy_install --find-links https://pypi.python.org/simple/certifi -U certifi</span><br><span class="line">~/Library/PonyDebugger/bin/easy_install --find-links https://pypi.python.org/simple/six/ -U six</span><br><span class="line">~/Library/PonyDebugger/bin/easy_install --find-links https://pypi.python.org/simple/futures -U futures</span><br><span class="line">sudo ~/Library/PonyDebugger/bin/easy_install -U pybonjour</span><br></pre></td></tr></table></div></figure><h2 id="å®‰è£…devtools">å®‰è£…devtools<a href="post/ios-ponydebuger#å®‰è£…devtools"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ponyd update-devtools</span><br></pre></td></tr></table></div></figure><h2 id="è¿è¡Œ">è¿è¡Œ<a href="post/ios-ponydebuger#è¿è¡Œ"></a></h2><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ponyd serve --listen-interface=127.0.0.1</span><br></pre></td></tr></table></div></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å¥½ç”¨çš„iOSè°ƒè¯•å·¥å…·PonyDebugger&quot;&gt;å¥½ç”¨çš„iOSè°ƒè¯•å·¥å…·PonyDebugger&lt;a href=&quot;post/ios-ponydebuger#å¥½ç”¨çš„iOSè°ƒè¯•å·¥å…·PonyDebugger&quot;&gt;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;PonyDebuggerï¼š&lt;a href
      
    
    </summary>
    
      <category term="iOS" scheme="https://blog.xujiaji.com/categories/iOS/"/>
    
    
      <category term="Debug" scheme="https://blog.xujiaji.com/tags/Debug/"/>
    
  </entry>
  
  <entry>
    <title>å®‰è£…Gitlabå°è®°</title>
    <link href="https://blog.xujiaji.com/post/linux-gitlab/index.html"/>
    <id>https://blog.xujiaji.com/post/linux-gitlab/index.html</id>
    <published>2019-09-24T12:49:42.000Z</published>
    <updated>2019-09-24T16:44:06.107Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å®‰è£…Gitlabå°è®°">å®‰è£…Gitlabå°è®°<a href="post/linux-gitlab#å®‰è£…Gitlabå°è®°"></a></h1><blockquote><p>ç¯å¢ƒï¼šCentOS7.6ã€å¤–éƒ¨Nginx</p></blockquote><h2 id="åšäº†äº›ä»€ä¹ˆï¼Ÿ">åšäº†äº›ä»€ä¹ˆï¼Ÿ<a href="post/linux-gitlab#åšäº†äº›ä»€ä¹ˆï¼Ÿ"></a></h2><ol><li>å®‰è£…gitlab</li><li>é…ç½®å‘é€é‚®ç®±ï¼ˆç”¨æ¥éªŒè¯è´¦å·ä¿®æ”¹å¯†ç ï¼‰</li><li>å¤–ç½®nginxé…ç½®ï¼ˆhttpsï¼‰</li><li>æ±‰åŒ–</li><li>CI Pipelineså®‰è£…</li></ol><h2 id="å®‰è£…Gitlab">å®‰è£…Gitlab<a href="post/linux-gitlab#å®‰è£…Gitlab"></a></h2><p>å®‰è£…é…åˆä¾èµ–ï¼ˆå…¶å®è¿™é‡Œéƒ½æ˜¯å®˜ç½‘çš„å®‰è£…è¯´æ–‡æ¡£ï¼Œæˆ‘å°±ç›´æ¥æ¬è¿è¿‡æ¥äº†ï¼‰</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y curl policycoreutils-python openssh-server</span><br><span class="line">sudo systemctl enable sshd</span><br><span class="line">sudo systemctl start sshd</span><br><span class="line"></span><br><span class="line">sudo firewall-cmd --permanent --add-service=http</span><br><span class="line">sudo firewall-cmd --permanent --add-service=https</span><br><span class="line">sudo systemctl reload firewalld</span><br></pre></td></tr></table></div></figure><p>æ·»åŠ Gitlabä»“åº“</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.rpm.sh | sudo bash</span><br></pre></td></tr></table></div></figure><p>å®‰è£…Gitlabï¼Œè¿™é‡Œçš„<code>EXTERNAL_URL</code>æ¢æˆè‡ªå·±çš„åŸŸå</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo EXTERNAL_URL="https://gitlab.example.com" yum install -y gitlab-ee</span><br></pre></td></tr></table></div></figure><h2 id="é…ç½®é‚®ç®±ï¼ˆä¸é…ç½®å¯ä»¥è·³è¿‡è¿™ä¸ªæ­¥éª¤ï¼‰">é…ç½®é‚®ç®±ï¼ˆä¸é…ç½®å¯ä»¥è·³è¿‡è¿™ä¸ªæ­¥éª¤ï¼‰<a href="post/linux-gitlab#é…ç½®é‚®ç®±ï¼ˆä¸é…ç½®å¯ä»¥è·³è¿‡è¿™ä¸ªæ­¥éª¤ï¼‰"></a></h2><p>æ‰“å¼€é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ é‚®ç®±é…ç½®ã€‚</p><p>è¿™é‡Œä»¥qqé‚®ç®±æ¥ä¸¾æ —å­ï¼ˆå› ä¸ºæˆ‘é…ç½®çš„qqé‚®ç®±ğŸ˜†ï¼‰ï¼Œå…¶ä»–éƒ½å·®ä¸å¤šç±»ä¼¼ã€‚</p><p>æ³¨æ„éœ€è¦åœ¨é‚®ç®±è®¾ç½®ä¸­å¼€å¯smtpæœåŠ¡</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/gitlab/gitlab.rb</span><br></pre></td></tr></table></div></figure><blockquote><p>ç›´æ¥åœ¨æ–‡ä»¶ä¸­æ·»åŠ ä¸‹æ–¹é…ç½®</p></blockquote><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">gitlab_rails['smtp_enable'] = true</span><br><span class="line">gitlab_rails['smtp_address'] = "smtp.qq.com"</span><br><span class="line">gitlab_rails['smtp_port'] = 465</span><br><span class="line">gitlab_rails['smtp_user_name'] = "é‚®ç®±å@qq.com"</span><br><span class="line">gitlab_rails['smtp_password'] = "dtjhinszpsasdhi"</span><br><span class="line">gitlab_rails['smtp_domain'] = "smtp.qq.com"</span><br><span class="line">gitlab_rails['smtp_authentication'] = "login"</span><br><span class="line">gitlab_rails['smtp_enable_starttls_auto'] = true</span><br><span class="line">gitlab_rails['smtp_tls'] = true</span><br></pre></td></tr></table></div></figure><div class="article-bounded"><div class="article-table"><table><thead><tr><th>å­—æ®µ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>smtp_enable</code></td><td>å¯ç”¨smtp</td></tr><tr><td><code>smtp_address</code></td><td>smtp.qq.comæ˜¯qqçš„smtpæœåŠ¡å™¨ï¼Œæ ¹æ®è‡ªå·±çš„æƒ…å†µæ›´æ¢</td></tr><tr><td><code>smtp_user_name</code></td><td>æ˜¯ä½ è¦ç”¨æ¥è®©gitlabå‘é€çš„é‚®ç®±</td></tr><tr><td><code>smtp_password</code></td><td>æ˜¯é‚®ç®±çš„ç™»å½•å¯†ç ï¼ˆQQçš„æ˜¯åœ¨è®¾ç½®ä¸­ç”Ÿæˆçš„ç¬¬ä¸‰æ–¹ç™»å½•å¯†ç ï¼‰</td></tr><tr><td><code>smtp_tls</code></td><td>å¼€å¯tlsåŠ å¯†</td></tr></tbody></table></div></div><p>é…ç½®é‚®ç®±æ¥æºï¼Œä¸å±•ç¤ºçš„åç§°</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gitlab_rails['gitlab_email_enabled'] = true</span><br><span class="line">gitlab_rails['gitlab_email_from'] = 'é‚®ç®±å@qq.com'</span><br><span class="line">gitlab_rails['gitlab_email_display_name'] = 'å‘é€é‚®ä»¶çš„é»˜è®¤æ ‡é¢˜'</span><br></pre></td></tr></table></div></figure><h2 id="å¤–ç½®nginxé…ç½®">å¤–ç½®nginxé…ç½®<a href="post/linux-gitlab#å¤–ç½®nginxé…ç½®"></a></h2><h3 id="å…³é—­Gilabå†…éƒ¨nginxå’Œä¸€äº›å…¶ä»–é…ç½®">å…³é—­Gilabå†…éƒ¨nginxå’Œä¸€äº›å…¶ä»–é…ç½®<a href="post/linux-gitlab#å…³é—­Gilabå†…éƒ¨nginxå’Œä¸€äº›å…¶ä»–é…ç½®"></a></h3><p>æ‰“å¼€é…ç½®æ–‡ä»¶</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/gitlab/gitlab.rb</span><br></pre></td></tr></table></div></figure><p>æ·»åŠ å¦‚ä¸‹é…ç½®</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">external_url 'https://git.longpuji.com'</span><br><span class="line"></span><br><span class="line">gitlab_workhorse['enable'] = true</span><br><span class="line">gitlab_workhorse['listen_network'] = "tcp"</span><br><span class="line">gitlab_workhorse['listen_addr'] = "127.0.0.1:8181"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> This example renews every 7th day at 12:30</span></span><br><span class="line">letsencrypt['auto_renew_hour'] = "12"</span><br><span class="line">letsencrypt['auto_renew_minute'] = "30"</span><br><span class="line">letsencrypt['auto_renew_day_of_month'] = "*/7"</span><br><span class="line"></span><br><span class="line">nginx['enable'] = false</span><br></pre></td></tr></table></div></figure><div class="article-bounded"><div class="article-table"><table><thead><tr><th>å­—æ®µ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>external_url</code></td><td>å¤–éƒ¨çš„urlä½¿ç”¨çš„urlï¼Œå¦‚æœä¸é…ç½®ä¼šå¯¼è‡´æœ‰äº›é“¾æ¥ä¸æ­£å¸¸</td></tr><tr><td><code>gitlab_workhorse[&#39;enable&#39;]</code></td><td>å¼€å¯gitlabå·¥ä½œç©ºé—´é…ç½®</td></tr><tr><td><code>gitlab_workhorse[&#39;listen_network&#39;]</code></td><td>tcpç½‘ç»œåè®®</td></tr><tr><td><code>gitlab_workhorse[&#39;listen_addr&#39;]</code></td><td><code>127.0.0.1:8181</code>ï¼ˆä¸€ä¼šå„¿nginxåå‘ä»£ç†çš„æ—¶å€™å°±ç”¨è¿™ä¸ªç«¯å£å·ï¼‰</td></tr><tr><td><code>nginx[&#39;enable&#39;]</code></td><td>å…³é—­Gitlabå†…éƒ¨nginx</td></tr></tbody></table></div></div><h3 id="ä¸ºå¤–éƒ¨nginxåå‘ä»£ç†é…ç½®">ä¸ºå¤–éƒ¨nginxåå‘ä»£ç†é…ç½®<a href="post/linux-gitlab#ä¸ºå¤–éƒ¨nginxåå‘ä»£ç†é…ç½®"></a></h3><p>é…ç½®å¦‚ä¸‹</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">location /</span><br><span class="line">&#123;</span><br><span class="line">    expires 12h;</span><br><span class="line">    if ($request_uri ~* "(php|jsp|cgi|asp|aspx)")</span><br><span class="line">    &#123;</span><br><span class="line">         expires 0;</span><br><span class="line">    &#125;</span><br><span class="line">    # è¿™ä¸ªå°±æ˜¯ä¸Šé¢è®¾ç½®çš„gitlab_workhorse['listen_addr']</span><br><span class="line">    proxy_pass http://127.0.0.1:8181;</span><br><span class="line">    proxy_set_header Host $host;</span><br><span class="line">    proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">    proxy_set_header REMOTE-HOST $remote_addr;</span><br><span class="line">    # æ³¨æ„å¦‚æœæ˜¯åŸŸåé…ç½®äº†sslï¼Œé‚£ä¹ˆåˆ™å¿…é¡»åŠ ä¸Šè¿™ä¸ªé…ç½®ï¼Œä¸ç„¶gitlabä¼šåœ¨é‡ç½®å¯†ç çš„æ—¶å€™æŠ¥é”™422</span><br><span class="line">    proxy_set_header X-Forwarded-Proto https;</span><br><span class="line">    proxy_set_header X-Forwarded-Ssl on;</span><br><span class="line"></span><br><span class="line">    proxy_read_timeout                  900;</span><br><span class="line">    proxy_cache off;</span><br><span class="line">    proxy_buffering off;</span><br><span class="line">    proxy_request_buffering off;</span><br><span class="line">    proxy_http_version 1.1;</span><br><span class="line"></span><br><span class="line">    add_header X-Cache $upstream_cache_status;</span><br><span class="line">    add_header Cache-Control no-cache;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="å¯åŠ¨">å¯åŠ¨<a href="post/linux-gitlab#å¯åŠ¨"></a></h2><blockquote><p>ä¸Šé¢çš„é‚£äº›åŸºæœ¬ä¸ŠGitlabå°±å·²ç»é…ç½®å¥½å•¦ï¼Œç°åœ¨éœ€è¦å¯¹Gitlabé‡æ–°åŠ è½½é…ç½®å’Œé‡å¯</p></blockquote><p>é‡è½½é…ç½®</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl reconfigure</span><br></pre></td></tr></table></div></figure><p>é‡å¯æœåŠ¡</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl start</span><br></pre></td></tr></table></div></figure><p>åˆ°è¿™é‡Œå¯ä»¥æ‰“å¼€åŸŸåé“¾æ¥å»çœ‹çœ‹ï¼Œæ²¡æœ‰å•¥é—®é¢˜å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œç¬¬ä¸€æ¬¡è¿›å…¥çš„æ—¶å€™éœ€è¦è®¾ç½®åˆå§‹å¯†ç ã€‚<br>åˆå§‹çš„è´¦å·æ˜¯<code>root</code><br>å»ç™»é™†è¯•è¯•å§</p><h2 id="æ±‰åŒ–">æ±‰åŒ–<a href="post/linux-gitlab#æ±‰åŒ–"></a></h2><p>æŸ¥çœ‹å½“å‰ç‰ˆæœ¬</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /opt/gitlab/embedded/service/gitlab-rails/VERSION</span><br></pre></td></tr></table></div></figure><p>è¾“å‡º</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">12.3.0-ee</span><br></pre></td></tr></table></div></figure><blockquote><p>ç”±äºæ±‰åŒ–ç°åœ¨è¿˜æ²¡æœ‰æ”¯æŒåˆ°è¿™ä¹ˆé«˜çš„ç‰ˆæœ¬ï¼Œäºæ˜¯è¿™é‡Œä»¥v12.2.4çš„ç‰ˆæœ¬æ±‰åŒ–çš„ã€‚ï¼ˆå¤§éƒ¨åˆ†éƒ½æ²¡æœ‰è¢«æ±‰åŒ–ğŸ˜…ï¼Œä¹‹åå¦‚æœè¯¥ä»“åº“æ›´æ–°çš„å¯¹åº”ç‰ˆæœ¬å¯ä»¥å†æ¬¡å°è¯•ï¼‰</p></blockquote><p>cloneæ±‰åŒ–é¡¹ç›®</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://gitlab.com/xhang/gitlab.git</span><br></pre></td></tr></table></div></figure><p>è¿›å…¥ä»“åº“</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd gitlab</span><br></pre></td></tr></table></div></figure><p>å¤‡ä»½<code>gitlab-rails</code>åˆ°å½“å‰ç›®å½•ï¼ˆå¦‚æœä¹‹åå‡ºç°é—®é¢˜ï¼Œæ–¹ä¾¿æ¢å¤ï¼‰</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -rf /opt/gitlab/embedded/service/gitlab-rails/ .</span><br></pre></td></tr></table></div></figure><p>ç”Ÿæˆ12.2.4ç‰ˆæœ¬çš„æ±‰åŒ–è¡¥ä¸</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff v12.2.4 v12.2.4-zh &gt; ./12.2.4-zh.diff</span><br></pre></td></tr></table></div></figure><p>å…³é—­gitlabæœåŠ¡</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl stop</span><br></pre></td></tr></table></div></figure><p>æ‰“æ±‰åŒ–è¡¥ä¸</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">patch -d /opt/gitlab/embedded/service/gitlab-rails/ -p1 &lt; ./12.2.4-zh.diff</span><br></pre></td></tr></table></div></figure><blockquote><p>è¿™é‡Œæœ‰äº›æ±‰åŒ–æ–‡ä»¶æ²¡æœ‰å¯¹åº”åˆ°çš„æ–‡ä»¶ï¼Œç›´æ¥å›è½¦ï¼Œyesè·³è¿‡å°±å¯ä»¥äº†</p></blockquote><p>å¯åŠ¨æœåŠ¡</p><figure class="highlight shell"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl start</span><br></pre></td></tr></table></div></figure><h2 id="CI-Pipelineså®‰è£…">CI Pipelineså®‰è£…<a href="post/linux-gitlab#CI-Pipelineså®‰è£…"></a></h2><p>è¿™ç¯‡æ–‡ä»¶ä¸é”™ï¼Œæˆ‘å°±ä¸å•°å—¦äº†å“ˆå“ˆ</p><p><a href="https://scarletsky.github.io/2016/07/29/use-gitlab-ci-for-continuous-integration/" target="_blank" rel="noopener">https://scarletsky.github.io/2016/07/29/use-gitlab-ci-for-continuous-integration/</a></p><h2 id="å‘½ä»¤æ–‡ä»¶æ•´ç†">å‘½ä»¤æ–‡ä»¶æ•´ç†<a href="post/linux-gitlab#å‘½ä»¤æ–‡ä»¶æ•´ç†"></a></h2><blockquote><p>å‘½ä»¤æ•´ç†</p></blockquote><div class="article-bounded"><div class="article-table"><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>gitlab-ctl reconfigure</code></td><td>é‡è½½gitlabé…ç½®</td></tr><tr><td><code>gitlab-ctl restart</code></td><td>é‡å¯gitlab</td></tr><tr><td><code>gitlab-ctl stop</code></td><td>åœæ­¢gitlabæœåŠ¡</td></tr><tr><td><code>gitlab-ctl start</code></td><td>å¯åŠ¨gitlabæœåŠ¡</td></tr></tbody></table></div></div><blockquote><p>æ–‡ä»¶è¯´æ˜</p></blockquote><div class="article-bounded"><div class="article-table"><table><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>/etc/gitlab/gitlab.rb</code></td><td>gitlabé…ç½®æ–‡ä»¶</td></tr><tr><td><code>/var/log/gitlab/gitlab-rails/production.log</code></td><td>gitlab-railsæ—¥å¿—æ–‡ä»¶</td></tr></tbody></table></div></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å®‰è£…Gitlabå°è®°&quot;&gt;å®‰è£…Gitlabå°è®°&lt;a href=&quot;post/linux-gitlab#å®‰è£…Gitlabå°è®°&quot;&gt;&lt;/a&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;ç¯å¢ƒï¼šCentOS7.6ã€å¤–éƒ¨Nginx&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=
      
    
    </summary>
    
    
      <category term="Git" scheme="https://blog.xujiaji.com/tags/Git/"/>
    
      <category term="Linux" scheme="https://blog.xujiaji.com/tags/Linux/"/>
    
      <category term="CentOS" scheme="https://blog.xujiaji.com/tags/CentOS/"/>
    
  </entry>
  
  <entry>
    <title>Dartå­¦ä¹ ç¬”è®°</title>
    <link href="https://blog.xujiaji.com/post/Note-Learn-Dart/index.html"/>
    <id>https://blog.xujiaji.com/post/Note-Learn-Dart/index.html</id>
    <published>2019-03-29T08:45:28.000Z</published>
    <updated>2019-10-15T16:41:13.656Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Dartç¬”è®°">Dartç¬”è®°<a href="post/Note-Learn-Dart#Dartç¬”è®°"></a></h1><h2 id="å˜é‡">å˜é‡<a href="post/Note-Learn-Dart#å˜é‡"></a></h2><p>åˆå§‹åŒ–ä¸€ä¸ªå˜é‡</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'Bob'</span>;</span><br></pre></td></tr></table></div></figure><p><code>name</code>å°†è‡ªåŠ¨åˆ¤æ–­ä¸º<code>String</code>ç±»å‹ï¼Œå¦‚æœä¸æƒ³è®©å…¶é™åˆ¶ä¸ºäº†ä¸€ä¸ªç±»å‹å¯ä»¥ä½¿ç”¨<code>Object</code>æˆ–<code>dynamic</code>ç±»å‹ã€‚<code>Object</code>ç±»å‹å’Œjavaä¸­å·®ä¸å¤šæ˜¯ä¸€ä¸ªé“ç†ã€‚</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dynamic</span> name = <span class="string">'Bob'</span>;</span><br></pre></td></tr></table></div></figure><p>å¦‚æœæƒ³æ˜ç¡®æ˜¾ç¤ºå£°æ˜ç±»å‹ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> name = <span class="string">'Bob'</span>;</span><br></pre></td></tr></table></div></figure><h2 id="é»˜è®¤å€¼">é»˜è®¤å€¼<a href="post/Note-Learn-Dart#é»˜è®¤å€¼"></a></h2><p>dartä¸­æœªåˆå§‹åŒ–çš„å€¼éƒ½æ˜¯nullï¼Œå³ä½¿æ˜¯æ•°å­—ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> lineCount;</span><br><span class="line"><span class="built_in">print</span>(lineCount);</span><br><span class="line"></span><br><span class="line"><span class="comment">//: null</span></span><br></pre></td></tr></table></div></figure><h2 id="fianl-å’Œ-const">fianl å’Œ const<a href="post/Note-Learn-Dart#fianl-å’Œ-const"></a></h2><p>å½“ä½ ä¸æƒ³è®©å˜é‡å¯ä»¥å†æ¬¡æ”¹å˜çš„æ—¶å€™ç”¨<code>final</code>æˆ–<code>const</code>ä¿®é¥°ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> name = <span class="string">'Bob'</span>; <span class="comment">// æˆ–è€…ï¼š final String name = 'Bob'; const name = 'Bob';</span></span><br></pre></td></tr></table></div></figure><p>æ­¤æ—¶nameçš„å€¼ä¸å¯ä»¥åœ¨ä¿®æ”¹ï¼</p><p>äºŒè€…çš„åŒºåˆ«æ˜¯ï¼Œ<code>const</code>æ˜¯ç¼–è¯‘æ—¶æœŸå¸¸é‡ï¼Œæ„æ€æ˜¯è¯´åœ¨ç¼–è¯‘åå°±æœ‰ç¡®åˆ‡çš„å€¼ã€‚</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚ä¸‹è¡¨è¾¾å¼å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯å°†barå˜é‡å‰é¢çš„ä¿®é¥°è¯constæ¢æ‰ï¼Œé‚£ä¹ˆå°±ä¼šæŠ¥é”™ã€‚å»æ‰å°±ä»£è¡¨äº†barçš„å€¼åœ¨ç¼–è¯‘æ—¶çš„ä¸ç¡®å®šæ€§ã€‚</span></span><br><span class="line"><span class="keyword">const</span> bar = <span class="number">1000000</span>;</span><br><span class="line"><span class="comment">// å¦‚æœatmå‰é¢çš„ä¿®é¥°constæ¢æˆfinalåï¼Œå³ä½¿baræ˜¯å˜é‡ä¹Ÿæ˜¯æ— æ‰€è°“äº†</span></span><br><span class="line"><span class="keyword">const</span> <span class="built_in">double</span> atm = <span class="number">1.01325</span> * bar;</span><br></pre></td></tr></table></div></figure><p><code>const</code>å…³é”®å­—è¿˜å¯ä»¥ç”¨æ¥ä¿®é¥°å€¼</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="keyword">const</span> [];</span><br><span class="line"><span class="keyword">final</span> bar = [];</span><br><span class="line"><span class="keyword">const</span> baz = [];</span><br></pre></td></tr></table></div></figure><p>æ­¤æ—¶<code>foo</code>æ˜¯å˜é‡ï¼Œå€¼æ˜¯å¸¸é‡ã€‚æ„æ€æ˜¯<code>foo</code>è¿˜å¯ä»¥å¼•ç”¨å…¶ä»–åŒç±»å‹çš„å€¼ï¼Œ<code>foo = [1, 2, 3];</code>æ˜¯è«å¾—é—®é¢˜çš„ã€‚ä½†æ˜¯å¦‚æœè®©å€¼<code>const []</code>æ”¹å˜å°±ä¸è¡Œäº†<del><code>foo.add(1);</code></del></p><p><code>bar</code>å˜é‡è™½ç„¶æ— æ³•æ”¹å˜å¼•ç”¨ï¼Œä½†æ˜¯å€¼æ˜¯å¯ä»¥æ”¹å˜çš„ã€‚<code>bar.add(1);</code>æ˜¯OKçš„ï¼Œä½†æ˜¯ <del><code>bar = [1];</code></del> æ˜¯NOã€‚</p><p><code>baz</code>ï¼Œä¸Šé¢ä¸¤æ ·éƒ½æ²¡å¾—ç©ï¼</p><p>å¦‚æœ<code>const</code>çš„å˜é‡æ˜¯ç±»ä¸€ä¸ªçº§åˆ«çš„ï¼Œè¿™æ ·å£°æ˜ï¼š<code>static const</code></p><h2 id="å†…ç½®ç±»å‹">å†…ç½®ç±»å‹<a href="post/Note-Learn-Dart#å†…ç½®ç±»å‹"></a></h2><p>ä»¥ä¸‹ç±»å‹æ˜¯<code>Dart</code>ä¸­ç‰¹æ®Šæ”¯æŒçš„ç±»å‹</p><ul><li><code>æ•°å­— numbers</code></li><li><code>å­—ç¬¦ä¸² strings</code></li><li><code>å¸ƒå°” booleans</code></li><li><code>åˆ—è¡¨ lists</code>(ä¹Ÿç§°ä¸ºæ•°ç»„)</li><li><code>é›†åˆ sets</code></li><li><code>æ˜ å°„ maps</code></li><li><code>ç¬¦æ–‡ runes</code>(ç”¨äºåœ¨å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºUnicodeå­—ç¬¦)</li><li><code>ç¬¦å· symbols</code></li></ul><p>æ‚¨å¯ä»¥ä½¿ç”¨å­—é¢æ–‡å­—åˆå§‹åŒ–ä¸€äº›ç‰¹åˆ«çš„ç±»å‹å¯¹è±¡ï¼Œä¾‹å¦‚<code>&#39;this is a string&#39;</code>æ˜¯ä¸€ä¸ªstringå¯¹è±¡ï¼Œ<code>true</code>æ˜¯ä¸€ä¸ªbooleanå¯¹è±¡ã€‚</p><p>å› ä¸ºåœ¨Dartä¸­æ¯ä¸ªå˜é‡éƒ½å¼•ç”¨äº†ä¸€ä¸ªå¯¹è±¡ï¼ˆä¸€ä¸ªç±»çš„å®ä¾‹ï¼‰ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ„é€ æ–¹æ³•åˆå§‹åŒ–å˜é‡ï¼Œæœ‰äº›å†…ç½®ç±»å‹æœ‰å®ƒä»¬è‡ªå·±çš„æ„é€ å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<code>Map()</code>æ„é€ æ¥åˆ›å»ºä¸€ä¸ªmapå®ä¾‹ã€‚</p><h3 id="æ•°å­—-Numbers">æ•°å­— Numbers<a href="post/Note-Learn-Dart#æ•°å­—-Numbers"></a></h3><p>Dartæœ‰ä¸¤ç§æ–¹å¼è¡¨ç¤ºæ•°å­—</p><p><strong><a href="https://api.dartlang.org/stable/2.2.0/dart-core/int-class.html" target="_blank" rel="noopener">int</a></strong></p><p>æ•´å‹æœ€å¤§ä¸è¶…è¿‡64bitï¼Œå¹¶ä¾èµ–äºå¹³å°ã€‚åœ¨Dartè™šæ‹Ÿæœºä¸Šï¼Œå€¼å–å€¼èŒƒå›´<code>[-2^63,2^63 - 1]</code>ã€‚ç¼–è¯‘ä¸ºJavaScriptæ—¶ä½¿ç”¨<a href="https://stackoverflow.com/questions/2802957/number-of-bits-in-javascript-numbers/2803010#2803010" target="_blank" rel="noopener">JavaScriptæ•°å­—</a>ï¼ŒåŒºé—´èŒƒå›´ä¸º<code>[-2^53,2^53-1]</code>ã€‚</p><p><strong><a href="https://stackoverflow.com/questions/2802957/number-of-bits-in-javascript-numbers/2803010#2803010" target="_blank" rel="noopener">double</a></strong></p><p>64bitï¼ˆåŒç²¾åº¦ï¼‰æµ®ç‚¹æ•°ç”±IEEE 754æ ‡å‡†è§„å®š</p><p><code>int</code>å’Œ<code>double</code>éƒ½æ˜¯<a href="https://api.dartlang.org/stable/dart-core/num-class.html" target="_blank" rel="noopener">num</a>çš„å­ç±»å‹ï¼Œåœ¨<code>num</code>ç±»å‹ä¸­åŒ…å«äº†<code>+</code>ã€<code>-</code>ã€<code>*</code>ã€<code>/</code>åŸºæœ¬è¿ç®—ç¬¦ï¼Œåœ¨å…¶ä»–æ–¹æ³•ä¸­æ‚¨ä¹Ÿå¯ä»¥æ‰¾åˆ°<code>abs()</code>,<code>ceil()</code>,<code>floor()</code>ã€‚ï¼ˆä½è¿ç®—ç¬¦ï¼Œå¦‚<code>&gt;&gt;</code>ï¼Œå®šä¹‰åœ¨<code>int</code>ç±»ï¼‰å¦‚æœ<code>num</code>å’Œå…¶å­ç±»æ²¡æœ‰æ‚¨æƒ³è¦çš„ï¼Œ<a href="https://api.dartlang.org/stable/dart-math" target="_blank" rel="noopener">dart:math</a>ç±»åº“ä¸­å¯èƒ½æœ‰ã€‚</p><p>å­—ç¬¦ä¸²å’Œæ•°å­—äº’è½¬</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// String -&gt; int</span></span><br><span class="line"><span class="built_in">int</span>.parse(<span class="string">'1'</span>); <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// String -&gt; double</span></span><br><span class="line"><span class="built_in">double</span>.parse(<span class="string">'1.1'</span>); <span class="comment">// 1.1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// int -&gt; String</span></span><br><span class="line"><span class="number">1.</span>toString(); <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// double -&gt; String ä¿ç•™ä¸¤ä½å°æ•°ï¼Œå››èˆäº”å…¥</span></span><br><span class="line"><span class="number">3.14159</span>.toStringAsFixed(<span class="number">2</span>); <span class="comment">// 1.14</span></span><br></pre></td></tr></table></div></figure><h3 id="å­—ç¬¦ä¸²-Strings">å­—ç¬¦ä¸² Strings<a href="post/Note-Learn-Dart#å­—ç¬¦ä¸²-Strings"></a></h3><p>Dartå­—ç¬¦ä¸²æ˜¯ä¸€ç³»åˆ—UTF-16ä»£ç å•å…ƒï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å•å¼•å·æˆ–åŒå¼•å·åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å•å¼•å·å¯ä»¥è¡¨ç¤º</span></span><br><span class="line"><span class="keyword">var</span> s1 = <span class="string">'single quotes string'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒå¼•å·ä¹Ÿå¯ä»¥è¡¨ç¤º</span></span><br><span class="line"><span class="keyword">var</span> s2 = <span class="string">"double quotes strings"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å•å¼•å·è¡¨ç¤ºæ—¶ï¼Œé‡Œé¢æœ‰å•å¼•å·éœ€è¦è½¬ä¹‰</span></span><br><span class="line"><span class="keyword">var</span> s3 = <span class="string">'i\'m a cool boy'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒå¼•å·è¡¨ç¤ºæ—¶ï¼Œé‡Œé¢æœ‰å•å¼•å·ä¸éœ€è¦è½¬ä¹‰</span></span><br><span class="line"><span class="keyword">var</span> s4 = <span class="string">"i'm a cool boy"</span>;</span><br></pre></td></tr></table></div></figure><p>å¯ä»¥å°†è¡¨è¾¾å¼æ”¾åœ¨å­—ç¬¦ä¸²é‡Œé¢é€šè¿‡<code>${expression}</code>çš„å½¢å¼ï¼Œè¡¨è¾¾å¼åªæ˜¯å˜é‡æ—¶ï¼Œæ‚¨å¯ä»¥ä¸è¦<code>{}</code>ã€‚å¦‚æœæ˜¯ä¸€ä¸ªå¯¹è±¡æ—¶Dartä¼šé€šè¿‡è°ƒç”¨<code>toString()</code>æ–¹æ³•è·å–è¿™å¯¹è±¡çš„å­—ç¬¦ä¸²ã€‚</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> v = <span class="string">'bc'</span>;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'a<span class="subst">$v<span class="string">'); // abc</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">print('</span></span>A<span class="subst">$&#123;v.toUpperCase()&#125;</span>'</span>); <span class="comment">// ABC</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">'<span class="subst">$Set</span>()'</span>); <span class="comment">// Set&lt;dynamic&gt;()</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">'<span class="subst">$&#123;Set().toString()&#125;</span>'</span>); <span class="comment">// &#123;&#125;</span></span><br></pre></td></tr></table></div></figure><p>ç›¸é‚»çš„å­—ç¬¦ä¸²ä¼šè‡ªå·±æ‹¼æ¥æˆ–é€šè¿‡<code>+</code>å·æ‹¼æ¥</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">'1'</span></span><br><span class="line">  <span class="string">'2'</span></span><br><span class="line">  <span class="string">"3"</span></span><br><span class="line">  <span class="string">'4'</span>;</span><br><span class="line"><span class="built_in">print</span>(a); <span class="comment">// 1234</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = <span class="string">'1'</span> + <span class="string">'2'</span> + <span class="string">"3"</span>;</span><br><span class="line"><span class="built_in">print</span>(b); <span class="comment">// 123</span></span><br></pre></td></tr></table></div></figure><p>å¯ä»¥ä½¿ç”¨ä¸‰å€çš„å•å¼•å·æˆ–åŒå¼•å·åˆ›å»ºå¤šè¡Œå­—ç¬¦ä¸²ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s1 =</span><br><span class="line">  <span class="string">'''</span></span><br><span class="line"><span class="string">  1</span></span><br><span class="line"><span class="string">    2\n3</span></span><br><span class="line"><span class="string">  '''</span>;</span><br><span class="line"><span class="built_in">print</span>(s1);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸‹é¢æ˜¯è¾“å‡ºï¼Œè¯•äº†ä¸‹åŒå¼•å·å•å¼•å·æ•ˆæœä¸€æ ·</span></span><br><span class="line"><span class="comment">//    1</span></span><br><span class="line"><span class="comment">//      2</span></span><br><span class="line"><span class="comment">//3</span></span><br></pre></td></tr></table></div></figure><p>æ‚¨å¯ä»¥åœ¨å¼•å·å‰é¢åŠ <code>r</code>è¡¨ç¤ºå­—ç¬¦ä¸²æ˜¯åŸå§‹(raw)ç±»å‹ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">r'a\nb'</span>); <span class="comment">// a\nb</span></span><br></pre></td></tr></table></div></figure><p>æ˜¯ä»€ä¹ˆå°±è¾“å‡ºä»€ä¹ˆï¼Œä¸éœ€è¦è½¬ä¹‰ï¼Œå•å¼•å·åŒå¼•å·ä¸‰å€å¼•å·éƒ½å¯ä»¥ç”¨ã€‚</p><p>æœ‰å…³å­—ç¬¦ä¸²ä¸­è¡¨è¾¾Unicodeå­—ç¬¦çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://www.dartlang.org/guides/language/language-tour#runes" target="_blank" rel="noopener">å­—ç¬¦ Runes</a></p><p>å­—ç¬¦ä¸²æ–‡å­—æ˜¯ä¸€ä¸ªç¼–è¯‘æœŸå¸¸é‡</p><p>æ›´å¤šå­—ç¬¦ä¸²ä½¿ç”¨ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://www.dartlang.org/guides/libraries/library-tour#strings-and-regular-expressions" target="_blank" rel="noopener">å­—ç¬¦ä¸²å’Œæ­£åˆ™è¡¨è¾¾å¼</a></p><h3 id="å¸ƒå°”-Booleans">å¸ƒå°” Booleans<a href="post/Note-Learn-Dart#å¸ƒå°”-Booleans"></a></h3><p>Dartç”¨ç±»å‹<code>bool</code>è¡¨ç¤ºå¸ƒå°”å€¼ã€‚åªæœ‰ä¸¤ä¸ªå¯¹è±¡è¡¨ç¤º<code>bool</code>ç±»å‹ï¼š<code>true</code>å’Œ<code>false</code>ï¼Œå®ƒä»¬çš„æ–‡å­—è¡¨è¾¾éƒ½æ˜¯ç¼–è¯‘æ—¶æœŸå¸¸é‡ã€‚</p><p>Dartæ˜¯ç±»å‹å®‰å…¨çš„ï¼Œæ„å‘³ç€æ‚¨ä¸èƒ½ä½¿ç”¨åƒ<code>if (éå¸ƒå°”å€¼)</code>æˆ–<code>assert(éå¸ƒå°”å€¼)</code>çš„ä»£ç ã€‚å–è€Œä»£ä¹‹çš„æ˜¯æ˜ç¡®æŒ‡å‡ºå¸ƒå°”å€¼ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ£€æŸ¥ç©ºå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">var</span> fullName = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">assert</span>(fullName.isEmpty);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥0</span></span><br><span class="line"><span class="keyword">var</span> hitPoints = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">assert</span>(hitPoints &lt;= <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥null</span></span><br><span class="line"><span class="keyword">var</span> unicorn;</span><br><span class="line"><span class="keyword">assert</span>(unicorn == <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥ NaN ï¼ˆNot a Number ä¸æ˜¯ä¸€ä¸ªæ•°ï¼‰</span></span><br><span class="line"><span class="keyword">var</span> iMeantToDoThis = <span class="number">0</span> / <span class="number">0</span>;</span><br><span class="line"><span class="keyword">assert</span>(iMeantToDoThis.isNaN);</span><br></pre></td></tr></table></div></figure><h3 id="åˆ—è¡¨-Lists">åˆ—è¡¨ Lists<a href="post/Note-Learn-Dart#åˆ—è¡¨-Lists"></a></h3><p>ä¹Ÿè®¸å‡ ä¹æ‰€æœ‰ç¼–ç¨‹è¯­è¨€ä¸­æœ€å¸¸è§çš„é›†åˆæ˜¯æ•°ç»„ï¼Œæˆ–æœ‰åºçš„å¯¹è±¡ç»„ã€‚åœ¨Dartä¸­æ•°ç»„å°±æ˜¯<a href="https://api.dartlang.org/stable/2.2.0/dart-core/List-class.html" target="_blank" rel="noopener">List</a>å¯¹è±¡ï¼Œå› æ­¤å¤§å¤šæ•°äººå«ä»–ä»¬åˆ—è¡¨ã€‚</p><p>Dartçš„åˆ—è¡¨å†™æ³•çœ‹èµ·æ¥å°±æ˜¯å…¶ä»–è¯­è¨€æ•°ç»„çš„å†™æ³•ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªDartåˆ—è¡¨çš„ç¤ºä¾‹ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br></pre></td></tr></table></div></figure><p>ä¸Šé¢çš„ç±»å‹ä¸º<code>List&lt;int&gt;</code></p><p>æ›´å¤šå…³äºåˆ—è¡¨çš„ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://www.dartlang.org/guides/language/language-tour#generics" target="_blank" rel="noopener">æ³›å‹</a>å’Œ<a href="https://www.dartlang.org/guides/libraries/library-tour#collections" target="_blank" rel="noopener">é›†åˆ</a></p><h3 id="é›†åˆ-Sets">é›†åˆ Sets<a href="post/Note-Learn-Dart#é›†åˆ-Sets"></a></h3><p>set åœ¨Dartä¸­æ˜¯ä¸€ä¸ªæ— åºé›†åˆï¼ŒDartæ”¯æŒé€šè¿‡æ–‡å­—è¡¨è¾¾å’Œ<a href="https://api.dartlang.org/stable/2.2.0/dart-core/Set-class.html" target="_blank" rel="noopener">Set</a>æ¥åˆ›å»ºé›†åˆã€‚</p><p>ç®€å•çš„é€šè¿‡æ–‡å­—è¡¨è¾¾</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> halogens = &#123;<span class="string">'fluorine'</span>, <span class="string">'chlorine'</span>, <span class="string">'bromine'</span>, <span class="string">'iodine'</span>, <span class="string">'astatine'</span>&#125;;</span><br></pre></td></tr></table></div></figure><p>ä¸Šé¢ç±»å‹ä¸ºï¼š<code>Set&lt;String&gt;</code></p><p>åˆ›å»ºä¸€ä¸ªç©ºé›†åˆï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> names1 = &lt;<span class="built_in">String</span>&gt;&#123;&#125;;</span><br><span class="line"><span class="built_in">Set</span>&lt;<span class="built_in">String</span>&gt; names2 = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// var names3 = &#123;&#125;; //æ³¨æ„è¿™æ ·åˆ›å»ºçš„ä¸æ˜¯ä¸€ä¸ªSetï¼Œè€Œæ˜¯ä¸€ä¸ªMapï¼Œå…·ä½“æ¥è¯´æ˜¯ä¸€ä¸ª Map&lt;dynamic, dynamic&gt;</span></span><br></pre></td></tr></table></div></figure><h3 id="æ˜ å°„-Maps">æ˜ å°„ Maps<a href="post/Note-Learn-Dart#æ˜ å°„-Maps"></a></h3><p>é€šå¸¸ï¼Œä¸€ä¸ªmapæœ‰keyå’Œvalueã€‚keyå’Œvalueå¯ä»¥æ˜¯ä»»ä½•å¯¹è±¡ï¼Œkeyåªèƒ½å‡ºç°ä¸€ä¸ªï¼Œä½†å€¼å¯ä»¥å¯¹åº”å¤šä¸ªkeyã€‚Dartåˆ›å»ºæ˜ å°„ä¹Ÿå¯ä»¥é€šè¿‡ç›´æ¥è¡¨è¾¾å’Œ<a href="https://api.dartlang.org/stable/dart-core/Map-class.html" target="_blank" rel="noopener">Set</a>ç±»å‹è¡¨è¾¾ã€‚</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> aa = &#123;</span><br><span class="line">  <span class="string">'a'</span>: <span class="string">'1'</span>,</span><br><span class="line">  <span class="string">'b'</span>: <span class="string">'2'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bb = &#123;</span><br><span class="line">  <span class="number">1</span>: <span class="string">'a'</span>,</span><br><span class="line">  <span class="number">2</span>: <span class="string">'b'</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure><p>ä¸Šé¢ï¼Œç¬¬ä¸€ä¸ª<code>aa</code>æ˜¯<code>Map&lt;String, String&gt;</code>ç±»å‹ï¼Œç¬¬äºŒä¸ª<code>bb</code>æ˜¯<code>Map&lt;int, String&gt;</code>ç±»å‹ã€‚</p><p>é€šè¿‡Mapæ„é€ ä¹Ÿå¯ä»¥åˆ›å»ºåŒæ ·çš„æ•ˆæœï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> aa = <span class="built_in">Map</span>();</span><br><span class="line">aa[<span class="string">'a'</span>] = <span class="string">'1'</span>;</span><br><span class="line">aa[<span class="string">'b'</span>] = <span class="string">'2'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bb = <span class="built_in">Map</span>();</span><br><span class="line">bb[<span class="number">1</span>] = <span class="string">'a'</span>;</span><br><span class="line">bb[<span class="number">2</span>] = <span class="string">'b'</span>;</span><br></pre></td></tr></table></div></figure><h3 id="Runes">Runes<a href="post/Note-Learn-Dart#Runes"></a></h3><p>Dartä¸­Runesæ˜¯UTF-32å­—ç¬¦é›†çš„å­—ç¬¦ä¸²å¯¹è±¡</p><p>Unicodeä¸ºä¸–ç•Œä¸Šçš„æ‰€æœ‰æ–‡å­—ç³»ç»Ÿéƒ½å®šä¹‰äº†ä¸€ä¸ªå”¯ä¸€æ•°å­—ä»£è¡¨æ–‡å­—ã€æ•°å­—å’Œç¬¦å·ã€‚å› ä¸ºä¸€ä¸ªDartå­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªUTF-16å­—ç¬¦é›†åºåˆ—ï¼Œåœ¨å­—ç¬¦ä¸²ä¸­è¡¨ç¤º32ä½Unicodeå€¼éœ€è¦ç‰¹æ®Šè¯­æ³•ã€‚</p><p>å¸¸ç”¨æ¥è¡¨è¾¾ä¸€ä¸ªUnicodeå­—ç¬¦çš„æ–¹å¼æ˜¯<code>\uXXXX</code>ï¼Œè¿™å„¿çš„<code>XXXX</code>æ˜¯ä¸€ä¸ª4ä½16è¿›åˆ¶å€¼ã€‚ä¾‹å¦‚ï¼Œå¿ƒå­—ç¬¦ï¼ˆâ™¥ï¼‰æ˜¯<code>\u2665</code>ã€‚å¦‚æœæ˜¯å¤šä½™æˆ–å°‘äº4ä¸ª16è¿›åˆ¶æ•°å­—çš„ï¼Œå°†å€¼æ”¾è¿›å¤§æ‹¬å·é‡Œé¢ã€‚ä¾‹å¦‚ç¬‘çš„emojiï¼ˆğŸ˜†ï¼‰æ˜¯<code>\u{1f600}</code>ã€‚</p><p><a href="https://api.dartlang.org/stable/2.2.0/dart-core/String-class.html" target="_blank" rel="noopener">String</a>ç±»æœ‰å‡ ä¸ªå±æ€§ä½¿æ‚¨å¯ä»¥å°†å­—ç¬¦ä¸²è½¬ä¸ºç¬¦æ–‡runesã€‚<code>codeUnitAt</code>å’Œ<code>codeUnits</code>è¿”å›16ä½å­—ç¬¦é›†ï¼ˆæ•°å­—ç¼–ç ï¼‰ã€‚ä½¿ç”¨<code>runes</code>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç¬¦æ–‡</p><p>ä¸‹é¢è¯´æ˜äº†ç¬¦æ–‡ï¼Œ16ä½å’Œ32ä½å­—ç¬¦é›†ä¹‹é—´çš„å…³ç³»</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> clapping = <span class="string">'\u&#123;1f44f&#125;ab'</span>;</span><br><span class="line"><span class="built_in">print</span>(clapping); <span class="comment">// ğŸ‘ab</span></span><br><span class="line"><span class="built_in">print</span>(clapping.codeUnitAt(<span class="number">0</span>)); <span class="comment">// 55357</span></span><br><span class="line"><span class="built_in">print</span>(clapping.codeUnits); <span class="comment">// [55357, 56399, 97, 98]</span></span><br><span class="line"><span class="built_in">print</span>(clapping.runes.toList()); <span class="comment">// [128079, 97, 98]</span></span><br><span class="line"></span><br><span class="line">Runes input = <span class="keyword">new</span> Runes(</span><br><span class="line">    <span class="string">'\u2665  \u&#123;1f605&#125;  \u&#123;1f60e&#125;  \u&#123;1f47b&#125;  \u&#123;1f596&#125;  \u&#123;1f44d&#125;'</span>);</span><br><span class="line"><span class="built_in">print</span>(<span class="keyword">new</span> <span class="built_in">String</span>.fromCharCodes(input)); <span class="comment">// â™¥  ğŸ˜…  ğŸ˜  ğŸ‘»  ğŸ––  ğŸ‘</span></span><br></pre></td></tr></table></div></figure><h3 id="ç¬¦å·-Symbols">ç¬¦å· Symbols<a href="post/Note-Learn-Dart#ç¬¦å·-Symbols"></a></h3><p>åœ¨Dartç¨‹åºä¸­ï¼Œ<a href="https://api.dartlang.org/stable/2.2.0/dart-core/Symbol-class.html" target="_blank" rel="noopener">Symbol</a>å¯¹è±¡è¡¨ç¤ºå£°æ˜è¿ç®—ç¬¦æˆ–æ ‡è¯†ç¬¦ã€‚æ‚¨å¯èƒ½ä»æ¥ä¸ä¼šä½¿ç”¨åˆ°Symbolï¼Œä½†æ˜¯å®ƒä»¬åœ¨æŒ‰åå­—å¼•ç”¨æ ‡è¯†ç¬¦çš„APIéå¸¸æœ‰ç”¨ï¼Œå› ä¸ºç¼©å°åˆ°æ”¹å˜æ ‡è¯†ç¬¦åç§°è€Œä¸æ›´æ”¹æ ‡è¯†ç¬¦ã€‚</p><p>è·å–æ ‡è¯†ç¬¦çš„symbolï¼Œä½¿ç”¨sybolè¡¨è¾¾å¼ï¼Œåªéœ€<code>#</code>å·åè·Ÿæ ‡è¯†ç¬¦ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="built_in">Map</span>();</span><br><span class="line">map[#foo] = <span class="string">"foo's value"</span>;</span><br><span class="line"><span class="built_in">print</span>(map[#foo]); <span class="comment">// foo's value</span></span><br><span class="line"><span class="built_in">print</span>(#foo); <span class="comment">// Symbol("foo")</span></span><br></pre></td></tr></table></div></figure><p>Symbolæ˜¯ç¼–è¯‘å™¨å¸¸é‡ã€‚</p><h2 id="æ–¹æ³•-Functions">æ–¹æ³• Functions<a href="post/Note-Learn-Dart#æ–¹æ³•-Functions"></a></h2><p>Dartæ˜¯ä¸€ä¸ªçœŸæ­£çš„é¢å‘å¯¹è±¡è¯­è¨€ï¼Œå› æ­¤ç”šè‡³å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡æœ‰ä¸€ä¸ªç±»å‹ï¼Œ<a href="https://api.dartlang.org/stable/dart-core/Function-class.html" target="_blank" rel="noopener">Function</a>ã€‚è¿™æ„å‘³ç€æ–¹æ³•èƒ½åˆ†é…ç»™å˜é‡æˆ–ä¼ å…¥å…¶ä»–æ–¹æ³•ï¼Œä½ ä¹Ÿå¯ä»¥å¥½åƒè°ƒç”¨ä¸€ä¸ªå‡½æ•°ä¸€æ ·ï¼Œè°ƒç”¨Dartç±»çš„å®ä¾‹ã€‚è¯¦æƒ…ï¼Œè¯·å‚é˜…<a href="https://www.dartlang.org/guides/language/language-tour#callable-classes" target="_blank" rel="noopener">å¯è°ƒç”¨çš„ç±»</a>ã€‚</p><p>è¿™å„¿æœ‰ä¸ªå®ç°æ–¹æ³•çš„ä¾‹å­ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span> isNoble(<span class="built_in">int</span> atomicNumber) &#123;</span><br><span class="line">  <span class="keyword">return</span> _nobleGases[atomicNumber] != <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>å°½ç®¡<a href="https://www.dartlang.org/guides/language/effective-dart/design#prefer-type-annotating-public-fields-and-top-level-variables-if-the-type-isnt-obvious" target="_blank" rel="noopener">Effective Dartå»ºè®®å†™ä¸Šè¿”å›ç±»å‹</a>ï¼Œä½†æ˜¯å¦‚æœä½ ä¸å†™ä¹Ÿå¯ä»¥æ­£å¸¸å·¥ä½œï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">isNoble(atomicNumber) &#123;</span><br><span class="line">  <span class="keyword">return</span> _nobleGases[atomicNumber] != <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>è¿™ä¸ªæ–¹æ³•é‡Œé¢åªæœ‰ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œäºæ˜¯å¯ä»¥ç®€å†™ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span> isNoble(<span class="built_in">int</span> atomicNumber) =&gt; _nobleGases[atomicNumber] != <span class="keyword">null</span>;</span><br></pre></td></tr></table></div></figure><p><code>=&gt; è¡¨è¾¾å¼</code>è¯­æ³•æ˜¯<code>{ return è¡¨è¾¾å¼;}</code>çš„ç®€å†™ã€‚<code>=&gt;</code>ç¬¦å·æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºç®­å¤´è¯­æ³•ã€‚</p><p>ä¸€ä¸ªæ–¹æ³•å¯èƒ½æœ‰ä¸¤ä¸ªç±»å‹çš„å‚æ•°ï¼šå¿…é¡»å’Œå¯é€‰ã€‚å¿…è¦çš„å‚æ•°åœ¨æœ€å‰ï¼Œéšåæ˜¯å¯é€‰å‚æ•°ã€‚</p><h3 id="å¯é€‰å‚æ•°">å¯é€‰å‚æ•°<a href="post/Note-Learn-Dart#å¯é€‰å‚æ•°"></a></h3><p>å¯é€‰å‚æ•°å¯ä»¥æ˜¯ä½ç½®å‚æ•°æˆ–å‘½åå‚æ•°ï¼Œä¸èƒ½åŒæ—¶å­˜åœ¨</p><h4 id="å¯é€‰å‘½åå‚æ•°">å¯é€‰å‘½åå‚æ•°<a href="post/Note-Learn-Dart#å¯é€‰å‘½åå‚æ•°"></a></h4><p>å½“è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼Œæ‚¨å¯ä»¥æŒ‡å®šå‘½åå‚æ•°<code>paramName: value.</code>ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enableFlags(bold: <span class="keyword">true</span>, hidden: <span class="keyword">false</span>);</span><br></pre></td></tr></table></div></figure><p>å½“å®šä¹‰ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œä½¿ç”¨<code>{param1, param2, ...}</code>æ¥æŒ‡å®šå‘½åå‚æ•°ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// è®¾ç½®åŠ ç²—å’Œéšè—æ ‡è®°</span></span><br><span class="line"><span class="keyword">void</span> enableFlags(&#123;<span class="built_in">bool</span> bold, <span class="built_in">bool</span> hidden&#125;) &#123;...&#125;</span><br></pre></td></tr></table></div></figure><p><a href="https://flutter.dev/" target="_blank" rel="noopener">Flutter</a>å®ä¾‹åˆ›å»ºå¯èƒ½æ›´å¤æ‚ï¼Œå› æ­¤widgetæ„é€ å™¨ä»…ä½¿ç”¨å‘½åå‚æ•°ã€‚è¿™è®©å®ä¾‹çš„åˆ›å»ºæ›´åŠ å®¹æ˜“é˜…è¯»ã€‚</p><p>æ‚¨å¯ä»¥åœ¨ä»»ä½•Dardä»£ç ä¸­æ ‡è®°æ³¨è§£<a href="https://pub.dartlang.org/documentation/meta/latest/meta/required-constant.html" target="_blank" rel="noopener">@required</a>ï¼Œè¡¨é¢å®ƒæ˜¯ä¸€ä¸ªå¿…ä¼ å‚æ•°ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Scrollbar(&#123;Key key, <span class="meta">@required</span> Widget child&#125;)</span><br></pre></td></tr></table></div></figure><p>å½“<code>Scrollbar</code>è¢«åˆ›å»ºæ—¶ï¼Œå¦‚æœæ²¡æœ‰ä¼ å…¥childé‚£ä¹ˆè§£æå™¨å°±ä¼šæŠ¥å‘Šé—®é¢˜ã€‚</p><p><a href="https://pub.dartlang.org/documentation/meta/latest/meta/required-constant.html" target="_blank" rel="noopener">Required</a>è¢«å®šä¹‰åœ¨<a href="https://pub.dartlang.org/packages/meta" target="_blank" rel="noopener">meta</a>åŒ…ä¸­ï¼Œè¦ä¹ˆç›´æ¥å¯¼å…¥<code>package:meta/meta.dart</code>ï¼Œè¦ä¹ˆå¯¼å…¥çš„å…¶ä»–åŒ…ä¸­å¯¼å…¥è¿‡<code>meta</code>ï¼Œä¾‹å¦‚Flutterçš„<code>package:flutter/material.dart</code>ã€‚</p><p>å‘½åå‚æ•°åŠ äº†<code>@required</code>å¿…ä¼ ï¼Œå…¶ä»–å¯ä¼ å¯ä¸ä¼ ã€‚</p><h4 id="å¯é€‰ä½ç½®å‚æ•°">å¯é€‰ä½ç½®å‚æ•°<a href="post/Note-Learn-Dart#å¯é€‰ä½ç½®å‚æ•°"></a></h4><p>åœ¨<code>[]</code>ä¸­è®¾ç½®å‡½æ•°ç±»å‹ä½¿å®ƒä»¬ä½œä¸ºå¯é€‰ä½ç½®å‚æ•°ï¼Œè¯¥å‚æ•°å¯ä¼ å¯ä¸ä¼ ã€‚</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> say(<span class="built_in">String</span> from, <span class="built_in">String</span> msg, [<span class="built_in">String</span> device]) &#123;</span><br><span class="line">  <span class="keyword">var</span> result = <span class="string">'<span class="subst">$from</span> says <span class="subst">$msg<span class="string">';</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  if (device != null) &#123;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">    result = '</span></span><span class="subst">$result</span> with a <span class="subst">$device<span class="string">';</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  &#125;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  return result;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;</span></span></span></span><br></pre></td></tr></table></div></figure><p>æ²¡æœ‰ä¼ å…¥å¯é€‰ä½ç½®å‚æ•°æ—¶ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(say(<span class="string">'Bob'</span>, <span class="string">'Howdy'</span>)); <span class="comment">// Bob says Howdy</span></span><br></pre></td></tr></table></div></figure><p>å½“ä¼ å…¥å¯é€‰ä½ç½®å‚æ•°çš„æ—¶å€™ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(say(<span class="string">'Bob'</span>, <span class="string">'Howdy'</span>, <span class="string">'smoke signal'</span>)); <span class="comment">// Bob says Howdy with a smoke a signal</span></span><br></pre></td></tr></table></div></figure><h4 id="å‚æ•°é»˜è®¤å€¼">å‚æ•°é»˜è®¤å€¼<a href="post/Note-Learn-Dart#å‚æ•°é»˜è®¤å€¼"></a></h4><p>å‘½åå‚æ•°å’Œä½ç½®å‚æ•°éƒ½å¯ä»¥ä½¿ç”¨<code>=</code>æ¥å®šä¹‰é»˜è®¤å€¼ï¼Œé»˜è®¤å€¼å¿…é¡»æ˜¯ç¼–è¯‘å™¨å¸¸é‡ã€‚å¦‚æœæ²¡æœ‰æä¾›é»˜è®¤å€¼ï¼Œé»˜è®¤å€¼ä¸º<code>null</code></p><p>è®¾ç½®å‘½åå‚æ•°çš„é»˜è®¤å€¼ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> enableFlags(&#123;<span class="built_in">bool</span> bold = <span class="keyword">false</span>, <span class="built_in">bool</span> hidden = <span class="keyword">false</span>&#125;) &#123;...&#125;</span><br><span class="line">enableFlags(bold: <span class="keyword">true</span>); <span class="comment">// bold = true, hidden = false</span></span><br></pre></td></tr></table></div></figure><p>è®¾ç½®å¯é€‰ä½ç½®å‚æ•°çš„é»˜è®¤å€¼ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> say(<span class="built_in">String</span> from, <span class="built_in">String</span> msg,</span><br><span class="line">    [<span class="built_in">String</span> device = <span class="string">'carrier pigeon'</span>, <span class="built_in">String</span> mood]) &#123; ... &#125;</span><br></pre></td></tr></table></div></figure><p>ä½ ä¹Ÿå¯ä»¥ä¸ºåˆ—è¡¨æˆ–é›†åˆå‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> doStuff(</span><br><span class="line">    &#123;<span class="built_in">List</span>&lt;<span class="built_in">int</span>&gt; list = <span class="keyword">const</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">String</span>&gt; gifts = <span class="keyword">const</span> &#123;</span><br><span class="line">      <span class="string">'first'</span>: <span class="string">'paper'</span>,</span><br><span class="line">      <span class="string">'second'</span>: <span class="string">'cotton'</span>,</span><br><span class="line">      <span class="string">'third'</span>: <span class="string">'leather'</span></span><br><span class="line">    &#125;&#125;) &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'list:  <span class="subst">$list<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  print('</span></span>gifts: <span class="subst">$gifts<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;</span></span></span></span><br></pre></td></tr></table></div></figure><h3 id="main-æ–¹æ³•"><code>main()</code>æ–¹æ³•<a href="post/Note-Learn-Dart#main-æ–¹æ³•"></a></h3><p>æ¯ä¸ªappå¿…é¡»æœ‰ä¸ªé¡¶çº§<code>main()</code>æ–¹æ³•ï¼Œå®ƒæ˜¯appçš„å…¥å£ç‚¹ã€‚<code>main()</code>æ–¹æ³•è¿”å›<code>void</code>å¹¶ä¸”æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°<code>List&lt;String&gt;</code>ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªweb appçš„main()æ–¹æ³•ä¾‹å­ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="built_in">querySelector</span>(<span class="string">'#sample_text_id'</span>)</span><br><span class="line">  ..text = <span class="string">'Click me!'</span></span><br><span class="line">  ..onClick.listen(reverseText);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>æ³¨æ„ï¼šè¿™é‡Œçš„<code>..</code>è¯­æ³•è¢«ç§°ä¸º<a href="https://www.dartlang.org/guides/language/language-tour#cascade-notation-" target="_blank" rel="noopener">çº§è”</a>ï¼Œé€šè¿‡çº§è”æ‚¨å¯ä»¥å¤šæ¬¡å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œæ“ä½œã€‚</p></blockquote><p>ä¸‹é¢æ˜¯åˆ›å»ºäº†ä¸€ä¸ªå‘½ä»¤è¡Œè¿è¡Œçš„appï¼Œåœ¨<code>main()</code>æ–¹æ³•çš„å‚æ•°å¯è·å¾—å‘½ä»¤è¡Œçš„å€¼ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main(<span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; arguments) &#123;</span><br><span class="line">  <span class="built_in">print</span>(arguments);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>é¦–å…ˆéœ€è¦é…ç½®å¥½dartç¯å¢ƒå˜é‡ï¼Œç„¶ååœ¨ç»ˆç«¯å½“å‰æ–‡ä»¶ç›®å½•è¿è¡Œï¼š<code>dart test.dart 1 test</code>ï¼Œå°†ä¼šè¾“å‡º<code>[1, test]</code>ã€‚</p><p>æ‚¨å¯ä»¥ä½¿ç”¨<a href="https://www.dartlang.org/guides/language/language-tour#cascade-notation-" target="_blank" rel="noopener">args</a>ç±»åº“å®šä¹‰æˆ–è§£æå‘½ä»¤è¡Œå‚æ•°ã€‚</p><h3 id="æ–¹æ³•çœ‹åšç±»å¯¹è±¡">æ–¹æ³•çœ‹åšç±»å¯¹è±¡<a href="post/Note-Learn-Dart#æ–¹æ³•çœ‹åšç±»å¯¹è±¡"></a></h3><p>æ‚¨å¯ä»¥å°†ä¸€ä¸ªæ–¹æ³•ä½œä¸ºå‚æ•°ä¼ å…¥å¦ä¸€ä¸ªæ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="keyword">void</span> printElement(<span class="built_in">int</span> element) &#123;</span><br><span class="line">    <span class="built_in">print</span>(element);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">  <span class="comment">// å°†æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ å…¥</span></span><br><span class="line">  list.forEach(printElement);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿è¡Œè¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 3</span></span><br></pre></td></tr></table></div></figure><p>æ‚¨ä¹Ÿå¯ä»¥ä¸ºå˜é‡åˆ†é…ä¸€ä¸ªæ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> loudify = (msg) =&gt; <span class="string">'!!!<span class="subst">$&#123;msg.toUpperCase()&#125;</span>!!!'</span>;</span><br><span class="line"><span class="built_in">print</span>(loudify(<span class="string">'hello'</span>)); <span class="comment">// !!!HELLO!!!</span></span><br></pre></td></tr></table></div></figure><p>è¿™ä¸ªä¾‹å­ä½¿ç”¨åŒ¿åæ–¹æ³•ï¼Œæ›´å¤šä¿¡æ¯è¯·æ¥ç€çœ‹çœ‹ä¸‹é¢å“¦ï¼</p><h3 id="åŒ¿åæ–¹æ³•">åŒ¿åæ–¹æ³•<a href="post/Note-Learn-Dart#åŒ¿åæ–¹æ³•"></a></h3><p>å¾ˆå¤šæ–¹é¢éƒ½æœ‰åå­—ï¼Œä¾‹å¦‚<code>main()</code>æˆ–<code>printElement()</code>ã€‚æ‚¨ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªæ²¡æœ‰åå­—çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºåŒ¿åæ–¹æ³•ï¼Œæˆ–<code>lambda</code>ï¼Œæˆ–<code>é—­åŒ…(closure)</code>ã€‚æ‚¨å¯ä»¥åˆ†é…ç»™å˜é‡ä¸€ä¸ªåŒ¿åæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥åœ¨åˆ—è¡¨ä¸­æ·»åŠ æˆ–ç§»é™¤å®ƒã€‚</p><p>åŒ¿åæ–¹æ³•å’Œå‘½åæ–¹æ³•å·®ä¸å¤šï¼Œä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°æ”¾åœ¨æ‹¬å·é‡Œï¼Œä¹‹é—´ç”¨é€—å·åˆ†éš”ã€‚</p><p>ä»£ç æ ·å¼çœ‹èµ·æ¥å¦‚ä¸‹é¢çš„æ ¼å¼ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">([[ç±»å‹] å‚æ•°<span class="number">1</span>[, â€¦]]) &#123;</span><br><span class="line">  ä»£ç å—;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure><p>ä¸‹é¢çš„ä¾‹å­ä¸­å®šä¹‰äº†ä¸€ä¸ªæ— ç±»å‹å‚æ•°<code>item</code>çš„åŒ¿åæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨åˆ—è¡¨è½®è¯¢æ—¶è¢«è°ƒç”¨ï¼Œæ‰“å°å¯¹åº”çš„å€¼å’Œä¸‹æ ‡ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> list = [<span class="string">'apples'</span>, <span class="string">'bananas'</span>, <span class="string">'oranges'</span>];</span><br><span class="line">list.forEach((item) &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'<span class="subst">$&#123;list.indexOf(item)&#125;</span>:<span class="subst">$item<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;);</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">// è¾“å‡ºï¼š</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">// 0:apples</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">// 1:bananas</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">// 2:oranges</span></span></span></span><br></pre></td></tr></table></div></figure><p>ç”±äºè¿™ä¸ªæ–¹æ³•åªæœ‰ä¸€æ¡æŒ‡ä»¤ï¼Œæ‚¨å¯ä»¥ç”¨ç®­å¤´è¡¨è¾¾ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list.forEach((item) =&gt; <span class="built_in">print</span>(<span class="string">'<span class="subst">$&#123;list.indexOf(item)&#125;</span>: <span class="subst">$item<span class="string">'));</span></span></span></span><br></pre></td></tr></table></div></figure><h3 id="ä½œç”¨åŸŸè¯­æ³•">ä½œç”¨åŸŸè¯­æ³•<a href="post/Note-Learn-Dart#ä½œç”¨åŸŸè¯­æ³•"></a></h3><p>Dartä¹Ÿæ˜¯ä¸€ä¸ªä½œç”¨åŸŸè¯­æ³•è¯­è¨€ï¼Œè¿™æ„å‘³ç€å˜é‡çš„ä½œç”¨åŸŸæ˜¯ç¡®å®šçš„ï¼Œåªéœ€æ”¹å˜ä»£ç å¸ƒå±€å°±å¯ã€‚æ‚¨å¯ä»¥ä½¿ç”¨èŠ±æ‹¬å·å¤–çš„å˜é‡æ¥æŸ¥çœ‹æ˜¯å¦åœ¨ä½œç”¨åŸŸå†…ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ–¹æ³•å†…åµŒçš„ä¾‹å­ï¼Œå¹¶ä¸”æ¯ä¸ªç­‰çº§çš„ä½œç”¨åŸŸä¸­éƒ½æœ‰ä¸€ä¸ªå˜é‡ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span> topLevel = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="keyword">var</span> insideMain = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> myFunction() &#123;</span><br><span class="line">    <span class="keyword">var</span> insideFunction = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> nestedFunction() &#123;</span><br><span class="line">      <span class="keyword">var</span> insideNestedFunction = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">assert</span>(topLevel);</span><br><span class="line">      <span class="keyword">assert</span>(insideMain);</span><br><span class="line">      <span class="keyword">assert</span>(insideFunction);</span><br><span class="line">      <span class="keyword">assert</span>(insideNestedFunction);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æ³¨æ„<code>nestedFunction()</code>å¦‚ä½•ä½¿ç”¨æ¯ä¸ªçº§åˆ«çš„å˜é‡ï¼Œä¸€ç›´åˆ°é¡¶çº§ã€‚</p><h3 id="é—­åŒ…è¯­æ³•">é—­åŒ…è¯­æ³•<a href="post/Note-Learn-Dart#é—­åŒ…è¯­æ³•"></a></h3><p>ä¸€ä¸ªé—­åŒ…æ˜¯ä¸€ä¸ªæ–¹æ³•å¯¹è±¡ï¼Œå®ƒèƒ½è®¿é—®åœ¨å®ƒä½œç”¨åŸŸè¯­æ³•å†…çš„å˜é‡ã€‚å³ä½¿å½“è¿™ä¸ªæ–¹æ³•ä½¿ç”¨åœ¨åŸæ¥çš„ä½œç”¨åŸŸä¹‹å¤–ã€‚</p><p>æ–¹æ³•èƒ½å…³è”ä½œç”¨åŸŸèŒƒå›´çš„å˜é‡ï¼Œåœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ<code>makeAdder()</code>è·å–çš„å˜é‡æ˜¯<code>addBy</code>ï¼Œè¿”å›ä¸€ä¸ªæ–¹æ³•ï¼Œæ— è®ºå®ƒè¿”å›åœ¨å“ªéƒ½ä¼šè®°ä½<code>addBy</code>ã€‚</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// è¿”å›ä¸€ä¸ªæ–¹æ³•</span></span><br><span class="line"><span class="comment">/// addBy + æ–¹æ³•çš„å‚æ•°i</span></span><br><span class="line"><span class="built_in">Function</span> makeAdder(<span class="built_in">num</span> addBy) =&gt; (i) =&gt; addBy + i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºä¸€ä¸ªåŠ 2çš„æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">var</span> add2 = makeAdder(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ›å»ºä¸€ä¸ªåŠ 4çš„æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">var</span> add4 = makeAdder(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'<span class="subst">$&#123;add2(<span class="number">3</span>)&#125;</span>, <span class="subst">$&#123;add4(<span class="number">3</span>)&#125;</span>'</span>); <span class="comment">// 5,  7</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="æµ‹è¯•æ–¹æ³•ç›¸ç­‰æ€§">æµ‹è¯•æ–¹æ³•ç›¸ç­‰æ€§<a href="post/Note-Learn-Dart#æµ‹è¯•æ–¹æ³•ç›¸ç­‰æ€§"></a></h3><p>è¿™å„¿æœ‰ä¸€ä¸ªæµ‹è¯•æœ€å¤–å±‚æ–¹æ³•ï¼Œé™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•çš„ç›¸ç­‰æ€§çš„ä¾‹å­ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> foo() &#123;&#125; <span class="comment">// æœ€å¤–å±‚æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">void</span> bar() &#123;&#125; <span class="comment">// é™æ€æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">void</span> baz() &#123;&#125; <span class="comment">// å®ä¾‹æ–¹æ³•</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="keyword">var</span> x;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¯”è¾ƒé™æ€æ–¹æ³•</span></span><br><span class="line">  x = foo;</span><br><span class="line">  <span class="built_in">print</span>(foo == x); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¯”è¾ƒå®ä¾‹æ–¹æ³•</span></span><br><span class="line">  x = A.bar;</span><br><span class="line">  <span class="built_in">print</span>(A.bar == x); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> v = A(); <span class="comment">// ç¬¬ä¸€ä¸ªAå®ä¾‹</span></span><br><span class="line">  <span class="keyword">var</span> w = A(); <span class="comment">// ç¬¬äºŒä¸ªAå®ä¾‹</span></span><br><span class="line">  <span class="keyword">var</span> y = w;</span><br><span class="line">  x = w.baz;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç”±äºè¿™ä¸¤ä¸ªå˜é‡å¼•ç”¨åŒä¸€ä¸ªå®ä¾‹ï¼Œå› æ­¤ä»–ä»¬çš„é—­åŒ…ç›¸ç­‰</span></span><br><span class="line">  <span class="built_in">print</span>(y.baz == x); <span class="comment">// true</span></span><br><span class="line">  <span class="comment">// ç”±äºè¿™æ˜¯ä¸¤ä¸ªå®ä¾‹ï¼Œå› æ­¤ä»–ä»¬çš„é—­åŒ…ä¸ç­‰</span></span><br><span class="line">  <span class="built_in">print</span>(v.baz == w.baz); <span class="comment">// false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="è¿”å›å€¼">è¿”å›å€¼<a href="post/Note-Learn-Dart#è¿”å›å€¼"></a></h3><p>æ‰€æœ‰æ–¹æ³•éƒ½æœ‰ä¸€ä¸ªè¿”å›å€¼ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šè¿”å›å€¼ï¼Œé‚£ä¹ˆåœ¨æ–¹æ³•ä½“ä¸­ä¼šéšå¼å£°æ˜<code>return null;</code></p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">foo() &#123;&#125;</span><br><span class="line"><span class="built_in">print</span>(foo()); <span class="comment">// null</span></span><br></pre></td></tr></table></div></figure><h2 id="è¿ç®—ç¬¦">è¿ç®—ç¬¦<a href="post/Note-Learn-Dart#è¿ç®—ç¬¦"></a></h2><p>ä¸‹é¢çš„è¡¨æ ¼ä¸­å±•ç¤ºäº†Dartä¸­å®šä¹‰çš„è¿ç®—ç¬¦ï¼Œæ‚¨å¯ä»¥è¦†ç›–ä¸‹é¢å¤§éƒ¨åˆ†è¿ç®—ç¬¦ï¼Œè¯¦æƒ…å‚ç…§ï¼š<a href="https://www.dartlang.org/guides/language/language-tour#overridable-operators" target="_blank" rel="noopener">å¯è¦†ç›–è¿ç®—ç¬¦</a></p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">æè¿°</th><th style="text-align:left">è¿ç®—ç¬¦</th></tr></thead><tbody><tr><td style="text-align:left">å•ç›®åç½®</td><td style="text-align:left"><code>expr++</code> <code>expr--</code> <code>()</code> <code>[]</code> <code>.</code> <code>?.</code></td></tr><tr><td style="text-align:left">å•ç›®å‰ç½®</td><td style="text-align:left"><code>-expr</code> <code>!expr</code> <code>~expr</code> <code>++expr</code> <code>--expr</code></td></tr><tr><td style="text-align:left">ä¹˜æ³•ç±»</td><td style="text-align:left"><code>*</code> <code>/</code> <code>%</code> <code>~/</code></td></tr><tr><td style="text-align:left">åŠ å‡ç±»</td><td style="text-align:left"><code>+</code> <code>-</code></td></tr><tr><td style="text-align:left">ä½ç§»</td><td style="text-align:left"><code>&gt;&gt;</code> <code>&lt;&lt;</code> <code>&gt;&gt;&gt;</code></td></tr><tr><td style="text-align:left">æŒ‰ä½ä¸</td><td style="text-align:left"><code>&amp;</code></td></tr><tr><td style="text-align:left">æŒ‰ä½å¼‚æˆ–</td><td style="text-align:left"><code>^</code></td></tr><tr><td style="text-align:left">æŒ‰ä½æˆ–</td><td style="text-align:left">`</td><td>`</td></tr><tr><td style="text-align:left">å…³ç³»å’Œç±»å‹æ ¡éªŒ</td><td style="text-align:left"><code>&gt;=</code> <code>&gt;</code> <code>&lt;=</code> <code>&lt;</code> <code>as</code> <code>is</code> â€˜is!â€™</td></tr><tr><td style="text-align:left">ç­‰æ€§</td><td style="text-align:left"><code>==</code> <code>!=</code></td></tr><tr><td style="text-align:left">é€»è¾‘ä¸</td><td style="text-align:left"><code>&amp;&amp;</code></td></tr><tr><td style="text-align:left">é€»è¾‘æˆ–</td><td style="text-align:left">`</td><td></td><td>`</td></tr><tr><td style="text-align:left">æ˜¯å¦æ˜¯null</td><td style="text-align:left">??</td></tr><tr><td style="text-align:left">ä¸‰ç›®è¿ç®—</td><td style="text-align:left"><code>expr1 ? expr2 : expr2</code></td></tr><tr><td style="text-align:left">çº§è”</td><td style="text-align:left"><code>..</code></td></tr><tr><td style="text-align:left">èµ‹å€¼</td><td style="text-align:left"><code>=</code> <code>*=</code> <code>/=</code> <code>+=</code> <code>-=</code> <code>&amp;=</code> <code>^=</code> ç­‰</td></tr></tbody></table></div></div><h3 id="ç®—æ•°è¿ç®—ç¬¦">ç®—æ•°è¿ç®—ç¬¦<a href="post/Note-Learn-Dart#ç®—æ•°è¿ç®—ç¬¦"></a></h3><p>Dartæ”¯æŒå¸¸ç”¨ç®—æ•°è¿ç®—ç¬¦ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">è¿ç®—ç¬¦</th><th style="text-align:left">è§£é‡Š</th></tr></thead><tbody><tr><td style="text-align:left"><code>+</code></td><td style="text-align:left">åŠ </td></tr><tr><td style="text-align:left"><code>-</code></td><td style="text-align:left">å‡</td></tr><tr><td style="text-align:left"><code>-expr</code></td><td style="text-align:left">ä¸€å…ƒå‡ï¼Œä¹Ÿç§°ä¸ºå¦å®šï¼ˆåè½¬è¡¨è¾¾å¼çš„ç¬¦å·ï¼‰</td></tr><tr><td style="text-align:left"><code>*</code></td><td style="text-align:left">ä¹˜</td></tr><tr><td style="text-align:left"><code>/</code></td><td style="text-align:left">é™¤</td></tr><tr><td style="text-align:left"><code>~/</code></td><td style="text-align:left">é™¤ä»¥ï¼Œå¹¶è¿”å›æ•´æ•°ç»“æœ</td></tr><tr><td style="text-align:left"><code>%</code></td><td style="text-align:left">æ±‚ä½™</td></tr></tbody></table></div></div><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="number">5</span> / <span class="number">2</span>); <span class="comment">// 2.5</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">5</span> ~/ <span class="number">2</span>); <span class="comment">// 2</span></span><br></pre></td></tr></table></div></figure><p>Dartä¹Ÿæ”¯æŒå•ç›®é€’å¢å’Œé€’å‡è¿ç®—ç¬¦</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">è¿ç®—ç¬¦</th><th style="text-align:left">è§£é‡Š</th></tr></thead><tbody><tr><td style="text-align:left"><code>++var</code></td><td style="text-align:left"><code>var = var + 1</code>(è¡¨è¾¾å¼çš„å€¼ä¸º<code>var + 1</code>)</td></tr><tr><td style="text-align:left"><code>var++</code></td><td style="text-align:left"><code>var = var + 1</code>(è¡¨è¾¾å¼çš„å€¼ä¸º<code>var</code>)</td></tr><tr><td style="text-align:left"><code>--var</code></td><td style="text-align:left"><code>var = var - 1</code>(è¡¨è¾¾å¼çš„å€¼ä¸º<code>var - 1</code>)</td></tr><tr><td style="text-align:left"><code>var--</code></td><td style="text-align:left"><code>var = var - 1</code>(è¡¨è¾¾å¼çš„å€¼ä¸º<code>var</code>)</td></tr></tbody></table></div></div><h3 id="ç­‰å¼å’Œå…³ç³»è¿ç®—ç¬¦">ç­‰å¼å’Œå…³ç³»è¿ç®—ç¬¦<a href="post/Note-Learn-Dart#ç­‰å¼å’Œå…³ç³»è¿ç®—ç¬¦"></a></h3><p>ä¸‹é¢çš„è¡¨æ ¼åˆ—å‡ºäº†ç­‰å¼å’Œå…³ç³»è¿ç®—ç¬¦çš„å«ä¹‰</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">è¿ç®—ç¬¦</th><th style="text-align:left">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left"><code>==</code></td><td style="text-align:left">æ’ç­‰äº</td></tr><tr><td style="text-align:left"><code>!=</code></td><td style="text-align:left">ä¸ç­‰äº</td></tr><tr><td style="text-align:left"><code>&gt;</code></td><td style="text-align:left">å¤§äº</td></tr><tr><td style="text-align:left"><code>&lt;</code></td><td style="text-align:left">å°äº</td></tr><tr><td style="text-align:left"><code>&gt;=</code></td><td style="text-align:left">å¤§äºæˆ–ç­‰äº</td></tr><tr><td style="text-align:left"><code>&lt;=</code></td><td style="text-align:left">å°äºæˆ–ç­‰äº</td></tr></tbody></table></div></div><p>ä½¿ç”¨<code>==</code>åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼ˆåœ¨å°‘æ•°æƒ…å†µä¸‹æ‚¨éœ€è¦åˆ¤æ–­ä¸¤ä¸ªå¼•ç”¨æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œä½¿ç”¨<a href="https://api.dartlang.org/stable/2.2.0/dart-core/identical.html" target="_blank" rel="noopener">identical()</a>ï¼‰</p><h3 id="ç±»å‹æ£€æµ‹è¿ç®—ç¬¦">ç±»å‹æ£€æµ‹è¿ç®—ç¬¦<a href="post/Note-Learn-Dart#ç±»å‹æ£€æµ‹è¿ç®—ç¬¦"></a></h3><p><code>as</code>,<code>is</code>å’Œ<code>is!</code>è¿ç®—ç¬¦ç”¨æ¥æ£€æµ‹è¿è¡Œæ—¶ç±»å‹</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">è¿ç®—ç¬¦</th><th style="text-align:left">æ„æ€</th></tr></thead><tbody><tr><td style="text-align:left"><code>as</code></td><td style="text-align:left">ç±»å‹è½¬æ¢ï¼ˆä¹Ÿç»å¸¸ç”¨æ¥æŒ‡å®š<a href="https://www.dartlang.org/guides/language/language-tour#specifying-a-library-prefix" target="_blank" rel="noopener">ç±»åº“å‰ç¼€</a>ï¼‰</td></tr><tr><td style="text-align:left"><code>is</code></td><td style="text-align:left">å¯¹è±¡æ˜¯å¦æœ‰æŒ‡å®šçš„ç±»å‹</td></tr><tr><td style="text-align:left"><code>is!</code></td><td style="text-align:left">å’Œä¸Šé¢ç›¸å</td></tr></tbody></table></div></div><p><code>as</code> å¼ºè½¬ç±»å‹ï¼Œ <code>is</code> ç±»å‹åˆ¤æ–­</p><h3 id="èµ‹å€¼è¿ç®—ç¬¦">èµ‹å€¼è¿ç®—ç¬¦<a href="post/Note-Learn-Dart#èµ‹å€¼è¿ç®—ç¬¦"></a></h3><p>æ‚¨å·²çŸ¥é“ï¼Œæ‚¨å¯ä»¥é€šè¿‡<code>=</code>è¿ç®—ç¬¦ä¸ºå˜é‡èµ‹å€¼ã€‚å¦‚æœè¦ä»…ä»…å˜é‡ä¸º<code>null</code>æ—¶æ‰èµ‹å€¼ï¼Œä½¿ç”¨<code>??=</code>è¿ç®—ç¬¦</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="built_in">int</span> a = <span class="number">5</span>;</span><br><span class="line">  <span class="built_in">int</span> b;</span><br><span class="line"></span><br><span class="line">  a ??= <span class="number">10</span>;</span><br><span class="line">  b ??= <span class="number">10</span>;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'a = <span class="subst">$a</span>, b = <span class="subst">$b<span class="string">'); // a = 5, b = 10</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;</span></span></span></span><br></pre></td></tr></table></div></figure><p>ç»„åˆèµ‹å€¼è¿ç®—ç¬¦ï¼Œå¦‚<code>+=</code>å°†è¿ç®—ç¬¦å’Œèµ‹å€¼ç»“åˆ</p><div class="article-bounded"><div class="article-table"><table><tbody><tr><td style="text-align:left"><code>=</code></td><td style="text-align:left"><code>-=</code></td><td style="text-align:left"><code>/=</code></td><td style="text-align:left"><code>%=</code></td><td style="text-align:left"><code>&gt;&gt;=</code></td><td style="text-align:left"><code>^=</code></td></tr><tr><td style="text-align:left"><code>+=</code></td><td style="text-align:left"><code>*=</code></td><td style="text-align:left"><code>~/=</code></td><td style="text-align:left"><code>&lt;&lt;=</code></td><td style="text-align:left"><code>&amp;=</code></td><td style="text-align:left"><code>&#124;=</code></td></tr></tbody></table></div></div><h3 id="é€»è¾‘è¿ç®—ç¬¦">é€»è¾‘è¿ç®—ç¬¦<a href="post/Note-Learn-Dart#é€»è¾‘è¿ç®—ç¬¦"></a></h3><p>æ‚¨å¯ä»¥é€šè¿‡é€»è¾‘è¿ç®—ç¬¦é¢ å€’æˆ–ç»„åˆå¸ƒå°”è¡¨è¾¾å¼</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">è¿ç®—ç¬¦</th><th style="text-align:left">æ„æ€</th></tr></thead><tbody><tr><td style="text-align:left"><code>!expr</code></td><td style="text-align:left">é¢ å€’æ˜¯é</td></tr><tr><td style="text-align:left"><code>&#124;&#124;</code></td><td style="text-align:left">é€»è¾‘æˆ–</td></tr><tr><td style="text-align:left"><code>&amp;&amp;</code></td><td style="text-align:left">é€»è¾‘ä¸</td></tr></tbody></table></div></div><h3 id="æŒ‰ä½è¿ç®—å’Œç§»ä½è¿ç®—ç¬¦">æŒ‰ä½è¿ç®—å’Œç§»ä½è¿ç®—ç¬¦<a href="post/Note-Learn-Dart#æŒ‰ä½è¿ç®—å’Œç§»ä½è¿ç®—ç¬¦"></a></h3><p>æ‚¨å¯ä»¥åœ¨Dartä¸­æ“ä½œæ•°å­—çš„ä½è¿ç®—</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">è¿ç®—ç¬¦</th><th style="text-align:left">æ„æ€</th></tr></thead><tbody><tr><td style="text-align:left"><code>&amp;</code></td><td style="text-align:left">ä¸</td></tr><tr><td style="text-align:left"><code>&#124;</code></td><td style="text-align:left">æˆ–</td></tr><tr><td style="text-align:left"><code>^</code></td><td style="text-align:left">å¼‚æˆ–</td></tr><tr><td style="text-align:left"><code>~expr</code></td><td style="text-align:left">å–å</td></tr><tr><td style="text-align:left"><code>&lt;&lt;</code></td><td style="text-align:left">å·¦ç§»</td></tr><tr><td style="text-align:left"><code>&gt;&gt;</code></td><td style="text-align:left">å³ç§»</td></tr></tbody></table></div></div><h3 id="æ¡ä»¶è¡¨è¾¾å¼">æ¡ä»¶è¡¨è¾¾å¼<a href="post/Note-Learn-Dart#æ¡ä»¶è¡¨è¾¾å¼"></a></h3><p>Dartæœ‰ä¸¤ç§è¡¨è¾¾å¼è®©æ‚¨ç®€æ˜çš„è¡¨è¾¾éœ€è¦ä½¿ç”¨åˆ°<code>if-else</code>çš„æƒ…æ™¯ï¼š</p><p>1.ä¸‰ç›®è¿ç®—ç¬¦</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">condition ? expr1 : expr2</span><br></pre></td></tr></table></div></figure><p>2.æ˜¯å¦ä¸ºnullï¼Œå¦‚æœä¸ºnullåˆ™ç”¨åé¢çš„è¡¨è¾¾å¼</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">expr1 ?? expr2</span><br></pre></td></tr></table></div></figure><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="number">1</span> &gt; <span class="number">2</span> ? <span class="string">"æ˜¯çš„1&gt;2"</span> : <span class="string">"ä¸ä¸ï¼Œ1&lt;2"</span>); <span class="comment">// ä¸ä¸ï¼Œ1&lt;2</span></span><br><span class="line">  <span class="built_in">int</span> value;</span><br><span class="line">  <span class="built_in">print</span>(value ?? <span class="number">100</span>); <span class="comment">// 100</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="çº§è”è¡¨ç¤ºæ³•">çº§è”è¡¨ç¤ºæ³•<a href="post/Note-Learn-Dart#çº§è”è¡¨ç¤ºæ³•"></a></h3><p><code>..</code>å…è®¸æ‚¨å¯¹åŒä¸€ä¸ªå¯¹è±¡è¿›è¡Œä¸€ç³»åˆ—è¿ç»­çš„æ“ä½œã€‚ä¸ä»…å¯ä»¥è°ƒç”¨æ–¹æ³•ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä¸ºè¿™ä¸ªå¯¹è±¡å­—æ®µèµ‹å€¼ã€‚è¿™é€šå¸¸ä¸ºæ‚¨èŠ‚çœäº†åˆ›å»ºä¸´æ—¶å˜é‡çš„ä¸æ­¥éª¤ï¼Œå¹¶èƒ½è®©ä½ å†™æˆæ›´å¤šæµç•…çš„ä»£ç ã€‚</p><p>è¯·å‚è€ƒä¸‹é¢ä»£ç ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">querySelector</span>(<span class="string">'#confirm'</span>) <span class="comment">// è·å¾—ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">  ..text = <span class="string">'Confirm'</span> <span class="comment">// ä½¿ç”¨å®ƒçš„æˆå‘˜å˜é‡</span></span><br><span class="line">  ..classes.add(<span class="string">'important'</span>)</span><br><span class="line">  ..onClick.listen((e) =&gt; <span class="built_in">window</span>.alert(<span class="string">'Confirmed!'</span>));</span><br></pre></td></tr></table></div></figure><p>è¿˜æœ‰å†…éƒ¨è”ç»“ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> addressBook = (AddressBookBuilder()</span><br><span class="line">      ..name = <span class="string">'jenny'</span></span><br><span class="line">      ..email = <span class="string">'jenny@example.com'</span></span><br><span class="line">      ..phone = (PhoneNumberBuilder()</span><br><span class="line">            ..number = <span class="string">'415-555-0100'</span></span><br><span class="line">            ..label = <span class="string">'home'</span>)</span><br><span class="line">          .build())</span><br><span class="line">    .build();</span><br></pre></td></tr></table></div></figure><h3 id="å…¶ä»–æ“ä½œç¬¦">å…¶ä»–æ“ä½œç¬¦<a href="post/Note-Learn-Dart#å…¶ä»–æ“ä½œç¬¦"></a></h3><p>æ‚¨å·²åœ¨å…¶ä»–æ¡ˆä¾‹ä¸­çœ‹åˆ°äº†å¤§å¤šæ•°çš„ç›¸å…³æ“ä½œç¬¦</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">æ“ä½œç¬¦</th><th style="text-align:left">åå­—</th><th style="text-align:left">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left"><code>()</code></td><td style="text-align:left">æ–¹æ³•</td><td style="text-align:left">è¡¨ç¤ºæ–¹æ³•è°ƒç”¨</td></tr><tr><td style="text-align:left"><code>[]</code></td><td style="text-align:left">åˆ—è¡¨è®¿é—®</td><td style="text-align:left">é€šè¿‡ç´¢å¼•å¼•ç”¨åˆ—è¡¨ä¸­çš„å€¼</td></tr><tr><td style="text-align:left"><code>.</code></td><td style="text-align:left">æˆå‘˜è®¿é—®</td><td style="text-align:left">å¼•ç”¨ä¸€ä¸ªå±æ€§ï¼›ä¾‹å¦‚ï¼š<code>foo.bar</code>ï¼Œå¼•ç”¨fooå¯¹è±¡ä¸­çš„barå±æ€§</td></tr><tr><td style="text-align:left"><code>?.</code></td><td style="text-align:left">æ¡ä»¶æˆå‘˜è®¿é—®</td><td style="text-align:left">å·¦è¾¹çš„å˜é‡å¯ä»¥æ˜¯null</td></tr></tbody></table></div></div><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  A a;</span><br><span class="line">  <span class="built_in">print</span>(a?.b); <span class="comment">// null, å¦‚æœä¸åŠ â€œï¼Ÿâ€å°±ä¼šæŠ¥é”™</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æ›´å¤šå…³äº<code>.</code>ï¼Œ<code>?.</code>å’Œ<code>..</code>çš„æ“ä½œï¼Œè¯·å‚è€ƒ<a href="https://www.dartlang.org/guides/language/language-tour#classes" target="_blank" rel="noopener">ç±»</a></p><h2 id="æ§åˆ¶æµè¯­å¥">æ§åˆ¶æµè¯­å¥<a href="post/Note-Learn-Dart#æ§åˆ¶æµè¯­å¥"></a></h2><p>æ‚¨å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»»æ„Dartä»£ç æ§åˆ¶æµç¨‹</p><ul><li><code>if</code> å’Œ <code>else</code></li><li><code>for</code> å¾ªç¯</li><li><code>while</code> å’Œ <code>do-while</code>å¾ªç¯</li><li><code>break</code> å’Œ <code>continue</code></li><li><code>switch</code> å’Œ <code>case</code></li><li><code>assert</code></li></ul><p>æ‚¨ä¹Ÿå¯ä»¥å¯ä»¥é€šè¿‡<code>try-catch</code>å’Œ<code>throw</code>å½±å“æµç¨‹ï¼Œè¯¦ç»†ä»‹ç»åœ¨<a href="https://www.dartlang.org/guides/language/language-tour#exceptions" target="_blank" rel="noopener">å¼‚å¸¸</a></p><h3 id="forå¾ªç¯">forå¾ªç¯<a href="post/Note-Learn-Dart#forå¾ªç¯"></a></h3><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="keyword">var</span> callback = [];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">    callback.add(() =&gt; <span class="built_in">print</span>(i));</span><br><span class="line">  &#125;</span><br><span class="line">  callback.forEach((c) =&gt; c());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment">// 0</span></span><br><span class="line"><span class="comment">// 1</span></span><br></pre></td></tr></table></div></figure><p>åˆ—è¡¨ä¸­æ”¾å…¥çš„æ˜¯ä¸¤ä¸ªé—­åŒ…ï¼Œåˆ—è¡¨æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<a href="https://api.dartlang.org/stable/2.2.0/dart-core/Iterable/forEach.html" target="_blank" rel="noopener">forEach()</a>æ–¹æ³•æ¥éå†ã€‚å¦‚æœä½ ä¸éœ€è¦çŸ¥é“å½“å‰çš„è¿­ä»£æ•°é‡ï¼Œä½¿ç”¨<code>forEach()</code>æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">candidates.forEach((candidate) =&gt; candidate.interview());</span><br></pre></td></tr></table></div></figure><p>å¯è¿­ä»£çš„ç±»å¦‚Listå’ŒSetä¹Ÿæ”¯æŒ<code>for-in</code><a href="https://www.dartlang.org/guides/libraries/library-tour#iteration" target="_blank" rel="noopener">iteration</a>ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> collection = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">in</span> collection) &#123;</span><br><span class="line">  <span class="built_in">print</span>(x); <span class="comment">// 0 1 2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="Switchå’Œcase">Switchå’Œcase<a href="post/Note-Learn-Dart#Switchå’Œcase"></a></h3><p>å€¼å¾—æ³¨æ„çš„æ˜¯switché‡Œé¢ä½¿ç”¨<code>==</code>ä½œä¸ºåˆ¤æ–­æ•´å‹ï¼Œå­—ç¬¦ä¸²æˆ–ç¼–è¯‘æœŸå¸¸é‡ã€‚ç”¨æ³•å¤§è‡´å’Œjavaå·®ä¸å¤šï¼Œä¸»è¦æ³¨æ„ä¸‹é¢è¿™æ ·çš„å†™æ³•æœ‰æ”¹è¿›ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> command = <span class="string">'OPEN'</span>;</span><br><span class="line"><span class="keyword">switch</span> (command) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'OPEN'</span>:</span><br><span class="line">    executeOpen();</span><br><span class="line">    <span class="comment">// é”™è¯¯ï¼š æ²¡æœ‰break ï¼ˆå¦‚æœå»æ‰executeOpen();ä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼‰</span></span><br><span class="line">  <span class="keyword">case</span> <span class="string">'CLOSED'</span>:</span><br><span class="line">    executeClosed();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æ”¹ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> command = <span class="string">'CLOSED'</span>;</span><br><span class="line"><span class="keyword">switch</span> (command) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'CLOSED'</span>:</span><br><span class="line">    executeClosed();</span><br><span class="line">    <span class="keyword">continue</span> nowClosed;</span><br><span class="line">  <span class="comment">// ç»§ç»­æ‰§è¡ŒnowClosedæ ‡ç­¾</span></span><br><span class="line"></span><br><span class="line">  nowClosed:</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'NOW_CLOSED'</span>:</span><br><span class="line">    <span class="comment">// Runs for both CLOSED and NOW_CLOSED.</span></span><br><span class="line">    executeNowClosed();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="æ–­è¨€">æ–­è¨€<a href="post/Note-Learn-Dart#æ–­è¨€"></a></h2><p>æ–­è¨€ä¸ä¼šå½±å“åˆ°ç”Ÿäº§ä»£ç ï¼Œåªåº”ç”¨åœ¨å¼€å‘è°ƒè¯•æ¨¡å¼ä¸‹</p><h2 id="å¼‚å¸¸">å¼‚å¸¸<a href="post/Note-Learn-Dart#å¼‚å¸¸"></a></h2><p>æ‚¨çš„Dartä»£ç å¯ä»¥æŠ›å‡ºæˆ–æ•è·å¼‚å¸¸ï¼Œå¼‚å¸¸æ˜¯å‘ç”Ÿäº†ä¸€äº›ä¸å¸Œæœ›çš„ã€‚å¦‚æœå¼‚å¸¸æ²¡æœ‰æ•è·å¤„ç†ï¼Œä¼šå¯¼è‡´ç¨‹åºç»ˆæ­¢ã€‚Dartæä¾›<a href="https://api.dartlang.org/stable/2.2.0/dart-core/Exception-class.html" target="_blank" rel="noopener">Exception</a>å’Œ<a href="https://api.dartlang.org/stable/2.2.0/dart-core/Error-class.html" target="_blank" rel="noopener">Error</a>ç±»å‹ï¼Œä»¥åŠè®¸å¤šé¢„å®šä¹‰çš„å­ç±»å‹ã€‚å½“ç„¶ï¼Œæ‚¨ä¹Ÿå¯ä»¥å®šä¹‰æ‚¨è‡ªå·±çš„å¼‚å¸¸ã€‚ç„¶è€Œå¯¹äºå¼‚å¸¸ï¼ŒDartç¨‹åºèƒ½æŠ›å‡ºä»»ä½•énullå¯¹è±¡ï¼Œä¸ä»…ä»…æ˜¯Exceptionå’ŒErrorå¯¹è±¡ã€‚</p><h3 id="Throw">Throw<a href="post/Note-Learn-Dart#Throw"></a></h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæŠ›å‡ºå¼‚å¸¸çš„åˆ—å­ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> FormatException(<span class="string">'Expected at least 1 section'</span>);</span><br></pre></td></tr></table></div></figure><p>æ‚¨ä¹Ÿå¯ä»¥éšæ„æŠ›å‡ºä¸€ä¸ªå¯¹è±¡ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="string">'å¼‚å¸¸ã€‚ã€‚ã€‚'</span>;</span><br></pre></td></tr></table></div></figure><p>ç”±äºæŠ›å‡ºå¼‚å¸¸æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå¯ä»¥é€šè¿‡<code>=&gt;</code>å¦‚ä¸‹è¡¨è¾¾ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> distanceTo(Point other) =&gt; <span class="keyword">throw</span> UnimplementedError();</span><br></pre></td></tr></table></div></figure><h3 id="Catch">Catch<a href="post/Note-Learn-Dart#Catch"></a></h3><p>æ•è·ä¸€ä¸ªå¼‚å¸¸</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  breedMoreLlamas();</span><br><span class="line">&#125; on OutOfLlamasException &#123;</span><br><span class="line">  buyMoreLlamas();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æ•è·å¤šä¸ªå¼‚å¸¸ï¼Œ<code>catch</code>å¯ä»¥å¾—åˆ°å¼‚å¸¸å¯¹è±¡çš„å¼•ç”¨ï¼Œå¦‚æœä¸æ˜ç¡®ç±»å‹ç›´æ¥ç”¨<code>catch</code>ï¼š</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  breedMoreLlamas();</span><br><span class="line">&#125; on OutOfLlamasException &#123;</span><br><span class="line">  <span class="comment">// ä¸€ä¸ªç‰¹å®šå¼‚å¸¸</span></span><br><span class="line">  buyMoreLlamas();</span><br><span class="line">&#125; on Exception <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="comment">// ä»»ä½•å…¶ä»–ç±»å‹Exceptionå¼‚å¸¸</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'Unknown exception: <span class="subst">$e<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125; catch (e) &#123;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  // ä¸æŒ‡å®šç±»å‹ï¼Œå¤„ç†æ‰€æœ‰</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  print('</span></span>Something really unknown: <span class="subst">$e<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;</span></span></span></span><br></pre></td></tr></table></div></figure><p><code>catch()</code>å¯æŒ‡å®šä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æŠ›å‡ºçš„å¼‚å¸¸å¯¹è±¡ï¼Œç¬¬äºŒä¸ªæ˜¯å †æ ˆï¼ˆ<a href="https://api.dartlang.org/stable/2.2.0/dart-core/StackTrace-class.html" target="_blank" rel="noopener">StackTrace</a>ï¼‰</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">// Â·Â·Â·</span></span><br><span class="line">&#125; on Exception <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">'Exception details:\n <span class="subst">$e<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125; catch (e, s) &#123;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  print('</span></span>Exception details:\n <span class="subst">$e<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">  print('</span></span>Stack trace:\n <span class="subst">$s<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;</span></span></span></span><br></pre></td></tr></table></div></figure><p>æ—¢è¦å¤„ç†å¼‚å¸¸ï¼Œåˆè¦è®©å¼‚å¸¸é‡æ–°è·‘å‡ºå»ä½¿ç”¨<code>rethrow</code>å…³é”®å­—</p><figure class="highlight dart"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> misbehave() &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">dynamic</span> foo = <span class="keyword">true</span>;</span><br><span class="line">    <span class="built_in">print</span>(foo++); <span class="comment">// è¿è¡Œæ—¶é”™è¯¯</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'misbehave() partially handled <span class="subst">$&#123;e.runtimeType&#125;</span>.'</span>);</span><br><span class="line">    <span class="keyword">rethrow</span>; <span class="comment">// è®©è°ƒç”¨è€…ç»§ç»­å¾—åˆ°å¼‚å¸¸</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="Finally">Finally<a href="post/Note-Learn-Dart#Finally"></a></h3><p>å’Œjavaä¸€æ ·</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Dartç¬”è®°&quot;&gt;Dartç¬”è®°&lt;a href=&quot;post/Note-Learn-Dart#Dartç¬”è®°&quot;&gt;&lt;/a&gt;&lt;/h1&gt;&lt;h2 id=&quot;å˜é‡&quot;&gt;å˜é‡&lt;a href=&quot;post/Note-Learn-Dart#å˜é‡&quot;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;åˆå§‹åŒ–ä¸€ä¸ªå˜é‡&lt;/p&gt;
      
    
    </summary>
    
    
      <category term="Dart" scheme="https://blog.xujiaji.com/tags/Dart/"/>
    
  </entry>
  
  <entry>
    <title>OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVBOï¼‰</title>
    <link href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven/index.html"/>
    <id>https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven/index.html</id>
    <published>2019-03-09T08:49:10.000Z</published>
    <updated>2019-04-12T17:44:07.238Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»è¯‘æ–‡</p></blockquote><p>åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Seven: An Introduction to Vertex Buffer Objects (VBOs)<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.learnopengles.com/android-lesson-seven-an-introduction-to-vertex-buffer-objects-vbos/" target="_blank" rel="noopener">http://www.learnopengles.com/android-lesson-seven-an-introduction-to-vertex-buffer-objects-vbos/</a><br><a id="more"></a></p><hr><h1 id="ä»‹ç»Vertex-Buffer-Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVBOï¼‰">ä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVBOï¼‰<a href="post/Learn-OpenGL-Lesson-Seven#ä»‹ç»Vertex-Buffer-Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVBOï¼‰"></a></h1><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>åœ¨è¿™èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•å®šä¹‰å’Œå¦‚ä½•å»ä½¿ç”¨<br>é¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼ˆVBOï¼‰ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬è¦è®²åˆ°çš„å‡ ç‚¹ï¼š<br><br>1.æ€æ ·ç”¨é¡¶ç‚¹ç¼“å†²å¯¹è±¡å®šä¹‰å’Œæ¸²æŸ“<br>2.å•ä¸ªç¼“å†²åŒºã€æ‰€æœ‰æ•°æ®æ‰“åŒ…è¿›å»ã€å¤šä¸ªç¼“å†²åŒºä¹‹é—´çš„åŒºåˆ«<br>3.é—®é¢˜å’Œé™·é˜±æˆ‘ä»¬å¦‚ä½•å–å¤„ç†å®ƒä»¬</td><td style="text-align:center"><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190309170313.png" alt="screenshot"></td></tr></tbody></table></div></div><h2 id="ä»€ä¹ˆæ˜¯é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨å®ƒä»¬ï¼Ÿ">ä»€ä¹ˆæ˜¯é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨å®ƒä»¬ï¼Ÿ<a href="post/Learn-OpenGL-Lesson-Seven#ä»€ä¹ˆæ˜¯é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨å®ƒä»¬ï¼Ÿ"></a></h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„è¯¾ç¨‹éƒ½æ˜¯å°†å¯¹è±¡æ•°æ®å­˜å‚¨åœ¨å®¢æˆ·ç«¯å†…å­˜ä¸­ï¼Œåªæœ‰åœ¨æ¸²æŸ“æ—¶å°†å…¶ä¼ è¾“åˆ°GPUä¸­ã€‚æ²¡æœ‰å¤§é‡æ•°æ®ä¼ è¾“æ—¶ï¼Œè¿™å¾ˆå¥½ï¼Œä½†éšç€æˆ‘ä»¬çš„åœºæ™¯è¶Šæ¥è¶Šå¤æ‚ï¼Œæœ‰æ›´å¤šçš„ç‰©ä½“å’Œä¸‰è§’å½¢ï¼Œè¿™ä¼šç»™GPUå’Œå†…å­˜å¢åŠ é¢å¤–çš„æˆæœ¬ã€‚</p><p>æˆ‘ä»¬èƒ½åšäº›ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ¯å¸§ä»å®¢æˆ·ç«¯å†…å­˜ä¼ è¾“é¡¶ç‚¹ä¿¡æ¯ï¼Œä¿¡æ¯å°†è¢«ä¼ è¾“ä¸€æ¬¡ï¼Œç„¶åæ¸²æŸ“å™¨å°†ä»è¯¥å›¾å½¢å­˜å‚¨å™¨ç¼“å­˜ä¸­å¾—åˆ°æ•°æ®ã€‚</p><h2 id="å‰ææ¡ä»¶">å‰ææ¡ä»¶<a href="post/Learn-OpenGL-Lesson-Seven#å‰ææ¡ä»¶"></a></h2><p>è¯·é˜…è¯»<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a>ä»‹ç»å¦‚ä½•ä»å®¢æˆ·ç«¯çš„å†…å­˜ä¸Šä¼ é¡¶ç‚¹æ•°æ®ã€‚äº†è§£OpenGL ESå¦‚ä½•ä¸é¡¶ç‚¹æ•°ç»„ä¸€èµ·å·¥ä½œå¯¹äºç†è§£æœ¬è¯¾è‡³å…³é‡è¦ã€‚</p><h2 id="æ›´è¯¦ç»†çš„äº†è§£å®¢æˆ·ç«¯ç¼“å†²åŒº">æ›´è¯¦ç»†çš„äº†è§£å®¢æˆ·ç«¯ç¼“å†²åŒº<a href="post/Learn-OpenGL-Lesson-Seven#æ›´è¯¦ç»†çš„äº†è§£å®¢æˆ·ç«¯ç¼“å†²åŒº"></a></h2><p>ä¸€ä½†äº†è§£äº†å¦‚ä½•ä½¿ç”¨å®¢æˆ·ç«¯å†…å­˜è¿›è¡Œæ¸²æŸ“ï¼Œåˆ‡æ¢åˆ°ä½¿ç”¨VBOå®é™…ä¸Šå¹¶ä¸å¤ªéš¾ã€‚å…¶ä¸»è¦çš„ä¸åŒåœ¨äºæ·»åŠ äº†ä¸€ä¸ªä¸Šä¼ æ•°æ®åˆ°å›¾å½¢å†…å­˜çš„é¢å¤–æ­¥éª¤ï¼Œä»¥åŠæ¸²æŸ“æ—¶æ·»åŠ äº†ç»‘å®šè¿™ä¸ªç¼“å†²åŒºçš„é¢å¤–è°ƒç”¨ã€‚</p><p>æœ¬èŠ‚è¯¾å°†ä½¿ç”¨å››ç§ä¸åŒçš„æ¨¡å¼ï¼š</p><ol><li>å®¢æˆ·ç«¯ï¼Œå•ç‹¬çš„ç¼“å†²åŒº</li><li>å®¢æˆ·ç«¯ï¼Œæ‰“åŒ…çš„ç¼“å†²</li><li>é¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼Œå•ç‹¬çš„ç¼“å†²åŒº</li><li>é¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼Œæ‰“åŒ…çš„ç¼“å†²</li></ol><p>æ— è®ºæˆ‘ä»¬æ˜¯å¦ä½¿ç”¨é¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼Œæˆ‘ä»¬éƒ½éœ€è¦å…ˆå°†æˆ‘ä»¬çš„æ•°æ®å­˜å‚¨åœ¨å®¢æˆ·ç«¯æœ¬åœ°ç¼“å†²åŒºã€‚ä¼šæƒ³åˆ°<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">ç¬¬ä¸€è¯¾</a>ä¸­OpenGL ES æ˜¯ä¸€ä¸ªæœ¬åœ°ç³»ç»Ÿåº“ï¼Œè€Œjavaæ˜¯è¿è¡Œåœ¨Androidä¸Šçš„ä¸€ä¸ªè™šæ‹Ÿæœºä¸­ã€‚å¦‚ä½•å»æ¡¥æ¥è¿™ä¸ªè·ç¦»ï¼Ÿæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ç»„ç‰¹æ®Šçš„ç¼“å†²åŒºç±»æ¥åœ¨æœ¬åœ°å †ä¸Šåˆ†é…å†…å­˜ï¼Œå¹¶ä½¿ä½¿å…¶ä¾›OpenGLè®¿é—®ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Java æ•°ç»„</span></span><br><span class="line"><span class="keyword">float</span>[] cubePositions;</span><br><span class="line">...</span><br><span class="line"><span class="comment">// æµ®ç‚¹ç¼“å†²åŒº</span></span><br><span class="line"><span class="keyword">final</span> FloatBuffer cubePositionsBuffer;</span><br><span class="line">...</span><br><span class="line"><span class="comment">// åœ¨æœ¬åœ°å †ä¸Šç›´æ¥åˆ†é…ä¸€å—å†…å­˜</span></span><br><span class="line"><span class="comment">// å­—èŠ‚å¤§å°ä¸ºcubePositionsçš„é•¿åº¦ä¹˜ä»¥æ¯ä¸ªæµ®ç‚¹æ•°çš„å­—èŠ‚å¤§å°</span></span><br><span class="line"><span class="comment">// æ¯ä¸ªfloatçš„å­—èŠ‚å¤§å°ä¸º4ï¼Œå› ä¸ºfloatæ˜¯32ä½æˆ–4å­—èŠ‚</span></span><br><span class="line">cubePositionsBuffer = ByteBuffer.allocateDirect(cubePositions.length * BYTES_PRE_FLOAT)</span><br><span class="line"><span class="comment">// æµ®ç‚¹ä¼šä»¥å¤§ç«¯ï¼ˆbig-endianï¼‰æˆ–å°æ®µï¼ˆlittle-endianï¼‰çš„é¡ºåºæ’åˆ—</span></span><br><span class="line"><span class="comment">// æˆ‘æƒ³è®©å…¶åŒæœ¬åœ°å¹³å°ç›¸åŒçš„æ’åˆ—</span></span><br><span class="line">.order(ByteOrder.nativeOrder())</span><br><span class="line"><span class="comment">// åœ¨è¿™ä¸ªå­—èŠ‚ç¼“å†²åŒºä¸Šç»™æˆ‘ä»¬ä¸€ä¸ªæµ®ç‚¹è§†è§’</span></span><br><span class="line">.asFloatBuffer();</span><br></pre></td></tr></table></div></figure><p>å°†Javaå †ä¸Šæ•°æ®è½¬æ¢åˆ°æœ¬åœ°å †ä¸Šï¼Œå°±æ˜¯ä¸¤æ–¹æ³•è°ƒç”¨çš„äº‹æƒ…ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†javaå †ä¸Šçš„æ•°æ®æ‹·è´åˆ°æœ¬åœ°å †</span></span><br><span class="line">cubePositionsBuffer.put(cubePositions)</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡ç½®è¿™ä¸ªç¼“å†²åŒºå¼€å§‹çš„ç¼“å†²ä½ç½®</span></span><br><span class="line">.position(<span class="number">0</span>);</span><br></pre></td></tr></table></div></figure><p>ç¼“å†²ä½ç½®çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿé€šå¸¸ï¼ŒJavaæ²¡æœ‰ä¸ºæˆ‘ä»¬æä¾›ä¸€ç§åœ¨å†…å­˜ä¸­ä½¿ç”¨<a href="https://en.wikipedia.org/wiki/Pointer_(computer_programming)" target="_blank" rel="noopener">æŒ‡é’ˆ</a>ï¼Œä»»æ„æŒ‡å®šä½ç½®çš„æ–¹æ³•ã€‚ç„¶è€Œï¼Œè®¾ç½®ç¼“å†²åŒºçš„ä½ç½®åœ¨åŠŸèƒ½ä¸Šç­‰åŒäºæ›´æ”¹æŒ‡å‘å†…å­˜å—æŒ‡é’ˆçš„å€¼ã€‚é€šè¿‡æ”¹å˜æŒ‡é’ˆçš„ä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç¼“å†²åŒºä¸­ä»»æ„çš„å†…å­˜ä½ç½®ä¼ é€’ç»™OpenGLè°ƒç”¨ã€‚å½“æˆ‘ä»¬ä½¿ç”¨æ‰“åŒ…çš„ç¼“å†²ä½œä¸šæ—¶ï¼Œè¿™å°†æ´¾ä¸Šç”¨åœºã€‚</p><p>ä¸€ä½†æ•°æ®å­˜æ”¾åˆ°æœ¬åœ°å †ä¸Šï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦é•¿æ—¶é—´æŒæœ‰float[]æ•°ç»„äº†ï¼Œæˆ‘ä»¬å¯ä»¥è®©åƒåœ¾å›æ”¶å™¨æ¸…ç†å®ƒã€‚</p><p>ä½¿ç”¨å®¢æˆ·ç«¯ç¼“å†²åŒºè¿›è¡Œæ¸²æŸ“éå¸¸ç®€å•ï¼Œæˆ‘ä»¬ä»…éœ€è¦å¯åŠ¨å¯¹åº”å±æ€§çš„é¡¶ç‚¹ç´ ç»„ï¼Œå¹¶å°†æŒ‡é’ˆä¼ é€’ç»™æˆ‘ä»¬çš„æ•°æ®ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ å…¥ä½ç½®ä¿¡æ¯</span></span><br><span class="line">GLES20.glEnableVertexAttribArray(mPositionHandle);</span><br><span class="line">GLES20.glVertexAttriPointer(mPositionHandle, POSITION_DATA_SIZE,</span><br><span class="line">    GLES20.GL_FLOAT, <span class="keyword">false</span>, <span class="number">0</span>, mCubePositions)</span><br></pre></td></tr></table></div></figure><p><a href="https://www.khronos.org/registry/OpenGL-Refpages/es2.0/xhtml/glVertexAttribPointer.xml" target="_blank" rel="noopener">glVertexAttriPointer</a>å‚æ•°è¯´æ˜ï¼š</p><ul><li><em>mPositionHandleï¼š</em> æˆ‘ä»¬ç€è‰²å™¨ç¨‹åºçš„ä½ç½®å±æ€§ç´¢å¼•</li><li><em>POSITION_DATA_SIZEï¼š</em> å®šä¹‰è¿™ä¸ªå±æ€§éœ€è¦å¤šå°‘ä¸ªfloatå…ƒç´ </li><li><em>GL_FLOATï¼š</em> æ¯ä¸ªå…ƒç´ çš„ç±»å‹</li><li><em>falseï¼š</em> å®šç‚¹æ•°æ®å› è¯¥æ ‡å‡†åŒ–å—ï¼Ÿç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯æµ®ç‚¹æ•°æ®ï¼Œå› æ­¤ä¸é€‚ç”¨ã€‚</li><li><em>0ï¼š</em> è·¨åº¦ï¼Œè®¾ç½®0ï¼Œä»¥ä¸ºç€åº”å®‰é¡ºåºè¯»å–ã€‚ç¬¬ä¸€è¯¾ä¸­è®¾ç½®ä¸º7ï¼Œè¡¨ç¤ºæ¯æ¬¡è¯»å–è·¨åº¦7ä¸ªä½ç½®</li><li><em>mCubePositionsï¼š</em> æŒ‡å‘ç¼“å†²åŒºçš„çš„æŒ‡é’ˆï¼ŒåŒ…å«æ‰€æœ‰ä½ç½®æ•°æ®</li></ul><h2 id="ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒº">ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒº<a href="post/Learn-OpenGL-Lesson-Seven#ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒº"></a></h2><p>ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒºæ˜¯éå¸¸ç›¸ä¼¼çš„ï¼Œæ›¿æ¢äº†æ¯ä¸ªä½ç½®ã€æ³•çº¿ç­‰çš„ç¼“å†²åŒºï¼Œç°åœ¨ä¸€ä¸ªç¼“å†²åŒºå°†åŒ…å«æ‰€æœ‰è¿™äº›æ•°æ®ã€‚ä¸åŒç‚¹çœ‹ä¸‹é¢ï¼š</p><blockquote><p>ä½¿ç”¨å•ç¼“å†²åŒº</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">positions = X,Y,Z,X,Y,Z,X,Y,Z,...</span><br><span class="line">colors = R,G,B,A,R,G,B,A,...</span><br><span class="line">textureCoordinates = S,T,S,T,S,T...</span><br></pre></td></tr></table></div></figure><blockquote><p>ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒº</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">buffer = X,Y,Z,R,G,B,A,S,T...</span><br></pre></td></tr></table></div></figure><p>ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒºçš„å¥½å¤„æ˜¯å®ƒå°†ä¼šä½¿GPUæ›´é«˜æ•ˆçš„æ¸²æŸ“ï¼Œå› ä¸ºæ¸²æŸ“ä¸‰è§’å½¢æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯éƒ½ä½äºå†…å­˜åŒä¸€å—åœ°æ–¹ã€‚ç¼ºç‚¹æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨åŠ¨æ€æ•°æ®ï¼Œæ›´æ–°å¯èƒ½ä¼šæ›´å›°éš¾ï¼Œæ›´æ…¢ã€‚</p><p>å½“æˆ‘ä»¬ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒºæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸‹å‡ ç§æ–¹å¼æ›´æ”¹æ¸²æŸ“è°ƒç”¨ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰OpenGL<code>è·¨åº¦ï¼ˆstrideï¼‰</code> ï¼Œå®šä¹‰ä¸€ä¸ªé¡¶ç‚¹çš„å­—èŠ‚æ•°ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> stride = (POSITION_DATA_SIZE + NORMAL_DATA_SIZE + TEXTURE_COORDINATE_DATA_SIZE)</span><br><span class="line">    * BYTES_PER_FLOAT;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼ å…¥ä½ç½®ä¿¡æ¯</span></span><br><span class="line">mCubeBuffer.position(<span class="number">0</span>);</span><br><span class="line">GLES20.glEnableVertexAttribArray(mPositionHandle);</span><br><span class="line">GLES20.glVertexAttribPointer(mPositionHandle, POSITION_DATA_SIZE,</span><br><span class="line">    GLES20.GL_FLOAT, <span class="keyword">false</span>, stride, mCubeBuffer);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼ å…¥æ³•çº¿ä¿¡æ¯</span></span><br><span class="line">mCubeBuffer.position(POSITION_DATA_SIZE);</span><br><span class="line">GLES20.glEnableVertexAttribArray(mNormalHandle);</span><br><span class="line">GLES20.glVertexAttribPointer(mNormalHandle, NORMAL_DATA_SIZE,</span><br><span class="line">    GLES20.GL_FLOAT, <span class="keyword">false</span>, stride, mCubeBuffer);</span><br><span class="line">...</span><br></pre></td></tr></table></div></figure><p>è¿™ä¸ªè·¨åº¦å‘Šè¯‰OpenGL ESä¸‹ä¸€ä¸ªé¡¶ç‚¹çš„åŒæ ·çš„å±æ€§è¦å†è·¨å¤šè¿œæ‰èƒ½æ‰¾åˆ°ã€‚ä¾‹å¦‚ï¼šå¦‚æœå…ƒç´ 0æ˜¯ç¬¬ä¸€ä¸ªé¡¶ç‚¹çš„å¼€å§‹ä½ç½®ï¼Œå¹¶ä¸”è¿™é‡Œæ¯ä¸ªé¡¶ç‚¹æœ‰8ä¸ªå…ƒç´ ï¼Œç„¶åè¿™ä¸ªè·¨åº¦å°†æ˜¯8ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯32ä¸ªå­—èŠ‚ã€‚ä¸‹ä¸€ä¸ªé¡¶ç‚¹çš„ä½ç½®å°†æ‰¾åˆ°ç¬¬8ä¸ªå…ƒç´ ï¼Œä¸‹ä¸‹ä¸ªé¡¶ç‚¹çš„ä½ç½®å°†æ‰¾åˆ°ç¬¬16ä¸ªå…ƒç´ ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>è¯·è®°ä½ï¼Œä¼ é€’ç»™<code>glVertexAttriPointer</code>çš„è·¨åº¦å•ä½æ˜¯å­—èŠ‚ï¼Œè€Œä¸æ˜¯å…ƒç´ ï¼Œå› æ­¤è¯·è®°ä½è¿›è¡Œè¯¥è½¬æ¢ã€‚</p><p>æ³¨æ„ï¼Œå½“æˆ‘ä»¬ä»æŒ‡å®šä½ç½®åˆ‡æ¢åˆ°æŒ‡å®šæ³•çº¿æ—¶ï¼Œæˆ‘ä»¬è¦æ›´æ”¹ç¼“å†²åŒºçš„å…¶å®ä½ç½®ã€‚è¿™æ˜¯æˆ‘ä»¬ä¹‹å‰æåˆ°çš„æŒ‡é’ˆç®—æ³•ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨OpengGL ESæ—¶ç”¨Javaåšçš„æ–¹å¼ã€‚æˆ‘ä»¬ä»ç„¶ä½¿ç”¨åŒä¸€ä¸ªç¼“å†²åŒº<code>mCubeBuffer</code>ï¼Œä½†æ˜¯æˆ‘ä»¬å‘Šè¯‰OpenGLä»ä½ç½®æ•°æ®åçš„ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹è¯»å–æ³•çº¿ä¿¡æ¯ã€‚æˆ‘ä»¬ä¹Ÿå‘Šè¯‰OpenGLä¸‹ä¸€ä¸ªæ³•çº¿è¦è·¨è¶Š8ä¸ªå…ƒç´ ï¼ˆä¹Ÿå¯ä»¥è¯´æ˜¯32ä¸ªå­—èŠ‚ï¼‰å¼€å§‹ã€‚</p><h2 id="Dalvikå’Œæœ¬åœ°å †ä¸Šçš„å†…å­˜">Dalvikå’Œæœ¬åœ°å †ä¸Šçš„å†…å­˜<a href="post/Learn-OpenGL-Lesson-Seven#Dalvikå’Œæœ¬åœ°å †ä¸Šçš„å†…å­˜"></a></h2><p>å¦‚æœä½ åœ¨æœ¬åœ°å †ä¸Šåˆ†é…å¤§é‡å†…å­˜æŠŠå¹¶å°†å…¶é‡Šæ”¾ï¼Œæ‚¨è¿Ÿæ—©ä¼šé‡åˆ°å¿ƒçˆ±çš„<code>OutOfMemoryError</code> ï¼ŒèƒŒåæœ‰å‡ ä¸ªåŸå› ï¼š</p><ol><li>æ‚¨å¯èƒ½è®¤ä¸ºé€šè¿‡è®©å¼•ç”¨è¶…å‡ºèŒƒå›´è€Œè‡ªåŠ¨é‡Šæ”¾äº†å†…å­˜ï¼Œä½†æ˜¯æœ¬åœ°å†…å­˜ä¼¼ä¹éœ€è¦ä¸€äº›é¢å¤–çš„GCå‘¨æœŸæ‰èƒ½å®Œå…¨æ¸…ç†ï¼Œå¦‚æœæ²¡æœ‰è¶³å¤Ÿå¯ç”¨çš„å†…å­˜å¹¶ä¸”å°šæœªé‡Šæ”¾æœ¬åœ°å†…å­˜ï¼ŒDalvikå°†æŠ›å‡ºå¼‚å¸¸ã€‚</li><li>æœ¬åœ°å †å¯èƒ½ä¼š<a href="https://stackoverflow.com/questions/6892676/android-bitmap-limit-preventing-java-lang-outofmemory" target="_blank" rel="noopener">ç¢ç‰‡åŒ–</a>ï¼Œè°ƒç”¨<code>allocateDirect()</code>å°†ä¼šè«åå…¶å¦™å¤±è´¥ï¼Œå°½ç®¡ä¼¼ä¹æœ‰è¶³å¤Ÿçš„å†…å­˜å¯ç”¨ã€‚æœ‰æ—¶å®ƒæœ‰åŠ©äºè¿›è¡Œè¾ƒå°çš„åˆ†é…ï¼Œé‡Šæ”¾å®ƒï¼Œç„¶åå†æ¬¡å°è¯•æ›´å¤§çš„åˆ†é…ã€‚</li></ol><p>å¦‚ä½•èƒ½é¿å…è¿™äº›é—®é¢˜ï¼Ÿé™¤äº†å¸Œæœ›Googleåœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­æ”¹è¿›Dalvikçš„è¡Œä¸ºä¹‹å¤–ï¼Œå¹¶ä¸å¤šã€‚æˆ–è€…é€šè¿‡æœ¬åœ°ä»£ç è¿›è¡Œåˆ†é…æˆ–é¢„å…ˆåˆ†é…ä¸€å¤§å—å†…å­˜æ¥è‡ªè¡Œç®¡ç†å †ï¼Œå¹¶æ ¹æ®æ­¤åˆ†ç¦»ç¼“å†²åŒºã€‚</p><blockquote><p>æ³¨æ„ï¼šè¿™äº›ä¿¡æ¯æœ€åˆå†™äº2012å¹´åˆï¼Œç°åœ¨Androidä½¿ç”¨äº†ä¸€ä¸ªåä¸ºARTçš„ä¸åŒè¿è¡Œæ—¶ï¼Œå®ƒå¯èƒ½åœ¨ç›¸åŒç¨‹åº¦ä¸Šä¸ä¼šé‡åˆ°è¿™äº›é—®é¢˜ã€‚</p></blockquote><h2 id="ç§»åŠ¨åˆ°é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡">ç§»åŠ¨åˆ°é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡<a href="post/Learn-OpenGL-Lesson-Seven#ç§»åŠ¨åˆ°é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡"></a></h2><p>ç°åœ¨æˆ‘ä»¬å·²ç»å›é¡¾äº†ä½¿ç”¨å®¢æˆ·ç«¯ç¼“å†²åŒºï¼Œè®©æˆ‘ä»¬ç»§ç»­è®¨è®ºé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å›é¡¾å‡ ä¸ªéå¸¸é‡è¦çš„é—®é¢˜ï¼š</p><h3 id="1-ç¼“å†²åŒºå¿…é¡»åˆ›å»ºåœ¨ä¸€ä¸ªæœ‰æ•ˆçš„OpenGLä¸Šä¸‹æ–‡ä¸­">1. ç¼“å†²åŒºå¿…é¡»åˆ›å»ºåœ¨ä¸€ä¸ªæœ‰æ•ˆçš„OpenGLä¸Šä¸‹æ–‡ä¸­<a href="post/Learn-OpenGL-Lesson-Seven#1-ç¼“å†²åŒºå¿…é¡»åˆ›å»ºåœ¨ä¸€ä¸ªæœ‰æ•ˆçš„OpenGLä¸Šä¸‹æ–‡ä¸­"></a></h3><p>è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„è§‚ç‚¹ï¼Œä½†æ˜¯å®ƒä»…ä»…æé†’ä½ å¿…é¡»ç­‰åˆ°<code>onSurfaceCreated()</code>æ‰§è¡Œï¼Œå¹¶ä¸”ä½ å¿…é¡»æ³¨æ„OpenGL ESè°ƒç”¨æ˜¯åœ¨GLçº¿ç¨‹ä¸Šå®Œæˆçš„ã€‚<br>çœ‹è¿™ä¸ªæ–‡æ¡£ï¼š<a href="https://developer.apple.com/library/archive/documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/Introduction/Introduction.html" target="_blank" rel="noopener">iOS OpenGL ESç¼–ç¨‹æŒ‡å—</a>ï¼Œå®ƒå¯èƒ½æ˜¯ä¸ºiOSå†™çš„ï¼Œä½†æ˜¯OpenGL ESåœ¨Androidçš„è¡Œä¸ºå’Œè¿™ç›¸åŒã€‚</p><h3 id="2-é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´å›¾å½¢é©±åŠ¨ç¨‹åºå´©æºƒ">2. é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´å›¾å½¢é©±åŠ¨ç¨‹åºå´©æºƒ<a href="post/Learn-OpenGL-Lesson-Seven#2-é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´å›¾å½¢é©±åŠ¨ç¨‹åºå´©æºƒ"></a></h3><p>å½“ä½ ä½¿ç”¨é¡¶ç‚¹ç¼“å†²å¯¹è±¡æ—¶ï¼Œéœ€è¦æ³¨æ„ä¼ é€’çš„æ•°æ®ã€‚ä¸å½“çš„å€¼å°†ä¼šå¯¼è‡´OpenGL ESç³»ç»Ÿåº“æˆ–å›¾å½¢é©±åŠ¨åº“æœ¬åœ°å´©æºƒã€‚åœ¨æˆ‘çš„Nexus Sä¸Šï¼Œä¸€äº›æ¸¸æˆå®Œå…¨å¡åœ¨æˆ‘çš„æ‰‹æœºä¸Šæˆ–å¯¼è‡´æ‰‹æœºé‡å¯ï¼Œå› ä¸ºå›¾å½¢é©±åŠ¨å› ä¸ºä»–ä»¬çš„æŒ‡ä»¤å´©æºƒã€‚å¹¶éæ‰€æœ‰çš„å´©æºƒéƒ½ä¼šé”å®šæ‚¨çš„è®¾å¤‡ï¼Œä½†è‡³å°‘æ‚¨ä¸ä¼šçœ‹åˆ°â€œæ­¤åº”ç”¨å·²åœæ­¢å·¥ä½œâ€çš„å¯¹è¯æ¡†ã€‚æ‚¨çš„æ´»åŠ¨å°†åœ¨æ²¡æœ‰è­¦å‘Šçš„æƒ…å†µä¸‹é‡æ–°å¯åŠ¨ï¼Œæ‚¨å°†è·å¾—å”¯ä¸€çš„ä¿¡æ¯å¯èƒ½æ˜¯æ—¥å¿—ä¸­çš„æœ¬åœ°è°ƒè¯•è·Ÿè¸ªã€‚</p><h2 id="ä¸Šä¼ é¡¶ç‚¹æ•°æ®åˆ°GPU">ä¸Šä¼ é¡¶ç‚¹æ•°æ®åˆ°GPU<a href="post/Learn-OpenGL-Lesson-Seven#ä¸Šä¼ é¡¶ç‚¹æ•°æ®åˆ°GPU"></a></h2><p>è¦ä¸Šä¼ æ•°æ®åˆ°GPUï¼Œæˆ‘ä»¬éœ€è¦åƒä»¥å‰ä¸€æ ·åˆ›å»ºå®¢æˆ·ç«¯ç¼“å†²åŒºçš„ç›¸åŒæ­¥éª¤ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">cubePositionsBuffer = ByteBuffer.allocateDirect(cubePositions.length * BYTES_PER_FLOAT)</span><br><span class="line">.order(ByteOrder.nativeOrder()).asFloatBuffer();</span><br><span class="line">cubePositionsBuffer.put(cubePositions).position(<span class="number">0</span>);</span><br><span class="line">...</span><br></pre></td></tr></table></div></figure><p>ä¸€æ—¦æˆ‘ä»¬æœ‰äº†å®¢æˆ·ç«¯ç¼“å†²åŒºï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸‹æŒ‡ä»¤å°†æ•°æ®ä»å®¢æˆ·ç«¯å†…å­˜ä¸Šä¼ åˆ°GPUï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é¦–å…ˆï¼Œæˆ‘ä»¬è¦å°½å¯èƒ½çš„ç”³è¯·æ›´å¤šçš„ç¼“å†²åŒº</span></span><br><span class="line"><span class="comment">// è¿™å°†ä¸ºæˆ‘ä»¬æä¾›è¿™äº›ç¼“å†²åŒºçš„handle</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> buffers[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>];</span><br><span class="line">GLES20.glGenBuffers(<span class="number">3</span>, buffers, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»‘å®šè¿™ä¸ªç¼“å†²åŒºï¼Œå°†æ¥çš„æŒ‡ä»¤å°†å•ç‹¬å½±å“æ­¤ç¼“å†²åŒº</span></span><br><span class="line">GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, buffers[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®¢æˆ·ç«¯å†…å­˜ä¸­çš„æ•°æ®è½¬ç§»åˆ°ç¼“å†²åŒº</span></span><br><span class="line"><span class="comment">// æˆ‘ä»¬èƒ½åœ¨æ­¤æ¬¡è°ƒåŠ¨åé‡Šæ”¾å®¢æˆ·ç«¯å†…å­˜</span></span><br><span class="line">GLES20.glBufferData(GLES20.GL_ARRAY_BUFFER, cubePositionsBuffer.capacity() * BYTES_PER_FLOAT,</span><br><span class="line">    cubePositionsBuffer, GLES20.GL_STATIC_DRAW);</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡è¦æé†’ï¼šå®Œæˆç¼“å†²åï¼Œä»ç¼“å†²åŒºå–æ¶ˆç»‘å®š</span></span><br><span class="line">GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, <span class="number">0</span>);</span><br></pre></td></tr></table></div></figure><p>ä¸€æ—¦æ•°æ®ä¸Šä¼ åˆ°äº†OpenGL ESï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡Šæ”¾è¿™ä¸ªå®¢æˆ·ç«¯å†…å­˜ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦å†ç»§ç»­ä¿ç•™å®ƒã€‚è¿™æ˜¯<a href="http://www.learnopengles.com/android-lesson-seven-an-introduction-to-vertex-buffer-objects-vbos/GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER,%200);" target="_blank" rel="noopener">glBufferData</a>çš„è§£é‡Šï¼š</p><ul><li><em>GL_ARRAY_BUFFERï¼š</em> è¿™ä¸ªç¼“å†²åŒºåŒ…å«é¡¶ç‚¹æ•°æ®æ•°ç»„</li><li><em>cubePositionsBuffer.capacity() </em> BYTES_PER_FLOATï¼š* è¿™ä¸ªç¼“å†²åŒºå› è¯¥åŒ…å«çš„å­—èŠ‚æ•°</li><li><em>cubePositionsBufferï¼š</em> å°†è¦æ‹·è´åˆ°è¿™ä¸ªé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡çš„æº</li><li><em>GL_STATIC_DRAWï¼š</em> è¿™ä¸ªç¼“å†²åŒºä¸ä¼šåŠ¨æ€æ›´æ–°</li></ul><p>æˆ‘ä»¬å¯¹<code>glVertexAttribPointer</code>çš„è°ƒç”¨çœ‹èµ·æ¥æœ‰ç‚¹å„¿ä¸åŒï¼Œå› ä¸ºæœ€åä¸€ä¸ªå‚æ•°ç°åœ¨æ˜¯åç§»é‡è€Œä¸æ˜¯æŒ‡å‘å®¢æˆ·ç«¯å†…å­˜çš„æŒ‡é’ˆï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ å…¥ä½ç½®ä¿¡æ¯</span></span><br><span class="line">GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, mCubePositionsBufferIdx);</span><br><span class="line">GLES20.glEnableVertexAttribArray(mPositionHandle);</span><br><span class="line">mGlEs20.glVertexAttribPointer(mPositionHandle, POSITION_DATA_SIZE, GLES20.GL_FLOAT, <span class="keyword">false</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">...</span><br></pre></td></tr></table></div></figure><p>åƒä»¥å‰ä¸€æ ·ï¼Œæˆ‘ä»¬ç»‘å®šåˆ°ç¼“å†²åŒºï¼Œç„¶åå¯ç”¨é¡¶ç‚¹æ•°ç»„ã€‚ç”±äºç¼“å†²åŒºæ—©å·²ç»‘å®šï¼Œå½“ä»ç¼“å†²åŒºè¯»å–æ•°æ®æ—¶ï¼Œæˆ‘ä»¬ä»…éœ€è¦å‘Šè¯‰OpenGLå¼€å§‹çš„åç§»ã€‚å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„ç‰¹å®šçš„ç¼“å†²åŒºï¼Œæˆ‘ä»¬ä¼ å…¥åç§»é‡0ã€‚å¦è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰ç»‘å®šæ¥è°ƒç”¨<code>glVertexAttribPointer</code>ï¼Œå› ä¸ºå®˜æ–¹SKDç¼ºå°‘æ­¤ç‰¹å®šå‡½æ•°è°ƒç”¨ã€‚</p><p>ä¸€æ—¦æˆ‘ä»¬ç”¨ç¼“å†²åŒºç»˜åˆ¶å®Œæˆï¼Œæˆ‘ä»¬åº”è¯¥è§£é™¤å®ƒï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, <span class="number">0</span>);</span><br></pre></td></tr></table></div></figure><p>å½“æˆ‘ä»¬ä¸æƒ³åœ¨ä¿ç•™ç¼“å†²åŒºæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é‡Šæ”¾å†…å­˜ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">int</span>[] buffersToDelete = <span class="keyword">new</span> <span class="keyword">int</span>[] &#123; mCubePositionsBufferIdx, mCubeNormalsBufferIdx,</span><br><span class="line">    mCubeTexCoordsBufferIdx &#125;;</span><br><span class="line">GLES20.glDeleteBuffers(buffersToDelete.length, buffersToDelete, <span class="number">0</span>);</span><br></pre></td></tr></table></div></figure><h2 id="æ‰“åŒ…é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡">æ‰“åŒ…é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡<a href="post/Learn-OpenGL-Lesson-Seven#æ‰“åŒ…é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡"></a></h2><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å•ä¸ªç¼“å†²åŒºæ‰“åŒ…é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡çš„æ‰€æœ‰é¡¶ç‚¹æ•°æ®ã€‚æ‰“åŒ…é¡¶ç‚¹ç¼“å†²åŒºçš„åˆ›å»ºå’Œä¸Šé¢ç›¸åŒï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯æˆ‘ä»¬ä»æ‰“åŒ…å®¢æˆ·ç«¯ç¼“å†²åŒºå¼€å§‹ã€‚æ‰“åŒ…ç¼“å†²åŒºæ¸²æŸ“ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œé™¤äº†æˆ‘ä»¬éœ€è¦ä¼ åç§»é‡ï¼Œå°±åƒåœ¨å®¢æˆ·ç«¯å†…å­˜ä¸­ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒºä¸€æ ·ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> stride = (POSITION_DATA_SIZE + NORMAL_DATA_SIZE + TEXTURE_COORDINATE_DATA_SIZE)</span><br><span class="line">    * BYTES_PER_FLOAT;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼ å…¥ä½ç½®ä¿¡æ¯</span></span><br><span class="line">GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, mCubeBufferIdx);</span><br><span class="line">GLES20.glEnableVertexAttribArray(mPositionHandle);</span><br><span class="line">mGlEs20.glVertexAttribPointer(mPositionHandle, POSITION_DATA_SIZE,</span><br><span class="line">    GLES20.GL_FLOAT, <span class="keyword">false</span>, stride, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼ å…¥æ³•çº¿ä¿¡æ¯</span></span><br><span class="line">GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, mCubeBufferIdx);</span><br><span class="line">GLES20.glEnableVertexAttribArray(mNormalHandle);</span><br><span class="line">mGlEs20.glVertexAttribPointer(mNormalHandle, NORMAL_DATA_SIZE,</span><br><span class="line">    GLES20.GL_FLOAT, <span class="keyword">false</span>, stride, POSITION_DATA_SIZE * BYTES_PER_FLOAT);</span><br><span class="line">...</span><br></pre></td></tr></table></div></figure><p>æ³¨æ„ï¼šåç§»é‡éœ€è¦ä»¥å­—èŠ‚ä¸ºå•ä½æŒ‡å®šã€‚ä¸ä¹‹å‰ä¸€æ ·è§£é™¤ç»‘å®šå’Œåˆ é™¤ç¼“å†²åŒºçš„ç›¸åŒæ³¨æ„äº‹é¡¹ä¹Ÿé€‚ç”¨ã€‚</p><h2 id="å°†é¡¶ç‚¹æ•°æ®æ”¾åˆ°ä¸€èµ·">å°†é¡¶ç‚¹æ•°æ®æ”¾åˆ°ä¸€èµ·<a href="post/Learn-OpenGL-Lesson-Seven#å°†é¡¶ç‚¹æ•°æ®æ”¾åˆ°ä¸€èµ·"></a></h2><p>è¿™èŠ‚è¯¾å·²æ„å»ºäº†å¤šç«‹æ–¹ä½“ç»„æˆçš„ç«‹æ–¹ä½“ï¼Œæ¯ä¸ªé¢çš„ç«‹æ–¹ä½“æ•°é‡ä½“ç›¸åŒã€‚å®ƒå°†åœ¨1x1x1ç«‹æ–¹ä½“å’Œ16x16x16ç«‹æ–¹ä½“ä¹‹é—´æ„å»ºç«‹æ–¹ä½“ã€‚ç”±äºæ¯ä¸ªç«‹æ–¹ä½“å…±äº«ç›¸åŒçš„æ³•çº¿å’Œçº¹ç†æ•°æ®ï¼Œå› æ­¤åœ¨åˆå§‹åŒ–å®¢æˆ·ç«¯ç¼“å†²åŒºæ—¶å°†é‡å¤å¤åˆ¶æ­¤æ•°æ®ã€‚æ‰€æœ‰ç«‹æ–¹ä½“éƒ½å°†åœ¨åŒä¸€ä¸ªç¼“å†²åŒºå¯¹è±¡ä¸­ç»“æŸã€‚</p><p>æ‚¨å¯ä»¥æŸ¥çœ‹è¯¾ç¨‹ä¸­çš„ä»£ç å¹¶æŸ¥çœ‹ä½¿ç”¨å’Œä¸ä½¿ç”¨VBOï¼Œä»¥åŠä½¿ç”¨å’Œä¸ä½¿ç”¨æ‰“åŒ…ç¼“å†²åŒºè¿›è¡Œæ¸²æŸ“çš„ç¤ºä¾‹ã€‚æ£€æŸ¥ä»£ç ä»¥æŸ¥çœ‹å¦‚ä½•å¤„ç†ä¸€ä¸‹æŸäº›æ“ä½œï¼š</p><ul><li>é€šè¿‡<code>runOnUiThread()</code>å°†äº‹ä»¶ä»OpenGLçº¿ç¨‹å‘å¸ƒå›UIä¸»çº¿ç¨‹</li><li>å¼‚æ­¥ç”Ÿæˆé¡¶ç‚¹æ•°æ®</li><li>å¤„ç†å†…å­˜æº¢å‡ºå¼‚å¸¸</li><li>æˆ‘ä»¬ç§»é™¤äº†<code>glEnable(GL_TEXTURE_2D)</code>çš„è°ƒç”¨ï¼Œå› ä¸ºå®ƒå®é™…åœ¨OpenGL ES 2æ˜¯ä¸€ä¸ªæ— æ•ˆæšä¸¾ã€‚è¿™æ˜¯ä»¥å‰çš„å›ºå®šå†™æ³•å»¶ç»­ä¸‹æ¥çš„ï¼Œåœ¨OpenGLES2ä¸­ï¼Œè¿™äº›ä¸œè¥¿ç”±ç€è‰²å™¨å¤„ç†ï¼Œå› æ­¤ä¸éœ€è¦ä½¿ç”¨<code>glEnable</code>æˆ–<code>glDisable</code>ã€‚</li><li>æ€æ ·ä½¿ç”¨ä¸åŒçš„æ–¹å¼è¿›è¡Œæ¸²æŸ“ï¼Œè€Œä¸æ·»åŠ å¤ªå¤šçš„ifè¯­å¥å’Œæ¡ä»¶ã€‚</li></ul><h2 id="è¿›ä¸€æ­¥ç»ƒä¹ ">è¿›ä¸€æ­¥ç»ƒä¹ <a href="post/Learn-OpenGL-Lesson-Seven#è¿›ä¸€æ­¥ç»ƒä¹ "></a></h2><p>æ‚¨ä½•æ—¶ä½¿ç”¨é¡¶ç‚¹ç¼“å†²åŒºï¼Ÿä»€ä¹ˆæ—¶å€™ä»å®¢æˆ·ç«¯å†…å­˜ä¼ è¾“æ•°æ®æ›´å¥½ï¼Ÿä½¿ç”¨é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡æœ‰å“ªäº›ç¼ºç‚¹ï¼Ÿæ‚¨å°†å¦‚ä½•æ”¹è¿›å¼‚æ­¥åŠ è½½ä»£ç ï¼Ÿ</p><h2 id="æ•™ç¨‹ç›®å½•">æ•™ç¨‹ç›®å½•<a href="post/Learn-OpenGL-Lesson-Seven#æ•™ç¨‹ç›®å½•"></a></h2><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five">OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six">OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven">OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVBOï¼‰</a></li></ul><h2 id="æ‰“åŒ…æ•™æ">æ‰“åŒ…æ•™æ<a href="post/Learn-OpenGL-Lesson-Seven#æ‰“åŒ…æ•™æ"></a></h2><p>å¯ä»¥åœ¨Githubä¸‹è½½æœ¬è¯¾ç¨‹æºä»£ç ï¼š<a href="https://github.com/learnopengles/Learn-OpenGLES-Tutorials" target="_blank" rel="noopener">ä¸‹è½½é¡¹ç›®</a><br>æœ¬è¯¾çš„ç¼–è¯‘ç‰ˆæœ¬ä¹Ÿå¯ä»¥å†Androidå¸‚åœºä¸‹ï¼š<a href="https://market.android.com/details?id=com.learnopengles.android" target="_blank" rel="noopener">google play ä¸‹è½½apk</a><br>ä¸ºäº†æ–¹ä¾¿å¤§å®¶ä¸‹è½½ï¼Œâ€œæˆ‘â€ä¹Ÿç¼–è¯‘äº†ä¸ªapkï¼Œï¼š<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">github download</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ–‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Seven: An Introduction to Vertex Buffer Objects (VBOs)&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.learnopengles.com/android-lesson-seven-an-introduction-to-vertex-buffer-objects-vbos/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.learnopengles.com/android-lesson-seven-an-introduction-to-vertex-buffer-objects-vbos/&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/categories/OpenGL/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/tags/OpenGL/"/>
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</title>
    <link href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six/index.html"/>
    <id>https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six/index.html</id>
    <published>2019-02-19T08:24:18.000Z</published>
    <updated>2019-04-08T06:56:15.793Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»è¯‘æ–‡</p></blockquote><p>åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Six: An Introduction to Texture Filtering<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.learnopengles.com/android-lesson-six-an-introduction-to-texture-filtering/" target="_blank" rel="noopener">http://www.learnopengles.com/android-lesson-six-an-introduction-to-texture-filtering/</a><br><a id="more"></a></p><hr><h1 id="ä»‹ç»çº¹ç†è¿‡æ»¤">ä»‹ç»çº¹ç†è¿‡æ»¤<a href="post/Learn-OpenGL-Lesson-Six#ä»‹ç»çº¹ç†è¿‡æ»¤"></a></h1><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°†ä»‹ç»åŸºæœ¬çº¹ç†è¿‡æ»¤çš„ä¸åŒç±»å‹å’Œæ€æ ·ä½¿ç”¨å®ƒä»¬ï¼Œ<br>åŒ…æ‹¬æœ€é‚»è¿‘ï¼ˆnearest-neighbourï¼‰è¿‡æ»¤ï¼Œ<a href="https://en.wikipedia.org/wiki/Bilinear_filtering" target="_blank" rel="noopener">åŒçº¿æ€§(bilinear)è¿‡æ»¤</a>ï¼Œ<br>å’Œä½¿ç”¨mipmapçš„<a href="https://en.wikipedia.org/wiki/Trilinear_filtering" target="_blank" rel="noopener">ä¸‰çº¿æ€§(trilinear)è¿‡æ»¤</a>ã€‚<br><br>ä½ å°†å­¦ä¹ å¦‚ä½•ä½¿çº¹ç†çœ‹èµ·æ¥æ›´å¹³æ»‘ï¼Œä»¥åŠå¹³æ»‘å¸¦æ¥çš„ç¼ºç‚¹ã€‚<br>[è¿™å„¿æœ‰æ—‹è½¬ç‰©ä½“][]çš„ä¸åŒæ–¹å¼ï¼Œæœ¬è¯¾ä½¿ç”¨äº†å…¶ä¸­ä¸€ã€‚</td><td style="text-align:center"><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190219164050.png" alt="screenshot"></td></tr></tbody></table></div></div><h2 id="å‰ææ¡ä»¶">å‰ææ¡ä»¶<a href="post/Learn-OpenGL-Lesson-Six#å‰ææ¡ä»¶"></a></h2><p>å¼ºçƒˆå»ºè®®æ‚¨å…ˆé˜…è¯»<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a>ï¼Œç†è§£çº¹ç†æ˜ å°„åœ¨OpenGLä¸­çš„åŸºæœ¬ä½¿ç”¨ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯çº¹ç†è¿‡æ»¤ï¼Ÿ">ä»€ä¹ˆæ˜¯çº¹ç†è¿‡æ»¤ï¼Ÿ<a href="post/Learn-OpenGL-Lesson-Six#ä»€ä¹ˆæ˜¯çº¹ç†è¿‡æ»¤ï¼Ÿ"></a></h2><p>OpenGLESä¸­çš„çº¹ç†ç”±å…ƒç´ æ•°ç»„ç»„æˆï¼Œè¢«ç§°ä¸ºçº¹ç´ (texels)ï¼Œå…¶ä¸­åŒ…å«é¢œè‰²å’Œalphaå€¼ã€‚è¿™ä¸æ˜¾ç¤ºå™¨ç›¸å¯¹åº”ï¼Œæ˜¾ç¤ºå™¨ç”±ä¸€å †åƒç´ ç»„æˆï¼Œå¹¶åœ¨æ¯ä¸ªç‚¹æ˜¾ç¤ºä¸åŒçš„é¢œè‰²ã€‚åœ¨OpenGLä¸­çº¹ç†è¢«ç”¨åœ¨ä¸‰è§’å½¢ä¸Šå¹¶ç»˜åˆ¶åˆ°å±å¹•ï¼Œå› æ­¤è¿™äº›çº¹ç†èƒ½ç»˜åˆ¶å‡ºå„ç§å„æ ·çš„å°ºå¯¸å’Œæ–¹å‘ã€‚OpenGLä¸­çš„çº¹ç†è¿‡æ»¤é€‰é¡¹å‘Šè¯‰å®ƒå¦‚ä½•æ ¹æ®å…·ä½“æƒ…å†µå°†çº¹ç†åƒç´ è¿‡æ»¤åˆ°è®¾å¤‡çš„åƒç´ ä¸Šã€‚</p><blockquote><p>æœ‰ä¸‰ç§æƒ…å†µï¼š</p></blockquote><ul><li>æ¯ä¸ªçº¹ç´ æ˜ å°„åˆ°å¤šä¸ªåƒç´ ï¼Œè¿™è¢«ç§°ä¸ºæ”¾å¤§(magnification)</li><li>æ¯ä¸ªçº¹ç´ ç²¾ç¡®çš„æ˜ å°„åˆ°ä¸€ä¸ªåƒç´ ï¼Œè¿‡æ»¤ä¸é€‚åˆè¿™ç§æƒ…å†µ</li><li>æ¯ä¸ªçº¹ç´ æ˜ å°„å°‘äºä¸€ä¸ªåƒç´ ï¼Œè¿™è¢«ç§°ä¸ºç¼©å°(minification)</li></ul><p>OpenGLå…è®¸æˆ‘ä»¬ä¸ºæ”¾å¤§å’Œç¼©å°åˆ†é…è¿‡æ»¤å™¨ï¼Œå¹¶å…è®¸æˆ‘ä»¬ä½¿ç”¨æœ€é‚»è¿‘ã€åŒçº¿æ€§å’Œä¸‰çº¿æ€§è¿‡æ»¤ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹é¢è§£é‡Šè¿™äº›æ„æ€ã€‚</p><h2 id="æ”¾å¤§å’Œç¼©å°">æ”¾å¤§å’Œç¼©å°<a href="post/Learn-OpenGL-Lesson-Six#æ”¾å¤§å’Œç¼©å°"></a></h2><p>è¿™é‡Œæ˜¯æ”¾å¤§å’Œç¼©å°çš„æœ€é‚»è¿‘æ¸²æŸ“çš„å¯è§†åŒ–ï¼Œå½“æ‚¨ç”¨USBè¿æ¥ä½ çš„Androidè®¾å¤‡æ—¶ä½¿ç”¨è¿™ä¸ªå¯çˆ±çš„Androidæ˜¾ç¤ºæˆåŠŸè¿æ¥ã€‚</p><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190221100843.png" alt="cute android" class="article-img"></p><h3 id="æ”¾å¤§">æ”¾å¤§<a href="post/Learn-OpenGL-Lesson-Six#æ”¾å¤§"></a></h3><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190221100936.png" alt="magnification android" class="article-img"></p><p>æ­£å¦‚æ‚¨æ‰€è§ï¼Œçº¹ç´ ç°åœ¨å¾ˆå®¹æ˜“çœ‹åˆ°ï¼Œå› ä¸ºå½“å‰ä¸€ä¸ªçº¹ç´ è¦†ç›–äº†å¾ˆå¤šåƒç´ å±•ç¤ºå‡ºæ¥ã€‚</p><h3 id="ç¼©å°">ç¼©å°<a href="post/Learn-OpenGL-Lesson-Six#ç¼©å°"></a></h3><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190221101211.png" alt="minification android" class="article-img"></p><p>éšç€ç¼©å°ï¼Œè®¸å¤šçº¹ç´ ä¸èƒ½æ¸²æŸ“åˆ°æœ‰é™çš„åƒç´ ä¸Šï¼Œè®¸å¤šç»†èŠ‚å°†ä¼šä¸¢å¤±ã€‚</p><h2 id="çº¹ç†è¿‡æ»¤æ¨¡å¼">çº¹ç†è¿‡æ»¤æ¨¡å¼<a href="post/Learn-OpenGL-Lesson-Six#çº¹ç†è¿‡æ»¤æ¨¡å¼"></a></h2><h3 id="åŒçº¿æ€§æ’å€¼ï¼ˆBilinear-interpolationï¼‰">åŒçº¿æ€§æ’å€¼ï¼ˆBilinear interpolationï¼‰<a href="post/Learn-OpenGL-Lesson-Six#åŒçº¿æ€§æ’å€¼ï¼ˆBilinear-interpolationï¼‰"></a></h3><p>å½“çº¹ç´ å€¼ä¹‹é—´æ²¡æœ‰æ’å€¼æ—¶ï¼Œåœ¨æ”¾å¤§ç¤ºä¾‹ä¸­ï¼Œçº¹ç†çš„çº¹ç´ æ¸…æ™°å¯è§ä¸ºå¤§æ­£æ–¹å½¢ã€‚å½“ä½¿ç”¨æœ€é‚»è¿‘æ–¹å¼æ—¶ï¼Œåƒç´ å°†ä¼šåˆ†é…åˆ°æœ€é‚»è¿‘çš„åƒç´ ã€‚</p><p>é€šè¿‡åˆ‡æ¢åˆ°åŒçº¿æ€§æ’å€¼ï¼Œæ¸²æŸ“è´¨é‡æ˜¾è‘—æé«˜ã€‚è¿™äº›å€¼å°†ä¼šåœ¨é‚»è¿‘çš„å››ä¸ªåƒç´ ä¹‹é—´çº¿æ€§æ’å€¼ï¼Œè€Œä¸æ˜¯å°†ä¸€ç»„åƒç´ åˆ†é…ç»™é‚»è¿‘ç›¸åŒçš„çº¹ç´ å€¼ã€‚æ¯ä¸ªåƒç´ è¢«å¹³æ»‘åŒ–ï¼Œä½¿å¾—æœ€åçš„å›¾ç‰‡çœ‹èµ·æ¥ä¹Ÿæ›´å¹³æ»‘ï¼š</p><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190221103115.png" alt="smoother android" class="article-img"></p><p>ä¸€äº›å—æ•ˆæœä»ç„¶å¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯è¿™ä¸ªå›¾ç‰‡çœ‹èµ·æ¥æ¯”ä¹‹å‰æ›´åŠ å¹³æ»‘ã€‚é‚£äº›åœ¨3DåŠ é€Ÿå¡å‡ºç°å‰ç©è¿‡3Dæ¸¸æˆçš„äººå°†ä¼šè®°å¾—è½¯ä»¶æ¸²æŸ“æ¸¸æˆå’Œç¡¬ä»¶åŠ é€Ÿæ¸¸æˆä¹‹é—´çš„ç‰¹æ€§ï¼šè½¯ä»¶æ¸²æŸ“æ¸¸æˆæ ¹æœ¬æ²¡æœ‰è¿›è¡Œé¢„è®¡ç®—å¤„ç†ï¼Œæ‰€ä»¥ä¸€åˆ‡éƒ½æ˜¾ç¤ºå¾—å—çŠ¶å’Œé”¯é½¿çŠ¶ã€‚ä¸€æ—¦äººä»¬å¼€å§‹ä½¿ç”¨å›¾å½¢åŠ é€Ÿï¼Œè¿™äº›ä¸œè¥¿éƒ½å°†å˜å¾—å¹³æ»‘ã€‚</p><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190221104453.png" alt="smooth" class="article-img"></p><p>åŒçº¿æ€§æ’å€¼å¤§å¤šä½¿ç”¨åœ¨æ”¾å¤§ã€‚å®ƒä¹Ÿèƒ½ä½¿ç”¨åœ¨ç¼©å°ï¼Œä½†æ˜¯è¶…è¿‡æŸä¸ªåº¦ï¼Œæˆ‘ä»¬å°†ä¼šé‡åˆ°åŒæ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨å°è¯•å°†å¤ªå¤šçš„çº¹ç´ æ”¾åˆ°ç›¸åŒçš„åƒç´ ä¸Šã€‚OpenGLä»…ä½¿ç”¨æœ€å¤š4ä¸ªçº¹ç´ æ¸²æŸ“ä¸€ä¸ªåƒç´ ï¼Œå› æ­¤è®¸å¤šä¿¡æ¯ä»ç„¶ä¼šä¸¢å¤±ã€‚</p><p>å¦‚æœæˆ‘ä»¬çœ‹åº”ç”¨äº†åŒçº¿æ€§æ’å€¼çš„çº¹ç†ï¼Œå½“æˆ‘ä»¬åœ¨è¿œå¤„çœ‹å®ƒç§»åŠ¨æ—¶çœ‹èµ·æ¥ä¼šå¾ˆå˜ˆæ‚ï¼Œå› ä¸ºæ¯å¸§éƒ½ä¼šé€‰æ‹©ä¸åŒçš„çº¹ç´ ã€‚</p><h3 id="çº¹ç†æ˜ å°„ï¼ˆMipmappingï¼‰">çº¹ç†æ˜ å°„ï¼ˆMipmappingï¼‰<a href="post/Learn-OpenGL-Lesson-Six#çº¹ç†æ˜ å°„ï¼ˆMipmappingï¼‰"></a></h3><p>æˆ‘ä»¬å¦‚ä½•æ‰èƒ½åœ¨ç¼©å°çº¹ç†æ—¶ä¸å¼•ç”¨å˜ˆæ‚å¹¶ä½¿ç”¨ä¸Šæ‰€æœ‰çº¹ç´ å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”Ÿæˆä¸€ç»„ä¼˜åŒ–åçš„ä¸åŒå°ºå¯¸çš„çº¹ç†ï¼Œç„¶ååœ¨æˆ‘ä»¬è¿è¡Œçš„æ—¶å€™ä½¿ç”¨å®ƒä»¬ã€‚ç”±äºè¿™äº›çº¹ç†å·²é¢„å…ˆç”Ÿæˆï¼Œå®ƒä»¬èƒ½ä½¿ç”¨æ›´å¤šé«˜æ˜‚çš„æŠ€æœ¯å»è¿‡æ»¤æ‰€æœ‰çº¹ç´ ï¼Œå¹¶ä¸”åœ¨è¿è¡Œæ—¶OpenGLä¼šæ ¹æ®çº¹ç†åœ¨å±å¹•ä¸Šçš„æœ€ç»ˆå¤§å°é€‰æ‹©æœ€åˆé€‚çš„å±‚ã€‚</p><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190221143838.png" alt="textures set" class="article-img"></p><p>ç”Ÿæˆçš„å›¾ç‰‡å¯ä»¥å…·æœ‰æ›´å¤šç»†èŠ‚ï¼Œæ›´å°‘å™ªç‚¹ï¼Œå¹¶ä¸”æ•´ä½“ä¸Šçœ‹èµ·æ¥æ›´å¥½ã€‚å°½ç®¡éœ€è¦æ›´å¤šçš„å†…å­˜ï¼Œä½†æ¸²æŸ“é€Ÿåº¦ä¹Ÿä¼šæ›´å¿«ï¼Œå› ä¸ºè¾ƒå°çš„å±‚çº§èƒ½æ›´å®¹æ˜“ä¿å­˜åœ¨GPUçš„çº¹ç†ç¼“å­˜ä¸­ã€‚è®©æˆ‘ä»¬æ¥ä»”ç»†ç ”ç©¶ä¸€ä¸‹åŸå°ºå¯¸çš„1/8å€çš„å›¾ç‰‡ï¼Œåœ¨ä½¿ç”¨äº†åŒçº¿æ€§è¿‡æ»¤ä½¿ç”¨çº¹ç†æ˜ å°„å’ŒåŒçº¿æ€§è¿‡æ»¤æ²¡æœ‰ä½¿ç”¨æ˜ å°„ã€‚ä¸ºäº†æ¸…æ¥šå›¾ç‰‡å·²è¢«æ‰©å¤§ï¼š</p><h4 id="åŒçº¿æ€§è¿‡æ»¤æ²¡æœ‰mipmap">åŒçº¿æ€§è¿‡æ»¤æ²¡æœ‰mipmap<a href="post/Learn-OpenGL-Lesson-Six#åŒçº¿æ€§è¿‡æ»¤æ²¡æœ‰mipmap"></a></h4><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190221145134.png" alt="without mipmaps" class="article-img"></p><h4 id="åŒçº¿æ€§è¿‡æ»¤-mipmap">åŒçº¿æ€§è¿‡æ»¤+mipmap<a href="post/Learn-OpenGL-Lesson-Six#åŒçº¿æ€§è¿‡æ»¤-mipmap"></a></h4><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190221145249.png" alt="with mipmaps" class="article-img"></p><p>ä½¿ç”¨mipmapçš„ç‰ˆæœ¬æ‹¥æœ‰æ›´å¤šç»†èŠ‚ï¼Œç”±äºå›¾åƒé¢„å¤„ç†åˆ°å•ç‹¬çš„å±‚çº§ï¼Œæ‰€æœ‰çº¹ç´ æœ€ç»ˆéƒ½ä¼šåœ¨æœ€ç»ˆçš„å›¾åƒä¸­ä½¿ç”¨ã€‚</p><h3 id="ä¸‰çº¿æ€§è¿‡æ»¤ï¼ˆTrilinear-filteringï¼‰">ä¸‰çº¿æ€§è¿‡æ»¤ï¼ˆTrilinear filteringï¼‰<a href="post/Learn-OpenGL-Lesson-Six#ä¸‰çº¿æ€§è¿‡æ»¤ï¼ˆTrilinear-filteringï¼‰"></a></h3><p>å½“ä½¿ç”¨åŒçº¿æ€§è¿‡æ»¤çš„mipmapæ—¶ï¼Œæœ‰æ—¶åœ¨æ¸²æŸ“åœºæ™¯ä¸­å¯ä»¥çœ‹åˆ°æ˜æ˜¾çš„è·³è·ƒæˆ–çº¿ï¼Œç”±äºOpenGLåœ¨çº¹ç†çš„ä¸åŒmipmapå±‚çº§ä¹‹é—´åˆ‡æ¢ã€‚æ¯”è¾ƒä¸åŒçš„OpenGLçº¹ç†çš„è¿‡æ»¤æ¨¡å¼å°†åœ¨ä¸‹é¢è¿›ä¸€æ­¥æŒ‡å‡ºã€‚</p><p>ä¸‰çº¿æ€§æ’å€¼é€šè¿‡åœ¨ä¸åŒmipmapå±‚çº§ä¹‹é—´æ’å€¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™æ ·æ€»å…±8ä¸ªçº¹ç´ å°†ç”¨äºæ’å€¼å¾—åˆ°æœ€ç»ˆçš„åƒç´ å€¼ï¼Œä½¿å¾—å›¾åƒæ›´å¹³æ»‘ã€‚</p><h2 id="OpenGL-çº¹ç†è¿‡æ»¤æ¨¡å¼">OpenGL çº¹ç†è¿‡æ»¤æ¨¡å¼<a href="post/Learn-OpenGL-Lesson-Six#OpenGL-çº¹ç†è¿‡æ»¤æ¨¡å¼"></a></h2><p>OpenGLæœ‰ä¸¤ä¸ªå¯è¢«è®¾ç½®çš„å‚æ•°ï¼š</p><ul><li><code>GL_TEXTURE_MIN_FILTER</code> çº¹ç†ç¼©å°æ—¶çš„è¿‡æ»¤æ¨¡å¼</li><li><code>GL_TEXTURE_MAG_FILTER</code> çº¹ç†æ”¾å¤§æ—¶çš„è¿‡æ»¤æ¨¡å¼</li></ul><p>è¿™äº›ç›¸å¯¹åº”äºä¸Šé¢çš„ç¼©å°å’Œæ”¾å¤§æè¿°ã€‚  </p><ul><li><code>GL_TEXTURE_MIN_FILTER</code>æ¥å—ä»¥ä¸‹é€‰é¡¹ï¼š<ul><li><code>GL_NEAREST</code></li><li><code>GL_LINEAR</code></li><li><code>GL_NEAREST_MIPMAP_NEAREST</code></li><li><code>GL_NEAREST_MIPMAP_LINEAR</code></li><li><code>GL_LINEAR_MIPMAP_NEAREST</code></li><li><code>GL_LINEAR_MIPMAP_LINEAR</code></li></ul></li><li><code>GL_TEXTURE_MAG_FILTER</code>æ¥å—ä»¥ä¸‹é€‰é¡¹ï¼š<ul><li><code>GL_NEAREST</code></li><li><code>GL_LINEAR</code></li></ul></li></ul><p><code>GL_NEAREST</code> å¯¹åº”æœ€é‚»è¿‘æ¸²æŸ“ï¼›<br><code>GL_LINEAR</code> å¯¹åº”åŒçº¿æ€§è¿‡æ»¤ï¼›<br><code>GL_LINEAR_MIPMAP_NEAREST</code> å¯¹åº”åŒçº¿æ€§è¿‡æ»¤+mipmapï¼›<br><code>GL_LINEAR_MIPMAP_LINEAR</code> å¯¹åº”ä¸‰çº¿æ€§è¿‡æ»¤ï¼›<br>æœ¬è¯¾ä¸­å°†è¿›ä¸€æ­¥ä»‹ç»å›¾å½¢ç¤ºä¾‹å’Œæœ€å¸¸è§é€‰é¡¹çš„è¿›ä¸€æ­¥è¯´æ˜ã€‚</p><h3 id="æ€æ ·è®¾ç½®çº¹ç†è¿‡æ»¤æ¨¡å¼">æ€æ ·è®¾ç½®çº¹ç†è¿‡æ»¤æ¨¡å¼<a href="post/Learn-OpenGL-Lesson-Six#æ€æ ·è®¾ç½®çº¹ç†è¿‡æ»¤æ¨¡å¼"></a></h3><p>æˆ‘ä»¬é¦–å…ˆéœ€è¦ç»‘å®šçº¹ç†ï¼Œç„¶åæˆ‘ä»¬åœ¨è¿™ä¸ªçº¹ç†ä¸Šè®¾ç½®åˆé€‚çš„è¿‡æ»¤å‚æ•°ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, mTextureHandle);</span><br><span class="line">GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, filter);</span><br></pre></td></tr></table></div></figure><h3 id="æ€æ ·ç”Ÿæˆmipmap">æ€æ ·ç”Ÿæˆmipmap<a href="post/Learn-OpenGL-Lesson-Six#æ€æ ·ç”Ÿæˆmipmap"></a></h3><p>è¿™çœŸçš„å¾ˆå®¹æ˜“ï¼åœ¨åŠ è½½çº¹ç†åˆ°OpenGLä¸­åï¼Œçº¹ç†ä»ç„¶æ˜¯ç»‘å®šçš„ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„è°ƒç”¨ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GLES20.glGenerateMipmap(GLES20.GL_TEXTURE_2D);</span><br></pre></td></tr></table></div></figure><p>å®ƒå°†ä¸ºæˆ‘ä»¬ç”Ÿæˆæ‰€æœ‰çš„mipmapå±‚çº§ï¼Œå¹¶ä¸”è¿™äº›å±‚çº§ä¼šæ ¹æ®çº¹ç†è¿‡æ»¤è‡ªåŠ¨ä½¿ç”¨ã€‚</p><h2 id="å®ƒçœ‹èµ·æ¥æ€ä¹ˆæ ·ï¼Ÿ">å®ƒçœ‹èµ·æ¥æ€ä¹ˆæ ·ï¼Ÿ<a href="post/Learn-OpenGL-Lesson-Six#å®ƒçœ‹èµ·æ¥æ€ä¹ˆæ ·ï¼Ÿ"></a></h2><p>ä»¥ä¸‹æ˜¯å¯ç”¨çš„æœ€å¸¸è§çš„ç»„åˆçš„å±å¹•æˆªå›¾ï¼Œå½“ä½ çœ‹åˆ°å®ƒè¿åŠ¨ä¸­æ—¶ï¼Œæ•ˆæœæ›´åŠ å¼•äººæ³¨ç›®ï¼Œå› æ­¤æˆ‘å»ºè®®ä¸‹è½½<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">è¿™ä¸ªApp</a>å¹¶è¯•ä¸€è¯•ã€‚</p><h3 id="æœ€é‚»è¿‘æ¸²æŸ“">æœ€é‚»è¿‘æ¸²æŸ“<a href="post/Learn-OpenGL-Lesson-Six#æœ€é‚»è¿‘æ¸²æŸ“"></a></h3><p>è¿™ä¸ªæ¨¡å¼è®©äººæƒ³èµ·æ—§ç‰ˆ3Dæ¸¸æˆè½¯ä»¶çš„æ¸²æŸ“ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GL_TEXTURE_MIN_FILTER = GL_NEAREST</span><br><span class="line">GL_TEXTURE_MAG_FILTER = GL_NEAREST</span><br></pre></td></tr></table></div></figure><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190221163746.png" alt="nearest nearest" class="article-img"></p><h3 id="åŒçº¿æ€§è¿‡æ»¤ï¼Œmipmap">åŒçº¿æ€§è¿‡æ»¤ï¼Œmipmap<a href="post/Learn-OpenGL-Lesson-Six#åŒçº¿æ€§è¿‡æ»¤ï¼Œmipmap"></a></h3><p>è®¸å¤šæ”¯æŒ3DåŠ é€Ÿçš„é¦–æ‰¹æ¸¸æˆéƒ½ä½¿ç”¨æ­¤æ¨¡å¼ï¼Œè¿™æ˜¯ä»Šå¤©åœ¨Androidæ‰‹æœºä¸Šå¹³æ»‘çº¹ç†çš„æœ‰æ•ˆæ–¹å¼ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GL_TEXTURE_MIN_FILTER = GL_LINEAR_MIPMAP_NEAREST</span><br><span class="line">GL_TEXTURE_MAG_FILTER = GL_LINEAR</span><br></pre></td></tr></table></div></figure><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190221164349.png" alt="linear mipmap" class="article-img"></p><p>é™æ€å›¾ä¸Šå¾ˆéš¾çœ‹å›¾é—®é¢˜ï¼Œä½†æ˜¯å½“ç‰©ä½“è¿åŠ¨æ—¶ï¼Œæ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°æ¸²æŸ“çš„åƒç´ åœ¨mipmapå±‚çº§ä¹‹é—´åˆ‡æ¢çš„æ°´å¹³æ¡å¸¦ã€‚</p><h3 id="ä¸‰çº¿æ€§è¿‡æ»¤">ä¸‰çº¿æ€§è¿‡æ»¤<a href="post/Learn-OpenGL-Lesson-Six#ä¸‰çº¿æ€§è¿‡æ»¤"></a></h3><p>æ­¤æ¨¡å¼é€šè¿‡åœ¨mipmapå±‚çº§ä¹‹é—´è¿›è¡Œæ’å€¼ï¼Œæ”¹è¿›äº†ä½¿ç”¨mipmapçš„åŒçº¿æ€§è¿‡æ»¤çš„æ¸²æŸ“è´¨é‡ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GL_TEXTURE_MIN_FILTER = GL_LINEAR_MIPMAP_LINEAR</span><br><span class="line">GL_TEXTURE_MAG_FILTER = GL_LINEAR</span><br></pre></td></tr></table></div></figure><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190221165703.png" alt="trilinear" class="article-img"></p><p>åƒç´ åœ¨è¿‘è·ç¦»å’Œè¿œè·ç¦»ä¹‹é—´å®Œå…¨å¹³æ»‘ï¼›äº‹å®ä¸Šï¼Œçº¹ç†ç°åœ¨å¯èƒ½åœ¨å€¾æ–œè§’åº¦ä¸‹æ˜¾ç¤ºçš„è¿‡äºå¹³æ»‘ã€‚<br><a href="https://en.wikipedia.org/wiki/Anisotropic_filtering" target="_blank" rel="noopener">å„å‘å¼‚æ€§è¿‡æ»¤ï¼ˆAnisotropic filteringï¼‰</a>æ˜¯ä¸€ç§æ›´å…ˆè¿›çš„æŠ€æœ¯ï¼Œå—åˆ°æŸäº›ç§»åŠ¨GPUçš„æ”¯æŒï¼Œå¯ç”¨äºæ”¹å–„æœ€ç»ˆç»“æœï¼Œè¶…å‡ºä¸‰çº¿æ€§è¿‡æ»¤æ‰€èƒ½æä¾›çš„æ•ˆæœã€‚</p><h3 id="è¿›ä¸€æ­¥ç»ƒä¹ ">è¿›ä¸€æ­¥ç»ƒä¹ <a href="post/Learn-OpenGL-Lesson-Six#è¿›ä¸€æ­¥ç»ƒä¹ "></a></h3><p>ä½¿ç”¨å…¶ä»–æ¨¡å¼å¯ä»¥è¾¾åˆ°ä»€ä¹ˆæ ·çš„æ•ˆæœï¼Ÿä¾‹å¦‚ï¼Œæ‚¨ä½•æ—¶ä¼šä½¿ç”¨åƒ<code>GL_NEAREST_MIPMAP_LINEAR</code>è¿™æ ·çš„ä¸œè¥¿ï¼Ÿ</p><h2 id="æ•™ç¨‹ç›®å½•">æ•™ç¨‹ç›®å½•<a href="post/Learn-OpenGL-Lesson-Six#æ•™ç¨‹ç›®å½•"></a></h2><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five">OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six">OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven">OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVOBï¼‰</a></li></ul><h2 id="æ‰“åŒ…æ•™æ">æ‰“åŒ…æ•™æ<a href="post/Learn-OpenGL-Lesson-Six#æ‰“åŒ…æ•™æ"></a></h2><p>å¯ä»¥åœ¨Githubä¸‹è½½æœ¬è¯¾ç¨‹æºä»£ç ï¼š<a href="https://github.com/learnopengles/Learn-OpenGLES-Tutorials" target="_blank" rel="noopener">ä¸‹è½½é¡¹ç›®</a><br>æœ¬è¯¾çš„ç¼–è¯‘ç‰ˆæœ¬ä¹Ÿå¯ä»¥å†Androidå¸‚åœºä¸‹ï¼š<a href="https://market.android.com/details?id=com.learnopengles.android" target="_blank" rel="noopener">google play ä¸‹è½½apk</a><br>â€œæˆ‘â€ä¹Ÿç¼–è¯‘äº†ä¸ªapkï¼Œæ–¹ä¾¿å¤§å®¶ä¸‹è½½ï¼š<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">github download</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ–‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Six: An Introduction to Texture Filtering&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.learnopengles.com/android-lesson-six-an-introduction-to-texture-filtering/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.learnopengles.com/android-lesson-six-an-introduction-to-texture-filtering/&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/categories/OpenGL/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/tags/OpenGL/"/>
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</title>
    <link href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five/index.html"/>
    <id>https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five/index.html</id>
    <published>2019-02-12T08:37:00.000Z</published>
    <updated>2019-04-08T06:55:57.729Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»è¯‘æ–‡</p></blockquote><p>åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Five: An Introduction to Blending<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.learnopengles.com/android-lesson-five-an-introduction-to-blending/" target="_blank" rel="noopener">http://www.learnopengles.com/android-lesson-five-an-introduction-to-blending/</a><br><a id="more"></a></p><hr><h1 id="ä»‹ç»æ··åˆï¼ˆBlendingï¼‰">ä»‹ç»æ··åˆï¼ˆBlendingï¼‰<a href="post/Learn-OpenGL-Lesson-Five#ä»‹ç»æ··åˆï¼ˆBlendingï¼‰"></a></h1><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬æ¥å­¦ä¹ æ··åˆ(blending)åœ¨OpenGLä¸­çš„<br>åŸºæœ¬ä½¿ç”¨ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•æ‰“å¼€æˆ–å…³é—­æ··åˆï¼Œæ€æ ·è®¾ç½®<br>ä¸åŒçš„æ··åˆæ¨¡å¼ï¼Œä»¥åŠä¸åŒçš„æ··åˆæ¨¡å¼å¦‚ä½•æ¨¡ä»¿æ˜¾ç¤ºç”Ÿ<br>æ´»ä¸­çš„æ•ˆæœã€‚åœ¨åé¢çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿˜å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨<br>alphaé€šé“ï¼Œå¦‚ä½•ä½¿ç”¨æ·±åº¦ç¼“å†²åŒºåœ¨åŒä¸€ä¸ªåœºæ™¯ä¸­æ¸²æŸ“<br>åŠé€æ˜å’Œä¸é€æ˜çš„ç‰©ä½“ï¼Œä»¥åŠä»€ä¹ˆæ—¶å€™æŒ‰æ·±åº¦æ’åºå¯¹è±¡ï¼Œ<br>ä»¥åŠä¸ºä»€ä¹ˆã€‚<br><br>æˆ‘ä»¬è¿˜å°†ç ”ç©¶å¦‚ä½•ç›‘å¬è§¦æ‘¸äº‹ä»¶ï¼Œç„¶ååŸºäºæ­¤æ›´æ”¹æ¸²æŸ“<br>çŠ¶æ€ã€‚</td><td style="text-align:center"><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190212163914.png" alt="display"><br><em>åŸºæœ¬æ··åˆ</em></td></tr></tbody></table></div></div><h2 id="å‰ææ¡ä»¶">å‰ææ¡ä»¶<a href="post/Learn-OpenGL-Lesson-Five#å‰ææ¡ä»¶"></a></h2><p>æœ¬ç³»åˆ—æ¯ä¸ªè¯¾ç¨‹æ„å»ºéƒ½æ˜¯ä»¥å‰ä¸€ä¸ªè¯¾ç¨‹ä¸ºåŸºç¡€ã€‚ç„¶è€Œï¼Œå¯¹äºè¿™èŠ‚è¯¾ï¼Œå¦‚æœæ‚¨ç†è§£äº†<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a>å°±è¶³å¤Ÿäº†ã€‚å°½ç®¡ä»£ç åŸºæœ¬ä¸Šæ˜¯å‰ä¸€è¯¾çš„ï¼Œç…§æ˜å’Œçº¹ç†éƒ¨åˆ†å·²åœ¨æœ¬è¯¾ä¸­ç§»é™¤ï¼Œå› æ­¤æˆ‘ä»¬ä»…å…³æ³¨æ··åˆã€‚</p><h2 id="æ··åˆï¼ˆBlendingï¼‰">æ··åˆï¼ˆBlendingï¼‰<a href="post/Learn-OpenGL-Lesson-Five#æ··åˆï¼ˆBlendingï¼‰"></a></h2><p>æ··åˆæ˜¯å°†ä¸€ç§é¢œè‰²ä¸å¦ä¸€ç§é¢œè‰²ç»„åˆä»¥è·å¾—ç¬¬ä¸‰ç§é¢œè‰²çš„è¡Œä¸ºã€‚æˆ‘ä»¬åœ¨ç°å®ä¸–ç•Œä»»ä½•æ—¶å€™éƒ½èƒ½çœ‹åˆ°æ··åˆï¼šå½“å…‰ç©¿è¿‡ç»ç’ƒæ—¶ï¼Œå½“å®ƒä»è¡¨é¢åå°„æ—¶ï¼Œå½“å…‰æºæœ¬èº«å åŠ åœ¨èƒŒæ™¯ä¸Šæ—¶ï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨æ™šä¸Šçœ‹åˆ°ä¸€ç›æ˜äº®çš„è·¯ç¯å‘¨å›´çš„è€€æ–‘ã€‚</p><p>OpenGLæœ‰ä¸åŒçš„æ··åˆæ¨¡å¼ï¼Œæˆ‘ä»¬èƒ½ä½¿ç”¨å®ƒæ¨¡æ‹Ÿè¿™ç§æ•ˆæœã€‚åœ¨OpenGLä¸­ï¼Œæ··åˆå‘ç”Ÿåœ¨æ¸²æŸ“è¿‡ç¨‹çš„åæœŸï¼šä¸€æ—¦ç‰‡æ®µç€è‰²å™¨è®¡ç®—å‡ºç‰‡æ®µçš„æœ€ç»ˆè¾“å‡ºé¢œè‰²å¹¶ä¸”å®ƒå³å°†è¢«å†™å…¥å¸§ç¼“å†²åŒºï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™ç‰‡æ®µä¼šè¦†ç›–ä¹‹å‰æ‰€æœ‰å†…å®¹ï¼Œä½†å¦‚æœå¯ç”¨äº†æ··åˆï¼Œé‚£ä¹ˆè¯¥ç‰‡æ®µå°†ä¸ä¹‹å‰çš„ç‰‡æ®µæ··åˆã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“<code>glBlendEquation()</code>è®¾ç½®ä¸ºé»˜è®¤å€¼<code>GL_FUNC_ADD</code>æ—¶OpenGLçš„é»˜è®¤æ··åˆæ–¹ç¨‹å¼ä¸ºï¼š</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¾“å‡º = ï¼ˆæºå› å­ * æºç‰‡æ®µï¼‰ + ï¼ˆç›®æ ‡å› å­ * ç›®æ ‡ç‰‡æ®µï¼‰</span></span><br><span class="line">output = (source factor * source fragment) + (destination factor * destination fragment)</span><br></pre></td></tr></table></div></figure><p>OpenGL ES 2 ä¸­è¿˜æœ‰å¦å¤–ä¸¤ç§æ¨¡å¼<code>GL_FUNC_SUBTRACT</code>å’Œ<code>GL_FUNC_REVERSE_SUBTRACT</code>ã€‚<br>è¿™äº›å¯èƒ½åœ¨ä»¥åçš„æ•™ç¨‹ä¸­ä»‹ç»ï¼Œç„¶è€Œï¼Œå½“æˆ‘å°è¯•è°ƒç”¨æ­¤å‡½æ•°æ—¶ï¼Œæˆ‘åœ¨Nexus Sä¸Šé‡åˆ°äº†<br><code>UnsupportedOperationException</code>ï¼Œå› æ­¤Androidå®ç°å¯èƒ½å®é™…ä¸Šä¸æ”¯æŒæ­¤åŠŸèƒ½ã€‚<br>è¿™ä¸æ˜¯ä¸–ç•Œæœ«æ—¥ï¼Œå› ä¸ºä½ å¯ä»¥ç”¨<code>GL_FUNC_ADD</code>åšå¾ˆå¤šäº‹æƒ…ã€‚</p><p>ä½¿ç”¨å‡½æ•°<code>glBlendFunc()</code>è®¾ç½®æºå› å­å’Œç›®æ ‡å› å­ã€‚ä¸‹é¢å°†ç»™å‡ºå‡ ä¸ªå¸¸è§æ··åˆå› å­çš„æ¦‚è¿°ï¼›æ›´å¤šä¿¡æ¯ä»¥åŠä¸åŒå¯èƒ½çš„å› ç´ çš„åˆ—ä¸¾ï¼Œè¯·å‚é˜…<a href="http://www.khronos.org/opengles/sdk/docs/man/" target="_blank" rel="noopener">Khronosåœ¨çº¿æ‰‹å†Œ</a>ï¼š</p><ul><li><a href="https://www.khronos.org/registry/OpenGL-Refpages/es2.0/xhtml/glBlendFunc.xml" target="_blank" rel="noopener">glBlendFunc()</a></li><li><a href="https://www.khronos.org/registry/OpenGL-Refpages/es2.0/xhtml/glBlendEquation.xml" target="_blank" rel="noopener">glBlendEquation()</a></li></ul><h3 id="æˆªå–ï¼ˆClampingï¼‰">æˆªå–ï¼ˆClampingï¼‰<a href="post/Learn-OpenGL-Lesson-Five#æˆªå–ï¼ˆClampingï¼‰"></a></h3><p>OpenGLé¢„æœŸçš„è¾“å…¥è¢«é™åˆ¶åœ¨[0,1]çš„èŒƒå›´å†…ï¼Œå¹¶ä¸”è¾“å…¥ä¹Ÿè¢«é™åˆ¶åœ¨[0,1]ã€‚è¿™åœ¨å®è·µä¸­æ„å‘³ç€å½“æ‚¨è¿›è¡Œæ··åˆæ—¶ï¼Œé¢œè‰²å¯ä»¥åœ¨è‰²è°ƒä¸­ç§»åŠ¨ã€‚<br>å¦‚æœç»§ç»­æƒ³å¸§ç¼“å†²åŒºæ·»åŠ çº¢è‰²ï¼ˆRGB = 1ï¼Œ0ï¼Œ0ï¼‰ï¼Œæœ€ç»ˆé¢œè‰²ä¼šæ˜¯çº¢è‰²ã€‚å¦‚æœæƒ³æ·»åŠ ä¸€ç‚¹å„¿ç»¿è‰²ï¼Œæ‚¨è¦æ·»åŠ ï¼ˆRGB = 1ï¼Œ0.1ï¼Œ0ï¼‰åˆ°ç¼“å†²åŒºï¼Œå³ä½¿æ‚¨å¼€å§‹å¸¦çº¢è‰²çš„è‰²è°ƒï¼Œæœ€åä¹Ÿä¼šå¾—åˆ°é»„è‰²ï¼<br>æ‰“å¼€æ··åˆæ—¶ï¼Œæ‚¨å¯ä»¥åœ¨æœ¬è¯¾ç¨‹çš„Demoä¸­çœ‹åˆ°æ­¤æ•ˆæœï¼šä¸åŒé¢œè‰²çš„é‡å çš„é¢œè‰²å˜å¾—è¿‡é¥±å’Œã€‚</p><h2 id="ä¸åŒç±»å‹çš„æ··åˆä»¥åŠå®ƒä»¬æœ‰æ€æ ·ä¸åŒçš„æ•ˆæœ">ä¸åŒç±»å‹çš„æ··åˆä»¥åŠå®ƒä»¬æœ‰æ€æ ·ä¸åŒçš„æ•ˆæœ<a href="post/Learn-OpenGL-Lesson-Five#ä¸åŒç±»å‹çš„æ··åˆä»¥åŠå®ƒä»¬æœ‰æ€æ ·ä¸åŒçš„æ•ˆæœ"></a></h2><h3 id="ç›¸åŠ æ··åˆï¼ˆAdditive-blendingï¼‰">ç›¸åŠ æ··åˆï¼ˆAdditive blendingï¼‰<a href="post/Learn-OpenGL-Lesson-Five#ç›¸åŠ æ··åˆï¼ˆAdditive-blendingï¼‰"></a></h3><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:center"><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190213200752.png" alt="rgb"></th></tr></thead><tbody><tr><td style="text-align:center"><em>RGBé¢œè‰²ç›¸åŠ æ¨¡å‹ï¼› æ¥æºï¼šWikipedia</em></td></tr></tbody></table></div></div><p>ç›¸åŠ æ··åˆæ˜¯å½“æˆ‘ä»¬æ·»åŠ ä¸åŒé¢œè‰²åœ¨ä¸€èµ·çš„æ··åˆï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„è§†è§‰ä¸å…‰ä¸€èµ·å·¥ä½œçš„æ¨¡å¼ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å¦‚ä½•åœ¨æˆ‘ä»¬çš„æ˜¾ç¤ºå™¨ä¸Šæ„ŸçŸ¥æ•°ç™¾ä¸‡ç§ä¸åŒçš„é¢œè‰²â€”â€”å®ƒä»¬å®é™…ä¸Šåªæ˜¯å°†ä¸‰ç§ä¸åŒçš„åŸè‰²æ··åˆåœ¨ä¸€èµ·ã€‚</p><p>è¿™ç§æ··åˆåœ¨3Dæ··åˆä¸­å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚åœ¨ç²’å­æ•ˆæœä¸­ï¼Œå®ƒä»¬ä¼¼ä¹å‘å‡ºå…‰çº¿å’Œè¦†ç›–ç‰©ï¼Œä¾‹å¦‚ç¯å…‰å‘¨å›´çš„å…‰æ™•ï¼Œæˆ–å…‰å‰‘å‘¨å›´çš„å‘å…‰æ•ˆæœã€‚</p><p>ç›¸åŠ æ··åˆèƒ½é€šè¿‡è°ƒç”¨<code>glBlendFunc(GL_ONE, GL_ONE)</code>æŒ‡å®šï¼Œ<br>æ··åˆçš„ç»“æœç­‰å¼<code>è¾“å‡º=ï¼ˆ1 * æºç‰‡æ®µï¼‰ + ï¼ˆ1 * ç›®æ ‡ç‰‡æ®µï¼‰</code>ï¼Œè¿ç®—åï¼š<code>è¾“å‡º=æºç‰‡æ®µ + ç›®æ ‡ç‰‡æ®µ</code></p><h3 id="ç›¸ä¹˜æ··åˆï¼ˆMultiplicative-blendingï¼‰">ç›¸ä¹˜æ··åˆï¼ˆMultiplicative blendingï¼‰<a href="post/Learn-OpenGL-Lesson-Five#ç›¸ä¹˜æ··åˆï¼ˆMultiplicative-blendingï¼‰"></a></h3><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:center"><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190213202603.png" alt="rg"></th></tr></thead><tbody><tr><td style="text-align:center"><em>å…‰ç…§è´´å›¾çš„ä¸€ä¸ªä¾‹å­</em></td></tr></tbody></table></div></div><p>ç›¸ä¹˜æ··åˆï¼ˆä¹Ÿç§°ä¸ºè°ƒåˆ¶ï¼‰æ˜¯å¦ä¸€ç§æœ‰ç”¨çš„æ··åˆæ¨¡å¼ï¼Œå®ƒè¡¨ç¤ºå…‰åœ¨é€šè¿‡è¿‡æ»¤å™¨æ—¶çš„è¡Œä¸ºæ–¹å¼ï¼Œæˆ–ä»è¢«ç‚¹ç‡ƒçš„ç‰©ä½“åå°„å¹¶è¿›å…¥æˆ‘ä»¬çš„çœ¼ç›ã€‚ä¸€ä¸ªçº¢è‰²çš„ç‰©ä½“çœ‹ä¸Šå»æ˜¯çº¢è‰²æ˜¯å› ä¸ºç™½å…‰ç…§å°„åˆ°è¿™ä¸ªç‰©ä½“ä¸Šï¼Œè“å…‰å’Œç»¿å…‰è¢«å¸æ”¶ï¼Œåªæœ‰çº¢å…‰åå°„å›æˆ‘ä»¬çš„çœ¼ç›ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°ä¸€äº›çº¢è‰²å’Œç»¿è‰²ï¼Œä½†æ˜¯å¾ˆå°‘ä¼šæœ‰ä¸€ç‚¹è“è‰²ã€‚</p><p>å½“å¤šçº¹ç†ä¸å¯ç”¨æ—¶ï¼Œä¹˜æ³•æ··åˆç”¨äºåœ¨æ¸¸æˆä¸­å®ç°å…‰ç…§è´´å›¾ã€‚çº¹ç†ä¸å…‰ç…§è´´å›¾ç›¸ä¹˜ï¼Œä»¥å¡«å……åœ¨æ˜äº®å’Œé˜´å½±çš„åŒºåŸŸã€‚</p><p>ç›¸ä¹˜æ··åˆèƒ½é€šè¿‡è°ƒç”¨<code>glBlendFunc(GL_DST_COLOR, GL_ZERO)</code>æŒ‡å®šï¼Œ<br>å…¶æ··åˆçš„ç»“æœç­‰å¼<code>è¾“å‡º=ï¼ˆç›®æ ‡ç‰‡æ®µ * æºç‰‡æ®µï¼‰+ ï¼ˆ0 * ç›®æ ‡ç‰‡æ®µï¼‰</code>ï¼Œå†™ä½œï¼š<code>è¾“å‡º=ç›®æ ‡ç‰‡æ®µ * æºç‰‡æ®µ</code>ã€‚</p><h3 id="æ’å€¼æ··åˆï¼ˆInterpolative-blendingï¼‰">æ’å€¼æ··åˆï¼ˆInterpolative blendingï¼‰<a href="post/Learn-OpenGL-Lesson-Five#æ’å€¼æ··åˆï¼ˆInterpolative-blendingï¼‰"></a></h3><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:center"><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190213205158.png" alt="textures"></th></tr></thead><tbody><tr><td style="text-align:center"><em>ä¸€ä¸ªä¸¤ä¸ªçº¹ç†ä¸€èµ·æ’å€¼çš„æ¡ˆä¾‹</em></td></tr></tbody></table></div></div><p>æ’å€¼æ··åˆç»“åˆäº†ä¹˜æ³•å’ŒåŠ æ³•ï¼Œä»¥æä¾›æ’å€¼æ•ˆæœã€‚ä¸æ·»åŠ å’Œè°ƒåˆ¶æœ¬èº«ä¸åŒï¼Œæ­¤æ··åˆæ¨¡å¼ä¹Ÿå¯æ˜¯ä¾èµ–ç»˜åˆ¶é¡ºåºçš„ã€‚å› æ­¤åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœæ‚¨å…ˆç”»å‡ºæœ€è¿œçš„åŠé€æ˜ç‰©ä½“ï¼Œç„¶åç»˜åˆ¶æ›´è¿‘çš„ç‰©ä½“ï¼Œç»“æœæ‰ä¼šæ˜¯æ­£ç¡®ã€‚å³ä½¿æ’åºä¹Ÿä¸æ˜¯å®Œç¾ï¼Œå› ä¸ºä¸‰è§’å½¢å¯èƒ½é‡å å¹¶ç›¸äº¤ï¼Œä½†äº§ç”Ÿçš„ä¼ªåƒå¯èƒ½æ˜¯å¯æ¥å—çš„ã€‚</p><p>æ’å€¼é€šå¸¸æ˜¯å°†ç›¸é‚»çš„è¡¨é¢æ··åˆåœ¨ä¸€èµ·ï¼Œä»¥åŠåšæœ‰è‰²ç»ç’ƒæˆ–æ·¡å…¥æ·¡å‡ºçš„æ•ˆæœã€‚ä¸Šé¢è¿™ä¸ªå›¾ç‰‡æ˜¾ç¤ºäº†ä¸¤ä¸ªçº¹ç†ï¼ˆçº¹ç†æ¥è‡ª<a href="http://pdtextures.blogspot.com/" target="_blank" rel="noopener">å…¬å…±é¢†åŸŸçº¹ç†</a>ï¼‰ä½¿ç”¨æ’å€¼æ··åˆåœ¨ä¸€èµ·ã€‚</p><p>æ’å€¼æ··åˆèƒ½é€šè¿‡è°ƒç”¨<code>glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA)</code>æŒ‡å®šï¼Œ<br>å…¶æ··åˆç»“æœç­‰å¼<code>è¾“å‡º = ï¼ˆæºalpha * æºç‰‡æ®µï¼‰ + ï¼ˆï¼ˆ1 - æºalphaï¼‰ * ç›®æ ‡ç‰‡æ®µï¼‰</code>ã€‚è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æ­£åœ¨ç»˜åˆ¶ä¸€ä¸ªåªæœ‰25%ä¸é€æ˜çš„ç»¿è‰²ï¼ˆ0ï¼Œ1ï¼Œ0ï¼‰ï¼Œå½“å‰å±å¹•ä¸Šçš„ç‰©ä½“æ—¶çº¢è‰²ï¼ˆ1ï¼Œ0ï¼Œ0ï¼‰ã€‚</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è¾“å‡º = ï¼ˆæºå› å­ * æºç‰‡æ®µï¼‰ + ï¼ˆç›®æ ‡å› å­ * ç›®æ ‡ç‰‡æ®µï¼‰</span><br><span class="line">è¾“å‡º = ï¼ˆæºalpha * æºç‰‡æ®µï¼‰ + ï¼ˆï¼ˆ<span class="number">1</span> - æºalphaï¼‰ * ç›®æ ‡ç‰‡æ®µï¼‰</span><br><span class="line"></span><br><span class="line">è¾“å‡º = (<span class="number">0.25</span> * (<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>)) + (<span class="number">0.72</span> * (<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">è¾“å‡º = (<span class="number">0</span>, <span class="number">0.25</span>, <span class="number">0</span>) + (<span class="number">0.75</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">è¾“å‡º = (<span class="number">0.75</span>, <span class="number">0.25</span>, <span class="number">0</span>)</span><br></pre></td></tr></table></div></figure><p>æ³¨æ„ï¼Œæˆ‘ä»¬ä¸éœ€è¦å¯¹ç›®æ ‡alphaåšä»»ä½•æ¶‰åŠï¼Œå› ä¸ºè¿™ä¸ªå¸§ç¼“å†²åŒºæœ¬èº«ä¸éœ€è¦alphaé€šé“ï¼Œè¿™ä¸ºæˆ‘ä»¬æä¾›äº†æ›´å¤šçš„é¢œè‰²é€šé“ä½ã€‚</p><h2 id="ä½¿ç”¨æ··åˆ">ä½¿ç”¨æ··åˆ<a href="post/Learn-OpenGL-Lesson-Five#ä½¿ç”¨æ··åˆ"></a></h2><p>åœ¨æˆ‘ä»¬çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬çš„Demoå°†ä½¿ç”¨ç›¸åŠ æ··åˆå°†ç«‹æ–¹ä½“æ˜¾ç¤ºä¸ºå…‰çš„å‘å°„å™¨ã€‚å‘å…‰çš„ä¸œè¥¿ä¸éœ€è¦å…¶ä»–å…‰æºç…§äº®ï¼Œå› æ­¤è¿™ä¸ªDemoä¸­æ²¡æœ‰ç¯å…‰ã€‚æˆ‘ä¹Ÿåˆ é™¤äº†çº¹ç†ï¼Œè™½ç„¶å®ƒå¯ä»¥å¾ˆå¥½åœ°ä½¿ç”¨ã€‚æœ¬è¯¾ç¨‹çš„ç€è‰²å™¨ç¨‹åºå¾ˆç®€å•ï¼›æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªå¯ä¼ é€’é¢œè‰²çš„ç€è‰²å™¨ã€‚</p><h3 id="é¡¶ç‚¹ç€è‰²å™¨">é¡¶ç‚¹ç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Five#é¡¶ç‚¹ç€è‰²å™¨"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVPMatrix;</span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Position;</span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Color;</span><br><span class="line"></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    v_Color = a_Color;</span><br><span class="line">    <span class="built_in">gl_Position</span> = u_MVPMatrix * a_Position;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="ç‰‡æ®µç€è‰²å™¨">ç‰‡æ®µç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Five#ç‰‡æ®µç€è‰²å™¨"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">precision</span> <span class="keyword">mediump</span> <span class="type">float</span>;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">gl_FragColor</span> = v_Color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="æ‰“å¼€æ··åˆ">æ‰“å¼€æ··åˆ<a href="post/Learn-OpenGL-Lesson-Five#æ‰“å¼€æ··åˆ"></a></h3><p>æ‰“å¼€æ··åˆå°±åƒæ˜¯åšä¸€äº›æ–¹æ³•è°ƒç”¨é‚£ä¹ˆç®€å•ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…³é—­å‰”é™¤å»æ‰èƒŒé¢</span></span><br><span class="line">GLES20.glDisable(GLES20.GL_CULL_FACE);</span><br><span class="line"><span class="comment">// å…³é—­æ·±åº¦æµ‹è¯•</span></span><br><span class="line">GLES20.glDisable(GLES20.GL_DEPTH_TEST);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨æ··åˆ</span></span><br><span class="line">GLES20.glEnable(GLES20.GL_BLEND);</span><br><span class="line">GLES20.glBlendFunc(GLES20.GL_ONE, GLES20.GL_ONE);</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬å…³é—­èƒŒé¢å‰”é™¤ï¼Œæ˜¯å› ä¸ºå¦‚æœç«‹æ–¹ä½“æ˜¯åŠé€æ˜çš„ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬èƒ½çœ‹åˆ°ç«‹æ–¹ä½“çš„èƒŒé¢ã€‚æˆ‘ä»¬éœ€è¦ç»˜åˆ¶å®ƒä»¬ï¼Œå¦åˆ™å¯èƒ½çœ‹èµ·æ¥ä¼šå¾ˆå¥‡æ€ªã€‚å‡ºäºåŒæ ·çš„åŸå› æˆ‘ä»¬å…³é—­äº†æ·±åº¦æµ‹è¯•ã€‚</p><h2 id="å­¦ä¹ è§¦æ‘¸äº‹ä»¶å¹¶è¿›è¡Œæ“ä½œ">å­¦ä¹ è§¦æ‘¸äº‹ä»¶å¹¶è¿›è¡Œæ“ä½œ<a href="post/Learn-OpenGL-Lesson-Five#å­¦ä¹ è§¦æ‘¸äº‹ä»¶å¹¶è¿›è¡Œæ“ä½œ"></a></h2><p>ä½ å°†æ³¨æ„åˆ°ï¼Œå½“æ‚¨è¿è¡ŒDemoæ—¶ï¼Œå¯ä»¥é€šè¿‡ç‚¹å‡»å±å¹•æ¥æ‰“å¼€å’Œå…³é—­æ··åˆã€‚</p><p>ç°å®è§¦æ‘¸äº‹ä»¶ï¼Œæ‚¨é¦–å…ˆéœ€è¦åˆ›å»ºæ‚¨çš„<code>GLSurfaceView</code>è‡ªå®šä¹‰viewã€‚åœ¨è¿™ä¸ªviewä¸­ï¼Œåˆ›å»ºä¸€ä¸ªé»˜è®¤æ„é€ ç”¨æ¥è°ƒç”¨çˆ¶ç±»ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ–¹æ³•æ¥æ¥æ”¶ç‰¹å®šçš„æ¸²æŸ“å™¨æ›¿æ¢å¸¸ç”¨æ¥å£ï¼Œå¹¶è¦†å†™<code>onTouchEvent()</code>ã€‚æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªå…·ä½“çš„æ¸²æŸ“å™¨ç±»ï¼Œå› ä¸ºæˆ‘ä»¬å°†è¦åœ¨<code>onTouchEvent()</code>æ–¹æ³•ä¸­è°ƒç”¨è¿™ä¸ªç±»çš„ç‰¹å®šæ–¹æ³•ã€‚</p><p>åœ¨Androidä¸­ï¼ŒOpenGLæ¸²æŸ“å™¨åœ¨ç‹¬ç«‹çš„çº¿ç¨‹ä¸­å®Œæˆï¼Œå› æ­¤æˆ‘ä»¬è¿˜å°†çœ‹çœ‹å¦‚ä½•å®‰å…¨çš„ä»æ­£åœ¨ç›‘å¬è§¦æ‘¸äº‹ä»¶çš„ä¸»çº¿ç¨‹è°ƒåº¦åˆ°å•ç‹¬çš„æ¸²æŸ“å™¨çº¿ç¨‹ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LessonFiveGLSurfaceView</span> <span class="keyword">extends</span> <span class="title">GLSurfaceView</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LessonFiveRenderer mRenderer;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LessonFiveGLSurfaceView</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">                event == <span class="keyword">null</span></span><br><span class="line">                || event.getAction() != MotionEvent.ACTION_DOWN</span><br><span class="line">                || mRenderer == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.onTouchEvent(event);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç¡®ä¿æˆ‘ä»¬åœ¨OpenGLçº¿ç¨‹ä¸Šè°ƒç”¨switchMode()</span></span><br><span class="line">        <span class="comment">// queueEvent() æ˜¯GLSurfaceViewçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå°†ä¸ºæˆ‘ä»¬åšåˆ°è¿™ç‚¹</span></span><br><span class="line">        queueEvent(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                mRenderer.switchMode();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRenderer</span><span class="params">(LessonFiveRenderer renderer)</span> </span>&#123;</span><br><span class="line">        mRenderer = renderer;</span><br><span class="line">        <span class="keyword">super</span>.setRenderer(renderer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>åœ¨<code>LessonFiveRenderer</code>ä¸­å®ç°<code>switchMode()</code></p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">switchMode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mBlending = !mBlending;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mBlending) &#123;</span><br><span class="line">        <span class="comment">// å…³é—­å‰”é™¤å»æ‰èƒŒé¢</span></span><br><span class="line">        GLES20.glDisable(GLES20.GL_CULL_FACE);</span><br><span class="line">        <span class="comment">// å…³é—­æ·±åº¦æµ‹è¯•</span></span><br><span class="line">        GLES20.glDisable(GLES20.GL_DEPTH_TEST);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯åŠ¨æ··åˆ</span></span><br><span class="line">        GLES20.glEnable(GLES20.GL_BLEND);</span><br><span class="line">        GLES20.glBlendFunc(GLES20.GL_ONE, GLES20.GL_ONE);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        GLES20.glEnable(GLES20.GL_CULL_FACE);</span><br><span class="line">        GLES20.glEnable(GLES20.GL_DEPTH_TEST);</span><br><span class="line">        GLES20.glDisable(GLES20.GL_BLEND);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>ä»”ç»†çœ‹<code>LessonFiveGLSurfaceView::onTouchEvent()</code>ï¼Œä¸»è¦è®°ä½è§¦æ‘¸äº‹ä»¶éƒ½æ˜¯åœ¨UIä¸»çº¿ç¨‹ä¸­<br>ï¼Œè€Œ<code>GLSurfaceView</code>åœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ä¸­åˆ›å»ºOpenGL ESä¸Šä¸‹æ–‡ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„æ¸²æŸ“å™¨çš„å›è°ƒä¹Ÿåœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ä¸­è¿è¡Œã€‚è¿™æ˜¯ä¸€ä¸ªéœ€è¦è®°ä½çš„é‡ç‚¹ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½å†å…¶ä»–çº¿ç¨‹è°ƒç”¨OpenGLå¹¶å¸Œæœ›å…¶å·¥ä½œã€‚</p><p>è¾›è¿çš„æ˜¯ï¼Œç¼–å†™<code>GLSurfaceView</code>çš„äººä¹Ÿæƒ³åˆ°äº†è¿™ç‚¹ï¼Œå¹¶æä¾›äº†ä¸€ä¸ª<code>queueEvent()</code>æ–¹æ³•ï¼Œè¿™ä½¿å¾—ä½ å¯ä»¥è°ƒç”¨OpenGLçº¿ç¨‹ä¸Šçš„ä¸œè¥¿ã€‚å› æ­¤ï¼Œå½“æˆ‘ä»¬æƒ³é€šè¿‡ç‚¹å‡»å±å¹•æ‰“å¼€å’Œå…³é—­æ··åˆæ—¶ï¼Œæˆ‘ä»¬ç¡®ä¿é€šè¿‡åœ¨UIçº¿ç¨‹ä¸­ä½¿ç”¨<code>queueEvent()</code>æ¥æ­£ç¡®è°ƒç”¨OpenGLçº¿ç¨‹ä¸­çš„å†…å®¹ã€‚</p><h3 id="è¿›ä¸€æ­¥ç»ƒä¹ ">è¿›ä¸€æ­¥ç»ƒä¹ <a href="post/Learn-OpenGL-Lesson-Five#è¿›ä¸€æ­¥ç»ƒä¹ "></a></h3><p>è¿™ä¸ªDemoç›®å‰ä»…ä½¿ç”¨ç›¸åŠ æ··åˆï¼Œå°è¯•æ”¹å˜å…¶ä¸ºæ’å€¼æ··åˆå¹¶é‡æ–°æ·»åŠ ç¯å…‰å’Œçº¹ç†ã€‚å¦‚æœæ‚¨åªåœ¨é»‘è‰²èƒŒæ™¯ä¸Šç»˜åˆ¶ä¸¤ä¸ªåŠé€æ˜çº¹ç†ï¼Œç»˜åˆ¶é¡ºåºæ˜¯å¦é‡è¦ï¼Ÿä»€ä¹ˆæ—¶å€™é‡è¦ï¼Ÿ</p><h2 id="æ•™ç¨‹ç›®å½•">æ•™ç¨‹ç›®å½•<a href="post/Learn-OpenGL-Lesson-Five#æ•™ç¨‹ç›®å½•"></a></h2><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five">OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six">OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven">OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVOBï¼‰</a></li></ul><h2 id="æ‰“åŒ…æ•™æ">æ‰“åŒ…æ•™æ<a href="post/Learn-OpenGL-Lesson-Five#æ‰“åŒ…æ•™æ"></a></h2><p>å¯ä»¥åœ¨Githubä¸‹è½½æœ¬è¯¾ç¨‹æºä»£ç ï¼š<a href="https://github.com/learnopengles/Learn-OpenGLES-Tutorials" target="_blank" rel="noopener">ä¸‹è½½é¡¹ç›®</a><br>æœ¬è¯¾çš„ç¼–è¯‘ç‰ˆæœ¬ä¹Ÿå¯ä»¥å†Androidå¸‚åœºä¸‹ï¼š<a href="https://market.android.com/details?id=com.learnopengles.android" target="_blank" rel="noopener">google play ä¸‹è½½apk</a><br>â€œæˆ‘â€ä¹Ÿç¼–è¯‘äº†ä¸ªapkï¼Œæ–¹ä¾¿å¤§å®¶ä¸‹è½½ï¼š<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">github download</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ–‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Five: An Introduction to Blending&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.learnopengles.com/android-lesson-five-an-introduction-to-blending/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.learnopengles.com/android-lesson-five-an-introduction-to-blending/&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/categories/OpenGL/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/tags/OpenGL/"/>
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</title>
    <link href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four/index.html"/>
    <id>https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four/index.html</id>
    <published>2019-02-08T11:26:29.000Z</published>
    <updated>2019-04-08T06:56:03.158Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»è¯‘æ–‡</p></blockquote><p>åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Four: Introducing Basic Texturing<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.learnopengles.com/android-lesson-four-introducing-basic-texturing/" target="_blank" rel="noopener">http://www.learnopengles.com/android-lesson-four-introducing-basic-texturing/</a><br><a id="more"></a></p><hr><h1 id="ä»‹ç»çº¹ç†åŸºç¡€">ä»‹ç»çº¹ç†åŸºç¡€<a href="post/Learn-OpenGL-Lesson-Four#ä»‹ç»çº¹ç†åŸºç¡€"></a></h1><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>è¿™æ˜¯æˆ‘ä»¬Androidç³»åˆ—çš„ç¬¬å››ä¸ªè¯¾ç¨‹ã€‚<br>åœ¨æœ¬è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†æ·»åŠ æˆ‘ä»¬åœ¨<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">ç¬¬ä¸‰è¯¾</a><br>ä¸­å­¦åˆ°çš„å†…å®¹ï¼Œå¹¶å­¦ä¹ å¦‚ä½•æ·»åŠ çº¹ç†ã€‚<br>æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä»åº”ç”¨èµ„æºä¸­è·å–ä¸€å¼ <br>å›¾ç‰‡åŠ è½½åˆ°OpenGLESä¸­ï¼Œå¹¶å±•ç¤ºåˆ°<br>å±å¹•ä¸Šã€‚<br><br>è·Ÿç€æˆ‘ä¸€èµ·æ¥ï¼Œä½ å°†é©¬ä¸Šæ˜ç™½çº¹ç†çš„<br>åŸºæœ¬ä½¿ç”¨æ–¹å¼ã€‚</td><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190208193740.png" alt="screenshot"></td></tr></tbody></table></div></div><h2 id="å‰ææ¡ä»¶">å‰ææ¡ä»¶<a href="post/Learn-OpenGL-Lesson-Four#å‰ææ¡ä»¶"></a></h2><p>æœ¬ç³»åˆ—æ¯ä¸ªè¯¾ç¨‹æ„å»ºéƒ½æ˜¯ä»¥å‰ä¸€ä¸ªè¯¾ç¨‹ä¸ºåŸºç¡€ï¼Œè¿™èŠ‚è¯¾æ˜¯<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">ç¬¬ä¸‰è¯¾</a>çš„æ‰©å±•ï¼Œå› æ­¤è¯·åŠ¡å¿…åœ¨ç»§ç»­ä¹‹å‰å¤ä¹ è¯¥è¯¾ç¨‹ã€‚</p><blockquote><p>å·²ä¸‹æ˜¯æœ¬ç³»åˆ—è¯¾ç¨‹çš„å‰å‡ è¯¾ï¼š</p></blockquote><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li></ul><h2 id="çº¹ç†åŸºç¡€">çº¹ç†åŸºç¡€<a href="post/Learn-OpenGL-Lesson-Four#çº¹ç†åŸºç¡€"></a></h2><p>çº¹ç†æ˜ å°„çš„è‰ºæœ¯ï¼ˆä»¥åŠç…§æ˜ï¼‰æ˜¯æ„å»ºé€¼çœŸçš„3Dä¸–ç•Œæœ€é‡è¦çš„éƒ¨åˆ†ã€‚æ²¡æœ‰çº¹ç†æ˜ å°„ï¼Œä¸€åˆ‡éƒ½æ˜¯å¹³æ»‘çš„é˜´å½±ï¼Œçœ‹èµ·æ¥å¾ˆäººå·¥ï¼Œå°±åƒæ˜¯90å¹´ä»£çš„è€å¼æ§åˆ¶å°æ¸¸æˆã€‚</p><p>ç¬¬ä¸€ä¸ªå¼€å§‹å¤§é‡ä½¿ç”¨çº¹ç†çš„æ¸¸æˆï¼Œå¦‚Doomå’ŒDuke Nukem 3Dï¼Œé€šè¿‡å¢åŠ è§†è§‰å†²å‡»åŠ›ï¼Œå¤§å¤§æå‡äº†æ¸¸æˆçš„çœŸå®æ„Ÿâ€”â€”å¦‚æœåœ¨æ™šä¸Šç©å¯èƒ½ä¼šçœŸçš„å“å”¬åˆ°æˆ‘ä»¬ã€‚</p><blockquote><p>è¿™é‡Œæˆ‘ä»¬æ¥çœ‹æœ‰çº¹ç†å’Œæ²¡æœ‰çº¹ç†çš„åœºæ™¯</p></blockquote><div class="article-bounded"><div class="article-table"><table><tbody><tr><td style="text-align:center"><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190208215006.png" alt="pre-fragment lighting"><br><em>æ¯ç‰‡æ®µç…§æ˜ï¼›<br>æ­£æ–¹å½¢å››ä¸ªé¡¶ç‚¹ä¸­å¿ƒä½ç½®</em></td><td style="text-align:center"><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190208215108.png" alt="added texture"><br><em>æ·»åŠ äº†çº¹ç†ï¼›<br>æ­£æ–¹å½¢å››ä¸ªé¡¶ç‚¹ä¸­å¿ƒä½ç½®</em></td><td>çœ‹å·¦è¾¹çš„å›¾ç‰‡ï¼Œè¿™ä¸ªåœºæ™¯é€šè¿‡æ¯åƒ<br>ç´ ç…§æ˜å’Œç€è‰²ç‚¹äº®ã€‚è¿™ä¸ªåœºæ™¯çœ‹èµ·<br>æ¥éå¸¸å¹³æ»‘ï¼Œç°å®ç”Ÿæ´»ä¸­æˆ‘ä»¬èµ°è¿›<br>ä¸€ä¸ªæˆ¿é—´æœ‰å……æ»¡äº†å…‰æ»‘é˜´å½±çš„ä¸œè¥¿<br>å°±åƒæ˜¯è¿™ä¸ªç«‹æ–¹ä½“ã€‚<br><br>åœ¨çœ‹å³è¾¹çš„å›¾ç‰‡ï¼ŒåŒæ ·çš„åœºæ™¯ç°åœ¨<br>çº¹ç†åŒ–äº†ã€‚ç¯å¢ƒå…‰ä¹Ÿå¢åŠ äº†ï¼Œå› ä¸º<br>çº¹ç†çš„ä½¿ç”¨ä½¿æ•´ä¸ªåœºæ™¯å˜æš—ï¼Œä¹Ÿå¯<br>ä»¥çœ‹åˆ°çº¹ç†å¯¹ä¾§é¢ç«‹æ–¹ä½“çš„å½±å“ã€‚<br>ç«‹æ–¹ä½“å…·æœ‰å’Œä»¥å‰ç›¸åŒæ•°é‡çš„å¤šè¾¹<br>å½¢ï¼Œä½†å®ƒä»¬æœ‰æ–°çº¹ç†çœ‹èµ·æ¥æ›´åŠ è¯¦<br>ç»†ã€‚<br><br>æ»¡è¶³äºé‚£äº›å¥½å¥‡çš„äººï¼Œè¿™ä¸ªçº¹ç†çš„<br>èµ„æºæ¥è‡ªäº<a href="http://pdtextures.blogspot.com/2008/03/first-set.html" target="_blank" rel="noopener">å…¬å…±é¢†åŸŸçš„èµ„æº</a></td></tr></tbody></table></div></div><h2 id="çº¹ç†åæ ‡">çº¹ç†åæ ‡<a href="post/Learn-OpenGL-Lesson-Four#çº¹ç†åæ ‡"></a></h2><p>åœ¨OpengGLä¸­ï¼Œçº¹ç†åæ ‡æ—¶å¸¸ä½¿ç”¨åæ ‡(s,t)ä»£æ›¿(x,y)ã€‚(s,t)è¡¨ç¤ºçº¹ç†ä¸Šçš„ä¸€ä¸ªçº¹ç†å…ƒç´ ï¼Œç„¶åæ˜ å°„åˆ°å¤šè¾¹å½¢ã€‚å¦å¤–éœ€è¦æ³¨æ„è¿™äº›çº¹ç†åæ ‡å’Œå…¶ä»–OpengGLåæ ‡ç›¸ä¼¼ï¼št(æˆ–y)è½´æŒ‡å‘ä¸Šæ–¹ï¼Œæ‰€ä»¥å€¼è¶Šé«˜æ‚¨èµ°çš„è¶Šè¿œã€‚</p><p>å¤§å¤šæ•°è®¡ç®—æœºå›¾å½¢ï¼Œyè½´æŒ‡å‘ä¸‹æ–¹ã€‚è¿™æ„å‘³ç€å·¦ä¸Šè§’æ˜¯å›¾ç‰‡çš„åŸç‚¹(0,0)ï¼Œå¹¶ä¸”yå€¼å‘ä¸‹é€’å¢ã€‚æ¢å¥è¯è¯´ï¼ŒOpenGLçš„åæ ‡ç³»å’Œå¤§å¤šæ•°è®¡ç®—æœºå›¾å½¢ç›¸åï¼Œè¿™æ˜¯æ‚¨éœ€è¦è€ƒè™‘åˆ°çš„ã€‚</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:center"><em>OpenGLçš„çº¹ç†åæ ‡ç³»</em></th></tr></thead><tbody><tr><td style="text-align:center"><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190208225905.png" alt="coordiante"></td></tr></tbody></table></div></div><h2 id="çº¹ç†æ˜ å°„åŸºç¡€">çº¹ç†æ˜ å°„åŸºç¡€<a href="post/Learn-OpenGL-Lesson-Four#çº¹ç†æ˜ å°„åŸºç¡€"></a></h2><p>åœ¨æœ¬è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†æ¥çœ‹çœ‹å¸¸è§„2Dçº¹ç†ï¼ˆ<code>GL_TEXTURE_2D</code>ï¼‰å’Œçº¢ï¼Œç»¿ï¼Œè“é¢œè‰²ä¿¡æ¯ï¼ˆ<code>GL_RGB</code>ï¼‰ã€‚OpenGL ES ä¹Ÿæä¾›å…¶ä»–çº¹ç†æ¨¡å¼è®©ä½ åšæ›´å¤šä¸åŒçš„ç‰¹æ®Šæ•ˆæœã€‚æˆ‘ä»¬å°†ä½¿ç”¨<code>GL_NEAREST</code>æŸ¥çœ‹ç‚¹é‡‡æ ·ï¼Œ<code>GL_LINEAR</code>å’ŒMIP-æ˜ å°„å°†åœ¨åé¢çš„è¯¾ç¨‹ä¸­è®²è§£ã€‚</p><p>è®©æˆ‘ä»¬ä¸€èµ·æ¥åˆ°ä»£ç éƒ¨åˆ†ï¼Œçœ‹çœ‹æ€æ ·å¼€å§‹åœ¨Androidä¸­ä½¿ç”¨åŸºæœ¬çš„çº¹ç†ã€‚</p><h3 id="é¡¶ç‚¹ç€è‰²å™¨">é¡¶ç‚¹ç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Four#é¡¶ç‚¹ç€è‰²å™¨"></a></h3><p>æˆ‘ä»¬å°†é‡‡ç”¨ä¸ŠèŠ‚è¯¾ä¸­çš„æ¯åƒç´ ç…§æ˜ç€è‰²å™¨ï¼Œå¹¶æ·»åŠ çº¹ç†æ”¯æŒã€‚</p><blockquote><p>è¿™å„¿æ˜¯æ–°çš„å˜åŒ–ï¼š</p></blockquote><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">attribute</span> <span class="type">vec2</span> a_TexCoordinate;<span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„çº¹ç†åæ ‡ä¿¡æ¯</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec2</span> v_TexCoordinate;  <span class="comment">// è¿™å°†ä¼šä¼ å…¥åˆ°ç‰‡æ®µç€è‰²å™¨</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// ä¼ å…¥çº¹ç†åæ ‡</span></span><br><span class="line">   v_TexCoordinate = a_TexCoordinate;</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæ–°çš„å±æ€§ç±»å‹<code>vec2</code>ï¼ˆä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå…ƒç´ çš„æ•°ç»„ï¼‰ï¼Œå°†ç”¨æ¥æ”¾å…¥çº¹ç†åæ ‡ä¿¡æ¯ã€‚è¿™å°†æ˜¯æ¯ä¸ªé¡¶ç‚¹éƒ½æœ‰ï¼ŒåŒä½ç½®ï¼Œé¢œè‰²ï¼Œæ³•çº¿æ•°æ®ä¸€æ ·ã€‚æˆ‘ä»¬ä¹Ÿæ·»åŠ äº†ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œå®ƒå°†é€šè¿‡ä¸‰è§’å½¢è¡¨é¢ä¸Šçš„çº¿æ€§æ’å€¼å°†æ•°æ®ä¼ å…¥ç‰‡æ®µç€è‰²å™¨ã€‚</p><h3 id="ç‰‡æ®µç€è‰²å™¨">ç‰‡æ®µç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Four#ç‰‡æ®µç€è‰²å™¨"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">uniform sampler2D u_Texture;" +  // ä¼ å…¥çº¹ç†</span><br><span class="line">...</span><br><span class="line">varying vec2 v_TexCoordinate;" + // æ’å…¥çš„çº¹ç†åæ ‡</span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">   ...</span><br><span class="line">   <span class="comment">// è®¡ç®—å…‰çº¿çŸ¢é‡å’Œé¡¶ç‚¹æ³•çº¿çš„ç‚¹ç§¯ï¼Œå¦‚æœæ³•çº¿å’Œå…‰çº¿çŸ¢é‡æŒ‡å‘ç›¸åŒçš„æ–¹å‘ï¼Œé‚£ä¹ˆå®ƒå°†è·å¾—æœ€å¤§çš„ç…§æ˜</span></span><br><span class="line">   float diffuse = max(dot(v_Normal, lightVector), 0.1);" +</span><br><span class="line">   <span class="comment">// æ ¹æ®è·ç¦»å“€å‡å…‰çº¿</span></span><br><span class="line">   diffuse = diffuse * (1.0 / (1.0 + (0.10 * distance * distance)));" +</span><br><span class="line">   <span class="comment">// æ·»åŠ ç¯å¢ƒç…§æ˜</span></span><br><span class="line">   diffuse = diffuse + 0.3;" +</span><br><span class="line">   <span class="comment">// é¢œè‰²ä¹˜ä»¥äº®åº¦å“€å‡å’Œçº¹ç†å€¼å¾—åˆ°æœ€ç»ˆçš„é¢œè‰²</span></span><br><span class="line">   gl_FragColor = v_Color * diffuse * texture2D(u_Texture, v_TexCoordinate);" +</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªæ–°çš„å¸¸é‡ç±»å‹<code>sampler2D</code>æ¥è¡¨ç¤ºå®é™…çº¹ç†æ•°æ®ï¼ˆä¸çº¹ç†åæ ‡å¯¹åº”ï¼‰ï¼Œ<br>ç”±å®šç‚¹ç€è‰²å™¨æ’å€¼ä¼ å…¥çº¹ç†åæ ‡ï¼Œæˆ‘ä»¬å†è°ƒç”¨<code>texture2D(texture, textureCoordinate)</code><br>å¾—åˆ°çº¹ç†åœ¨å½“å‰åæ ‡çš„å€¼ï¼Œæˆ‘ä»¬å¾—åˆ°è¿™ä¸ªå€¼åå†ä¹˜ä»¥å…¶ä»–é¡¹å¾—åˆ°æœ€ç»ˆè¾“å‡ºçš„é¢œè‰²ã€‚</p><p>è¿™ç§æ–¹å¼æ·»åŠ çº¹ç†ä¼šä½¿æ•´ä¸ªåœºæ™¯å˜æš—ï¼Œå› æ­¤æˆ‘ä»¬è¿˜ä¼šç¨å¾®å¢å¼ºç¯å¢ƒå…‰ç…§å¹¶å‡å°‘å…‰ç…§å“€å‡ã€‚</p><h3 id="å°†ä¸€ä¸ªå›¾ç‰‡åŠ è½½åˆ°çº¹ç†">å°†ä¸€ä¸ªå›¾ç‰‡åŠ è½½åˆ°çº¹ç†<a href="post/Learn-OpenGL-Lesson-Four#å°†ä¸€ä¸ªå›¾ç‰‡åŠ è½½åˆ°çº¹ç†"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">loadTexture</span><span class="params">(<span class="keyword">final</span> Context context, <span class="keyword">final</span> <span class="keyword">int</span> resourceId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span>[] textureHandle = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    GLES20.glGenTextures(<span class="number">1</span>, textureHandle, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (textureHandle[<span class="number">0</span>] != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">final</span> BitmapFactory.Options options = <span class="keyword">new</span> BitmapFactory.Options();</span><br><span class="line">        options.inScaled = <span class="keyword">false</span>; <span class="comment">// æ²¡æœ‰é¢„å…ˆç¼©æ”¾</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¾—åˆ°å›¾ç‰‡èµ„æº</span></span><br><span class="line">        <span class="keyword">final</span> Bitmap bitmap = BitmapFactory.decodeResource(context.getResources(), resourceId, options);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åœ¨OpenGLä¸­ç»‘å®šçº¹ç†</span></span><br><span class="line">        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textureHandle[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®è¿‡æ»¤</span></span><br><span class="line">        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST);</span><br><span class="line">        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_NEAREST);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†ä½å›¾åŠ è½½åˆ°å·²ç»‘å®šçš„çº¹ç†ä¸­</span></span><br><span class="line">        GLUtils.texImage2D(GLES20.GL_TEXTURE_2D, <span class="number">0</span>, bitmap, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å›æ”¶ä½å›¾ï¼Œå› ä¸ºå®ƒçš„æ•°æ®å·²åŠ è½½åˆ°OpenGLä¸­</span></span><br><span class="line">        bitmap.recycle();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (textureHandle[<span class="number">0</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Error loading texture."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> textureHandle[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>è¿™æ®µä»£ç å°†Android<code>res</code>æ–‡ä»¶å¤¹ä¸­çš„å›¾å½¢æ–‡ä»¶è¯»å–å¹¶åŠ è½½åˆ°OpenGLä¸­ï¼Œæˆ‘ä¼šè§£é‡Šæ¯ä¸€éƒ¨åˆ†çš„ä½œç”¨ã€‚</p><p>æˆ‘ä»¬é¦–å…ˆéœ€è¦å‘Šè¯‰OpenGLå»ä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„<code>handle</code>ï¼Œè¿™ä¸ª<code>handle</code>ä½œä¸ºä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œæˆ‘ä»¬æƒ³åœ¨OpenGLä¸­å¼•ç”¨çº¹ç†æ—¶å°±ä¼šä½¿ç”¨å®ƒã€‚</p><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">final <span class="type">int</span>[] textureHandle = new <span class="type">int</span>[<span class="number">1</span>];</span><br><span class="line">GLES20.glGenTextures(<span class="number">1</span>, textureHandle, <span class="number">0</span>);</span><br></pre></td></tr></table></div></figure><p>è¿™ä¸ªOpenGLæ–¹æ³•å¯ä»¥ç”¨æ¥åŒæ—¶ç”Ÿæˆå¤šä¸ª<code>handle</code>ï¼Œè¿™é‡Œæˆ‘ä»¬ä»…ç”Ÿæˆä¸€ä¸ªã€‚</p><p>å› ä¸ºæˆ‘ä»¬è¿™é‡Œåªéœ€è¦ä¸€ä¸ªhandleå»åŠ è½½çº¹ç†ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¾—åˆ°OpenGLèƒ½ç†è§£çš„çº¹ç†æ ¼å¼ã€‚<br>æˆ‘ä»¬ä¸èƒ½åªä»PNGæˆ–JPGæä¾›åŸå§‹æ•°æ®ï¼Œå› ä¸ºå®ƒä¸ä¼šç†è§£ã€‚æˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€æ­¥æ˜¯å°†å›¾åƒæ–‡ä»¶è§£ç ä¸ºAndroid Bitmapå¯¹è±¡ï¼š</p><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">final BitmapFactory.Options options = new BitmapFactory.Options();</span><br><span class="line">options.inScaled = <span class="literal">false</span>; <span class="comment">// æ²¡æœ‰é¢„å…ˆç¼©æ”¾</span></span><br><span class="line"><span class="comment">// å¾—åˆ°å›¾ç‰‡èµ„æº</span></span><br><span class="line">final Bitmap bitmap = BitmapFactory.decodeResource(context.getResources(), resourceId, options);</span><br></pre></td></tr></table></div></figure><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒAndroidä¼šæ ¹æ®è®¾å¤‡çš„åˆ†è¾¨ç‡å’Œä½ æ”¾ç½®å›¾ç‰‡çš„èµ„æºæ–‡ä»¶ç›®å½•è€Œé¢„å…ˆç¼©æ”¾ä½å›¾ã€‚æˆ‘ä»¬ä¸å¸Œæœ›Androidæ ¹æ®æˆ‘ä»¬çš„æƒ…å†µå¯¹ä½å›¾è¿›è¡Œç¼©æ”¾ï¼Œå› æ­¤æˆ‘ä»¬å°†<code>inScaled</code>è®¾ç½®ä¸º<code>false</code></p><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨OpenGLä¸­ç»‘å®šçº¹ç†</span></span><br><span class="line">GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textureHandle[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®è¿‡æ»¤</span></span><br><span class="line">GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST);</span><br><span class="line">GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_NEAREST);</span><br></pre></td></tr></table></div></figure><p>ç„¶åæˆ‘ä»¬ç»‘å®šçº¹ç†ï¼Œå¹¶è®¾ç½®å‡ ä¸ªå‚æ•°ï¼Œç»‘å®šä¸€ä¸ªçº¹ç†ï¼Œå¹¶å‘Šè¯‰OpenGLåç»­OpenGLè°ƒç”¨éœ€è¦è¿™æ ·è¿‡æ»¤è¿™ä¸ªçº¹ç†ã€‚æˆ‘ä»¬å°†é»˜è®¤è¿‡æ»¤å™¨è®¾ç½®ä¸º<code>GL_NEAREST</code>ï¼Œè¿™æ˜¯æœ€å¿«ï¼Œä¹Ÿæ˜¯æœ€ç²—ç³™çš„è¿‡æ»¤å½¢å¼ã€‚å®ƒæ‰€åšçš„å°±æ˜¯åœ¨å±å¹•çš„æ¯ä¸ªç‚¹é€‰æ‹©æœ€è¿‘çš„çº¹ç´ ï¼Œè¿™å¯èƒ½å¯¼è‡´å›¾åƒä¼ªåƒå’Œé”¯é½¿ã€‚</p><ul><li><code>GL_TEXTURE_MIN_FILTER</code> è¿™æ˜¯å‘Šè¯‰OpenGLåœ¨ç»˜åˆ¶å°äºåŸå§‹å¤§å°ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰çš„çº¹ç†æ—¶è¦åº”ç”¨å“ªç§ç±»å‹çš„è¿‡æ»¤ã€‚</li><li><code>GL_TEXTURE_MAG_FILTER</code> è¿™æ˜¯å‘Šè¯‰OpenGLåœ¨æ”¾å¤§çº¹ç†åˆ°åŸå§‹å¤§å°æ—¶è¦åº”ç”¨å“ªç§ç±»å‹çš„è¿‡æ»¤ã€‚</li></ul><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†ä½å›¾åŠ è½½åˆ°å·²ç»‘å®šçš„çº¹ç†ä¸­</span></span><br><span class="line">GLUtils.texImage2D(GLES20.GL_TEXTURE_2D, <span class="number">0</span>, bitmap, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å›æ”¶ä½å›¾ï¼Œå› ä¸ºå®ƒçš„æ•°æ®å·²åŠ è½½åˆ°OpenGLä¸­</span></span><br><span class="line">bitmap.recycle();</span><br></pre></td></tr></table></div></figure><p>å®‰å“æœ‰ä¸€ä¸ªéå¸¸å®ç”¨çš„åŠŸèƒ½å¯ä»¥ç›´æ¥å°†ä½å›¾åŠ è½½åˆ°OpenGLä¸­ã€‚ä¸€æ—¦æ‚¨å°†èµ„æºè¯»å…¥Bitmapå¯¹è±¡<code>GLUtils.texImage2D()</code>å°†è´Ÿè´£å…¶ä»–äº‹æƒ…ï¼Œè¿™ä¸ªæ–¹æ³•çš„ç­¾åï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">texImage2D</span> <span class="params">(<span class="keyword">int</span> target, <span class="keyword">int</span> level, Bitmap bitmap, <span class="keyword">int</span> border)</span></span></span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬æƒ³è¦ä¸€ä¸ªå¸¸è§„çš„2Dä½å›¾ï¼Œå› æ­¤æˆ‘ä»¬ä¼ å…¥<code>GL_TEXTURE_2D</code>ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚ç¬¬äºŒä¸ªå‚æ•°ç”¨äºMIP-æ˜ å°„ï¼Œå¹¶å…è®¸æ‚¨æŒ‡å®šè¦åœ¨å“ªä¸ªçº§åˆ«ä½¿ç”¨çš„å›¾åƒã€‚æˆ‘ä»¬è¿™é‡Œæ²¡æœ‰ä½¿ç”¨MIP-æ˜ å°„ï¼Œå› æ­¤æˆ‘ä»¬å°†ä¼ å…¥0è®¾ç½®ä¸ºé»˜è®¤çº§åˆ«ã€‚æˆ‘ä»¬ä¼ å…¥ä½å›¾ï¼Œç”±äºæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨è¾¹æ¡†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ å…¥0ã€‚</p><p>ç„¶ååŸå§‹ä½å›¾å¯¹è±¡è°ƒç”¨<code>recycle()</code>ï¼Œè¿™æé†’Androidå¯ä»¥å›æ”¶è¿™éƒ¨åˆ†å†…å­˜ã€‚ç”±äºçº¹ç†å·²è¢«åŠ è½½åˆ°OpenGLï¼Œæˆ‘ä»¬ä¸éœ€è¦ç»§ç»­ä¿ç•™è¿™ä¸ªå‰¯æœ¬ã€‚<br>æ˜¯çš„ï¼ŒAndroidåº”ç”¨ç¨‹åºåœ¨æ‰§è¡Œåƒåœ¾æ”¶é›†çš„Dalvik VMä¸‹è¿è¡Œï¼Œä½†Bitmapå¯¹è±¡åŒ…å«é©»ç•™åœ¨nativeå†…å­˜ä¸­çš„æ•°æ®ï¼Œå¦‚æœä½ ä¸æ˜ç¡®çš„å›æ”¶å®ƒä»¬ï¼Œå®ƒä»¬éœ€è¦å‡ ä¸ªå‘¨æœŸæ¥è¿›è¡Œåƒåœ¾æ”¶é›†ã€‚<br>è¿™æ„å‘³ç€å¦‚æœæ‚¨å¿˜è®°æ‰§è¡Œæ­¤æ“ä½œï¼Œå®é™…ä¸Šå¯èƒ½ä¼šå› å†…å­˜ä¸è¶³é”™è¯¯è€Œå´©æºƒï¼Œå³ä½¿æ‚¨ä¸å†æŒæœ‰å¯¹ä½å›¾çš„ä»»ä½•å¼•ç”¨ã€‚</p><h3 id="å°†çº¹ç†åº”ç”¨åˆ°æˆ‘ä»¬çš„åœºæ™¯">å°†çº¹ç†åº”ç”¨åˆ°æˆ‘ä»¬çš„åœºæ™¯<a href="post/Learn-OpenGL-Lesson-Four#å°†çº¹ç†åº”ç”¨åˆ°æˆ‘ä»¬çš„åœºæ™¯"></a></h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ å„ç§æˆå‘˜å˜é‡æ¥æŒæœ‰æˆ‘ä»¬çº¹ç†æ‰€éœ€è¦çš„ä¸œè¥¿ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å­˜æ”¾æˆ‘ä»¬çš„æ¨¡å‹æ•°æ®åœ¨æµ®ç‚¹ç¼“å†²åŒº</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> FloatBuffer mCubeTextureCoordinates;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨æ¥ä¼ å…¥çº¹ç†</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mTextureUniformHandle;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨æ¥ä¼ å…¥æ¨¡å‹çº¹ç†åæ ‡</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mTextureCoordinateHandle;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¯ä¸ªæ•°æ®å…ƒç´ çš„çº¹ç†åæ ‡å¤§å°</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mTextureCoordinateDataSize = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¹ç†æ•°æ®</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mTextureDataHandle;</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬åŸºæœ¬ä¸Šæ˜¯éœ€è¦æ·»åŠ æ–°æˆå‘˜å˜é‡æ¥è·Ÿè¸ªæˆ‘ä»¬æ·»åŠ åˆ°ç€è‰²å™¨çš„å†…å®¹ï¼Œä»¥åŠä¿æŒå¯¹çº¹ç†çš„å¼•ç”¨ã€‚</p><h3 id="å®šä¹‰çº¹ç†åæ ‡">å®šä¹‰çº¹ç†åæ ‡<a href="post/Learn-OpenGL-Lesson-Four#å®šä¹‰çº¹ç†åæ ‡"></a></h3><p>æˆ‘ä»¬åœ¨æ„é€ æ–¹æ³•ä¸­å®šä¹‰æˆ‘ä»¬çš„çº¹ç†åæ ‡</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// S, T ï¼ˆæˆ– Xï¼Œ Yï¼‰</span></span><br><span class="line"><span class="comment">// çº¹ç†åæ ‡æ•°æ®</span></span><br><span class="line"><span class="comment">// å› ä¸ºå›¾åƒYè½´æŒ‡å‘ä¸‹æ–¹ï¼ˆå‘ä¸‹ç§»åŠ¨å›¾ç‰‡æ—¶å€¼ä¼šå¢åŠ ï¼‰ï¼ŒOpenGLçš„Yè½´æŒ‡å‘ä¸Šæ–¹</span></span><br><span class="line"><span class="comment">// æˆ‘ä»¬é€šè¿‡ç¿»è½¬Yè½´æ¥è°ƒæ•´å®ƒ</span></span><br><span class="line"><span class="comment">// æ¯ä¸ªé¢çš„çº¹ç†åæ ‡éƒ½æ˜¯ç›¸åŒçš„</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">float</span>[] cubeTextureCoordinateData =</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="comment">// æ­£é¢</span></span><br><span class="line">                <span class="number">0.0F</span>, <span class="number">0.0F</span>,</span><br><span class="line">                <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">                <span class="number">1.0F</span>, <span class="number">0.0F</span>,</span><br><span class="line">                <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">                <span class="number">1.0F</span>, <span class="number">1.1F</span>,</span><br><span class="line">                <span class="number">1.0F</span>, <span class="number">0.0F</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">...</span><br></pre></td></tr></table></div></figure><p>è¿™åæ ‡æ•°æ®çœ‹èµ·æ¥å¯èƒ½æœ‰ç‚¹æ··ä¹±ã€‚å¦‚æœæ‚¨è¿”å›å»çœ‹ç¬¬ä¸‰è¯¾ä¸­ç‚¹çš„ä½ç½®æ˜¯å¦‚ä½•å®šä¹‰çš„ï¼Œæ‚¨å°†ä¼šå‘ç°æˆ‘ä»¬ä¸ºæ­£æ–¹ä½“æ¯ä¸ªé¢éƒ½å®šä¹‰äº†ä¸¤ä¸ªä¸‰è§’å½¢ã€‚ç‚¹çš„å®šä¹‰æ–¹å¼åƒä¸‹é¢è¿™æ ·ï¼š</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ï¼ˆä¸‰è§’å½¢<span class="number">1</span>ï¼‰</span><br><span class="line">å·¦ä¸Šï¼Œ</span><br><span class="line">å·¦ä¸‹ï¼Œ</span><br><span class="line">å³ä¸Š</span><br><span class="line">ï¼ˆä¸‰è§’å½¢<span class="number">2</span>ï¼‰</span><br><span class="line">å·¦ä¸‹ï¼Œ</span><br><span class="line">å³ä¸‹ï¼Œ</span><br><span class="line">å³ä¸Š</span><br></pre></td></tr></table></div></figure><p>çº¹ç†åæ ‡å’Œæ­£é¢çš„ä½ç½®åæ ‡å¯¹åº”ï¼Œä½†æ˜¯ç”±äºYè½´ç¿»è½¬ï¼ŒYè½´æŒ‡å‘å’ŒOpenGLçš„Yè½´ç›¸åçš„æ–¹å‘ã€‚</p><blockquote><p>çœ‹ä¸‹å›¾ï¼Œå®çº¿åæ ‡è¡¨ç¤ºåœ¨OpenGLä¸­æ­£æ–¹ä½“æ­£é¢Xï¼ŒYåæ ‡ã€‚è™šçº¿è¡¨ç¤ºç¿»è½¬åçš„åæ ‡ï¼Œå¯ä»¥çœ‹å‡ºå’Œä¸Šé¢å®šä¹‰çš„çº¹ç†åæ ‡æ˜¯ä¸€ä¸€å¯¹åº”çš„</p></blockquote><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190211153435.jpg" alt="çº¹ç†åæ ‡å¯¹åº”" class="article-img"></p><h3 id="è®¾ç½®çº¹ç†">è®¾ç½®çº¹ç†<a href="post/Learn-OpenGL-Lesson-Four#è®¾ç½®çº¹ç†"></a></h3><p>æˆ‘ä»¬åœ¨<code>onSurfaceCreated()</code>æ–¹æ³•ä¸­åŠ è½½çº¹ç†</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSurfaceCreated</span><span class="params">(GL10 gl, EGLConfig config)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    mProgramHandle = ShaderHelper.createAndLinkProgram(vertexShaderHandle, fragmentShaderHandle, <span class="string">"a_Position"</span>, <span class="string">"a_Color"</span>, <span class="string">"a_Normal"</span>, <span class="string">"a_TexCoordinate"</span>);</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// åŠ è½½çº¹ç†</span></span><br><span class="line">    mTextureDataHandle = TextureHelper.loadTexture(mActivityContext, R.drawable.bumpy_bricks_public_domain);</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªæ–°çš„å±æ€§<code>a_TexCoordinate</code>ç»‘å®šåˆ°æˆ‘ä»¬çš„ç€è‰²å™¨ä¸­ï¼Œå¹¶ä¸”æˆ‘ä»¬é€šè¿‡ä¹‹å‰åˆ›å»ºçš„<code>loadTexture()</code>æ–¹æ³•åŠ è½½ç€è‰²å™¨ã€‚</p><h3 id="ä½¿ç”¨çº¹ç†">ä½¿ç”¨çº¹ç†<a href="post/Learn-OpenGL-Lesson-Four#ä½¿ç”¨çº¹ç†"></a></h3><p>æˆ‘ä»¬ä¹Ÿéœ€è¦åœ¨<code>onDrawFrame(GL10 gl)</code>æ–¹æ³•ä¸­æ·»åŠ ä¸€äº›ä»£ç ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDrawFrame</span><span class="params">(GL10 gl)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    mTextureUniformHandle = GLES20.glGetUniformLocation(mProgramHandle, <span class="string">"u_Texture"</span>);</span><br><span class="line">    mTextureCoordinateHandle = GLES20.glGetAttribLocation(mProgramHandle, <span class="string">"a_TexCoordinate"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†çº¹ç†å•å…ƒè®¾ç½®ä¸ºçº¹ç†å•å…ƒ0</span></span><br><span class="line">    GLES20.glActiveTexture(GLES20.GL_TEXTURE0);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†çº¹ç†ç»‘å®šåˆ°è¿™ä¸ªå•å…ƒ</span></span><br><span class="line">    GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, mTextureDataHandle);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡ç»‘å®šåˆ°çº¹ç†å•å…ƒ0ï¼Œå‘Šè¯‰çº¹ç†æ ‡å‡†é‡‡æ ·å™¨åœ¨ç€è‰²å™¨ä¸­ä½¿ç”¨æ­¤çº¹ç†</span></span><br><span class="line">    GLES20.glUniform1i(mTextureUniformHandle, <span class="number">0</span>);</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬å¾—åˆ°ç€è‰²å™¨ä¸­çš„çº¹ç†æ•°æ®å’Œçº¹ç†åæ ‡å¥æŸ„ã€‚åœ¨OpenGLä¸­ï¼Œçº¹ç†èƒ½åœ¨ç€è‰²ä¹‹å‰ï¼Œéœ€è¦ç»‘å®šåˆ°çº¹ç†å•å…ƒã€‚çº¹ç†å•å…ƒæ˜¯è¯»å–çº¹ç†å¹¶å®é™…å°†å®ƒä¼ å…¥ç€è‰²å™¨çš„ä¸­ï¼Œå› æ­¤å¯ä»¥å†å±å¹•ä¸Šæ˜¾ç¤ºã€‚ä¸åŒçš„å›¾å½¢èŠ¯ç‰‡æœ‰ä¸åŒæ•°é‡çš„çº¹ç†å•å…ƒï¼Œå› æ­¤åœ¨ä½¿ç”¨å®ƒä»¬ä¹‹å‰ï¼Œæ‚¨éœ€è¦æ£€æŸ¥æ˜¯å¦å­˜åœ¨å…¶ä»–çº¹ç†å•å…ƒã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å‘Šè¯‰OpenGLæˆ‘ä»¬æƒ³è®¾ç½®ä½¿ç”¨çš„çº¹ç†å•å…ƒåˆ°ç¬¬ä¸€ä¸ªå•å…ƒï¼Œçº¹ç†å•å…ƒ0ã€‚ç„¶åè‡ªåŠ¨ç»‘å®šçº¹ç†åˆ°ç¬¬ä¸€ä¸ªå•å…ƒï¼Œé€šè¿‡è°ƒç”¨<code>glBindTexture()</code>ã€‚æœ€åï¼Œæˆ‘ä»¬å‘Šè¯‰OpenGLï¼Œæˆ‘ä»¬æƒ³å°†<code>mTextureUniformHandle</code>ç»‘å®šåˆ°ç¬¬ä¸€ä¸ªçº¹ç†å•å…ƒï¼Œå®ƒå¼•ç”¨äº†ç‰‡æ®µç€è‰²å™¨ä¸­<code>u_Texture</code>å±æ€§ã€‚</p><p>ç®€è€Œè¨€ä¹‹ï¼š</p><ol><li>è®¾ç½®çº¹ç†å•å…ƒ</li><li>ç»‘å®šçº¹ç†åˆ°è¿™ä¸ªå•å…ƒ</li><li>å°†æ­¤å•å…ƒæŒ‡å®šç»™ç‰‡æ®µç€è‰²å™¨ä¸­çš„çº¹ç†æ ‡å‡†</li></ol><p>æ ¹æ®éœ€è¦é‡å¤å¤šä¸ªçº¹ç†ã€‚</p><h3 id="è¿›ä¸€æ­¥ç»ƒä¹ ">è¿›ä¸€æ­¥ç»ƒä¹ <a href="post/Learn-OpenGL-Lesson-Four#è¿›ä¸€æ­¥ç»ƒä¹ "></a></h3><p>ä¸€æ—¦æ‚¨åšåˆ°è¿™å„¿ï¼Œæ‚¨å°±å®Œæˆçš„å·®ä¸å¤šäº†ï¼å½“ç„¶è¿™è¿™å¹¶æ²¡æœ‰æ‚¨é¢„æœŸçš„é‚£ä¹ˆç³Ÿç³•â€¦æˆ–è€…ç¡®å®ç³Ÿç³•ï¼ŸğŸ˜‰ä½œä¸ºä¸‹ä¸€ä¸ªç»ƒä¹ ï¼Œå°è¯•é€šè¿‡åŠ è½½å¦ä¸€ä¸ªçº¹ç†ï¼Œå°†å…¶ç»‘å®šåˆ°å¦ä¸€ä¸ªå•å…ƒï¼Œå¹¶åœ¨ç€è‰²å™¨ä¸­ä½¿ç”¨å®ƒã€‚</p><h2 id="å›é¡¾">å›é¡¾<a href="post/Learn-OpenGL-Lesson-Four#å›é¡¾"></a></h2><p>ç°åœ¨æˆ‘ä»¬å›é¡¾ä¸€ä¸‹æ‰€æœ‰çš„ç€è‰²å™¨ä»£ç ï¼Œä»¥åŠæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªæ–°çš„å¸®åŠ©åŠŸèƒ½ç”¨æ¥ä»èµ„æºç›®å½•è¯»å–ç€è‰²å™¨ä»£ç ï¼Œè€Œä¸æ˜¯å­˜å‚¨åœ¨javaå­—ç¬¦ä¸²ä¸­ï¼š</p><h3 id="é¡¶ç‚¹ç€è‰²å™¨-all">é¡¶ç‚¹ç€è‰²å™¨ all<a href="post/Learn-OpenGL-Lesson-Four#é¡¶ç‚¹ç€è‰²å™¨-all"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVPMatrix;                      <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewã€projectionçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVMatrix;                       <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Position;                     <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Color;                        <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„é¢œè‰²ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec3</span> a_Normal;                       <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„æ³•çº¿ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec2</span> a_TexCoordinate;                <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„çº¹ç†åæ ‡ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Position;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Normal;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec2</span> v_TexCoordinate;                  <span class="comment">// è¿™å°†ä¼šä¼ å…¥åˆ°ç‰‡æ®µç€è‰²å™¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é¡¶ç‚¹ç€è‰²å™¨å…¥å£ç‚¹</span></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// ä¼ å…¥çº¹ç†åæ ‡</span></span><br><span class="line">   v_TexCoordinate = a_TexCoordinate;</span><br><span class="line">   <span class="comment">// å°†é¡¶ç‚¹ä½ç½®è½¬æ¢æˆçœ¼ç›ç©ºé—´çš„ä½ç½®</span></span><br><span class="line">   v_Position = <span class="type">vec3</span>(u_MVMatrix * a_Position);</span><br><span class="line">   <span class="comment">// ä¼ å…¥é¢œè‰²</span></span><br><span class="line">   v_Color = a_Color;</span><br><span class="line">   <span class="comment">// å°†æ³•çº¿çš„æ–¹å‘è½¬æ¢åœ¨çœ¼ç›ç©ºé—´</span></span><br><span class="line">   v_Normal = <span class="type">vec3</span>(u_MVMatrix * <span class="type">vec4</span>(a_Normal, <span class="number">0.0</span>));</span><br><span class="line">   <span class="comment">// gl_Positionæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ç”¨æ¥å­˜å‚¨æœ€ç»ˆçš„ä½ç½®</span></span><br><span class="line">   <span class="comment">// å°†é¡¶ç‚¹ä¹˜ä»¥çŸ©é˜µå¾—åˆ°æ ‡å‡†åŒ–å±å¹•åæ ‡çš„æœ€ç»ˆç‚¹</span></span><br><span class="line">   <span class="built_in">gl_Position</span> = u_MVPMatrix * a_Position;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="ç‰‡æ®µç€è‰²å™¨-all">ç‰‡æ®µç€è‰²å™¨ all<a href="post/Learn-OpenGL-Lesson-Four#ç‰‡æ®µç€è‰²å™¨-all"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">precision</span> <span class="keyword">mediump</span> <span class="type">float</span>; <span class="comment">//æˆ‘ä»¬å°†é»˜è®¤ç²¾åº¦è®¾ç½®ä¸ºä¸­ç­‰ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç‰‡æ®µç€è‰²å™¨ä¸­çš„é«˜ç²¾åº¦</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">sampler2D</span> u_Texture;  <span class="comment">// ä¼ å…¥çº¹ç†</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">vec3</span> u_LightPos; <span class="comment">// å…‰æºåœ¨çœ¼ç›ç©ºé—´çš„ä½ç½®</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Position; <span class="comment">// æ’å…¥çš„ä½ç½®</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color; <span class="comment">// æ’å…¥çš„ä½ç½®é¢œè‰²</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Normal; <span class="comment">// æ’å…¥çš„ä½ç½®æ³•çº¿</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec2</span> v_TexCoordinate; <span class="comment">// æ’å…¥çš„çº¹ç†åæ ‡</span></span><br><span class="line"><span class="type">void</span> main()  <span class="comment">// ç‰‡æ®µç€è‰²å™¨å…¥å£</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// å°†ç”¨äºå“€å‡</span></span><br><span class="line">   <span class="type">float</span> <span class="built_in">distance</span> = <span class="built_in">length</span>(u_LightPos - v_Position);</span><br><span class="line">   <span class="comment">// è·å–ä»å…‰æºåˆ°é¡¶ç‚¹æ–¹å‘çš„å…‰çº¿å‘é‡</span></span><br><span class="line">   <span class="type">vec3</span> lightVector = <span class="built_in">normalize</span>(u_LightPos - v_Position);</span><br><span class="line">   <span class="comment">// è®¡ç®—å…‰çº¿çŸ¢é‡å’Œé¡¶ç‚¹æ³•çº¿çš„ç‚¹ç§¯ï¼Œå¦‚æœæ³•çº¿å’Œå…‰çº¿çŸ¢é‡æŒ‡å‘ç›¸åŒçš„æ–¹å‘ï¼Œé‚£ä¹ˆå®ƒå°†è·å¾—æœ€å¤§çš„ç…§æ˜</span></span><br><span class="line">   <span class="type">float</span> diffuse = <span class="built_in">max</span>(<span class="built_in">dot</span>(v_Normal, lightVector), <span class="number">0.1</span>);</span><br><span class="line">   <span class="comment">// æ ¹æ®è·ç¦»å“€å‡å…‰çº¿</span></span><br><span class="line">   diffuse = diffuse * (<span class="number">1.0</span> / (<span class="number">1.0</span> + (<span class="number">0.25</span> * <span class="built_in">distance</span> * <span class="built_in">distance</span>)));</span><br><span class="line">   <span class="comment">// æ·»åŠ ç¯å¢ƒç…§æ˜</span></span><br><span class="line">   diffuse = diffuse + <span class="number">0.3</span>;</span><br><span class="line">   <span class="comment">// é¢œè‰²ä¹˜ä»¥äº®åº¦å“€å‡å’Œçº¹ç†å€¼å¾—åˆ°æœ€ç»ˆçš„é¢œè‰²</span></span><br><span class="line">   <span class="built_in">gl_FragColor</span> = v_Color * diffuse * <span class="built_in">texture2D</span>(u_Texture, v_TexCoordinate);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="æ€æ ·ä»rawèµ„æºç›®å½•ä¸­è¯»å–æ–‡æœ¬ï¼Ÿ">æ€æ ·ä»rawèµ„æºç›®å½•ä¸­è¯»å–æ–‡æœ¬ï¼Ÿ<a href="post/Learn-OpenGL-Lesson-Four#æ€æ ·ä»rawèµ„æºç›®å½•ä¸­è¯»å–æ–‡æœ¬ï¼Ÿ"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RawResourceReader</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">readTextFileFromRawResource</span><span class="params">(<span class="keyword">final</span> Context context, <span class="keyword">final</span> <span class="keyword">int</span> resurceId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> InputStream inputStream = context.getResources().openRawResource(resurceId);</span><br><span class="line">        <span class="keyword">final</span> InputStreamReader inputStreamReader = <span class="keyword">new</span> InputStreamReader(inputStream);</span><br><span class="line">        <span class="keyword">final</span> BufferedReader bufferedReader = <span class="keyword">new</span> BufferedReader(inputStreamReader);</span><br><span class="line"></span><br><span class="line">        String nextLine;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> StringBuilder body = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> ((nextLine = bufferedReader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                body.append(nextLine).append(<span class="string">'\n'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                bufferedReader.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> body.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="æ•™ç¨‹ç›®å½•">æ•™ç¨‹ç›®å½•<a href="post/Learn-OpenGL-Lesson-Four#æ•™ç¨‹ç›®å½•"></a></h2><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five">OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six">OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven">OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVOBï¼‰</a></li></ul><h2 id="æ‰“åŒ…æ•™æ">æ‰“åŒ…æ•™æ<a href="post/Learn-OpenGL-Lesson-Four#æ‰“åŒ…æ•™æ"></a></h2><p>å¯ä»¥åœ¨Githubä¸‹è½½æœ¬è¯¾ç¨‹æºä»£ç ï¼š<a href="https://github.com/learnopengles/Learn-OpenGLES-Tutorials" target="_blank" rel="noopener">ä¸‹è½½é¡¹ç›®</a><br>æœ¬è¯¾çš„ç¼–è¯‘ç‰ˆæœ¬ä¹Ÿå¯ä»¥å†Androidå¸‚åœºä¸‹ï¼š<a href="https://market.android.com/details?id=com.learnopengles.android" target="_blank" rel="noopener">google play ä¸‹è½½apk</a><br>â€œæˆ‘â€ä¹Ÿç¼–è¯‘äº†ä¸ªapkï¼Œæ–¹ä¾¿å¤§å®¶ä¸‹è½½ï¼š<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">github download</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ–‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Four: Introducing Basic Texturing&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.learnopengles.com/android-lesson-four-introducing-basic-texturing/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.learnopengles.com/android-lesson-four-introducing-basic-texturing/&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/categories/OpenGL/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/tags/OpenGL/"/>
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</title>
    <link href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three/index.html"/>
    <id>https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three/index.html</id>
    <published>2019-01-26T09:55:49.000Z</published>
    <updated>2019-04-08T08:32:50.360Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»è¯‘æ–‡</p></blockquote><p>åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Three: Moving to Per-Fragment Lighting<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.learnopengles.com/android-lesson-three-moving-to-per-fragment-lighting/" target="_blank" rel="noopener">http://www.learnopengles.com/android-lesson-three-moving-to-per-fragment-lighting/</a><br><a id="more"></a></p><hr><h1 id="ä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜">ä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜<a href="post/Learn-OpenGL-Lesson-Three#ä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜"></a></h1><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>æ¬¢è¿æ¥åˆ°ç¬¬ä¸‰è¯¾ï¼è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°†ä¼šåœ¨<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">ç¬¬äºŒè¯¾</a>çš„åŸºç¡€ä¸Šï¼Œ<br>å­¦ä¹ å¦‚ä½•ä½¿ç”¨æ¯åƒç´ æŠ€æœ¯æ¥è¾¾åˆ°ç›¸åŒçš„ç…§æ˜ã€‚<br>ç®€å•çš„æ­£æ–¹ä½“å³ä½¿ä½¿ç”¨æ ‡å‡†çš„æ¼«å°„ç…§æ˜æˆ‘ä»¬ä¹Ÿèƒ½çœ‹åˆ°å·®å¼‚ã€‚</td><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190126183929.png" alt="screenshot"></td></tr></tbody></table></div></div><h2 id="å‰ææ¡ä»¶">å‰ææ¡ä»¶<a href="post/Learn-OpenGL-Lesson-Three#å‰ææ¡ä»¶"></a></h2><p>æœ¬ç³»åˆ—çš„æ¯èŠ‚è¯¾éƒ½ä»¥å‰é¢çš„è¯¾ç¨‹ä¸ºåŸºç¡€ï¼Œæœ¬èŠ‚è¯¾æ˜¯<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">ç¬¬äºŒè¯¾</a>çš„è¡¥å……ï¼Œå› æ­¤è¯·åŠ¡åœ¨é˜…è¯»äº†ä¹‹å‰çš„è¯¾ç¨‹åå†æ¥å›é¡¾ã€‚</p><blockquote><p>ä¸‹é¢æ˜¯æœ¬ç³»åˆ—è¯¾ç¨‹çš„å‰å‡ è¯¾ï¼š</p></blockquote><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li></ul><h2 id="ä»€ä¹ˆæ˜¯æ¯åƒç´ ç…§æ˜">ä»€ä¹ˆæ˜¯æ¯åƒç´ ç…§æ˜<a href="post/Learn-OpenGL-Lesson-Three#ä»€ä¹ˆæ˜¯æ¯åƒç´ ç…§æ˜"></a></h2><p>éšç€ç€è‰²å™¨çš„ä½¿ç”¨ï¼Œæ¯åƒç´ ç…§æ˜åœ¨æ¸¸æˆä¸­æ˜¯ä¸€ç§ç›¸å¯¹è¾ƒæ–°çš„ç°è±¡ã€‚è®¸å¤šæœ‰åçš„æ—§æ¸¸æˆï¼Œä¾‹å¦‚åŸç‰ˆçš„<a href="https://en.wikipedia.org/wiki/Half-Life_(video_game)" target="_blank" rel="noopener">åŠæ¡å‘½</a>ï¼Œéƒ½æ˜¯åœ¨ç€è‰²å™¨ä¹‹å‰å¼€å‘å‡ºæ¥çš„ï¼Œä¸»è¦ä½¿ç”¨é™æ€ç…§æ˜ï¼Œé€šè¿‡ä¸€äº›æŠ€å·§æ¨¡æ‹ŸåŠ¨æ€ç…§æ˜ï¼Œä½¿ç”¨æ¯é¡¶ç‚¹ï¼ˆä¹Ÿç§°ä¸º<a href="http://en.wikipedia.org/wiki/Gouraud_shading" target="_blank" rel="noopener">Gouraudé˜´å½±</a>ï¼‰ç…§æ˜æˆ–å…¶ä»–æŠ€æœ¯ï¼Œå¦‚åŠ¨æ€<a href="https://en.wikipedia.org/wiki/Lightmap" target="_blank" rel="noopener">å…‰ç…§è´´å›¾</a>ã€‚</p><p>å…‰ç…§è´´å›¾å¯ä»¥æä¾›éå¸¸å¥½çš„æ•ˆæœï¼Œæœ‰æ—¶å¯ä»¥æ¯”å•ç‹¬çš„ç€è‰²å™¨æä¾›æ›´å¥½çš„æ•ˆæœï¼Œå› ä¸ºå¯ä»¥é¢„å…ˆè®¡ç®—æ˜‚è´µçš„å…‰çº¿è®¡ç®—ã€‚ä½†ç¼ºç‚¹æ˜¯å®ƒä»¬å ç”¨äº†å¤§é‡å†…å­˜å¹¶ä½¿ç”¨å®ƒä»¬è¿›è¡ŒåŠ¨æ€ç…§æ˜ä»…é™äºç®€å•çš„è®¡ç®—ã€‚</p><p>ä½¿ç”¨ç€è‰²å™¨ï¼Œç°åœ¨å¾ˆå¤šè¿™äº›è®¡ç®—è½¬ç»™GPUï¼Œè¿™å¯ä»¥å®Œæˆæ›´å¤šå®æ—¶çš„æ•ˆæœã€‚</p><h2 id="ä»æ¯é¡¶ç‚¹ç…§æ˜è½¬ç§»åˆ°æ¯ç‰‡æ®µç…§æ˜">ä»æ¯é¡¶ç‚¹ç…§æ˜è½¬ç§»åˆ°æ¯ç‰‡æ®µç…§æ˜<a href="post/Learn-OpenGL-Lesson-Three#ä»æ¯é¡¶ç‚¹ç…§æ˜è½¬ç§»åˆ°æ¯ç‰‡æ®µç…§æ˜"></a></h2><p>è¿™æœ¬è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†é’ˆå¯¹æ¯é¡¶ç‚¹è§£å†³æ–¹æ¡ˆå’Œæ¯ç‰‡æ®µè§£å†³æ–¹æ¡ˆæŸ¥çœ‹ç›¸åŒçš„ç…§æ˜ä»£ç ã€‚å°½ç®¡æˆ‘å°†è¿™ç§ç±»å‹ç§°ä¸ºæ¯åƒç´ ï¼Œä½†åœ¨OpenGL ESä¸­æˆ‘ä»¬å®é™…ä¸Šä½¿ç”¨ç‰‡æ®µï¼Œå¹¶ä¸”å‡ ä¸ªç‰‡æ®µå¯ä»¥è´¡çŒ®ä¸€ä¸ªåƒç´ çš„æœ€ç»ˆå€¼ã€‚</p><p>æ‰‹æœºçš„GPUå˜å¾—è¶Šæ¥è¶Šå¿«ï¼Œä½†æ˜¯æ€§èƒ½ä»ç„¶æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚å¯¹äºâ€œè½¯â€ç…§æ˜ä¾‹å¦‚åœ°å½¢ï¼Œæ¯é¡¶ç‚¹ç…§æ˜å¯èƒ½è¶³å¤Ÿå¥½ã€‚ç¡®ä¿æ‚¨åœ¨è´¨é‡å’Œé€Ÿåº¦ä¹‹é—´å–å¾—é€‚å½“çš„å¹³è¡¡ã€‚</p><p>åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥çœ‹åˆ°ä¸¤ç§ç±»å‹çš„ç…§æ˜ä¹‹é—´çš„æ˜¾è‘—å·®å¼‚ã€‚çœ‹çœ‹ä¸‹é¢çš„å±å¹•æˆªå›¾ï¼š</p><div class="article-bounded"><div class="article-table"><table><tbody><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190127004415.png" alt="Per vertex lighting"><br>æ¯é¡¶ç‚¹ç…§æ˜ï¼›<br>åœ¨æ­£æ–¹å½¢å››ä¸ªé¡¶ç‚¹ä¸ºä¸­å¿ƒ</td><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190127004455.png" alt="Per fragment lighting"><br>æ¯ç‰‡æ®µç…§æ˜ï¼›<br>åœ¨æ­£æ–¹å½¢å››ä¸ªé¡¶ç‚¹ä¸ºä¸­å¿ƒ</td><td>åœ¨å·¦å›¾çš„æ¯é¡¶ç‚¹ç…§æ˜ä¸­æ­£æ–¹ä½“çš„<br>æ­£é¢çœ‹èµ·æ¥åƒæ˜¯å¹³é¢é˜´å½±ï¼Œä¸èƒ½<br>è¡¨æ˜é™„è¿‘æœ‰å…‰æºã€‚è¿™æ˜¯å› ä¸ºæ­£é¢<br>çš„å››ä¸ªé¡¶ç‚¹å’Œå…‰æºè·ç¦»å·®ä¸å¤šç›¸<br>ç­‰ï¼Œå¹¶ä¸”å››ä¸ªç‚¹çš„ä½å…‰å¼ºåº¦è¢«ç®€<br>å•çš„æ’å…¥ä¸¤ä¸ªä¸‰è§’å½¢æ„æˆçš„æ­£é¢ã€‚<hr>ç›¸å¯¹æ¯”ï¼Œæ¯ç‰‡æ®µç…§æ˜å¾ˆå¥½çš„<br>æ˜¾ç¤ºäº†äº®ç‚¹ç‰¹æ€§</td></tr><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190127004542.png" alt="Per vertex lighting"><br>æ¯é¡¶ç‚¹ç…§æ˜ï¼›<br>åœ¨æ­£æ–¹å½¢è§’è½</td><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190127004615.png" alt="Per fragment lighting"><br>æ¯ç‰‡æ®µç…§æ˜ï¼›<br>åœ¨æ­£æ–¹å½¢è§’è½</td><td>å·¦å›¾æ˜¾ç¤ºäº†ä¸€ä¸ª<a href="http://en.wikipedia.org/wiki/Gouraud_shading" target="_blank" rel="noopener">Gouraudé˜´å½±</a><br>ç«‹æ–¹ä½“ã€‚å½“å…‰æºç§»åŠ¨åˆ°ç«‹æ–¹ä½“æ­£<br>é¢è§’è½æ—¶ï¼Œå¯ä»¥çœ‹åˆ°ç±»ä¼¼ä¸‰è§’å½¢<br>çš„æ•ˆæœã€‚è¿™æ˜¯å› ä¸ºæ­£é¢å®é™…ä¸Šæ˜¯<br>ç”±ä¸¤ä¸ªä¸‰è§’å½¢ç»„æˆï¼Œå¹¶ä¸”åœ¨æ¯ä¸ª<br>ä¸‰è§’å½¢ä¸åŒæ–¹å‘æ’å€¼ï¼Œæˆ‘ä»¬èƒ½çœ‹<br>åˆ°æ„æˆç«‹æ–¹ä½“çš„åŸºç¡€å‡ ä½•å›¾å½¢ã€‚<hr>æ¯ç‰‡æ®µçš„ç‰ˆæœ¬æ˜¾ç¤ºä¸Šæ²¡æœ‰æ­¤ç±»æ’<br>å€¼çš„é—®é¢˜å¹¶ä¸”å®ƒåœ¨è¾¹ç¼˜é™„è¿‘æ˜¾ç¤º<br>äº†ä¸€ä¸ªæ¼‚äº®çš„åœ†å½¢é«˜å…‰ã€‚</td></tr></tbody></table></div></div><h3 id="æ¯é¡¶ç‚¹ç…§æ˜æ¦‚è¿°">æ¯é¡¶ç‚¹ç…§æ˜æ¦‚è¿°<a href="post/Learn-OpenGL-Lesson-Three#æ¯é¡¶ç‚¹ç…§æ˜æ¦‚è¿°"></a></h3><p>æˆ‘ä»¬æ¥çœ‹çœ‹<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">ç¬¬äºŒè¯¾</a>è®²çš„ç€è‰²å™¨ï¼›åœ¨è¯¥è¯¾ç¨‹ä¸­å¯ä»¥æ‰¾åˆ°è¯¦ç»†çš„ç€è‰²å™¨è¯´æ˜ã€‚</p><h3 id="é¡¶ç‚¹ç€è‰²å™¨">é¡¶ç‚¹ç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Three#é¡¶ç‚¹ç€è‰²å™¨"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVPMatrix;      <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewã€projectionçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVMatrix;       <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">vec3</span> u_LightPos;       <span class="comment">// å…‰æºåœ¨çœ¼ç›ç©ºé—´çš„ä½ç½®</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Position;     <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Color;        <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„é¢œè‰²ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec3</span> a_Normal;       <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„æ³•çº¿ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color;          <span class="comment">// è¿™å°†è¢«ä¼ å…¥ç‰‡æ®µç€è‰²å™¨</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()                    <span class="comment">// é¡¶ç‚¹ç€è‰²å™¨å…¥å£</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// å°†é¡¶ç‚¹è½¬æ¢æˆçœ¼ç›ç©ºé—´</span></span><br><span class="line">   <span class="type">vec3</span> modelViewVertex = <span class="type">vec3</span>(u_MVMatrix * a_Position);</span><br><span class="line"><span class="comment">// å°†æ³•çº¿çš„æ–¹å‘è½¬æ¢æˆçœ¼ç›ç©ºé—´</span></span><br><span class="line">   <span class="type">vec3</span> modelViewNormal = <span class="type">vec3</span>(u_MVMatrix * <span class="type">vec4</span>(a_Normal, <span class="number">0.0</span>));</span><br><span class="line"><span class="comment">// å°†ç”¨äºå“€å‡</span></span><br><span class="line">   <span class="type">float</span> <span class="built_in">distance</span> = <span class="built_in">length</span>(u_LightPos - modelViewVertex);</span><br><span class="line"><span class="comment">// è·å–ä»å…‰æºåˆ°é¡¶ç‚¹æ–¹å‘çš„å…‰çº¿å‘é‡</span></span><br><span class="line">   <span class="type">vec3</span> lightVector = <span class="built_in">normalize</span>(u_LightPos - modelViewVertex);</span><br><span class="line"><span class="comment">// è®¡ç®—å…‰çº¿çŸ¢é‡å’Œé¡¶ç‚¹æ³•çº¿çš„ç‚¹ç§¯ï¼Œå¦‚æœæ³•çº¿å’Œå…‰çº¿çŸ¢é‡æŒ‡å‘ç›¸åŒçš„æ–¹å‘ï¼Œé‚£ä¹ˆå®ƒå°†è·å¾—æœ€å¤§çš„ç…§æ˜</span></span><br><span class="line">   <span class="type">float</span> diffuse = <span class="built_in">max</span>(<span class="built_in">dot</span>(modelViewNormal, lightVector), <span class="number">0.1</span>);</span><br><span class="line"><span class="comment">// æ ¹æ®è·ç¦»å“€å‡å…‰çº¿</span></span><br><span class="line">   diffuse = diffuse * (<span class="number">1.0</span> / (<span class="number">1.0</span> + (<span class="number">0.25</span> * <span class="built_in">distance</span> * <span class="built_in">distance</span>)));</span><br><span class="line"><span class="comment">// å°†é¢œè‰²ä¹˜ä»¥äº®åº¦ï¼Œå®ƒå°†è¢«æ’å…¥ä¸‰è§’å½¢ä¸­</span></span><br><span class="line">   v_Color = a_Color * diffuse;</span><br><span class="line"><span class="comment">// gl_Positionæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ç”¨æ¥å­˜å‚¨æœ€ç»ˆçš„ä½ç½®</span></span><br><span class="line"><span class="comment">// å°†é¡¶ç‚¹ä¹˜ä»¥çŸ©é˜µå¾—åˆ°æ ‡å‡†åŒ–å±å¹•åæ ‡çš„æœ€ç»ˆç‚¹</span></span><br><span class="line">   <span class="built_in">gl_Position</span> = u_MVPMatrix * a_Position;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="ç‰‡æ®µç€è‰²å™¨">ç‰‡æ®µç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Three#ç‰‡æ®µç€è‰²å™¨"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">precision</span> <span class="keyword">mediump</span> <span class="type">float</span>;     <span class="comment">// æˆ‘ä»¬å°†é»˜è®¤ç²¾åº¦è®¾ç½®ä¸ºä¸­ç­‰ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç‰‡æ®µç€è‰²å™¨ä¸­çš„é«˜ç²¾åº¦</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color;        <span class="comment">// è¿™æ˜¯ä»ä¸‰è§’å½¢æ¯ä¸ªç‰‡æ®µå†…æ’çš„é¡¶ç‚¹ç€è‰²å™¨çš„é¢œè‰²</span></span><br><span class="line"><span class="type">void</span> main()                  <span class="comment">// ç‰‡æ®µç€è‰²å™¨å…¥å£</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">gl_FragColor</span> = v_Color;   <span class="comment">// ç›´æ¥å°†é¢œè‰²ä¼ é€’</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æ­£å¦‚æ‚¨æ‰€è§ï¼Œå¤§éƒ¨åˆ†å·¥ä½œéƒ½åœ¨æˆ‘ä»¬çš„ç€è‰²å™¨ä¸­åšçš„ã€‚è½¬ç§»åˆ°æ¯ç‰‡æ®µç€è‰²ç…§æ˜æ„å‘³ç€ï¼Œæˆ‘ä»¬çš„ç‰‡æ®µç€è‰²å™¨è¿˜æœ‰æ›´å¤šçš„å·¥ä½œè¦åšã€‚</p><h3 id="å®ç°æ¯ç‰‡æ®µç…§æ˜">å®ç°æ¯ç‰‡æ®µç…§æ˜<a href="post/Learn-OpenGL-Lesson-Three#å®ç°æ¯ç‰‡æ®µç…§æ˜"></a></h3><p>ä»¥ä¸‹æ˜¯ç§»åŠ¨åˆ°æ¯ç‰‡æ®µç…§æ˜åçš„ä»£ç çš„æ ·å­ã€‚</p><h3 id="é¡¶ç‚¹ç€è‰²å™¨-new">é¡¶ç‚¹ç€è‰²å™¨ new<a href="post/Learn-OpenGL-Lesson-Three#é¡¶ç‚¹ç€è‰²å™¨-new"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVPMatrix;    <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewã€projectionçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVMatrix;     <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Position;   <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_Color;      <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„é¢œè‰²ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec3</span> a_Normal;     <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„æ³•çº¿ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Position;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Normal;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¡¶ç‚¹ç€è‰²å™¨å…¥å£ç‚¹</span></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// å°†é¡¶ç‚¹ä½ç½®è½¬æ¢æˆçœ¼ç›ç©ºé—´çš„ä½ç½®</span></span><br><span class="line">   v_Position = <span class="type">vec3</span>(u_MVMatrix * a_Position);</span><br><span class="line">   <span class="comment">// ä¼ å…¥é¢œè‰²</span></span><br><span class="line">   v_Color = a_Color;</span><br><span class="line">   <span class="comment">// å°†æ³•çº¿çš„æ–¹å‘è½¬æ¢åœ¨çœ¼ç›ç©ºé—´</span></span><br><span class="line">   v_Normal = <span class="type">vec3</span>(u_MVMatrix * <span class="type">vec4</span>(a_Normal, <span class="number">0.0</span>));</span><br><span class="line">   <span class="comment">// gl_Positionæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ç”¨æ¥å­˜å‚¨æœ€ç»ˆçš„ä½ç½®</span></span><br><span class="line">   <span class="comment">// å°†é¡¶ç‚¹ä¹˜ä»¥çŸ©é˜µå¾—åˆ°æ ‡å‡†åŒ–å±å¹•åæ ‡çš„æœ€ç»ˆç‚¹</span></span><br><span class="line">   <span class="built_in">gl_Position</span> = u_MVPMatrix * a_Position;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>é¡¶ç‚¹ç€è‰²å™¨æ¯”ä¹‹å‰æ›´åŠ çš„ç®€å•ã€‚æˆ‘ä»¬æ·»åŠ äº†ä¸¤ä¸ªçº¿æ€§æ’å€¼å˜é‡ç”¨æ¥ä¼ å…¥åˆ°ç‰‡æ®µç€è‰²å™¨ï¼šé¡¶ç‚¹ä½ç½®å’Œé¡¶ç‚¹æ³•çº¿ã€‚å®ƒä»¬å°†åœ¨ç‰‡æ®µç€è‰²å™¨è®¡ç®—å…‰äº®çš„æ—¶å€™è¢«ä½¿ç”¨ã€‚</p><h3 id="ç‰‡æ®µç€è‰²å™¨-new">ç‰‡æ®µç€è‰²å™¨ new<a href="post/Learn-OpenGL-Lesson-Three#ç‰‡æ®µç€è‰²å™¨-new"></a></h3><figure class="highlight glsl"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">precision</span> <span class="keyword">mediump</span> <span class="type">float</span>; <span class="comment">//æˆ‘ä»¬å°†é»˜è®¤ç²¾åº¦è®¾ç½®ä¸ºä¸­ç­‰ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç‰‡æ®µç€è‰²å™¨ä¸­çš„é«˜ç²¾åº¦</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">vec3</span> u_LightPos; <span class="comment">// å…‰æºåœ¨çœ¼ç›ç©ºé—´çš„ä½ç½®</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Position; <span class="comment">// æ’å…¥çš„ä½ç½®</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_Color;    <span class="comment">// æ’å…¥çš„ä½ç½®é¢œè‰²</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> v_Normal;   <span class="comment">// æ’å…¥çš„ä½ç½®æ³•çº¿</span></span><br><span class="line"><span class="type">void</span> main()              <span class="comment">// ç‰‡æ®µç€è‰²å™¨å…¥å£</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// å°†ç”¨äºå“€å‡</span></span><br><span class="line">   <span class="type">float</span> <span class="built_in">distance</span> = <span class="built_in">length</span>(u_LightPos - v_Position);</span><br><span class="line">   <span class="comment">// è·å–ä»å…‰æºåˆ°é¡¶ç‚¹æ–¹å‘çš„å…‰çº¿å‘é‡</span></span><br><span class="line">   <span class="type">vec3</span> lightVector = <span class="built_in">normalize</span>(u_LightPos - v_Position);</span><br><span class="line">   <span class="comment">// è®¡ç®—å…‰çº¿çŸ¢é‡å’Œé¡¶ç‚¹æ³•çº¿çš„ç‚¹ç§¯ï¼Œå¦‚æœæ³•çº¿å’Œå…‰çº¿çŸ¢é‡æŒ‡å‘ç›¸åŒçš„æ–¹å‘ï¼Œé‚£ä¹ˆå®ƒå°†è·å¾—æœ€å¤§çš„ç…§æ˜</span></span><br><span class="line">   <span class="type">float</span> diffuse = <span class="built_in">max</span>(<span class="built_in">dot</span>(v_Normal, lightVector), <span class="number">0.1</span>);</span><br><span class="line">   <span class="comment">// æ ¹æ®è·ç¦»å“€å‡å…‰çº¿</span></span><br><span class="line">   diffuse = diffuse * (<span class="number">1.0</span> / (<span class="number">1.0</span> + (<span class="number">0.25</span> * <span class="built_in">distance</span> * <span class="built_in">distance</span>)));</span><br><span class="line">   <span class="comment">// é¢œè‰²ä¹˜ä»¥äº®åº¦å“€å‡å¾—åˆ°æœ€ç»ˆçš„é¢œè‰²</span></span><br><span class="line">   <span class="built_in">gl_FragColor</span> = v_Color * diffuse;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>ä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜ï¼Œæˆ‘ä»¬çš„ç‰‡æ®µç€è‰²å™¨è¿˜æœ‰æ›´å¤šçš„å·¥ä½œè¦åšã€‚æˆ‘ä»¬åŸºæœ¬ä¸Šå°†<a href="https://en.wikipedia.org/wiki/Lambert%27s_cosine_law" target="_blank" rel="noopener">æœ—ä¼¯è®¡ç®—</a>å’Œå“€å‡ç§»åˆ°äº†æ¯åƒç´ çº§åˆ«ï¼Œè¿™ä¸ºæˆ‘ä»¬æä¾›äº†æ›´é€¼çœŸçš„ç…§æ˜ï¼Œè€Œæ— éœ€æ·»åŠ æ›´å¤šé¡¶ç‚¹ã€‚</p><h2 id="è¿›ä¸€æ­¥ç»ƒä¹ ">è¿›ä¸€æ­¥ç»ƒä¹ <a href="post/Learn-OpenGL-Lesson-Three#è¿›ä¸€æ­¥ç»ƒä¹ "></a></h2><p>æˆ‘ä»¬å¯ä»¥åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­è®¡ç®—è·ç¦»ï¼Œç„¶åèµ‹å€¼ç»™å˜é‡é€šè¿‡çº¿æ€§æ’å€¼ä¼ å…¥ç‰‡æ®µç€è‰²å™¨å—ï¼Ÿ</p><h2 id="æ•™ç¨‹ç›®å½•">æ•™ç¨‹ç›®å½•<a href="post/Learn-OpenGL-Lesson-Three#æ•™ç¨‹ç›®å½•"></a></h2><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five">OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six">OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven">OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVOBï¼‰</a></li></ul><h2 id="æ‰“åŒ…æ•™æ">æ‰“åŒ…æ•™æ<a href="post/Learn-OpenGL-Lesson-Three#æ‰“åŒ…æ•™æ"></a></h2><p>å¯ä»¥åœ¨Githubä¸‹è½½æœ¬è¯¾ç¨‹æºä»£ç ï¼š<a href="https://github.com/learnopengles/Learn-OpenGLES-Tutorials" target="_blank" rel="noopener">ä¸‹è½½é¡¹ç›®</a><br>æœ¬è¯¾çš„ç¼–è¯‘ç‰ˆæœ¬ä¹Ÿå¯ä»¥å†Androidå¸‚åœºä¸‹ï¼š<a href="https://market.android.com/details?id=com.learnopengles.android" target="_blank" rel="noopener">google play ä¸‹è½½apk</a><br>â€œæˆ‘â€ä¹Ÿç¼–è¯‘äº†ä¸ªapkï¼Œæ–¹ä¾¿å¤§å®¶ä¸‹è½½ï¼š<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">github download</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ–‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡æ ‡é¢˜ï¼šAndroid Lesson Three: Moving to Per-Fragment Lighting&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.learnopengles.com/android-lesson-three-moving-to-per-fragment-lighting/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.learnopengles.com/android-lesson-three-moving-to-per-fragment-lighting/&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/categories/OpenGL/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/tags/OpenGL/"/>
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</title>
    <link href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two/index.html"/>
    <id>https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two/index.html</id>
    <published>2019-01-23T07:50:51.000Z</published>
    <updated>2019-04-08T06:56:23.990Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»è¯‘æ–‡</p></blockquote><p>åŸæ–‡æ ‡é¢˜ï¼šOpenGL Android Lesson One: Getting Started<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.learnopengles.com/android-lesson-two-ambient-and-diffuse-lighting/" target="_blank" rel="noopener">http://www.learnopengles.com/android-lesson-two-ambient-and-diffuse-lighting/</a><br><a id="more"></a></p><hr><h1 id="ç¯å¢ƒå…‰å’Œæ¼«å°„å…‰">ç¯å¢ƒå…‰å’Œæ¼«å°„å…‰<a href="post/Learn-OpenGL-Lesson-Two#ç¯å¢ƒå…‰å’Œæ¼«å°„å…‰"></a></h1><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>æ¬¢è¿æ¥åˆ°ç¬¬äºŒè¯¾ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨<br>ç€è‰²å™¨å®ç°<a href="https://en.wikipedia.org/wiki/Lambertian_reflectance" target="_blank" rel="noopener">æœ—ä¼¯åå°„ï¼ˆ Lambertian reflectance ï¼‰</a>ï¼Œä¹Ÿç§°ä¸ºæ ‡å‡†æ¼«å°„ç…§æ˜ã€‚<br><br>åœ¨OpengGLES2ï¼Œæˆ‘ä»¬éœ€è¦å®ç°æˆ‘ä»¬è‡ªå·±çš„ç…§æ˜ç®—æ³•ï¼Œ<br>å› æ­¤æˆ‘ä»¬è¦å­¦ä¼šæ•°å­¦å¦‚ä½•å·¥ä½œä»¥åŠå¦‚ä½•åº”ç”¨åˆ°æˆ‘ä»¬çš„åœºæ™¯ä¸­ã€‚</td><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190123163828.png" alt="screenshot"></td></tr></tbody></table></div></div><h2 id="é˜…è¯»æœ¬æ–‡å‰ææ¡ä»¶">é˜…è¯»æœ¬æ–‡å‰ææ¡ä»¶<a href="post/Learn-OpenGL-Lesson-Two#é˜…è¯»æœ¬æ–‡å‰ææ¡ä»¶"></a></h2><p>æœ¬ç³»åˆ—çš„æ¯èŠ‚è¯¾éƒ½ä»¥å‰é¢çš„è¯¾ç¨‹ä¸ºåŸºç¡€ã€‚åœ¨å¼€å§‹å‰ï¼Œ<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">è¯·çœ‹ç¬¬ä¸€è¯¾</a>ï¼Œå› ä¸ºæœ¬è¯¾ç¨‹å°†ä»¥æ­¤ä¸ºåŸºç¡€æ¦‚å¿µä»‹ç»ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯å…‰">ä»€ä¹ˆæ˜¯å…‰<a href="post/Learn-OpenGL-Lesson-Two#ä»€ä¹ˆæ˜¯å…‰"></a></h2><p>æ²¡é”™ï¼ä¸€ä¸ªæ²¡æœ‰å…‰çš„ä¸–ç•Œæ˜¯æ˜æš—çš„ã€‚æ²¡æœ‰[å…‰]ï¼Œæˆ‘ä»¬ç”šè‡³ä¸èƒ½æ„ŸçŸ¥ä¸–ç•Œæˆ–æˆ‘ä»¬å‘¨å›´çš„ç‰©ä½“ï¼Œé™¤äº†å£°éŸ³å’Œè§¦æ‘¸ç­‰å…¶ä»–æ„Ÿå®˜ã€‚<br>å…‰å‘æˆ‘ä»¬å±•ç¤ºäº†ç‰©ä½“æ˜¯æ˜äº®è¿˜æ˜¯æ˜æš—ï¼Œæ˜¯è¿œè¿˜æ˜¯è¿‘ï¼Œå®ƒçš„è§’åº¦æ˜¯ä»€ä¹ˆã€‚</p><p>åœ¨ç°å®ä¸–ç•Œï¼Œæˆ‘ä»¬æ‰€æ„ŸçŸ¥çš„å…‰å®é™…æ˜¯æ•°ä¸‡äº¿å¾®å°ç²’å­çš„èšé›†ï¼Œç§°ä¸ºå…‰å­ã€‚å®ƒä»å…‰æºé£å‡ºï¼Œåå¼¹æ•°åƒæˆ–æ•°ç™¾ä¸‡æ¬¡ï¼Œæœ€ç»ˆåˆ°è¾¾æˆ‘ä»¬çš„çœ¼é•œæˆ‘ä»¬ç§°ä¹‹ä¸ºå…‰ã€‚</p><p>æˆ‘ä»¬å¦‚ä½•é€šè¿‡è®¡ç®—æœºå›¾å½¢æ¨¡æ‹Ÿå…‰çš„å½±å“ï¼Ÿ<br>æœ‰ä¸¤ç§æµè¡Œçš„æ–¹æ³•ï¼š<a href="http://en.wikipedia.org/wiki/Ray_tracing_(graphics)" target="_blank" rel="noopener">å…‰çº¿è¿½è¸ª</a>å’Œ<a href="http://en.wikipedia.org/wiki/Rasterisation" target="_blank" rel="noopener">å…‰æ …åŒ–</a><br>å…‰çº¿è·Ÿè¸ªçš„å·¥ä½œåŸç†æ˜¯é€šè¿‡æ•°å­¦è®¡ç®—è·Ÿè¸ªå®é™…å…‰çº¿å¹¶æŸ¥çœ‹å®ƒä»¬çš„æœ€ç»ˆä½ç½®ã€‚è¯¥æŠ€æœ¯å¯ä»¥å¾—åˆ°éå¸¸ç²¾å‡†å’Œé€¼çœŸçš„ç»“æœï¼Œä½†ç¼ºç‚¹æ˜¯æ¨¡æ‹Ÿæ‰€æœ‰è¿™äº›å…‰çº¿çš„è®¡ç®—æˆæœ¬éå¸¸é«˜ï¼Œå¹¶ä¸”é€šå¸¸å¯¹äºå®æ—¶æ¸²æŸ“æ¥è¯´å¤ªæ…¢äº†ã€‚<br>ç”±äºè¿™ä¸ªé™åˆ¶ï¼Œå¤§å¤šæ•°å®æ—¶å›¾å½¢è®¡ç®—ä½¿ç”¨å…‰æ …åŒ–ï¼Œå®ƒé€šè¿‡è¿‘ä¼¼å€¼æ¨¡æ‹Ÿå…‰ç…§ã€‚é‰´äºå½“å‰æ¸¸æˆçš„çœŸå®æ€§ï¼Œå…‰æ …åŒ–çœ‹èµ·æ¥éå¸¸å¥½ï¼Œå³ä½¿åœ¨æ‰‹æœºä¸Šä¹Ÿå¯ä»¥å¿«é€Ÿå®ç°å®æ—¶å›¾å½¢ã€‚OpengGL ESä¸»è¦æ˜¯ä¸€ä¸ªå…‰æ …åŒ–åº“ï¼Œå› æ­¤æˆ‘ä»¬ä¸»è¦å…³æ³¨è¿™ä¸ªã€‚</p><h3 id="ä¸åŒç§ç±»çš„å…‰">ä¸åŒç§ç±»çš„å…‰<a href="post/Learn-OpenGL-Lesson-Two#ä¸åŒç§ç±»çš„å…‰"></a></h3><p>äº‹å®è¯æ˜ï¼Œæˆ‘ä»¬å¯ä»¥æŠ½è±¡å‡ºå…‰çš„å·¥ä½œæ–¹å¼ï¼Œå¹¶æå‡ºä¸‰ç§åŸºæœ¬çš„å…‰ç…§æ–¹å¼</p><div class="article-bounded"><div class="article-table"><table><tbody><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190123234400.png" alt="Ambient"><br>ç¯å¢ƒå…‰</td><td><strong>ç¯å¢ƒå…‰</strong><br>è¿™æ˜¯åŸºæœ¬çš„ç…§æ˜æ°´å¹³ï¼Œä¼¼ä¹éå¸ƒæ•´ä¸ªåœºæ™¯ã€‚å®ƒä¼¼ä¹ä¸æ˜¯æ¥è‡ªä»»ä½•<br>å…‰æºçš„å…‰ï¼Œå› ä¸ºå®ƒåœ¨åˆ°è¾¾ä½ ä¹‹å‰å·²ç»åå¼¹äº†å¾ˆå¤šæ¬¡ã€‚è¿™ç§ç±»å‹çš„å…‰<br>åœ¨æˆ·å¤–çš„é˜´å¤©å¯ä»¥ä½“éªŒï¼Œæˆ–è€…åœ¨æˆ·å†…ä½œä¸ºè®¸å¤šä¸åŒå…‰æºçš„ç§¯ç´¯å½±å“ã€‚<br>æˆ‘ä»¬å¯ä»¥ä¸ºç‰©ä½“æˆ–åœºæ™¯è®¾ç½®ä¸€ä¸ªåŸºæœ¬çš„äº®åº¦ï¼Œè€Œä¸æ˜¯ä¸ºæ‰€æœ‰çš„<br>å…‰å•ç‹¬è®¡ç®—ã€‚</td></tr><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190124093759.png" alt="diffuse"><br>ç¯å¢ƒç…§æ˜å’Œæ¼«å°„ç…§æ˜<br>çš„ä¾‹å­</td><td><strong>æ¼«å°„ç…§æ˜</strong><br>è¿™æ˜¯ç›´æ¥ä»ä¸€ä¸ªç‰©ä½“ä¸Šè·³å¼¹ååˆ°è¾¾æ‚¨çœ¼ç›ä¸­çš„å…‰ï¼Œç‰©ä½“çš„äº®åº¦<br>éšç€å®ƒä¸ç…§æ˜çš„è§’åº¦è€Œå˜åŒ–ï¼Œé¢å‘ç¯å…‰çš„æ–¹å‘æ¯”å…¶ä»–è§’åº¦æ›´åŠ æ˜äº®<br>æ­¤å¤–ï¼Œæ— è®ºæˆ‘ä»¬ç›¸å¯¹äºç‰©ä½“çš„è§’åº¦æ€æ ·ï¼Œæˆ‘ä»¬éƒ½è§‰å¾—ç‰©ä½“æ˜¯ç›¸åŒçš„<br>äº®åº¦ï¼Œè¿™ä¹Ÿè¢«ç§°ä¸º<a href="https://en.wikipedia.org/wiki/Lambert%27s_cosine_law" target="_blank" rel="noopener">Lambertçš„ä½™å¼¦å®šå¾‹</a>ã€‚æ¼«å°„ç…§æ˜æˆ–æœ—ä¼¯åå°„ç‡åœ¨<br>æ—¥å¸¸ç”Ÿæ´»ä¸­å¾ˆå¸¸è§ï¼Œæ‚¨å¯ä»¥åœ¨å®¤å†…ç¯å…‰ç…§æ˜çš„ç™½å¢™ä¸Šè½»æ¾çœ‹åˆ°ã€‚</td></tr><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190124105013.png" alt="specular"><br>é•œé¢é«˜å…‰çš„ä¸€ä¸ªä¾‹å­</td><td><strong>é•œé¢ç…§æ˜</strong><br>ä¸æ¼«å°„ç…§æ˜ä¸åŒï¼Œå½“æˆ‘ä»¬ç›¸å¯¹äºç‰©ä½“ç§»åŠ¨æ—¶ï¼Œé•œé¢å…‰ç…§ä¹Ÿä¼š<br>å‘ç”Ÿæ”¹å˜ã€‚è¿™ç»™ç‰©ä½“å¸¦æ¥â€œå…‰æ³½â€ï¼Œå¹¶ä¸”å¯ä»¥åœ¨â€œæ›´å…‰æ»‘â€çš„è¡¨é¢<br>ä¸Šçœ‹åˆ°ï¼Œä¾‹å¦‚ç»ç’ƒå’Œå…¶ä»–æœ‰å…‰æ³½çš„ç‰©ä½“ã€‚</td></tr></tbody></table></div></div><h3 id="æ¨¡æ‹Ÿå…‰">æ¨¡æ‹Ÿå…‰<a href="post/Learn-OpenGL-Lesson-Two#æ¨¡æ‹Ÿå…‰"></a></h3><p>æ­£å¦‚3Dåœºæ™¯ä¸­çš„3ä¸­ä¸»è¦ç±»å‹çš„å…‰ç…§ä¸€æ ·ï¼Œè¿˜æœ‰ä¸‰ç§ä¸»è¦ç±»å‹çš„å…‰æºï¼šå®šå‘å…‰æºï¼Œç‚¹å…‰æºï¼Œèšå…‰ç¯ï¼Œè¿™äº›ä¹Ÿå¯ä»¥åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­è½»æ¾çœ‹åˆ°ã€‚</p><div class="article-bounded"><div class="article-table"><table><tbody><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190124112017.png" alt="Directional lighting"><br>ä¸€ä¸ªæ˜äº®çš„é£æ™¯</td><td><strong>å®šå‘å…‰æº</strong><br>å®šå‘å…‰ç…§é€šå¸¸æ¥è‡ªäºä¸€ä¸ªå¾ˆè¿œçš„å…‰æºï¼Œå®ƒå¯ä»¥å‡åŒ€çš„ç…§äº®æ•´ä¸ª<br>åœºæ™¯è¾¾åˆ°ç›¸åŒçš„äº®åº¦ã€‚è¿™ç§å…‰æºæ˜¯æœ€ç®€å•çš„ç±»å‹ï¼Œæ— è®ºæ‚¨å¤„åœ¨<br>åœºæ™¯å“ªé‡Œï¼Œå…‰ç…§éƒ½å…·æœ‰ç›¸åŒçš„å¼ºåº¦å’Œæ–¹å‘ã€‚</td></tr><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190124112915.png" alt="Point lighting"><br>ä¸€ä¸ªç‚¹å…‰æºçš„ä¾‹å­</td><td><strong>ç‚¹å…‰æº</strong><br>ç‚¹å…‰æºå¯ä»¥æ·»åŠ åˆ°åœºæ™¯ä¸­ï¼Œä»¥æä¾›æ›´å¤šæ ·åŒ–å’Œé€¼çœŸçš„ç…§æ˜ã€‚<br>ç‚¹å…‰çš„ç…§å°„<a href="https://en.wikipedia.org/wiki/Inverse-square_law" target="_blank" rel="noopener">éšç€è·ç¦»è€Œä¸‹é™</a>ï¼Œå¹¶ä¸”å®ƒçš„å…‰çº¿åœ¨æ‰€æœ‰æ–¹å‘ä¸Š<br>å‘å¤–ä¼ æ’­ï¼Œå…‰æºä½äºä¸­å¿ƒã€‚</td></tr><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190124113930.png" alt="Spot lighting"><br>èšå…‰ç¯</td><td><strong>èšå…‰ç¯</strong><br>é™¤äº†å…·æœ‰ç‚¹å…‰æºçš„ç‰¹æ€§å¤–ï¼Œèšå…‰ç¯ä¹Ÿæœ‰å…‰å“€å‡çš„æ–¹å‘ï¼Œ<br>é€šå¸¸å‘ˆé”¥å½¢ã€‚</td></tr></tbody></table></div></div><h3 id="æ•°å­¦">æ•°å­¦<a href="post/Learn-OpenGL-Lesson-Two#æ•°å­¦"></a></h3><p>æœ¬èŠ‚è¯¾ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ¥è‡ªä¸€ä¸ªç‚¹å…‰æºçš„ç¯å¢ƒç…§æ˜å’Œæ¼«å°„ç…§æ˜ã€‚</p><h3 id="ç¯å¢ƒç…§æ˜">ç¯å¢ƒç…§æ˜<a href="post/Learn-OpenGL-Lesson-Two#ç¯å¢ƒç…§æ˜"></a></h3><p>ç¯å¢ƒç…§æ˜å…¶å®æ˜¯<a href="https://en.wikipedia.org/wiki/Radiosity_(computer_graphics)" target="_blank" rel="noopener">é—´æ¥æ¼«å°„ç…§æ˜</a>ï¼Œä½†å®ƒä¹Ÿå¯ä»¥è¢«è®¤ä¸ºæ˜¯éå¸ƒæ•´ä¸ªåœºæ™¯çš„ä½çº§å…‰ã€‚å¦‚æœæˆ‘ä»¬è¿™ä¹ˆæƒ³ï¼Œé‚£ä¹ˆå®ƒå°†éå¸¸å¥½è®¡ç®—ï¼š</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ€ç»ˆé¢œè‰² = æè´¨é¢œè‰² * ç¯å¢ƒå…‰é¢œè‰²</span></span><br><span class="line">final color = material color * ambient light color</span><br></pre></td></tr></table></div></figure><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸ªçº¢è‰²çš„ç‰©ä½“å’Œä¸€ä¸ªæš—ç™½è‰²çš„ç¯å¢ƒç…§æ˜ã€‚æˆ‘ä»¬å‡è®¾ä¸‰ä¸ªé¢œè‰²ï¼ˆçº¢ï¼Œç»¿ï¼Œè“ï¼‰çš„æ•°ç»„å­˜å‚¨é¢œè‰²ï¼Œä½¿ç”¨<a href="https://en.wikipedia.org/wiki/RGB_color_model" target="_blank" rel="noopener">RGBé¢œè‰²æ¨¡å‹</a>ï¼š</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ€ç»ˆé¢œè‰² = çº¢è‰² * æš—ç™½è‰² = æš—çº¢è‰²</span></span><br><span class="line">final color = &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125; * &#123;<span class="number">0.1</span>, <span class="number">0.1</span>, <span class="number">0.1</span>&#125; = &#123;<span class="number">0.1</span>, <span class="number">0.0</span>, <span class="number">0.0</span>&#125;</span><br></pre></td></tr></table></div></figure><p>ç‰©ä½“çš„æœ€ç»ˆé¢œè‰²å°†æ˜¯æš—çº¢è‰²ï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ªè¢«æ˜æš—çš„ç™½å…‰ç…§æ˜çš„çº¢è‰²ç‰©ä½“ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯æ‚¨çš„é¢„æœŸã€‚åŸºæœ¬çš„ç¯å¢ƒå…‰çœŸçš„æ²¡æœ‰æ¯”è¿™æ›´å¤šçš„äº†ï¼Œé™¤éæ‚¨æƒ³åŠ å…¥æ›´å…ˆè¿›çš„ç…§æ˜æŠ€æœ¯ï¼Œå¦‚å…‰èƒ½ä¼ é€’ã€‚</p><h3 id="æ¼«å°„ç…§æ˜-ç‚¹å…‰æº">æ¼«å°„ç…§æ˜-ç‚¹å…‰æº<a href="post/Learn-OpenGL-Lesson-Two#æ¼«å°„ç…§æ˜-ç‚¹å…‰æº"></a></h3><p>å¯¹äºæ¼«å°„ç…§æ˜ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ å“€å‡å’Œå…‰æºä½ç½®ã€‚å…‰æºä½ç½®å°†ç”¨æ¥è®¡ç®—å…‰çº¿å’Œè¡¨é¢çš„è§’åº¦ï¼Œå®ƒå°†å½±å“è¡¨é¢çš„æ•´ä½“å…‰ç…§æ°´å¹³ã€‚å®ƒè¿˜å°†ç”¨äºè®¡ç®—å…‰æºåˆ°è¡¨é¢çš„è·ç¦»ï¼Œè¿™å†³å®šäº†å…‰åœ¨è¿™ä¸ªç‚¹ä¸Šçš„å¼ºåº¦ã€‚</p><h4 id="ç¬¬ä¸€æ­¥ï¼šè®¡ç®—æœ—ä¼¯å› å­ï¼ˆlambert-factorï¼‰">ç¬¬ä¸€æ­¥ï¼šè®¡ç®—æœ—ä¼¯å› å­ï¼ˆlambert factorï¼‰<a href="post/Learn-OpenGL-Lesson-Two#ç¬¬ä¸€æ­¥ï¼šè®¡ç®—æœ—ä¼¯å› å­ï¼ˆlambert-factorï¼‰"></a></h4><p>æˆ‘ä»¬æœ€é‡è¦çš„æ˜¯éœ€è¦å¼„æ¸…æ¥šè¡¨é¢å’Œå…‰çº¿ä¹‹é—´çš„è§’åº¦ã€‚é¢å‘å…‰ç›´å°„çš„è¡¨é¢å› è¯¥å…¨å¼ºåº¦ç…§å°„ï¼Œè€Œå€¾æ–œçš„è¡¨é¢å› è¯¥å¾—åˆ°è¾ƒå°‘çš„ç…§å°„ï¼Œæ¯”è¾ƒåˆé€‚çš„è®¡ç®—æ–¹å¼æ˜¯ä½¿ç”¨<a href="https://en.wikipedia.org/wiki/Lambert%27s_cosine_law" target="_blank" rel="noopener">Lambertçš„ä½™å¼¦å®šå¾‹</a>ã€‚<br>æœæˆ‘ä»¬æœ‰ä¸¤ä¸ªå‘é‡ï¼Œä¸€ä¸ªæ˜¯ä»å…‰åˆ°è¡¨é¢ä¸Šçš„ä¸€ä¸ªç‚¹ï¼Œç¬¬äºŒä¸ªæ˜¯<a href="https://en.wikipedia.org/wiki/Normal_(geometry)" target="_blank" rel="noopener">è¡¨é¢çš„æ³•çº¿</a>ï¼ˆå¦‚æœè¡¨é¢æ˜¯å¹³é¢ï¼Œåˆ™è¡¨é¢æ³•çº¿æ˜¯æŒ‡å‘ä¸Šæˆ–å‚ç›´äºè¯¥è¡¨é¢çš„çŸ¢é‡ï¼‰ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹æ¯ä¸ªå‘é‡è¿›è¡Œå½’ä¸€åŒ–æ¥è®¡ç®—ä½™å¼¦ï¼Œä½¿å…¶é•¿åº¦ä¸º1ï¼Œç„¶åé€šè¿‡è®¡ç®—ä¸¤ä¸ªå‘é‡çš„<a href="https://en.wikipedia.org/wiki/Dot_product" target="_blank" rel="noopener">ç‚¹ç§¯ï¼ˆæ•°é‡ç§¯ï¼‰</a>ã€‚<br>è¿™ä¸ªæ“ä½œå¯ä»¥ç”±OpenGL ES 2è½»æ¾å®Œæˆã€‚</p><p>æˆ‘ä»¬ç§°è¿™ä½æœ—ä¼¯å› å­ï¼Œå®ƒçš„å–å€¼èŒƒå›´åœ¨0~1ä¹‹é—´</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…‰çº¿å‘é‡ = å…‰æºä½ç½® - ç‰©ä½“ä½ç½®</span></span><br><span class="line">light <span class="built_in">vector</span> = light position - object position</span><br><span class="line"><span class="comment">// ä½™å¼¦ = ç‰©ä½“æ³•çº¿å’Œå½’ä¸€åŒ–åçš„å…‰çº¿å‘é‡çš„ç‚¹ç§¯</span></span><br><span class="line">cosine = dot product(object normal, normalize(light <span class="built_in">vector</span>))</span><br><span class="line"><span class="comment">// æœ—ä¼¯å› å­ = å–ä½™å¼¦å’Œ0ä¸­æœ€å¤§çš„</span></span><br><span class="line">lambert factor = max(cosine, <span class="number">0</span>)</span><br></pre></td></tr></table></div></figure><p>é¦–å…ˆæˆ‘ä»¬é€šè¿‡å…‰æºä½ç½®å‡å»ç‰©ä½“ä½ç½®å¾—åˆ°å…‰çº¿å‘é‡ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡ç‰©ä½“æ³•çº¿å’Œå…‰å‘é‡çš„ç‚¹ç§¯å¾—åˆ°ä½™å¼¦ã€‚æˆ‘ä»¬æ ‡å‡†åŒ–å…‰å‘é‡ï¼Œè¿™æ„å‘³ç€æ”¹å˜å®ƒçš„é•¿åº¦ï¼Œé•¿åº¦ä¸º1ï¼Œè¿™ä¸ªç‰©ä½“çš„æ³•çº¿é•¿åº¦ä¹Ÿæ˜¯1ï¼Œä¸¤ä¸ªå½’ä¸€åŒ–å‘é‡çš„ç‚¹ç§¯å¾—åˆ°ä»–ä»¬ä¹‹é—´çš„ä½™å¼¦ã€‚å› ä¸ºç‚¹ç§¯çš„å–å€¼èŒƒå›´æ˜¯-1~1ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å…¶é™åˆ¶åˆ°0~1ã€‚</p><p>è¿™å„¿æœ‰ä¸ªå¤„åœ¨åŸç‚¹çš„å¹³é¢ï¼Œå…¶è¡¨é¢æ³•çº¿æŒ‡å‘å¤©ç©ºçš„ä¾‹å­ã€‚</p><blockquote><p>å…‰çš„ä½ç½®åœ¨{0, 10, -10}ï¼Œæˆ‘ä»¬æƒ³è¦è®¡ç®—åœ¨åŸç‚¹çš„å…‰ã€‚</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…‰çº¿å‘é‡</span></span><br><span class="line">light <span class="built_in">vector</span> = &#123;<span class="number">0</span>, <span class="number">10</span>, <span class="number">-10</span>&#125; - &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125; = &#123;<span class="number">0</span>, <span class="number">10</span>, <span class="number">-10</span>&#125;</span><br><span class="line"><span class="comment">// ç‰©ä½“æ³•çº¿</span></span><br><span class="line">object normal = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ç®€æ´çš„è¯´ï¼Œå¦‚æœä»¬æ²¿ç€å…‰çº¿çŸ¢é‡èµ°ï¼Œæˆ‘ä»¬åˆ°è¾¾å…‰æºçš„ä½ç½®ã€‚ä¸ºäº†å½’ä¸€åŒ–çŸ¢é‡ï¼Œæˆ‘ä»¬å°†æ¯ä¸ªåˆ†é‡é™¤ä»¥çŸ¢é‡é•¿åº¦ï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…‰çº¿å‘é‡é•¿åº¦ = å¹³æ–¹æ ¹(0*0 + 10*10 + (-10 * -10)) = å¹³æ–¹æ ¹(200) = 14.14</span></span><br><span class="line">light <span class="built_in">vector</span> length = square root(<span class="number">0</span>*<span class="number">0</span> + <span class="number">10</span>*<span class="number">10</span> + (<span class="number">-10</span> * <span class="number">-10</span>)) = square root(<span class="number">200</span>) = <span class="number">14.14</span></span><br><span class="line"><span class="comment">// å½’ä¸€åŒ–å…‰çº¿å‘é‡</span></span><br><span class="line">normalize light <span class="built_in">vector</span> = &#123;<span class="number">0</span>, <span class="number">10</span>/<span class="number">14.14</span>, <span class="number">-10</span>/<span class="number">14.14</span>&#125; = &#123;<span class="number">0</span>, <span class="number">0.707</span>, <span class="number">-0.707</span>&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ç„¶åæˆ‘ä»¬è®¡ç®—ç‚¹ç§¯ï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç‚¹ç§¯</span></span><br><span class="line"><span class="function">dot <span class="title">product</span><span class="params">(&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">0.707</span>, <span class="number">-0.707</span>&#125;)</span> </span>= (<span class="number">0</span> * <span class="number">0</span>) + (<span class="number">1</span> * <span class="number">0.707</span>) + (<span class="number">0</span> * <span class="number">-0.707</span>) = <span class="number">0.707</span></span><br></pre></td></tr></table></div></figure><p><a href="http://programmedlessons.org/VectorLessons/vch07/vch07_5.html" target="_blank" rel="noopener">è¿™é‡Œæœ‰ä¸ªä¸€å¯¹ç‚¹ç§¯è®¡ç®—å¾ˆå¥½çš„è§£é‡Š</a></p><blockquote><p>æœ€åæˆ‘ä»¬é™åˆ¶èŒƒå›´ï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ—ä¼¯å› å­</span></span><br><span class="line">lambert factor = max(<span class="number">0.707</span>, <span class="number">0</span>) = <span class="number">0.707</span></span><br></pre></td></tr></table></div></figure><p>OpenGL ES 2çš„ç€è‰²å™¨è¯­è¨€å†…ç½®äº†å¯¹å…¶ä¸­ä¸€äº›å‡½æ•°çš„æ”¯æŒï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦æ‰‹åŠ¨å®Œæˆæ‰€æœ‰æ•°å­¦è¿ç®—ï¼Œä½†å®ƒä»ç„¶æœ‰åŠ©äºç†è§£æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚</p><h4 id="ç¬¬äºŒæ­¥ï¼šè®¡ç®—å“€å‡ç³»æ•°">ç¬¬äºŒæ­¥ï¼šè®¡ç®—å“€å‡ç³»æ•°<a href="post/Learn-OpenGL-Lesson-Two#ç¬¬äºŒæ­¥ï¼šè®¡ç®—å“€å‡ç³»æ•°"></a></h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—å“€å‡ã€‚æ¥è‡ªå…‰æºçš„å®é™…å…‰å“€å‡éµå¾ª<a href="https://en.wikipedia.org/wiki/Inverse-square_law" target="_blank" rel="noopener">åå¹³æ–¹å®šå¾‹</a></p><blockquote><p>ä¹Ÿå¯ä»¥è¿™æ ·è¡¨ç¤ºï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// äº®åº¦ = 1 / è·ç¦»çš„å¹³æ–¹</span></span><br><span class="line">luminosity = <span class="number">1</span> / (distance * distance)</span><br></pre></td></tr></table></div></figure><blockquote><p>å›åˆ°æˆ‘ä»¬çš„åˆ—å­ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰å…‰çº¿é•¿åº¦ä¸º14.14ï¼Œè¿™å„¿æˆ‘ä»¬æœ€ç»ˆçš„äº®åº¦ï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">luminosity = <span class="number">1</span> / (<span class="number">14.14</span> * <span class="number">14.14</span>) = <span class="number">1</span> / <span class="number">200</span> = <span class="number">0.005</span></span><br></pre></td></tr></table></div></figure><p>æ­£å¦‚æ‚¨æ‰€è§ï¼Œåå¹³æ–¹å®šå¾‹ä¼šå¯¼è‡´è·ç¦»çš„å¼ºçƒˆå“€å‡ã€‚è¿™å°±æ˜¯ç‚¹å…‰æºçš„å…‰åœ¨ç°å®ä¸–ç•Œä¸­çš„ä½œç”¨ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬å›¾å½¢å±•ç¤ºèŒƒå›´æœ‰é™ï¼Œæ§åˆ¶è¿™ä¸ªå“€å‡ç³»æ•°æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œå› æ­¤æˆ‘ä»¬ä»ç„¶èƒ½è·å¾—é€¼çœŸçš„ç…§æ˜è€Œä¸ä¼šè®©å…¶çœ‹èµ·æ¥å¾ˆæ˜æš—ã€‚</p><h4 id="ç¬¬ä¸‰æ­¥ï¼šè®¡ç®—æœ€ç»ˆé¢œè‰²">ç¬¬ä¸‰æ­¥ï¼šè®¡ç®—æœ€ç»ˆé¢œè‰²<a href="post/Learn-OpenGL-Lesson-Two#ç¬¬ä¸‰æ­¥ï¼šè®¡ç®—æœ€ç»ˆé¢œè‰²"></a></h4><blockquote><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ä½™å¼¦å’Œå“€å‡åº¦ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æˆ‘ä»¬æœ€ç»ˆçš„äº®åº¦ï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ€ç»ˆé¢œè‰² = æè´¨é¢œè‰² * ï¼ˆå…‰çš„é¢œè‰² * æœ—ä¼¯å› å­ * äº®åº¦ï¼‰</span></span><br><span class="line">final color = material color * (light color * lambert factor * luminosity)</span><br></pre></td></tr></table></div></figure><blockquote><p>ç»§ç»­æˆ‘ä»¬ä¹‹å‰çš„çº¢è‰²ç‰©ä½“å’Œç™½å…‰æºçš„ä¾‹å­ï¼Œè¿™å„¿è®¡ç®—æœ€ç»ˆé¢œè‰²ï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">final color = &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125; * (&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125; * <span class="number">0.707</span> * <span class="number">0.005</span>) = &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125; * &#123;<span class="number">0.0035</span>, <span class="number">0.0035</span>, <span class="number">0.0035</span>&#125; = &#123;<span class="number">0.0035</span>, <span class="number">0</span>, <span class="number">0</span>&#125;</span><br></pre></td></tr></table></div></figure><p>å›é¡¾ä¸€ä¸‹ï¼Œå¯¹äºæ¼«å°„ç…§æ˜ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨è¡¨é¢å’Œå…‰çº¿ä¹‹é—´çš„è§’åº¦ä»¥åŠè·ç¦»ï¼Œç”¨æ¥è®¡ç®—æœ€ç»ˆçš„æ•´ä½“æ¼«å°„äº®åº¦ã€‚</p><blockquote><p>ä»¥ä¸‹æ˜¯æ­¥éª¤ï¼š</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¬¬ä¸€æ­¥</span></span><br><span class="line">light <span class="built_in">vector</span> = light position - object position</span><br><span class="line">cosine = dot product(object normal, normalize(light <span class="built_in">vector</span>))</span><br><span class="line">lambert factor = mac(cosine, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬äºŒæ­¥</span></span><br><span class="line">luminosity = <span class="number">1</span> / (distance * distance)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸‰æ­¥</span></span><br><span class="line">final color = material color * (light color * lambert factor * luminosity)</span><br></pre></td></tr></table></div></figure><h3 id="å°†è¿™ä¸€åˆ‡æ”¾åˆ°OpenGL-ES-2ç€è‰²å™¨ä¸­">å°†è¿™ä¸€åˆ‡æ”¾åˆ°OpenGL ES 2ç€è‰²å™¨ä¸­<a href="post/Learn-OpenGL-Lesson-Two#å°†è¿™ä¸€åˆ‡æ”¾åˆ°OpenGL-ES-2ç€è‰²å™¨ä¸­"></a></h3><h4 id="é¡¶ç‚¹ç€è‰²å™¨">é¡¶ç‚¹ç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Two#é¡¶ç‚¹ç€è‰²å™¨"></a></h4><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> String vertexShader =</span><br><span class="line">        <span class="string">"uniform mat4 u_MVPMatrix;      \n"</span> + <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewã€projectionçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line">        <span class="string">"uniform mat4 u_MVMatrix;       \n"</span> + <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line">        <span class="string">"uniform vec3 u_LightPos;       \n"</span> + <span class="comment">// å…‰æºåœ¨çœ¼ç›ç©ºé—´ï¼ˆç›¸å¯¹äºç›¸æœºè§†è§’ï¼‰çš„ä½ç½®</span></span><br><span class="line"></span><br><span class="line">        <span class="string">"attribute vec4 a_Position;     \n"</span> + <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®ä¿¡æ¯</span></span><br><span class="line">        <span class="string">"attribute vec4 a_Color;        \n"</span> + <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„é¢œè‰²ä¿¡æ¯</span></span><br><span class="line">        <span class="string">"attribute vec3 a_Normal;       \n"</span> + <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„æ³•çº¿ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">        <span class="string">"varying vec4 v_Color;          \n"</span> + <span class="comment">// è¿™å°†è¢«ä¼ å…¥ç‰‡æ®µç€è‰²å™¨</span></span><br><span class="line"></span><br><span class="line">        <span class="string">"void main()                    \n"</span> + <span class="comment">// é¡¶ç‚¹ç€è‰²å™¨å…¥å£</span></span><br><span class="line">        <span class="string">"&#123;                              \n"</span> +</span><br><span class="line">        <span class="comment">// å°†é¡¶ç‚¹è½¬æ¢æˆçœ¼ç›ç©ºé—´ï¼ˆç›¸å¯¹äºç›¸æœºè§†è§’ï¼‰</span></span><br><span class="line">        <span class="string">"   vec3 modelViewVertex = vec3(u_MVMatrix * a_Position);                \n"</span> +</span><br><span class="line">        <span class="comment">// å°†æ³•çº¿çš„æ–¹å‘è½¬æ¢æˆçœ¼ç›ç©ºé—´ï¼ˆç›¸å¯¹äºç›¸æœºè§†è§’ï¼‰</span></span><br><span class="line">        <span class="string">"   vec3 modelViewNormal = vec3(u_MVMatrix * vec4(a_Normal, 0.0));       \n"</span> +</span><br><span class="line">        <span class="comment">// å°†ç”¨äºå“€å‡</span></span><br><span class="line">        <span class="string">"   float distance = length(u_LightPos - modelViewVertex);               \n"</span> +</span><br><span class="line">        <span class="comment">// è·å–ä»å…‰æºåˆ°é¡¶ç‚¹æ–¹å‘çš„å…‰çº¿å‘é‡</span></span><br><span class="line">        <span class="string">"   vec3 lightVector = normalize(u_LightPos - modelViewVertex);          \n"</span> +</span><br><span class="line">        <span class="comment">// è®¡ç®—å…‰çº¿çŸ¢é‡å’Œé¡¶ç‚¹æ³•çº¿çš„ç‚¹ç§¯ï¼Œå¦‚æœæ³•çº¿å’Œå…‰çº¿çŸ¢é‡æŒ‡å‘ç›¸åŒçš„æ–¹å‘ï¼Œé‚£ä¹ˆå®ƒå°†è·å¾—æœ€å¤§çš„ç…§æ˜</span></span><br><span class="line">        <span class="string">"   float diffuse = max(dot(modelViewNormal, lightVector), 0.1);         \n"</span> +</span><br><span class="line">        <span class="comment">// æ ¹æ®è·ç¦»å“€å‡å…‰çº¿</span></span><br><span class="line">        <span class="string">"   diffuse = diffuse * (1.0 / (1.0 + (0.25 * distance * distance)));    \n"</span> +</span><br><span class="line">        <span class="comment">// å°†é¢œè‰²ä¹˜ä»¥äº®åº¦ï¼Œå®ƒå°†è¢«æ’å…¥ä¸‰è§’å½¢ä¸­</span></span><br><span class="line">        <span class="string">"   v_Color = a_Color * diffuse;                                         \n"</span> +</span><br><span class="line">        <span class="comment">// gl_Positionæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ç”¨æ¥å­˜å‚¨æœ€ç»ˆçš„ä½ç½®</span></span><br><span class="line">        <span class="comment">// å°†é¡¶ç‚¹ä¹˜ä»¥çŸ©é˜µå¾—åˆ°æ ‡å‡†åŒ–å±å¹•åæ ‡çš„æœ€ç»ˆç‚¹</span></span><br><span class="line">        <span class="string">"   gl_Position = u_MVPMatrix * a_Position;                              \n"</span> +</span><br><span class="line">        <span class="string">"&#125;                                                                       \n"</span>;</span><br></pre></td></tr></table></div></figure><p>è¿™é‡Œæœ‰ç›¸å½“å¤šçš„äº‹æƒ…è¦åšã€‚æˆ‘ä»¬åœ¨<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">ç¬¬ä¸€è¯¾</a>è®²åˆ°è¿‡æˆ‘ä»¬è¦æœ‰ä¸€ä¸ªmodel/view/projectionçš„ç»„åˆçŸ©é˜µï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜è¦æ·»åŠ äº†ä¸€ä¸ªmodel/viewçŸ©é˜µã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºæˆ‘ä»¬å°†éœ€è¦è¿™ä¸ªçŸ©é˜µå»è®¡ç®—å…‰æºä½ç½®åˆ°å½“å‰é¡¶ç‚¹ä½ç½®ä¹‹é—´çš„è·ç¦»ã€‚å¯¹äºæ¼«å°„ç…§æ˜ï¼Œæ— è®ºæ‚¨ä½¿ç”¨ä¸–ç•Œç©ºé—´ï¼ˆmodelçŸ©é˜µï¼‰æˆ–çœ¼ç›ç©ºé—´ï¼ˆmodel/viewçŸ©é˜µï¼‰åªè¦ä½ èƒ½è®¡ç®—å‡ºåˆé€‚çš„è·ç¦»å’Œè§’åº¦å®é™…ä¸Šéƒ½æ²¡æœ‰é—®é¢˜ã€‚</p><p>æˆ‘ä»¬ä¼ å…¥é¡¶ç‚¹çš„é¢œè‰²å’Œä½ç½®ä¿¡æ¯ï¼Œä»¥åŠå®ƒçš„<a href="https://en.wikipedia.org/wiki/Normal_(geometry)" target="_blank" rel="noopener">æ³•çº¿</a>ã€‚æˆ‘ä»¬ä¼šå°†æœ€ç»ˆçš„é¢œè‰²ä¼ å…¥ç‰‡æ®µç€è‰²å™¨ï¼Œå®ƒå°†åœ¨é¡¶ç‚¹ä¹‹é—´æ’å€¼ï¼Œè¿™ä¹Ÿè¢«ç§°ä¸º<a href="https://en.wikipedia.org/wiki/Gouraud_shading" target="_blank" rel="noopener">Gouraudç€è‰²æ³•</a>ã€‚</p><p>è®©æˆ‘ä»¬æ¥çœ‹çœ‹ç€è‰²å™¨æ¯ä¸€éƒ¨åˆ†çš„æ„ä¹‰ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†é¡¶ç‚¹è½¬æ¢æˆçœ¼ç›ç©ºé—´ï¼ˆç›¸å¯¹äºç›¸æœºè§†è§’ï¼‰</span></span><br><span class="line"><span class="string">"   vec3 modelViewVertex = vec3(u_MVMatrix * a_Position);                \n"</span></span><br></pre></td></tr></table></div></figure><p>å› ä¸ºæˆ‘ä»¬æ˜¯åœ¨çœ¼ç›ç©ºé—´è§‚å¯Ÿå…‰æºä½ç½®ï¼Œæˆ‘ä»¬è½¬æ¢å½“å‰çš„é¡¶ç‚¹ä½ç½®åˆ°çœ¼ç›ç©ºé—´çš„åæ ‡ç³»ä¸­ï¼Œå› æ­¤æˆ‘ä»¬èƒ½è®¡ç®—å‡ºå¯¹åº”çš„è·ç¦»å’Œè§’åº¦ã€‚</p><hr><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†æ³•çº¿çš„æ–¹å‘è½¬æ¢æˆçœ¼ç›ç©ºé—´ï¼ˆç›¸å¯¹äºç›¸æœºè§†è§’ï¼‰</span></span><br><span class="line"><span class="string">"   vec3 modelViewNormal = vec3(u_MVMatrix * vec4(a_Normal, 0.0));       \n"</span> +</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬ä¹Ÿéœ€è¦è½¬æ¢æ³•çº¿çš„æ–¹å‘ã€‚è¿™é‡Œæˆ‘ä»¬åªæ˜¯æƒ³ä¸Šé¢ä½ç½®ä¸€æ ·åšäº†ä¸ªå¸¸è§„ä¹˜æ³•ï¼Œä½†æ˜¯å¦‚æœmodelæˆ–viewçŸ©é˜µåšè¿‡æ—‹è½¬æˆ–å€¾æ–œï¼Œé‚£ä¹ˆå°†ä¸èƒ½å·¥ä½œï¼šæˆ‘ä»¬å®é™…ä¸Šéœ€è¦é€šè¿‡å°†æ³•çº¿ä¹˜ä»¥åŸå§‹çŸ©é˜µçš„åè½¬æ¥æ¶ˆé™¤å€¾æ–œæˆ–ç¼©æ”¾çš„å½±å“ã€‚<a href="https://web.archive.org/web/20150101061328/http://www.arcsynthesis.org/gltut/Illumination/Tut09%20Normal%20Transformation.html" target="_blank" rel="noopener">è¿™ä¸ªç½‘ç«™å¾ˆå¥½çš„è§£é‡Šäº†ä¸ºä»€ä¹ˆæˆ‘ä»¬å¿…é¡»è¿™ä¹ˆåš</a></p><hr><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†ç”¨äºå“€å‡</span></span><br><span class="line"><span class="string">"   float distance = length(u_LightPos - modelViewVertex);               \n"</span></span><br></pre></td></tr></table></div></figure><p>å¦‚å‰é¢æ•°å­¦éƒ¨åˆ†æ‰€ç¤ºï¼Œæˆ‘ä»¬éœ€è¦è¿™ä¸ªè·ç¦»å»è®¡ç®—å“€å‡ç³»æ•°</p><hr><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–ä»å…‰æºåˆ°é¡¶ç‚¹æ–¹å‘çš„å…‰çº¿å‘é‡</span></span><br><span class="line"><span class="string">"   vec3 lightVector = normalize(u_LightPos - modelViewVertex);          \n"</span></span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬ä¹Ÿéœ€è¦å…‰çº¿å‘é‡å»è®¡ç®—æœ—ä¼¯åå°„å› å­</p><hr><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¡ç®—å…‰çº¿çŸ¢é‡å’Œé¡¶ç‚¹æ³•çº¿çš„ç‚¹ç§¯ï¼Œå¦‚æœæ³•çº¿å’Œå…‰çº¿çŸ¢é‡æŒ‡å‘ç›¸åŒçš„æ–¹å‘ï¼Œé‚£ä¹ˆå®ƒå°†è·å¾—æœ€å¤§çš„ç…§æ˜</span></span><br><span class="line"><span class="string">"   float diffuse = max(dot(modelViewNormal, lightVector), 0.1);         \n"</span></span><br></pre></td></tr></table></div></figure><p>è¿™ä¸ä¸Šé¢çš„æ•°å­¦éƒ¨åˆ†ç›¸åŒï¼Œåªæ˜¯åœ¨OpenGL ES 2ç€è‰²å™¨ä¸­å®Œæˆã€‚åé¢çš„0.1æ˜¯ä¸€ç§éå¸¸ä¾¿å®œçš„ç¯å¢ƒç…§æ˜æ–¹å¼ï¼ˆæœ€å°å€¼å°†è¢«é™åˆ¶åœ¨0.1ï¼‰ã€‚</p><hr><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ®è·ç¦»å“€å‡å…‰çº¿</span></span><br><span class="line"><span class="string">"   diffuse = diffuse * (1.0 / (1.0 + (0.25 * distance * distance)));    \n"</span></span><br></pre></td></tr></table></div></figure><p>è¿™é‡Œå’Œä¸Šé¢çš„æ•°å­¦éƒ¨åˆ†ç•¥æœ‰ä¸åŒã€‚æˆ‘ä»¬å°†è·ç¦»çš„å¹³æ–¹ç¼©æ”¾0.25ä»¥æŠ‘åˆ¶è¡°å‡çš„æ•ˆåº”ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜å°†ä¿®æ”¹çš„è·ç¦»åŠ 1ï¼Œè¿™æ ·å½“å…‰æºéå¸¸æ¥è¿‘ç‰©ä½“æ—¶æˆ‘ä»¬å°±ä¸ä¼šè¿‡é¥±å’Œï¼ˆå¦åˆ™ï¼Œå½“è·ç¦»å°äº1æ—¶ï¼Œè¯¥ç­‰å¼å®é™…ä¸Šå›ç…§äº®å…‰æºè€Œä¸æ˜¯å“€å‡å®ƒï¼‰ã€‚</p><hr><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†é¢œè‰²ä¹˜ä»¥äº®åº¦ï¼Œå®ƒå°†è¢«æ’å…¥ä¸‰è§’å½¢ä¸­</span></span><br><span class="line"><span class="string">"   v_Color = a_Color * diffuse;                                         \n"</span> +</span><br><span class="line"><span class="comment">// gl_Positionæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ç”¨æ¥å­˜å‚¨æœ€ç»ˆçš„ä½ç½®</span></span><br><span class="line"><span class="comment">// å°†é¡¶ç‚¹ä¹˜ä»¥çŸ©é˜µå¾—åˆ°æ ‡å‡†åŒ–å±å¹•åæ ‡çš„æœ€ç»ˆç‚¹</span></span><br><span class="line"><span class="string">"   gl_Position = u_MVPMatrix * a_Position;                              \n"</span></span><br></pre></td></tr></table></div></figure><p>å½“æˆ‘ä»¬æœ‰äº†æœ€ç»ˆçš„å…‰è‰²ï¼Œæˆ‘ä»¬å°†å®ƒä¹˜ä»¥é¡¶ç‚¹çš„é¢œè‰²å¾—åˆ°æœ€ç»ˆè¾“å‡ºçš„é¢œè‰²ï¼Œç„¶åæˆ‘ä»¬å°†è¿™ä¸ªé¡¶ç‚¹çš„ä½ç½®æŠ•å½±åˆ°å±å¹•ä¸Šã€‚</p><h4 id="åƒç´ ç€è‰²å™¨">åƒç´ ç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-Two#åƒç´ ç€è‰²å™¨"></a></h4><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> String fragmentShader =</span><br><span class="line">        <span class="string">"precision mediump float;       \n"</span> + <span class="comment">// æˆ‘ä»¬å°†é»˜è®¤ç²¾åº¦è®¾ç½®ä¸ºä¸­ç­‰ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç‰‡æ®µç€è‰²å™¨ä¸­çš„é«˜ç²¾åº¦</span></span><br><span class="line">                <span class="string">"varying vec4 v_Color;          \n"</span> + <span class="comment">// è¿™æ˜¯ä»ä¸‰è§’å½¢æ¯ä¸ªç‰‡æ®µå†…æ’çš„é¡¶ç‚¹ç€è‰²å™¨çš„é¢œè‰²</span></span><br><span class="line">                <span class="string">"void main()                    \n"</span> + <span class="comment">// ç‰‡æ®µç€è‰²å™¨å…¥å£</span></span><br><span class="line">                <span class="string">"&#123;                              \n"</span> +</span><br><span class="line">                <span class="string">"   gl_FragColor = v_Color;     \n"</span> + <span class="comment">// ç›´æ¥å°†é¢œè‰²ä¼ é€’</span></span><br><span class="line">                <span class="string">"&#125;                              \n"</span>;</span><br></pre></td></tr></table></div></figure><p>å› ä¸ºæˆ‘ä»¬æ˜¯åœ¨æ¯ä¸ªé¡¶ç‚¹çš„åŸºç¡€ä¸Šè®¡ç®—å…‰ï¼Œæˆ‘ä»¬çš„ç‰‡æ®µç€è‰²å™¨å’Œ<a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">ä¸ŠèŠ‚è¯¾</a>ä¸€æ ·ï¼Œæˆ‘ä»¬æ‰€åšçš„æ˜¯å°†é¢œè‰²ç›´æ¥ä¼ è¿‡å»ã€‚åœ¨ä¸‹èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ æ¯åƒç´ ç…§æ˜ã€‚</p><h2 id="æ¯é¡¶ç‚¹ç…§æ˜å’Œæ¯åƒç´ ç…§æ˜">æ¯é¡¶ç‚¹ç…§æ˜å’Œæ¯åƒç´ ç…§æ˜<a href="post/Learn-OpenGL-Lesson-Two#æ¯é¡¶ç‚¹ç…§æ˜å’Œæ¯åƒç´ ç…§æ˜"></a></h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬çš„å…³æ³¨ç‚¹åœ¨å®ç°æ¯é¡¶ç‚¹ç…§æ˜ã€‚å¯¹äºå…·æœ‰å…‰æ»‘è¡¨é¢çš„ç‰©ä½“ï¼ˆå¦‚åœ°å½¢ï¼‰ï¼Œæˆ–å…·æœ‰è®¸å¤šä¸‰è§’å½¢çš„ç‰©ä½“çš„æ¼«åå°„ï¼Œè¿™é€šå¸¸æ˜¯è¶³å¤Ÿäº†ã€‚ç„¶è€Œï¼Œå½“æ‚¨çš„ç‰©ä½“æ²¡æœ‰åŒ…å«è®¸å¤šé¡¶ç‚¹æ—¶ï¼ˆä¾‹å¦‚æˆ‘ä»¬çš„åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­çš„æ­£æ–¹ä½“ï¼‰ï¼Œæˆ–è€…æœ‰å°–è§’ï¼Œé¡¶ç‚¹å…‰ç…§å¯èƒ½ä¼šå¯¼è‡´ä¼ªå½±ï¼Œå› ä¸ºäº®åº¦åœ¨å¤šè¾¹å½¢ä¸Šçº¿æ€§æ’å€¼ï¼›å½“é•œé¢é«˜å…‰æ·»åŠ åˆ°å›¾åƒæ—¶ï¼Œè¿™äº›ä¼ªå½±ä¹Ÿä¼šå˜å¾—æ›´åŠ æ˜æ˜¾ã€‚æ›´å¤šå…³äº<a href="https://en.wikipedia.org/wiki/Gouraud_shading" target="_blank" rel="noopener">Gouraudç€è‰²æ³•</a>çš„Wikiæ–‡ç« </p><h2 id="æ­£æ–¹ä½“çš„æ„é€ ">æ­£æ–¹ä½“çš„æ„é€ <a href="post/Learn-OpenGL-Lesson-Two#æ­£æ–¹ä½“çš„æ„é€ "></a></h2><p>åœ¨ç¬¬ä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†ä½ç½®å’Œé¢œè‰²å±æ€§æ‰“åŒ…åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œä½†æ˜¯OpengGL ES 2ä¹Ÿå…è®¸è®©æˆ‘ä»¬å°†å±æ€§å•ç‹¬å­˜æ”¾ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//X, Y, Z</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">float</span>[] cubePositionData = &#123;</span><br><span class="line">        <span class="comment">// åœ¨OpenGLï¼Œé€†æ—¶é’ˆç»•ç»„ï¼ˆä¸‹é¢çš„ç‚¹äº‹é€†æ—¶é’ˆé¡ºåºï¼‰æ˜¯é»˜è®¤çš„ã€‚</span></span><br><span class="line">        <span class="comment">// è¿™æ„å‘³ç€å½“æˆ‘ä»¬åœ¨è§‚å¯Ÿä¸€ä¸ªä¸‰è§’å½¢æ—¶ï¼Œå¦‚æœè¿™äº›ç”µè§†é€†æ—¶é’ˆçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ­£åœ¨çœ‹"å‰é¢"ï¼Œå¦‚æœä¸æ˜¯æˆ‘ä»¬åˆ™æ­£åœ¨çœ‹èƒŒé¢</span></span><br><span class="line">        <span class="comment">// OpenGLæœ‰ä¸€ä¸ªä¼˜åŒ–ï¼Œæ‰€æœ‰èƒŒé¢çš„ä¸‰è§’å½¢éƒ½ä¼šè¢«å‰”é™¤ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸ä»£è¡¨ä¸€ä¸ªç‰©ä½“çš„èƒŒé¢ï¼Œæ— è®ºå¦‚ä½•éƒ½ä¸å¯è§</span></span><br><span class="line">        <span class="comment">// æ­£é¢</span></span><br><span class="line">        -<span class="number">1.0F</span>, <span class="number">1.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        -<span class="number">1.0F</span>, -<span class="number">1.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">1.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        -<span class="number">1.0F</span>, -<span class="number">1.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, -<span class="number">1.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">1.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Rï¼ŒGï¼ŒBï¼ŒA</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">float</span>[] cubeColorData = &#123;</span><br><span class="line">        <span class="comment">// æ­£é¢çº¢è‰²</span></span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line">        ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure><h2 id="æ–°çš„OpenGL-flag">æ–°çš„OpenGL flag<a href="post/Learn-OpenGL-Lesson-Two#æ–°çš„OpenGL-flag"></a></h2><p>æˆ‘ä»¬è¿˜ä½¿ç”¨äº†<code>glEnable()</code>è°ƒç”¨å¯ç”¨äº†å‰”é™¤å’Œæ·±åº¦ç¼“å†²ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨å‰”é™¤å»æ‰èƒŒé¢</span></span><br><span class="line">GLES20.glEnable(GLES20.GL_CULL_FACE);</span><br><span class="line"><span class="comment">// å¯ç”¨æ·±åº¦æµ‹è¯•</span></span><br><span class="line">GLES20.glEnable(GLES20.GL_DEPTH_TEST);</span><br></pre></td></tr></table></div></figure><p>ä½œä¸ºä¼˜åŒ–ï¼Œæ‚¨å¯ä»¥å‘Šè¯‰OpenGLå‰”é™¤ç‰©ä½“èƒŒé¢çš„ä¸‰è§’å½¢ã€‚å½“æˆ‘ä»¬å®šä¹‰æ­£æ–¹ä½“æ—¶ï¼Œæˆ‘ä»¬è¿˜å®šä¹‰äº†æ¯ä¸ªä¸‰è§’å½¢çš„ä¸‰ä¸ªç‚¹ï¼Œä»¥ä¾¿å½“æˆ‘ä»¬åœ¨æŸ¥çœ‹æ­£é¢çš„æ—¶å€™æ˜¯é€†æ—¶é’ˆçš„ã€‚å½“æˆ‘ä»¬ç¿»è½¬ä¸‰è§’å½¢ä»¥ä¾¿æˆ‘ä»¬åˆ°èƒŒé¢æ—¶ï¼Œè¿™äº›ç‚¹å°†ä¼šé¡ºæ—¶é’ˆå±•ç¤ºã€‚<br>æ‚¨åªèƒ½åŒæ—¶çœ‹åˆ°ä¸€ä¸ªæ­£æ–¹ä½“çš„ä¸‰ä¸ªé¢ï¼Œæ‰€ä»¥è¿™ä¸ªä¼˜åŒ–å‘Šè¯‰OpenGLä¸è¦æµªè´¹æ—¶é—´å»ç»˜åˆ¶èƒŒé¢çš„ä¸‰è§’å½¢ã€‚</p><p>ä¹‹åå½“æˆ‘ä»¬ç»˜åˆ¶é€æ˜çš„ç‰©ä½“æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å…³é—­å‰”é™¤ï¼Œç„¶åç‰©ä½“èƒŒé¢å°†ä¼šå˜å¾—å¯è§ã€‚</p><p>æˆ‘ä»¬è¿˜å¼€å¯äº†<a href="https://en.wikipedia.org/wiki/Z-buffering" target="_blank" rel="noopener">æ·±åº¦æµ‹è¯•</a>ã€‚å¦‚æœä½ æ€»æ˜¯ä»åé¢å‘å‰é¢ç»˜åˆ¶ç‰©ä½“ï¼Œé‚£ä¹ˆæ·±åº¦æµ‹è¯•ç»éå¿…è¦ï¼Œä½†æ˜¯é€šè¿‡å¯ç”¨å®ƒæ‚¨ä¸ä»…ä¸éœ€è¦æ‹…å¿ƒç»˜åˆ¶é¡ºåºï¼ˆå°½ç®¡å¦‚æœä½ å…ˆç”»æœ€è¿‘çš„ç‰©ä½“æ¸²æŸ“ä¼šæ›´å¿«ï¼‰ï¼Œä¸€äº›æ˜¾å¡ä¹Ÿå°†è¿›è¡Œä¼˜åŒ–ï¼Œé€šè¿‡èŠ±è´¹æ›´å°‘çš„æ—¶é—´ç»˜åˆ¶åƒç´ æ¥åŠ é€Ÿæ¸²æŸ“ã€‚</p><h2 id="åŠ è½½ç€è‰²å™¨ç¨‹åºçš„ä¿®æ”¹">åŠ è½½ç€è‰²å™¨ç¨‹åºçš„ä¿®æ”¹<a href="post/Learn-OpenGL-Lesson-Two#åŠ è½½ç€è‰²å™¨ç¨‹åºçš„ä¿®æ”¹"></a></h2><p>å› ä¸ºåœ¨OpenGLä¸­åŠ è½½ç€è‰²å™¨ç¨‹åºçš„æ­¥éª¤å¤§è‡´ç›¸åŒï¼Œè¿™äº›æ­¥éª¤å¯ä»¥å¾ˆå®¹æ˜“çš„é‡æ„ä¸ºä¸€ä¸ªå•ç‹¬çš„æ–¹æ³•ã€‚æˆ‘ä»¬è¿˜æ·»åŠ äº†ä»¥ä¸‹è°ƒç”¨æ¥æ£€ç´¢è°ƒè¯•ä¿¡æ¯ï¼Œä»¥é˜²ç¼–è¯‘/é“¾æ¥å¤±è´¥ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GLES20.glGetProgramInfoLog(programHandle);</span><br><span class="line">GLES20.glGetShaderInfoLog(shaderHandle);</span><br></pre></td></tr></table></div></figure><h2 id="å…‰ç‚¹çš„é¡¶ç‚¹å’Œç€è‰²ç¨‹åº">å…‰ç‚¹çš„é¡¶ç‚¹å’Œç€è‰²ç¨‹åº<a href="post/Learn-OpenGL-Lesson-Two#å…‰ç‚¹çš„é¡¶ç‚¹å’Œç€è‰²ç¨‹åº"></a></h2><p>è¿™ä¸ªæ–°çš„é¡¶ç‚¹å’Œç€è‰²å™¨ç¨‹åºç»˜åˆ¶åœ¨å±å¹•ä¸Šä»£è¡¨å½“å‰å…‰æºçš„ä½ç½®ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªç®€å•çš„ç€è‰²ç¨‹åº</span></span><br><span class="line"><span class="keyword">final</span> String pointVertexShader =</span><br><span class="line">        <span class="string">"uniform mat4 u_MVPMatrix;                  \n"</span> +</span><br><span class="line">        <span class="string">"attribute vec4 a_Position;                 \n"</span> +</span><br><span class="line">        <span class="string">"void main()                                \n"</span> +</span><br><span class="line">        <span class="string">"&#123;                                          \n"</span> +</span><br><span class="line">        <span class="string">"   gl_Position = u_MVPMatrix * a_Position; \n"</span> +</span><br><span class="line">        <span class="string">"   gl_PointSize = 5.0;                     \n"</span> +</span><br><span class="line">        <span class="string">"&#125;                                          \n"</span>;</span><br><span class="line"><span class="keyword">final</span> String pointFragmentShader =</span><br><span class="line">        <span class="string">"precision mediump float;                   \n"</span> +</span><br><span class="line">        <span class="string">"void main()                                \n"</span> +</span><br><span class="line">        <span class="string">"&#123;                                          \n"</span> +</span><br><span class="line">        <span class="string">"   gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0) \n"</span> +</span><br><span class="line">        <span class="string">"&#125;                                          \n"</span>;</span><br></pre></td></tr></table></div></figure><p>è¿™ä¸ªç€è‰²å™¨ç±»ä¼¼äºç¬¬ä¸€è¯¾çš„ç®€å•ç€è‰²å™¨ï¼Œè¿™é‡Œæœ‰ä¸ªæ–°çš„æˆå‘˜<code>gl_PointSize</code>ï¼Œç›´æ¥å›ºå®šå®ƒçš„å€¼ä¸º5.0ï¼Œè¿™æ˜¯ç‚¹çš„åƒç´ å°ºå¯¸ã€‚å½“æˆ‘ä»¬ä½¿ç”¨<code>GLES20.GL_POINTS</code>æ¨¡å¼ç»˜åˆ¶è¿™ä¸ªç‚¹çš„æ—¶å€™å®ƒä¼šè¢«ä½¿ç”¨ã€‚æˆ‘ä»¬ä¹Ÿç›´æ¥è®¾ç½®äº†å®ƒçš„æ˜¾ç¤ºé¢œè‰²ä¸ºç™½è‰²ã€‚</p><h2 id="è¿›ä¸€æ­¥ç»ƒä¹ ">è¿›ä¸€æ­¥ç»ƒä¹ <a href="post/Learn-OpenGL-Lesson-Two#è¿›ä¸€æ­¥ç»ƒä¹ "></a></h2><ul><li>å°è¯•åˆ é™¤â€œè¿‡æ¸¡é¥±å’Œâ€çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆ</li><li>è¿™é‡Œçš„ç…§æ˜æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä½ èƒ½å‘ç°æ˜¯ä»€ä¹ˆå—ï¼Ÿæç¤ºï¼šæˆ‘ä»¬åšç¯å¢ƒç…§æ˜çš„æ–¹å¼çš„ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Œä»¥åŠalphaä¼šæ”¾ç”Ÿä»€ä¹ˆï¼Ÿ</li><li>å¦‚æœå°†<code>gl_PointSize</code>æ·»åŠ åˆ°æ­£æ–¹ä½“ç€è‰²å™¨å¹¶ä½¿ç”¨<code>GL_POINTS</code>ç»˜åˆ¶å®ƒä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</li></ul><h2 id="è¿›ä¸€æ­¥é˜…è¯»">è¿›ä¸€æ­¥é˜…è¯»<a href="post/Learn-OpenGL-Lesson-Two#è¿›ä¸€æ­¥é˜…è¯»"></a></h2><ul><li><a href="https://www.opengl.org/sdk/docs/tutorials/ClockworkCoders/lighting.php" target="_blank" rel="noopener">Clockworkcodersæ•™ç¨‹ï¼šæ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="http://www.lighthouse3d.com/tutorials/glsl-12-tutorial/the-normal-matrix/" target="_blank" rel="noopener">Lighthouse3d.comï¼šæ³•çº¿çŸ©é˜µ</a></li><li><a href="https://web.archive.org/web/20150101061328/http://www.arcsynthesis.org/gltut/Illumination/Tut09%20Normal%20Transformation.html" target="_blank" rel="noopener">arcsynthesis.org: OpenGLæ•™ç¨‹ï¼šæ³•çº¿è½¬æ¢</a></li><li><a href="http://glprogramming.com/red/chapter05.html" target="_blank" rel="noopener">OpenGLç¼–ç¨‹æŒ‡å—ï¼š5ç«  ç…§æ˜</a></li></ul><p>åœ¨ç¼–å†™æœ¬æ•™ç¨‹æ—¶ï¼Œä¸Šé¢çš„è¿›ä¸€æ­¥é˜…è¯»éƒ¨åˆ†å¯¹æˆ‘æ¥è¯´æ˜¯éå¸¸å®è´µçš„èµ„æºï¼Œå› æ­¤æˆ‘å¼ºçƒˆå»ºè®®æ‚¨é˜…è¯»å®ƒä»¬ä»¥è·å¾—æ›´å¤šçš„ä¿¡æ¯å’Œè§£é‡Šã€‚</p><h2 id="æ•™ç¨‹ç›®å½•">æ•™ç¨‹ç›®å½•<a href="post/Learn-OpenGL-Lesson-Two#æ•™ç¨‹ç›®å½•"></a></h2><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five">OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six">OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven">OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVOBï¼‰</a></li></ul><h2 id="æ‰“åŒ…æ•™æ">æ‰“åŒ…æ•™æ<a href="post/Learn-OpenGL-Lesson-Two#æ‰“åŒ…æ•™æ"></a></h2><p>å¯ä»¥åœ¨Githubä¸‹è½½æœ¬è¯¾ç¨‹æºä»£ç ï¼š<a href="https://github.com/learnopengles/Learn-OpenGLES-Tutorials" target="_blank" rel="noopener">ä¸‹è½½é¡¹ç›®</a><br>æœ¬è¯¾çš„ç¼–è¯‘ç‰ˆæœ¬ä¹Ÿå¯ä»¥å†Androidå¸‚åœºä¸‹ï¼š<a href="https://market.android.com/details?id=com.learnopengles.android" target="_blank" rel="noopener">google play ä¸‹è½½apk</a><br>â€œæˆ‘â€ä¹Ÿç¼–è¯‘äº†ä¸ªapkï¼Œæ–¹ä¾¿å¤§å®¶ä¸‹è½½ï¼š<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">github download</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ–‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡æ ‡é¢˜ï¼šOpenGL Android Lesson One: Getting Started&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.learnopengles.com/android-lesson-two-ambient-and-diffuse-lighting/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.learnopengles.com/android-lesson-two-ambient-and-diffuse-lighting/&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/categories/OpenGL/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/tags/OpenGL/"/>
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</title>
    <link href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One/index.html"/>
    <id>https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One/index.html</id>
    <published>2019-01-21T08:10:46.000Z</published>
    <updated>2019-08-09T16:28:55.133Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç¿»è¯‘æ–‡</p></blockquote><p>åŸæ–‡æ ‡é¢˜ï¼šOpenGL Android Lesson One: Getting Started<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.learnopengles.com/android-lesson-one-getting-started/" target="_blank" rel="noopener">http://www.learnopengles.com/android-lesson-one-getting-started/</a><br><a id="more"></a></p><hr><p>è¿™æ˜¯åœ¨Androidä¸­ä½¿ç”¨OpenGL ES2çš„ç¬¬ä¸€ä¸ªæ•™ç¨‹ã€‚è¿™ä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†ä¸€æ­¥ä¸€æ­¥è·Ÿéšä»£ç ï¼Œå­¦ä¹ å¦‚ä½•åˆ›å»ºä¸€ä¸ªOpenGL ES 2å¹¶ç»˜åˆ¶åˆ°å±å¹•ä¸Šã€‚<br>æˆ‘ä»¬è¿˜å°†äº†è§£ä»€ä¹ˆæ˜¯ç€è‰²å™¨ï¼Œå®ƒä»¬å¦‚ä½•å·¥ä½œï¼Œä»¥åŠæ€æ ·ä½¿ç”¨çŸ©é˜µå°†åœºæ™¯è½¬æ¢ä¸ºæ‚¨åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„å›¾åƒã€‚æœ€åï¼Œæ‚¨éœ€è¦åœ¨æ¸…å•æ–‡ä»¶ä¸­æ·»åŠ æ‚¨æ­£åœ¨ä½¿ç”¨OpenGL ES 2çš„è¯´æ˜ï¼Œä»¥å‘ŠçŸ¥Androidåº”ç”¨å¸‚åœºæ”¯æŒçš„è®¾å¤‡å¯è§ã€‚</p><h1 id="å…¥é—¨">å…¥é—¨<a href="post/Learn-OpenGL-Lesson-One#å…¥é—¨"></a></h1><p>æˆ‘ä»¬å°†è¿‡ä¸€é“ä¸‹é¢æ‰€æœ‰çš„ä»£ç å¹¶ä¸”è§£é‡Šæ¯ä¸€éƒ¨åˆ†çš„ä½œç”¨ã€‚æ‚¨å¯ä»¥è·Ÿç€æ‹·è´æ¯ä¸€å¤„çš„ä»£ç ç‰‡æ®µæ¥åˆ›å»ºæ‚¨è‡ªå·±çš„é¡¹ç›®ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨æ–‡ç« æœ«å°¾ä¸‹è½½è¿™ä¸ªå·²å®Œæˆçš„é¡¹ç›®ã€‚<br>åœ¨å¼€å‘å·¥å…·ï¼ˆå¦‚ï¼šAndroid Studioï¼‰ä¸­åˆ›å»ºæ‚¨çš„Androidé¡¹ç›®ï¼Œåå­—ä¸é‡è¦ï¼Œè¿™é‡Œç”±äºè¿™ä¸ªè¯¾ç¨‹æˆ‘å°†<code>MainActivity</code>æ›´åä¸º<code>LessonOneActivity</code>ã€‚</p><blockquote><p>æˆ‘ä»¬æ¥çœ‹è¿™æ®µä»£ç ï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** ä¿ç•™å¯¹GLSurfaceViewçš„å¼•ç”¨*/</span></span><br><span class="line"><span class="keyword">private</span> GLSurfaceView mGLSurfaceView;</span><br></pre></td></tr></table></div></figure><p>è¿™ä¸ª<a href="http://developer.android.com/reference/android/opengl/GLSurfaceView.html" target="_blank" rel="noopener">GLSurfaceView</a>æ˜¯ä¸€ä¸ªç‰¹åˆ«çš„Viewï¼Œå®ƒä¸ºæˆ‘ä»¬ç®¡ç†OpenGLç•Œé¢å¹¶ä¸”å°†å®ƒç»˜åˆ¶åœ¨Android Viewç³»ç»Ÿã€‚å®ƒè¿˜æ·»åŠ äº†è®¸å¤šåŠŸèƒ½ï¼Œä½¿å…¶æ›´æ˜“äºä½¿ç”¨OpenGLï¼ŒåŒ…æ‹¬ä¸‹é¢ç­‰ç­‰ï¼š</p><ul><li>å®ƒä¸ºOpenGLæä¾›ä¸€ä¸ªä¸“ç”¨çš„ç€è‰²çº¿ç¨‹ï¼Œå› æ­¤ä¸»çº¿ç¨‹ä¸ä¼šåœæ‡ˆ</li><li>å®ƒæ”¯æŒè¿ç»­æˆ–æŒ‰éœ€æ¸²æŸ“</li><li>å®ƒä½¿ç”¨<a href="https://en.wikipedia.org/wiki/EGL_(API)" target="_blank" rel="noopener">EGL</a> (OpenGLå’Œåº•å±‚ç³»ç»Ÿçª—å£ä¹‹é—´çš„æ¥å£)æ¥å¤„ç†å±å¹•è®¾ç½®</li></ul><blockquote><p><code>GLSurfaceView</code>ä½¿å¾—åœ¨Androidä¸­è®¾ç½®å’Œä½¿ç”¨OpenGLç›¸å¯¹è½»æ¾</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    mGLSurfaceView = <span class="keyword">new</span> GLSurfaceView(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//æ£€æµ‹ç³»ç»Ÿæ˜¯å¦æ”¯æŒOpenGL ES 2.0</span></span><br><span class="line">    <span class="keyword">final</span> ActivityManager activityManager = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);</span><br><span class="line">    <span class="keyword">final</span> ConfigurationInfo configurationInfo = activityManager.getDeviceConfigurationInfo();</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">boolean</span> supportsEs2 = configurationInfo.reqGlEsVersion &gt;= <span class="number">0x20000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (supportsEs2) &#123;</span><br><span class="line">        <span class="comment">// è¯·æ±‚ä¸€ä¸ªOpenGL ES 2.0å…¼å®¹çš„ä¸Šä¸‹æ–‡</span></span><br><span class="line">        mGLSurfaceView.setEGLContextClientVersion(<span class="number">2</span>);</span><br><span class="line">        <span class="comment">// è®¾ç½®æˆ‘ä»¬çš„Demoæ¸²æŸ“å™¨ï¼Œå®šä¹‰åœ¨åé¢è®²</span></span><br><span class="line">        mGLSurfaceView.setRenderer(<span class="keyword">new</span> LessonOneRenderer());</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ‚¨æƒ³åŒæ—¶æ”¯æŒES 1.0å’Œ2.0çš„è¯ï¼Œè¿™é‡Œæ‚¨å¯ä»¥åˆ›å»ºå…¼å®¹OpenGL ES 1.0çš„æ¸²æŸ“å™¨</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    setContentView(mGLSurfaceView);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>åœ¨<code>onCreate()</code>æ–¹æ³•ä¸­æ˜¯æˆ‘ä»¬åˆ›å»ºOpenGLä¸Šä¸‹æ–‡ä»¥åŠä¸€åˆ‡å¼€å§‹å‘ç”Ÿçš„é‡è¦éƒ¨åˆ†ã€‚<br>åœ¨æˆ‘ä»¬çš„<code>onCreate()</code>æ–¹æ³•ä¸­,åœ¨è°ƒç”¨<code>super.onCreate()</code>åæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†<code>GLSurfaceView</code>å®ä¾‹ã€‚<br>ç„¶åæˆ‘ä»¬éœ€è¦å¼„æ¸…æ¥šç³»ç»Ÿæ˜¯å¦æ”¯æŒOpenGL ES 2.ä¸ºæ­¤ï¼Œæˆ‘ä»¬è·å¾—ä¸€ä¸ª<code>ActivityManager</code>å®ä¾‹ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä¸å…¨å±€ç³»ç»ŸçŠ¶æ€è¿›è¡Œäº¤äº’ã€‚<br>ç„¶åæˆ‘ä»¬ä½¿ç”¨å®ƒè·å–è®¾å¤‡é…ç½®ä¿¡æ¯ï¼Œå®ƒå°†å‘Šè¯‰æˆ‘ä»¬è®¾å¤‡æ˜¯å¦æ”¯æŒOpenGL ES 2ã€‚<br>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¼ å…¥ä¸åŒçš„æ¸²æŸ“å™¨æ¥æ”¯æŒOpenGL ES 1.xï¼Œå°½ç®¡å› ä¸ºAPIä¸åŒï¼Œæˆ‘ä»¬éœ€è¦ç¼–å†™ä¸åŒçš„ä»£ç ã€‚å¯¹äºæœ¬è¯¾æˆ‘ä»¬ä»…ä»…å…³æ³¨æ”¯æŒOpenGL ES 2ã€‚</p><p>ä¸€æ—¦æˆ‘ä»¬çŸ¥é“è®¾å¤‡æ˜¯å¦æ”¯æŒOpenGL ES 2ï¼Œæˆ‘ä»¬å‘Šè¯‰<code>GLSurfaceView</code>å…¼å®¹OpenGL ES 2ï¼Œç„¶åä¼ å…¥æˆ‘ä»¬çš„è‡ªå®šä¹‰æ¸²æŸ“å™¨ã€‚æ— è®ºä½•æ—¶è°ƒæ•´ç•Œé¢æˆ–ç»˜åˆ¶æ–°å¸§ï¼Œç³»ç»Ÿéƒ½ä¼šè°ƒç”¨æ­¤æ¸²æŸ“å™¨ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬è°ƒç”¨<code>setContentView()</code>è®¾ç½®GLSurfaceViewä¸ºæ˜¾ç¤ºå†…å®¹ï¼Œå®ƒå‘Šè¯‰Androidè¿™ä¸ªæ´»åŠ¨å†…å®¹å› è¯¥è¢«æˆ‘ä»¬çš„OpenGLç•Œé¢å¡«å……ã€‚è¦å…¥é—¨OpenGLï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onResume();</span><br><span class="line">    <span class="comment">//Activity å¿…é¡»åœ¨onResumeä¸­è°ƒç”¨GLSurfaceViewçš„onResumeæ–¹æ³•</span></span><br><span class="line">    mGLSurfaceView.onResume();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onPause();</span><br><span class="line">    <span class="comment">//Activity å¿…é¡»åœ¨onPauseä¸­è°ƒç”¨GLSurfaceViewçš„onPauseæ–¹æ³•</span></span><br><span class="line">    mGLSurfaceView.onPause();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><code>GLSurfaceView</code>è¦æ±‚æˆ‘ä»¬åœ¨Activity<code>onResume()</code>å’Œ<code>onPause()</code>çš„çˆ¶æ–¹æ³•è¢«è°ƒç”¨ååˆ†åˆ«è°ƒç”¨å®ƒçš„<code>onResume()</code>å’Œ<code>onPause()</code>æ–¹æ³•ã€‚æˆ‘ä»¬åœ¨æ­¤æ·»åŠ è°ƒç”¨ä»¥å®Œå–„æˆ‘ä»¬çš„Activityã€‚</p><h2 id="å¯è§†åŒ–3Dä¸–ç•Œ">å¯è§†åŒ–3Dä¸–ç•Œ<a href="post/Learn-OpenGL-Lesson-One#å¯è§†åŒ–3Dä¸–ç•Œ"></a></h2><p>åœ¨è¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ¥çœ‹æ€æ ·è®©OpenGL ES 2å·¥ä½œï¼Œä»¥åŠæˆ‘ä»¬å¦‚ä½•åœ¨å±å¹•ä¸Šç»˜åˆ¶ä¸œè¥¿ã€‚<br>åœ¨Activityä¸­æˆ‘ä»¬ä¼ å…¥è‡ªå®šä¹‰çš„<a href="http://developer.android.com/reference/android/opengl/GLSurfaceView.Renderer.html" target="_blank" rel="noopener">GLSurfaceView.Renderer</a>åˆ°<code>GLSurfaceView</code>ï¼Œå®ƒå°†åœ¨è¿™é‡Œå®šä¹‰ã€‚<br>è¿™ä¸ªæ¸²æŸ“å™¨æœ‰ä¸‰ä¸ªé‡è¦çš„æ–¹æ³•ï¼Œæ¯å½“ç³»ç»Ÿäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå®ƒä»¬å°†ä¼šè‡ªåŠ¨è¢«è°ƒç”¨ï¼š</p><blockquote><p><em>public void onSurfaceCreated(GL10 gl, EGLConfig config)</em></p></blockquote><p>å½“ç•Œé¢ç¬¬ä¸€æ¬¡è¢«åˆ›å»ºæ—¶è°ƒç”¨ï¼Œå¦‚æœæˆ‘ä»¬å¤±å»ç•Œé¢ä¸Šä¸‹æ–‡å¹¶ä¸”ä¹‹åç”±ç³»ç»Ÿé‡å»ºï¼Œä¹Ÿä¼šè¢«è°ƒç”¨ã€‚</p><blockquote><p><em>public void onSurfaceChanged(GL10 gl, int width, int height)</em></p></blockquote><p>æ¯å½“ç•Œé¢æ”¹å˜æ—¶è¢«è°ƒç”¨ï¼›ä¾‹å¦‚ï¼Œä»çºµå±åˆ‡æ¢åˆ°æ¨ªå±ï¼Œåœ¨åˆ›å»ºç•Œé¢åä¹Ÿä¼šè¢«è°ƒç”¨ã€‚</p><blockquote><p><em>public void onDrawFrame(GL10 gl)</em></p></blockquote><p>æ¯å½“ç»˜åˆ¶æ–°å¸§æ—¶è¢«è°ƒç”¨ã€‚</p><p>æ‚¨å¯èƒ½æ³¨æ„åˆ°<code>GL10</code>çš„å®ä¾‹è¢«ä¼ å…¥åå­—æ˜¯<code>gl</code>ã€‚å½“ä½¿ç”¨OpengGL ES 2ç»˜åˆ¶æ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨å®ƒï¼›<br>æˆ‘ä»¬ä½¿ç”¨<code>GLES20</code>ç±»çš„é™æ€æ–¹æ³•æ¥ä»£æ›¿ã€‚è¿™ä¸ª<code>GL10</code>å‚æ•°ä»…ä»…æ˜¯åœ¨è¿™é‡Œï¼Œå› ä¸ºç›¸åŒçš„æ¥å£è¢«ä½¿ç”¨åœ¨OpenGL ES 1.xã€‚</p><blockquote><p>åœ¨æˆ‘ä»¬çš„æ¸²æŸ“å™¨å¯ä»¥æ˜¾ç¤ºä»»ä½•å†…å®¹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æœ‰äº›ä¸œè¥¿å»æ˜¾ç¤ºã€‚åœ¨OpenGL ES 2ï¼Œæˆ‘ä»¬é€šè¿‡åˆ¶å®šæ•°å­—æ•°ç»„ä¼ é€’å†…å®¹ã€‚è¿™äº›æ•°å­—å¯ä»¥è¡¨ç¤ºä½ç½®ã€é¢œè‰²æˆ–ä»»ä½•æˆ‘ä»¬éœ€è¦çš„ã€‚åœ¨è¿™ä¸ªDemoä¸­ï¼Œæˆ‘ä»¬å°†æ˜¾ç¤ºä¸‰ä¸ªä¸‰è§’å½¢ã€‚</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°ç±»æˆå‘˜</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> FloatBuffer mTriangle1Verticels;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> FloatBuffer mTriangle2Verticels;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> FloatBuffer mTriangle3Verticels;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** æ¯ä¸ªFloatå¤šå°‘å­—èŠ‚*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mBytePerFloat = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆå§‹Modelæ•°æ®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LessonOneRenderer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¿™ä¸ªä¸‰è§’å½¢æ˜¯çº¢è‰²ï¼Œè“è‰²å’Œç»¿è‰²ç»„æˆ</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span>[] triangle1VerticesData = &#123;</span><br><span class="line">        <span class="comment">// X, Y, Z,</span></span><br><span class="line">        <span class="comment">// R, G, B, A</span></span><br><span class="line">        -<span class="number">0.5F</span>, -<span class="number">0.25F</span>, <span class="number">0.0F</span>,</span><br><span class="line">        <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line"></span><br><span class="line">        <span class="number">0.5F</span>, -<span class="number">0.25F</span>, <span class="number">0.0F</span>,</span><br><span class="line">        <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>, <span class="number">1.0F</span>,</span><br><span class="line"></span><br><span class="line">        <span class="number">0.0F</span>, <span class="number">0.559016994F</span>, <span class="number">0.0F</span>,</span><br><span class="line">        <span class="number">0.0F</span>, <span class="number">1.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span></span><br><span class="line">    &#125;;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ç¼“å†²åŒº</span></span><br><span class="line">    mTriangle1Verticels = ByteBuffer.allocateDirect(triangle1VerticesData.length * mBytePerFloat).order(ByteOrder.nativeOrder()).asFloatBuffer();</span><br><span class="line">    ...</span><br><span class="line">    mTriangle1Verticels.put(triangle1VerticesData).position(<span class="number">0</span>);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>é‚£ä¹ˆï¼Œè¿™äº›æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿå¦‚æœæ‚¨æ›¾ç»ä½¿ç”¨è¿‡OpenGL 1ï¼Œ æ‚¨å¯èƒ½ä¼šä¹ æƒ¯è¿™æ ·åšï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">glBegin(GL_TRIANGLES);</span><br><span class="line">glVertex3f(-<span class="number">0.5f</span>, -<span class="number">0.25f</span>, <span class="number">0.0f</span>);</span><br><span class="line">glColor3f(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">...</span><br><span class="line">glEnd();</span><br></pre></td></tr></table></div></figure><p>è¿™ç§æ–¹æ³•åœ¨OpenGL ES 2ä¸­ä¸èµ·ä½œç”¨ã€‚æˆ‘ä»¬ä¸æ˜¯é€šè¿‡ä¸€å †æ–¹æ³•è°ƒç”¨æ¥å®šä¹‰ç‚¹ï¼Œè€Œæ˜¯å®šä¹‰ä¸€ä¸ªæ•°ç»„ã€‚è®©æˆ‘ä»¬å†æ¥çœ‹çœ‹æˆ‘ä»¬è¿™ä¸ªæ•°ç»„ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">float</span>[] triangle1VerticesData = &#123;</span><br><span class="line">                <span class="comment">// X, Y, Z,</span></span><br><span class="line">                <span class="comment">// R, G, B, A</span></span><br><span class="line">                -<span class="number">0.5f</span>, -<span class="number">0.25f</span>, <span class="number">0.0f</span>,</span><br><span class="line">                <span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>,</span><br><span class="line">                ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure><p>ä¸Šé¢å±•ç¤ºçš„ä»£è¡¨ä¸‰è§’å½¢çš„ä¸€ä¸ªç‚¹ã€‚æˆ‘ä»¬å·²è®¾ç½®å¥½å‰ä¸‰ä¸ªæ•°å­—ä»£è¡¨ä½ç½®ï¼ˆX,Y,Zï¼‰ï¼Œéšåçš„å››ä¸ªæ•°å­—ä»£è¡¨é¢œè‰²ï¼ˆçº¢ï¼Œç»¿ï¼Œè“ï¼Œé€æ˜åº¦ï¼‰ã€‚<br>æ‚¨ä¸å¿…å¤ªæ‹…å¿ƒå¦‚ä½•å®šä¹‰è¿™ä¸ªæ•°ç»„ï¼›åªè¦è®°ä½å½“æˆ‘ä»¬æƒ³ç»˜åˆ¶ä¸œè¥¿åœ¨OpenGL ES 2æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä»¥å—çš„å½¢å¼ä¼ é€’æ•°æ®ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡ä¼ é€’ä¸€ä¸ªã€‚</p><h3 id="äº†è§£ç¼“å†²åŒº">äº†è§£ç¼“å†²åŒº<a href="post/Learn-OpenGL-Lesson-One#äº†è§£ç¼“å†²åŒº"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆå§‹åŒ–ç¼“å†²åŒº</span></span><br><span class="line">mTriangle1Verticels = ByteBuffer.allocateDirect(triangle1VerticesData.length * mBytePerFloat).order(ByteOrder.nativeOrder()).asFloatBuffer();</span><br><span class="line">...</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬åœ¨Androidä¸Šä½¿ç”¨Javaè¿›è¡Œç¼–ç ï¼Œä½†OpengGL ES 2åº•å±‚å®ç°å…¶å®ä½¿ç”¨Cè¯­è¨€ç¼–å†™çš„ã€‚<br>åœ¨æˆ‘ä»¬å°†æ•°æ®ä¼ é€’ç»™OpenGLä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶è½¬æ¢æˆå®ƒèƒ½ç†è§£çš„å½¢å¼ã€‚<br>Javaå’Œnativeç³»ç»Ÿå¯èƒ½ä¸ä¼šä»¥ç›¸åŒçš„é¡ºåºå­˜å‚¨å®ƒä»¬çš„å­—èŠ‚ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„ç¼“å†²ç±»å¹¶åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„<code>ByteBuffer</code>æ¥ä¿å­˜æˆ‘ä»¬çš„æ•°æ®ï¼Œå¹¶å‘Šè¯‰å®ƒä½¿ç”¨nativeå­—èŠ‚é¡ºåºå­˜å‚¨æ•°æ®ã€‚<br>ç„¶åæˆ‘ä»¬å°†å®ƒè½¬æ¢æˆ<code>FloatBuffer</code>ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥ä¿å­˜æµ®ç‚¹æ•°æ®ã€‚<br>æœ€åï¼Œæˆ‘ä»¬å°†æ•°ç»„å¤åˆ¶åˆ°ç¼“å†²åŒºã€‚</p><p>è¿™ä¸ªç¼“å†²åŒºçš„ä¸œè¥¿çœ‹èµ·æ¥å¯èƒ½å¾ˆæ··ä¹±ï¼Œå•è¯·è®°ä½ï¼Œåœ¨å°†æ•°æ®ä¼ é€’ç»™OpenGLä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€ä¸ªé¢å¤–çš„æ­¥éª¤ã€‚æˆ‘ä»¬ç°åœ¨çš„ç¼“å†²åŒºå·²å‡†å¤‡å¥½å¯ä»¥ç”¨äºå°†æ•°æ®ä¼ å…¥OpenGLã€‚</p><p><strong>å¦å¤–ï¼Œ<a href="https://issuetracker.google.com/issues/36921128" target="_blank" rel="noopener">floatç¼“å†²åŒºåœ¨Froyoä¸Šå¾ˆæ…¢</a>,åœ¨Gingerbreadä¸Šç¼“æ…¢ï¼Œå› æ­¤æ‚¨å¯èƒ½ä¸å¸Œæœ›ç»å¸¸æ›´æ¢å®ƒä»¬ã€‚</strong></p><h3 id="ç†è§£çŸ©é˜µ">ç†è§£çŸ©é˜µ<a href="post/Learn-OpenGL-Lesson-One#ç†è§£çŸ©é˜µ"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// new class å®šä¹‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å­˜å‚¨viewçŸ©é˜µã€‚å¯ä»¥è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªç›¸æœºï¼Œæˆ‘ä»¬é€šè¿‡ç›¸æœºå°†ä¸–ç•Œç©ºé—´è½¬æ¢ä¸ºçœ¼ç›ç©ºé—´</span></span><br><span class="line"><span class="comment"> * å®ƒå®šä½ç›¸å¯¹äºæˆ‘ä»¬çœ¼ç›çš„ä¸œè¥¿</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">float</span>[] mViewMatrix = <span class="keyword">new</span> <span class="keyword">float</span>[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSurfaceCreated</span><span class="params">(GL10 gl, EGLConfig config)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è®¾ç½®èƒŒæ™¯æ¸…ç†é¢œè‰²ä¸ºç°è‰²</span></span><br><span class="line">    GLES20.glClearColor(<span class="number">0.5F</span>, <span class="number">0.5F</span>, <span class="number">0.5F</span>, <span class="number">0.5F</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†çœ¼ç›æ”¾åˆ°åŸç‚¹ä¹‹å</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> eyeX = <span class="number">0.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> eyeY = <span class="number">0.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> eyeZ = <span class="number">1.5F</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æˆ‘ä»¬çš„çœ¼ç›æœ›å‘å“ª</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> lookX = <span class="number">0.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> lookY = <span class="number">0.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> lookZ = -<span class="number">5.0F</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®æˆ‘ä»¬çš„å‘é‡ï¼Œè¿™æ˜¯æˆ‘ä»¬æ‹¿ç€ç›¸æœºæ—¶å¤´æŒ‡å‘çš„æ–¹å‘</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> upX = <span class="number">0.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> upY = <span class="number">1.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> upZ = <span class="number">0.0F</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å…·ä½“åœºæ™¯ï¼šæŠŠæ‰‹æœºæ­£æ”¾æ¡Œé¢ä¸Šï¼Œç„¶åæˆ‘ä»¬å»çœ‹å±å¹•é‡Œé¢çš„ä¸œè¥¿</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®viewçŸ©é˜µï¼Œå¯ä»¥è¯´è¿™ä¸ªçŸ©é˜µä»£è¡¨ç›¸æœºçš„ä½ç½®</span></span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šåœ¨OpenGL 1ä¸­ä½¿ç”¨ModelView matrixï¼Œè¿™æ˜¯ä¸€ä¸ªmodelå’ŒviewçŸ©é˜µçš„ç»„åˆã€‚</span></span><br><span class="line">    <span class="comment">//åœ¨OpenGL2ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©åˆ†åˆ«è·Ÿè¸ªè¿™äº›çŸ©é˜µ</span></span><br><span class="line">    Matrix.setLookAtM(mViewMatrix, <span class="number">0</span>, eyeX, eyeY, eyeZ, lookX, lookY, lookZ, upX, upY, upZ);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>å¦ä¸€ä¸ªæœ‰è¶£çš„è¯é¢˜æ˜¯çŸ©é˜µï¼æ— è®ºæ‚¨ä½•æ—¶è¿›è¡Œ3Dç¼–ç¨‹ï¼Œè¿™äº›éƒ½å°†æˆä¸ºæ‚¨æœ€å¥½çš„æœ‹å‹ã€‚å› æ­¤ï¼Œæ‚¨éœ€è¦å¾ˆå¥½çš„äº†è§£ä»–ä»¬ã€‚</p><p>å½“æˆ‘ä»¬çš„ç•Œé¢è¢«åˆ›å»ºï¼Œæˆ‘ä»¬ç¬¬ä¸€ä»¶äº‹æƒ…æ˜¯è®¾ç½®æ¸…ç†é¢œè‰²ä¸ºç°è‰²ã€‚alphaéƒ¨åˆ†ä¹Ÿè®¾ç½®ä¸ºç°è‰²ï¼Œä½†åœ¨æˆ‘ä»¬æœ¬è¯¾ç¨‹ä¸­æ²¡æœ‰è¿›è¡Œalphaæ··åˆï¼Œå› æ­¤è¯¥å€¼æœªä½¿ç”¨ã€‚æˆ‘ä»¬åªéœ€è¦è®¾ç½®ä¸€æ¬¡æ¸…ç†é¢œè‰²ï¼Œä¹‹åæˆ‘ä»¬ä¸ä¼šæ›´æ”¹å®ƒã€‚</p><p>æˆ‘ä»¬ç¬¬äºŒä»¶äº‹æƒ…æ˜¯è®¾ç½®viewçŸ©é˜µã€‚æˆ‘ä»¬ä½¿ç”¨äº†å‡ ä¸ªä¸åŒç§ç±»çš„çŸ©é˜µï¼Œå®ƒä»¬éƒ½åšäº†äº›é‡è¦çš„äº‹æƒ…ï¼š</p><ol><li>modelï¼ˆæ¨¡å‹ï¼‰çŸ©é˜µï¼Œè¯¥çŸ©é˜µç”¨äºåœ¨â€œä¸–ç•Œâ€ä¸­çš„æŸå¤„æ”¾ç½®æ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œæ‚¨æœ‰ä¸€ä¸ªæ¨¡å‹è½¦ï¼Œä½ æƒ³å°†å®ƒæ”¾ç½®åœ¨ä¸œè¾¹ä¸€åƒç±³å¤„ï¼Œæ‚¨å°†ä½¿ç”¨çŸ©é˜µæ¨¡å‹æ¥åšè¿™ä»¶äº‹ã€‚</li><li>view ï¼ˆè§†å›¾)çŸ©é˜µï¼Œè¯¥çŸ©é˜µä»£è¡¨ç›¸æœºã€‚å¦‚æœæˆ‘ä»¬æƒ³æŸ¥çœ‹ä½äºä¸œè¾¹ä¸€åƒç±³å¤„çš„è½¦ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦å‘ä¸œç§»åŠ¨ä¸€åƒç±³ï¼ˆå¦ä¸€ç§æ€è€ƒæ–¹å¼æ˜¯æˆ‘ä»¬ä¿æŒé™æ­¢ï¼Œä¸–ç•Œå‘è¥¿ç§»åŠ¨ä¸€åƒç±³ï¼‰ã€‚æˆ‘ä»¬ä½¿ç”¨è§†å›¾çŸ©é˜µæ¥åšåˆ°è¿™ç‚¹ã€‚</li><li>projectionï¼ˆæŠ•å½±)çŸ©é˜µã€‚ç”±äºæˆ‘ä»¬çš„å±å¹•æ˜¯å¹³é¢çš„ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæœ€åçš„è½¬æ¢ï¼Œå°†æˆ‘ä»¬çš„è§†å›¾â€œæŠ•å½±â€åˆ°æˆ‘ä»¬çš„å±å¹•ä¸Šå¹¶è·å¾—æ¼‚äº®çš„3Dè§†è§’ã€‚è¿™å°±æ˜¯æŠ•å½±çŸ©é˜µçš„ç”¨é€”</li></ol><p>å¯ä»¥åœ¨<a href="http://www.songho.ca/opengl/gl_transform.html" target="_blank" rel="noopener">SongHoçš„OpenGLæ•™ç¨‹</a>ä¸­æ‰¾åˆ°å¾ˆå¥½çš„è§£é‡Šã€‚æˆ‘å»ºè®®æ‚¨é˜…è¯»å‡ æ¬¡ç›´åˆ°æ‚¨æŠŠæ¡å¥½è¿™ä¸ªæƒ³æ³•ä¸ºæ­¢ï¼›åˆ«æ‹…å¿ƒï¼Œæˆ‘ä¹Ÿé˜…è¯»äº†å®ƒå¥½å‡ æ¬¡ï¼</p><p>åœ¨OpenGL 1ä¸­ï¼Œæ¨¡å‹å’Œè§†å›¾çŸ©é˜µè¢«ç»„åˆå¹¶ä¸”å‡è®¾äº†æ‘„åƒæœºå¤„äº(0,0,0)åæ ‡å¹¶é¢å‘Zè½´æ–¹å‘ã€‚</p><p>æˆ‘ä»¬ä¸éœ€è¦æ‰‹åŠ¨æ„å»ºè¿™äº›çŸ©é˜µï¼ŒAndroidæœ‰ä¸€ä¸ªMatrixå¸®åŠ©ç±»ï¼Œå®ƒèƒ½ä¸ºæˆ‘ä»¬åšç¹é‡çš„å·¥ä½œã€‚è¿™é‡Œï¼Œæˆ‘ä¸ºæ‘„åƒæœºåˆ›å»ºäº†ä¸€ä¸ªè§†å›¾çŸ©é˜µï¼Œå®ƒä½äºåŸç‚¹åï¼Œæœå‘è¿œå¤„ã€‚</p><h3 id="å®šä¹‰vertexï¼ˆé¡¶ç‚¹ï¼‰å’Œfragmentï¼ˆç‰‡æ®µï¼‰ç€è‰²å™¨">å®šä¹‰vertexï¼ˆé¡¶ç‚¹ï¼‰å’Œfragmentï¼ˆç‰‡æ®µï¼‰ç€è‰²å™¨<a href="post/Learn-OpenGL-Lesson-One#å®šä¹‰vertexï¼ˆé¡¶ç‚¹ï¼‰å’Œfragmentï¼ˆç‰‡æ®µï¼‰ç€è‰²å™¨"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> String vertexShader =</span><br><span class="line">        <span class="string">"uniform mat4 u_MVPMatrix;    \n"</span> + <span class="comment">// ä¸€ä¸ªè¡¨ç¤ºç»„åˆmodelã€viewã€projectionçŸ©é˜µçš„å¸¸é‡</span></span><br><span class="line">        <span class="string">"attribute vec4 a_Position;   \n"</span> + <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®ä¿¡æ¯</span></span><br><span class="line">        <span class="string">"attribute vec4 a_Color;      \n"</span> + <span class="comment">// æˆ‘ä»¬å°†è¦ä¼ å…¥çš„æ¯ä¸ªé¡¶ç‚¹çš„é¢œè‰²ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">        <span class="string">"varying vec4 v_Color;        \n"</span> + <span class="comment">// ä»–å°†è¢«ä¼ å…¥ç‰‡æ®µç€è‰²å™¨</span></span><br><span class="line"></span><br><span class="line">        <span class="string">"void main()                  \n"</span> + <span class="comment">// é¡¶ç‚¹ç€è‰²å™¨å…¥å£</span></span><br><span class="line">        <span class="string">"&#123;                            \n"</span> +</span><br><span class="line">        <span class="string">"   v_Color = a_Color;        \n"</span> + <span class="comment">// å°†é¢œè‰²ä¼ é€’ç»™ç‰‡æ®µç€è‰²å™¨</span></span><br><span class="line">                                            <span class="comment">// å®ƒå°†åœ¨ä¸‰è§’å½¢å†…æ’å€¼</span></span><br><span class="line">        <span class="string">"   gl_Position = u_MVPMatrix \n"</span> + <span class="comment">// gl_Positionæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ç”¨æ¥å­˜å‚¨æœ€ç»ˆçš„ä½ç½®</span></span><br><span class="line">        <span class="string">"               * a_Position  \n"</span> + <span class="comment">// å°†é¡¶ç‚¹ä¹˜ä»¥çŸ©é˜µå¾—åˆ°æ ‡å‡†åŒ–å±å¹•åæ ‡çš„æœ€ç»ˆç‚¹</span></span><br><span class="line">        <span class="string">"&#125;                            \n"</span>;</span><br></pre></td></tr></table></div></figure><p>åœ¨OpenGL ES 2ä¸­ä»»ä½•æˆ‘ä»¬æƒ³å±•ç¤ºåœ¨å±å¹•ä¸­çš„ä¸œè¥¿éƒ½å¿…é¡»å…ˆç»è¿‡é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨ï¼Œè¿˜å¥½è¿™äº›ç€è‰²å™¨å¹¶ä¸åƒä»–ä»¬çœ‹èµ·æ¥çš„é‚£ä¹ˆå¤æ‚ã€‚é¡¶ç‚¹ç€è‰²å™¨åœ¨æ¯ä¸ªé¡¶ç‚¹æ‰§è¡Œæ“ä½œï¼Œå¹¶æŠŠè¿™äº›æ“ä½œçš„ç»“æœä½¿ç”¨åœ¨ç‰‡æ®µç€è‰²å™¨åšé¢å¤–çš„æ¯åƒç´ è®¡ç®—ã€‚</p><p>æ¯ä¸ªç€è‰²å™¨åŸºæœ¬ç”±è¾“å…¥ï¼ˆinputï¼‰ã€è¾“å‡ºï¼ˆoutputï¼‰å’Œä¸€ä¸ªç¨‹åºï¼ˆprogramï¼‰ç»„æˆã€‚<br>é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç»Ÿä¸€ï¼ˆuniformï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰å˜æ¢çš„ç»„åˆçŸ©é˜µã€‚å®ƒæ˜¯æ‰€æœ‰é¡¶ç‚¹çš„å¸¸é‡ï¼Œç”¨äºå°†å®ƒä»¬æŠ•å½±åˆ°å±å¹•ä¸Šã€‚<br>ç„¶åæˆ‘ä»¬å®šä¹‰äº†ä½ç½®å’Œé¢œè‰²å±æ€§ï¼ˆattributeï¼‰ï¼Œè¿™äº›å±æ€§å°†ä»æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„ç¼“å­˜åŒºä¸­è¯»å…¥ï¼Œå¹¶æŒ‡å®šæ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®å’Œé¢œè‰²ã€‚<br>æ¥ç€æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå˜é‡ï¼ˆvaryingï¼‰ï¼Œå®ƒè´Ÿè´£åœ¨ä¸‰è§’å½¢ä¸­æ’å€¼å¹¶ä¼ é€’åˆ°ç‰‡æ®µç€è‰²å™¨ã€‚å½“å®ƒè¿è¡Œåˆ°ç‰‡æ®µç€è‰²å™¨ï¼Œå®ƒå°†ä¸ºæ¯ä¸ªåƒç´ æŒæœ‰ä¸€ä¸ªæ’å€¼ã€‚</p><p>å‡è®¾æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªä¸‰è§’å½¢æ¯ä¸ªç‚¹éƒ½æ˜¯çº¢è‰²ã€ç»¿è‰²å’Œè“è‰²ï¼Œæˆ‘ä»¬è°ƒæ•´å®ƒçš„å¤§å°è®©å®ƒå ç”¨10åƒç´ å±å¹•ã€‚å½“ç‰‡æ®µç€è‰²å™¨è¿è¡Œæ—¶ï¼Œå®ƒå°†ä¸ºæ¯åƒç´ åŒ…å«ä¸€ä¸ªä¸åŒçš„å˜é‡ï¼ˆvaryingï¼‰é¢œè‰²ã€‚åœ¨æŸä¸€ç‚¹ä¸Šï¼Œå˜é‡ï¼ˆvaryingï¼‰å°†æ˜¯çº¢è‰²ï¼Œä½†æ˜¯åœ¨çº¢è‰²å’Œè“è‰²ä¹‹é—´å®ƒå¯èƒ½æ˜¯æ›´ç´«çš„é¢œè‰²ã€‚</p><p>é™¤äº†è®¾ç½®é¢œè‰²ï¼Œæˆ‘ä»¬è¿˜å‘Šè¯‰OpenGLé¡¶ç‚¹åœ¨å±å¹•ä¸Šçš„æœ€ç»ˆä½ç½®ã€‚ç„¶åæˆ‘ä»¬å®šä¹‰ç‰‡æ®µç€è‰²å™¨ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> String fragmentShader =</span><br><span class="line">        <span class="string">"precision mediump float;       \n"</span> + <span class="comment">// æˆ‘ä»¬å°†é»˜è®¤ç²¾åº¦è®¾ç½®ä¸ºä¸­ç­‰ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç‰‡æ®µç€è‰²å™¨ä¸­çš„é«˜ç²¾åº¦</span></span><br><span class="line">        <span class="string">"varying vec4 v_Color;          \n"</span> + <span class="comment">// è¿™æ˜¯ä»ä¸‰è§’å½¢æ¯ä¸ªç‰‡æ®µå†…æ’çš„é¡¶ç‚¹ç€è‰²å™¨çš„é¢œè‰²</span></span><br><span class="line">        <span class="string">"void main()                    \n"</span> + <span class="comment">// ç‰‡æ®µç€è‰²å™¨å…¥å£</span></span><br><span class="line">        <span class="string">"&#123;                              \n"</span> +</span><br><span class="line">        <span class="string">"   gl_FragColor = v_Color;     \n"</span> + <span class="comment">// ç›´æ¥å°†é¢œè‰²ä¼ é€’</span></span><br><span class="line">        <span class="string">"&#125;                              \n"</span>;</span><br></pre></td></tr></table></div></figure><p>è¿™æ˜¯ä¸ªç‰‡æ®µç€è‰²å™¨ï¼Œå®ƒä¼šå°†ä¸œè¥¿æ”¾åˆ°å±å¹•ä¸Šã€‚åœ¨è¿™ä¸ªç€è‰²å™¨ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°çš„å˜é‡ï¼ˆvaryingï¼‰é¢œè‰²æ¥è‡ªé¡¶ç‚¹ç€è‰²å™¨ï¼Œç„¶åå°†å®ƒç›´æ¥ä¼ é€’ç»™OpenGLã€‚è¯¥ç‚¹å·²æŒ‰åƒç´ æ’å€¼ï¼Œå› ä¸ºç‰‡æ®µç€è‰²å™¨å°†é’ˆå¯¹æ¯ä¸ªå°†è¦ç»˜åˆ¶çš„åƒç´ ç‚¹è¿è¡Œã€‚</p><p>æ›´å¤šä¿¡æ¯ï¼š<a href="http://www.khronos.org/opengles/sdk/docs/reference_cards/OpenGL-ES-2_0-Reference-card.pdf" target="_blank" rel="noopener">OpenGL ES 2 APIå¿«é€Ÿå‚è€ƒå¡</a></p><h3 id="å°†ç€è‰²å™¨åŠ è½½åˆ°OpenGL">å°†ç€è‰²å™¨åŠ è½½åˆ°OpenGL<a href="post/Learn-OpenGL-Lesson-One#å°†ç€è‰²å™¨åŠ è½½åˆ°OpenGL"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŠ è½½é¡¶ç‚¹ç€è‰²å™¨</span></span><br><span class="line"><span class="keyword">int</span> vertexShaderHandle = GLES20.glCreateShader(GLES20.GL_VERTEX_SHADER);</span><br><span class="line"><span class="keyword">if</span> (vertexShaderHandle != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// ä¼ å…¥é¡¶ç‚¹ç€è‰²å™¨æºä»£ç </span></span><br><span class="line">    GLES20.glShaderSource(vertexShaderHandle, vertexShader);</span><br><span class="line">    <span class="comment">// ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨</span></span><br><span class="line">    GLES20.glCompileShader(vertexShaderHandle);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–ç¼–è¯‘çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span>[] compileStatus = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">1</span>];</span><br><span class="line">    GLES20.glGetShaderiv(vertexShaderHandle, GLES20.GL_COMPILE_STATUS, compileStatus, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœç¼–è¯‘å¤±è´¥åˆ™åˆ é™¤ç€è‰²å™¨</span></span><br><span class="line">    <span class="keyword">if</span> (compileStatus[<span class="number">0</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">        GLES20.glDeleteShader(vertexShaderHandle);</span><br><span class="line">        vertexShaderHandle = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (vertexShaderHandle == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Error creating vertex shader."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç€è‰²å™¨å¯¹è±¡ã€‚å¦‚æœæˆåŠŸï¼Œæˆ‘ä»¬å°†å¾—åˆ°è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚<br>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªå¼•ç”¨ä¼ å…¥ç€è‰²å™¨æºç ç„¶åç¼–è¯‘å®ƒã€‚<br>æˆ‘ä»¬å¯ä»¥ä»OpenGLè·å–ç¼–è¯‘æ˜¯å¦æˆåŠŸçš„çŠ¶æ€ï¼Œå¦‚æœå¤±è´¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>GLES20.glGetShaderInfoLog(shader)</code>æ‰¾åˆ°åŸå› ã€‚æˆ‘ä»¬æŒ‰ç…§ç›¸åŒçš„æ­¥éª¤åŠ è½½ç‰‡æ®µç€è‰²å™¨ã€‚</p><h3 id="å°†é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨é“¾æ¥åˆ°ä¸€ä¸ªç¨‹åºä¸­">å°†é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨é“¾æ¥åˆ°ä¸€ä¸ªç¨‹åºä¸­<a href="post/Learn-OpenGL-Lesson-One#å°†é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨é“¾æ¥åˆ°ä¸€ä¸ªç¨‹åºä¸­"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªç¨‹åºå¯¹è±¡å¹¶å°†å¼•ç”¨æ”¾è¿›å»</span></span><br><span class="line"><span class="keyword">int</span> programHandle = GLES20.glCreateProgram();</span><br><span class="line"><span class="keyword">if</span> (programHandle != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// ç»‘å®šé¡¶ç‚¹ç€è‰²å™¨åˆ°ç¨‹åºå¯¹è±¡ä¸­</span></span><br><span class="line">    GLES20.glAttachShader(programHandle, vertexShaderHandle);</span><br><span class="line">    <span class="comment">// ç»‘å®šç‰‡æ®µç€è‰²å™¨åˆ°ç¨‹åºå¯¹è±¡ä¸­</span></span><br><span class="line">    GLES20.glAttachShader(programHandle, fragmentShaderHandle);</span><br><span class="line">    <span class="comment">// ç»‘å®šå±æ€§</span></span><br><span class="line">    GLES20.glBindAttribLocation(programHandle, <span class="number">0</span>, <span class="string">"a_Position"</span>);</span><br><span class="line">    GLES20.glBindAttribLocation(programHandle, <span class="number">1</span>, <span class="string">"a_Color"</span>);</span><br><span class="line">    <span class="comment">// å°†ä¸¤ä¸ªç€è‰²å™¨è¿æ¥åˆ°ç¨‹åº</span></span><br><span class="line">    GLES20.glLinkProgram(programHandle);</span><br><span class="line">    <span class="comment">// è·å–è¿æ¥çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span>[] linkStatus = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">1</span>];</span><br><span class="line">    GLES20.glGetProgramiv(programHandle, GLES20.GL_LINK_STATUS, linkStatus, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// å¦‚æœè¿æ¥å¤±è´¥ï¼Œåˆ é™¤è¿™ç¨‹åº</span></span><br><span class="line">    <span class="keyword">if</span> (linkStatus[<span class="number">0</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">        GLES20.glDeleteProgram(programHandle);</span><br><span class="line">        programHandle = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (programHandle == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Error creating program."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>åœ¨æˆ‘ä»¬ä½¿ç”¨é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒä»¬ç»‘å®šåˆ°ä¸€ä¸ªç¨‹åºä¸­ï¼Œå®ƒè¿æ¥äº†é¡¶ç‚¹ç€è‰²å™¨çš„è¾“å‡ºå’Œç‰‡æ®µç€è‰²å™¨çš„è¾“å…¥ã€‚è¿™ä¹Ÿæ˜¯è®©æˆ‘ä»¬ä»ç¨‹åºä¼ é€’è¾“å…¥å¹¶ä½¿ç”¨ç€è‰²å™¨ç»˜åˆ¶å½¢çŠ¶çš„åŸå› ã€‚</p><p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç¨‹åºå¯¹è±¡ï¼Œå¦‚æœæˆåŠŸç»‘å®šç€è‰²å™¨ã€‚æˆ‘ä»¬æƒ³è¦å°†ä½ç½®å’Œé¢œè‰²ä½œä¸ºå±æ€§ä¼ é€’è¿›å»ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç»‘å®šè¿™äº›å±æ€§ã€‚ç„¶åæˆ‘ä»¬å°†ç€è‰²å™¨è¿æ¥åˆ°ä¸€èµ·ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°ç±»æˆå‘˜</span></span><br><span class="line"><span class="comment">/** è¿™å°†ç”¨äºä¼ é€’å˜æ¢çŸ©é˜µ*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mMVPMatrixHandle;</span><br><span class="line"><span class="comment">/** ç”¨äºä¼ é€’modelä½ç½®ä¿¡æ¯*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mPositionHandle;</span><br><span class="line"><span class="comment">/** ç”¨äºä¼ é€’æ¨¡å‹é¢œè‰²ä¿¡æ¯*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mColorHandle;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSurfaceCreated</span><span class="params">(GL10 gl, EGLConfig config)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// è®¾ç½®ç¨‹åºå¼•ç”¨ï¼Œè¿™å°†åœ¨ä¹‹åä¼ é€’å€¼åˆ°ç¨‹åºæ—¶ä½¿ç”¨</span></span><br><span class="line">    mMVPMatrixHandle = GLES20.glGetUniformLocation(programHandle, <span class="string">"u_MVPMatrix"</span>);</span><br><span class="line">    mPositionHandle = GLES20.glGetAttribLocation(programHandle, <span class="string">"a_Position"</span>);</span><br><span class="line">    mColorHandle = GLES20.glGetAttribLocation(programHandle, <span class="string">"a_Color"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘Šè¯‰OpenGLæ¸²æŸ“çš„æ—¶å€™ä½¿ç”¨è¿™ä¸ªç¨‹åº</span></span><br><span class="line">    GLES20.glUseProgram(programHandle);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>åœ¨æˆ‘ä»¬æˆåŠŸè¿æ¥ç¨‹åºåï¼Œæˆ‘ä»¬è¿˜è¦å®Œæˆå‡ ä¸ªä»»åŠ¡ï¼Œä»¥ä¾¿æˆ‘ä»¬èƒ½å®é™…ä½¿ç”¨å®ƒã€‚<br>ç¬¬ä¸€ä¸ªä»»åŠ¡æ˜¯è·å–å¼•ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬è¦ä¼ é€’æ•°æ®åˆ°ç¨‹åºä¸­ã€‚<br>ç„¶åæˆ‘ä»¬è¦å‘Šè¯‰OpenGLåœ¨ç»˜åˆ¶æ—¶ä½¿ç”¨æˆ‘ä»¬è¿™ä¸ªç¨‹åºã€‚<br>ç”±äºæœ¬è¯¾æˆ‘ä»¬ä»…ä½¿ç”¨äº†ä¸€ä¸ªç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒæ”¾åˆ°<code>onSurfaceCreated()</code>æ–¹æ³•ä¸­è€Œä¸æ˜¯<code>onDrawFrame()</code></p><h3 id="è®¾ç½®é€è§†æŠ•å½±">è®¾ç½®é€è§†æŠ•å½±<a href="post/Learn-OpenGL-Lesson-One#è®¾ç½®é€è§†æŠ•å½±"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°ç±»æˆå‘˜</span></span><br><span class="line"><span class="comment">// å­˜æ”¾æŠ•å½±çŸ©é˜µï¼Œç”¨äºå°†åœºæ™¯æŠ•å½±åˆ°2Dè§†è§’</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">float</span>[] mProjectionMatrix = <span class="keyword">new</span> <span class="keyword">float</span>[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSurfaceChanged</span><span class="params">(GL10 gl, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è®¾ç½®OpenGLç•Œé¢å’Œå½“å‰è§†å›¾ç›¸åŒçš„å°ºå¯¸</span></span><br><span class="line">    GLES20.glViewport(<span class="number">0</span>, <span class="number">0</span>, width, height);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„é€è§†æŠ•å½±çŸ©é˜µï¼Œé«˜åº¦ä¿æŒä¸å˜ï¼Œè€Œé«˜åº¦æ ¹æ®çºµæ¨ªæ¯”è€Œå˜æ¢</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> ratio = (<span class="keyword">float</span>) width / height;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> left = -ratio;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> right = ratio;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> bottom = -<span class="number">1.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> top = <span class="number">1.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> near = <span class="number">1.0F</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> far = <span class="number">10.0F</span>;</span><br><span class="line"></span><br><span class="line">    Matrix.frustumM(mProjectionMatrix, <span class="number">0</span>, left, right, bottom, top, near, far);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><code>onSurfaceChanged()</code>æ–¹æ³•è‡³å°‘è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œæ¯å½“ç•Œé¢æ”¹å˜ä¹Ÿä¼šè¢«è°ƒç”¨ã€‚å› ä¸ºæˆ‘ä»¬éœ€è¦æ¯å½“ç•Œé¢æ”¹å˜çš„æ—¶å€™é‡ç½®æŠ•å½±çŸ©é˜µï¼Œé‚£ä¹ˆ<code>onSurfaceChanged()</code>æ–¹æ³•ä¸­æ˜¯ä¸ªç†æƒ³çš„åœ°æ–¹ã€‚</p><h3 id="ç»˜åˆ¶ä¸œè¥¿åˆ°å±å¹•ä¸Šï¼">ç»˜åˆ¶ä¸œè¥¿åˆ°å±å¹•ä¸Šï¼<a href="post/Learn-OpenGL-Lesson-One#ç»˜åˆ¶ä¸œè¥¿åˆ°å±å¹•ä¸Šï¼"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°ç±»æˆå‘˜</span></span><br><span class="line"><span class="comment">// å­˜æ”¾æ¨¡å‹çŸ©é˜µï¼Œè¯¥çŸ©é˜µç”¨äºå°†æ¨¡å‹ä»å¯¹è±¡ç©ºé—´ï¼ˆå¯ä»¥è®¤ä¸ºæ¯ä¸ªæ¨¡å‹å¼€å§‹éƒ½ä½äºå®‡å®™çš„ä¸­å¿ƒï¼‰ç§»åŠ¨åˆ°ä¸–ç•Œç©ºé—´</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">float</span>[] mModelMatrix = <span class="keyword">new</span> <span class="keyword">float</span>[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDrawFrame</span><span class="params">(GL10 gl)</span> </span>&#123;</span><br><span class="line">    GLES20.glClear(GLES20.GL_DEPTH_BUFFER_BIT | GLES20.GL_COLOR_BUFFER_BIT);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¯10så®Œæˆä¸€æ¬¡æ—‹è½¬</span></span><br><span class="line">    <span class="keyword">long</span> time = SystemClock.uptimeMillis() % <span class="number">10000L</span>;</span><br><span class="line">    <span class="keyword">float</span> angleDegrees = (<span class="number">360.0F</span> / <span class="number">10000.0F</span>) * ((<span class="keyword">int</span>)time);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”»ä¸‰è§’å½¢</span></span><br><span class="line">    Matrix.setIdentityM(mModelMatrix, <span class="number">0</span>);</span><br><span class="line">    Matrix.rotateM(mModelMatrix, <span class="number">0</span>, angleDegrees, <span class="number">0.0F</span>, <span class="number">0.0F</span>, <span class="number">1.0F</span>);</span><br><span class="line">    drawTriangle(mTriangle1Verticels);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>è¿™æ˜¯å®é™…æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„å†…å®¹ã€‚æˆ‘ä»¬æ¸…ç†å±å¹•ï¼Œå› æ­¤ä¸ä¼šå¾—åˆ°ä»»ä½•å¥‡æ€ªçš„<a href="https://en.wikipedia.org/wiki/Noclip_mode#.22Hall_of_mirrors.22_effect" target="_blank" rel="noopener">é•œåƒæ•ˆåº”</a>å½±å“ï¼Œæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„ä¸‰è§’å½¢åœ¨å±å¹•ä¸Šèƒ½æœ‰å¹³æ»‘çš„åŠ¨ç”»ï¼Œé€šå¸¸ä½¿ç”¨æ—¶é—´è€Œä¸æ˜¯å¸§ç‡æ›´å¥½ã€‚</p><blockquote><p>å®é™…ç»˜åˆ¶åœ¨<code>drawTriangle()</code>æ–¹æ³•ä¸­å®Œæˆ</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°çš„ç±»æˆå‘˜</span></span><br><span class="line"><span class="comment">/** ä¸ºæœ€ç»ˆçš„ç»„åˆçŸ©é˜µåˆ†é…å­˜å‚¨ç©ºé—´ï¼Œè¿™å°†ç”¨æ¥ä¼ å…¥ç€è‰²å™¨ç¨‹åº*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">float</span>[] mMVPMatrix = <span class="keyword">new</span> <span class="keyword">float</span>[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">/** æ¯ä¸ªé¡¶ç‚¹æœ‰å¤šå°‘å­—èŠ‚ç»„æˆï¼Œæ¯æ¬¡éœ€è¦è¿ˆè¿‡è¿™ä¹ˆä¸€å¤§æ­¥ï¼ˆæ¯ä¸ªé¡¶ç‚¹æœ‰7ä¸ªå…ƒç´ ï¼Œ3ä¸ªè¡¨ç¤ºä½ç½®ï¼Œ4ä¸ªè¡¨ç¤ºé¢œè‰²ï¼Œ7 * 4 = 28ä¸ªå­—èŠ‚ï¼‰*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mStrideBytes = <span class="number">7</span> * mBytePerFloat;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** ä½ç½®æ•°æ®åç§»é‡*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mPositionOffset = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** ä¸€ä¸ªå…ƒç´ çš„ä½ç½®æ•°æ®å¤§å°*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mPositionDataSize = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** é¢œè‰²æ•°æ®åç§»é‡*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mColorOffset = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** ä¸€ä¸ªå…ƒç´ çš„é¢œè‰²æ•°æ®å¤§å°*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mColorDataSize = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä»ç»™å®šçš„é¡¶ç‚¹æ•°æ®ä¸­ç»˜åˆ¶ä¸€ä¸ªä¸‰è§’å½¢</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> aTriangleBuffer åŒ…å«é¡¶ç‚¹æ•°æ®çš„ç¼“å†²åŒº</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawTriangle</span><span class="params">(FloatBuffer aTriangleBuffer)</span> </span>&#123;</span><br><span class="line">    aTriangleBuffer.position(mPositionOffset);</span><br><span class="line">    GLES20.glVertexAttribPointer(</span><br><span class="line">            mPositionHandle, mPositionDataSize, GLES20.GL_FLOAT, <span class="keyword">false</span>,</span><br><span class="line">            mStrideBytes, aTriangleBuffer);</span><br><span class="line"></span><br><span class="line">    GLES20.glEnableVertexAttribArray(mPositionHandle);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¼ å…¥é¢œè‰²ä¿¡æ¯</span></span><br><span class="line">    aTriangleBuffer.position(mColorOffset);</span><br><span class="line">    GLES20.glVertexAttribPointer(mColorHandle, mColorDataSize, GLES20.GL_FLOAT, <span class="keyword">false</span>,</span><br><span class="line">            mStrideBytes, aTriangleBuffer);</span><br><span class="line"></span><br><span class="line">    GLES20.glEnableVertexAttribArray(mColorHandle);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†è§†å›¾çŸ©é˜µä¹˜ä»¥æ¨¡å‹çŸ©é˜µï¼Œå¹¶å°†ç»“æœå­˜æ”¾åˆ°MVP Matrixï¼ˆmodel * viewï¼‰</span></span><br><span class="line">    Matrix.multiplyMM(mMVPMatrix, <span class="number">0</span>, mViewMatrix, <span class="number">0</span>, mModelMatrix, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†ä¸Šé¢è®¡ç®—å¥½çš„è§†å›¾æ¨¡å‹çŸ©é˜µä¹˜ä»¥æŠ•å½±çŸ©é˜µï¼Œå¹¶å°†ç»“æœå­˜æ”¾åˆ°MVP Matrixï¼ˆmodel * view * projectionï¼‰</span></span><br><span class="line">    Matrix.multiplyMM(mMVPMatrix, <span class="number">0</span>, mProjectionMatrix, <span class="number">0</span>, mMVPMatrix, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    GLES20.glUniformMatrix4fv(mMVPMatrixHandle, <span class="number">1</span>, <span class="keyword">false</span>, mMVPMatrix, <span class="number">0</span>);</span><br><span class="line">    GLES20.glDrawArrays(GLES20.GL_TRIANGLES, <span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>æ‚¨è¿˜è®°å¾—æˆ‘ä»¬æœ€åˆåˆ›å»ºæ¸²æŸ“å™¨æ—¶å®šä¹‰çš„é‚£äº›ç¼“å†²åŒºå—ï¼Ÿæˆ‘ä»¬ç»ˆäºå¯ä»¥ä½¿ç”¨å®ƒä»¬äº†ã€‚<br>æˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>GLES20.glVertexAttribPointer()</code>æ¥å‘Šè¯‰OpenGLæ€æ ·ä½¿ç”¨è¿™äº›æ•°æ®ã€‚</p><blockquote><p>æˆ‘ä»¬æ¥çœ‹ç¬¬ä¸€ä¸ªä½¿ç”¨</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">aTriangleBuffer.position(mPositionOffset);</span><br><span class="line">GLES20.glVertexAttribPointer(</span><br><span class="line">        mPositionHandle, mPositionDataSize, GLES20.GL_FLOAT, <span class="keyword">false</span>,</span><br><span class="line">        mStrideBytes, aTriangleBuffer);</span><br><span class="line">GLES20.glEnableVertexAttribArray(mPositionHandle);</span><br></pre></td></tr></table></div></figure><p>æˆ‘ä»¬è®¾ç½®ç¼“å†²åŒºçš„ä½ç½®åç§»ï¼Œå®ƒä½äºç¼“å†²åŒºçš„å¼€å¤´ã€‚ç„¶åæˆ‘ä»¬å‘Šè¯‰OpenGLä½¿ç”¨è¿™äº›æ•°æ®å¹¶å°†å…¶æä¾›ç»™é¡¶ç‚¹ç€è‰²å™¨å¹¶å°†å…¶åº”ç”¨åˆ°ä½ç½®å±æ€§ï¼ˆa_Positionï¼‰ã€‚æˆ‘ä»¬ä¹Ÿéœ€è¦å‘Šè¯‰OpenGLæ¯ä¸ªé¡¶ç‚¹æˆ–è¿ˆå¹…ä¹‹é—´æœ‰å¤šå°‘ä¸ªå…ƒç´ ã€‚</p><blockquote><p>æ³¨æ„ï¼šè¿ˆå¹…ï¼ˆStrideï¼‰éœ€è¦å®šä¹‰ä¸ºå­—èŠ‚ï¼ˆbyteï¼‰ï¼Œå°½ç®¡æ¯ä¸ªé¡¶ç‚¹ä¹‹é—´æˆ‘ä»¬æœ‰7ä¸ªå…ƒç´ ï¼ˆ3ä¸ªæ˜¯ä½ç½®ï¼Œ4ä¸ªæ˜¯é¢œè‰²ï¼‰ï¼Œä½†æˆ‘ä»¬äº‹å®ä¸Šæœ‰28ä¸ªå­—èŠ‚ï¼Œå› ä¸ºæ¯ä¸ªæµ®ç‚¹æ•°ï¼ˆfloatï¼‰å°±æ˜¯4ä¸ªå­—èŠ‚ï¼ˆbyteï¼‰ã€‚å¿˜è®°æ­¤æ­¥éª¤æ‚¨å¯èƒ½æ²¡æœ‰ä»»ä½•é”™è¯¯ï¼Œä½†æ˜¯ä½ ä¼šæƒ³çŸ¥é“ä¸ºä»€ä¹ˆæ‚¨çš„å±å¹•ä¸Šçœ‹ä¸åˆ°ä»»ä½•å†…å®¹ã€‚</p></blockquote><p>æœ€ç»ˆï¼Œæˆ‘ä»¬ä½¿ç”¨äº†é¡¶ç‚¹å±æ€§ï¼Œå¾€ä¸‹æˆ‘ä»¬ä½¿ç”¨äº†ä¸‹ä¸€ä¸ªå±æ€§ã€‚å†å¾€åç‚¹æˆ‘ä»¬æ„å»ºä¸€ä¸ªç»„åˆçŸ©é˜µï¼Œå°†ç‚¹æŠ•å½±åˆ°å±å¹•ä¸Šã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­æ‰§è¡Œæ­¤æ“ä½œï¼Œä½†æ˜¯ç”±äºå®ƒåªéœ€è¦æ‰§è¡Œä¸€æ¬¡æˆ‘ä»¬ä¹Ÿå¯ä»¥åªç¼“å­˜ç»“æœã€‚<br>æˆ‘ä»¬ä½¿ç”¨<code>GLES20.glUniformMatrix4fv()</code>æ–¹æ³•å°†æœ€ç»ˆçš„çŸ©é˜µä¼ å…¥é¡¶ç‚¹ç€è‰²å™¨ã€‚<br><code>GLES20.glDrawArrays()</code>å°†æˆ‘ä»¬çš„ç‚¹è½¬æ¢ä¸ºä¸‰è§’å½¢å¹¶å°†å…¶ç»˜åˆ¶åœ¨å±å¹•ä¸Šã€‚</p><h2 id="æ€»ç»“">æ€»ç»“<a href="post/Learn-OpenGL-Lesson-One#æ€»ç»“"></a></h2><p>å‘¼å‘¼ï¼è¿™æ˜¯é‡è¦çš„ä¸€è¯¾ï¼Œå¦‚æœæ‚¨å®Œæˆäº†æœ¬è¯¾ï¼Œæ„Ÿè°¢æ‚¨ï¼<br>æˆ‘ä»¬å­¦ä¹ äº†æ€æ ·åˆ›å»ºOpenGLä¸Šä¸‹æ–‡ï¼Œä¼ å…¥å½¢çŠ¶æ•°æ®ï¼ŒåŠ è½½é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨ï¼Œè®¾ç½®æˆ‘ä»¬çš„è½¬æ¢çŸ©é˜µï¼Œæœ€ç»ˆæ”¾åœ¨ä¸€èµ·ã€‚<br>å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ‚¨å› è¯¥çœ‹åˆ°äº†ç±»ä¼¼ä¸‹é¢çš„æˆªå±ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-opengl/20190122233309.png" alt="screenshot"></p><p>è¿™ä¸€è¯¾æœ‰å¾ˆå¤šéœ€è¦æ¶ˆåŒ–çš„å†…å®¹ï¼Œæ‚¨å¯èƒ½éœ€è¦å¤šæ¬¡é˜…è¯»è¿™äº›æ­¥éª¤æ‰èƒ½ç†è§£å®ƒã€‚<br>OpenGL ES 2éœ€è¦æ›´å¤šçš„è®¾ç½®æ‰èƒ½å¼€å§‹ï¼Œä½†æ˜¯ä¸€æ—¦æ‚¨å®Œæˆäº†è¿™ä¸ªè¿‡ç¨‹å‡ æ¬¡ï¼Œæ‚¨å°±ä¼šè®°ä½è¿™ä¸ªæµç¨‹ã€‚</p><h2 id="åœ¨Androidå¸‚åœºä¸Šå‘å¸ƒ">åœ¨Androidå¸‚åœºä¸Šå‘å¸ƒ<a href="post/Learn-OpenGL-Lesson-One#åœ¨Androidå¸‚åœºä¸Šå‘å¸ƒ"></a></h2><p>å½“å¼€å‘çš„åº”ç”¨æˆ‘ä»¬ä¸æƒ³åœ¨æ— æ³•è¿è¡Œè¿™äº›åº”ç”¨ç¨‹åºçš„äººåœ¨å¸‚åœºä¸Šçœ‹åˆ°å®ƒä»¬ï¼Œå¦åˆ™å½“åº”ç”¨ç¨‹åºåœ¨å…¶è®¾å¤‡ä¸Šå´©æºƒæ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæ”¶åˆ°å¤§é‡ç³Ÿç³•çš„è¯„è®ºå’Œè¯„åˆ†ã€‚<br>è¦é˜²æ­¢OpenGL ES 2 åº”ç”¨ç¨‹åºå‡ºç°åœ¨ä¸æ”¯æŒå®ƒçš„è®¾å¤‡ä¸Šï¼Œä½ å¯ä»¥åœ¨æ¸…å•æ–‡ä»¶ä¸­æ·»åŠ ï¼š</p><figure class="highlight xml"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-feature</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:glEsVersion</span>=<span class="string">"0x00020000"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:required</span>=<span class="string">"true"</span> /&gt;</span></span><br></pre></td></tr></table></div></figure><p>è¿™å‘Šè¯‰å¸‚åœºæ‚¨çš„appéœ€è¦æœ‰OpenGL ES 2æ”¯æŒï¼Œä¸æ”¯æŒçš„è®¾å¤‡å°†ä¼šéšè—æ‚¨çš„appã€‚</p><h2 id="è¿›ä¸€æ­¥æ¢ç´¢">è¿›ä¸€æ­¥æ¢ç´¢<a href="post/Learn-OpenGL-Lesson-One#è¿›ä¸€æ­¥æ¢ç´¢"></a></h2><p>å°è¯•æ›´æ”¹åŠ¨ç”»é€Ÿåº¦ï¼Œé¡¶ç‚¹æˆ–é¢œè‰²ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼<br>å¯ä»¥åœ¨Githubä¸‹è½½æœ¬è¯¾ç¨‹æºä»£ç ï¼š<a href="https://github.com/learnopengles/Learn-OpenGLES-Tutorials" target="_blank" rel="noopener">ä¸‹è½½é¡¹ç›®</a><br>æœ¬è¯¾çš„ç¼–è¯‘ç‰ˆæœ¬ä¹Ÿå¯ä»¥å†Androidå¸‚åœºä¸‹ï¼š<a href="https://market.android.com/details?id=com.learnopengles.android" target="_blank" rel="noopener">google play ä¸‹è½½apk</a><br>â€œæˆ‘â€ä¹Ÿç¼–è¯‘äº†ä¸ªapkï¼Œæ–¹ä¾¿å¤§å®¶ä¸‹è½½ï¼š<a href="https://github.com/xujiaji/LearnOpenGL/releases" target="_blank" rel="noopener">github download</a></p><h2 id="æ•™ç¨‹ç›®å½•">æ•™ç¨‹ç›®å½•<a href="post/Learn-OpenGL-Lesson-One#æ•™ç¨‹ç›®å½•"></a></h2><ul><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-One">OpenGL Androidè¯¾ç¨‹ä¸€ï¼šå…¥é—¨</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Two">OpenGL Androidè¯¾ç¨‹äºŒï¼šç¯å¢ƒå…‰å’Œæ¼«å°„å…‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Three">OpenGL Androidè¯¾ç¨‹ä¸‰ï¼šä½¿ç”¨æ¯ç‰‡æ®µç…§æ˜</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Four">OpenGL Androidè¯¾ç¨‹å››ï¼šä»‹ç»çº¹ç†åŸºç¡€</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Five">OpenGL Androidè¯¾ç¨‹äº”ï¼šä»‹ç»æ··åˆï¼ˆBlendingï¼‰</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Six">OpenGL Androidè¯¾ç¨‹å…­ï¼šä»‹ç»çº¹ç†è¿‡æ»¤</a></li><li><a href="https://blog.xujiaji.com/post/Learn-OpenGL-Lesson-Seven">OpenGL Androidè¯¾ç¨‹ä¸ƒï¼šä»‹ç»Vertex Buffer Objectsï¼ˆé¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ï¼Œç®€ç§°ï¼šVOBï¼‰</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ–‡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡æ ‡é¢˜ï¼šOpenGL Android Lesson One: Getting Started&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.learnopengles.com/android-lesson-one-getting-started/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.learnopengles.com/android-lesson-one-getting-started/&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/categories/OpenGL/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="OpenGL" scheme="https://blog.xujiaji.com/tags/OpenGL/"/>
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>C å­¦ä¹ ç¬”è®°</title>
    <link href="https://blog.xujiaji.com/post/c-learn-note/index.html"/>
    <id>https://blog.xujiaji.com/post/c-learn-note/index.html</id>
    <published>2018-12-25T15:18:45.000Z</published>
    <updated>2019-05-15T08:15:04.969Z</updated>
    
    <content type="html"><![CDATA[<p>é‡å­¦ä¸€æ¬¡Cè¯­è¨€ï¼Œè®°å½•ä¸€ä¸‹å­¦ä¹ ã€ŠC Primer Plusã€‹çš„ç¬”è®°ï¼Œæ–¹ä¾¿å›å¿†ï¼</p><a id="more"></a><h2 id="ç¼–è¯‘">ç¼–è¯‘<a href="post/c-learn-note#ç¼–è¯‘"></a></h2><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -o foo.exe foo.c -lregex</span><br><span class="line">gcc foo.c -o foo.exe -lregex</span><br></pre></td></tr></table></div></figure><h2 id="å­—ç¬¦ä¸²å’Œæ ¼å¼åŒ–è¾“å…¥-è¾“å‡º">å­—ç¬¦ä¸²å’Œæ ¼å¼åŒ–è¾“å…¥/è¾“å‡º<a href="post/c-learn-note#å­—ç¬¦ä¸²å’Œæ ¼å¼åŒ–è¾“å…¥-è¾“å‡º"></a></h2><ol><li>å­—ç¬¦ä¸²ä»¥<code>char</code>æ•°ç»„æ¥å­˜å‚¨</li><li><p>å¸¸é‡ç”¨ <code>#define</code> å®šä¹‰</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DENSITY 62.4</span></span><br></pre></td></tr></table></div></figure></li><li><p><code>strlen()</code>è·å–å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œæ³¨æ„éœ€è¦<code>#include &lt;string.h&gt;</code></p></li><li><code>char</code>ç±»å‹æ•°ç»„å’Œ<code>null</code>å­—ç¬¦<ol><li>Cè¯­è¨€æ²¡æœ‰ä¸“é—¨ç”¨äºå‚¨å­˜å­—ç¬¦ä¸²çš„å˜é‡ç±»å‹ï¼Œå­—ç¬¦ä¸²éƒ½è¢«å‚¨å­˜åœ¨<code>char</code>ç±»å‹çš„æ•°ç»„ä¸­</li><li>å­—ç¬¦ä¸²ä»¥<code>\0</code>ï¼ˆç©ºå­—ç¬¦ï¼‰ç»“æŸï¼Œå®ƒæ˜¯ä¸æ‰“å°å‡ºæ¥çš„å­—ç¬¦</li><li>å¦‚æœæœ‰40å“¥å­˜å‚¨å•å•å…ƒçš„å­—ç¬¦ä¸²ï¼Œåªèƒ½å‚¨å­˜39å“¥å­—ç¬¦ï¼Œå‰©ä¸‹ä¸€ä¸ªå­—èŠ‚ç•™ç»™ç©ºå­—ç¬¦</li></ol></li><li><p>ä¸€ä¸‹ä»£ç <code>%s</code>ä½œä¸ºè½¬åŒ–è¯´æ˜ï¼Œ<code>scanf()</code>åªä¼šè¯»å–å­—ç¬¦ä¸²ä¸­çš„ä¸€ä¸ªå•è¯ã€‚å¹¶ä¸”æ²¡æœ‰åŠ <code>&amp;</code>å–åœ°å€ç¬¦ï¼Œ<code>name</code>å°±æ˜¯åœ°å€</p><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> name[<span class="number">40</span>];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>, name);</span><br></pre></td></tr></table></div></figure></li><li><p><code>&quot;x&quot;</code>ä¸åŒäº<code>&#39;x&#39;</code>,<code>&quot;x&quot;</code>æ˜¯å­—ç¬¦ä¸²ç”±<code>x</code>å’Œ<code>\0</code>ç»„æˆ</p></li><li><code>sizeof</code>è¿ç®—ç¬¦ï¼Œå®ƒä»¥å­—èŠ‚ä¸ºå•ä½ç»™å‡ºå¯¹è±¡çš„å¤§å°ã€‚<code>strlen()</code>åªç»™å‡ºå­—ç¬¦ä¸²é•¿åº¦ï¼Œåˆ°ç©ºå­—ç¬¦ï¼ˆä¸åŒ…æ‹¬ç©ºå­—ç¬¦ï¼‰<ol><li>C99å’ŒC11æ ‡å‡†ä¸“é—¨ä¸º<code>sizeof</code>è¿ç®—ç¬¦çš„è¿”å›ç±»å‹æ·»åŠ äº†<code>%zd</code>è½¬æ¢è¯´æ˜ï¼Œå¯¹äº<code>strlen()</code>ä¹Ÿé€‚ç”¨</li><li><code>sizeof</code>ä½¿ç”¨æ—¶ï¼Œå¯¹äºç±»å‹å¿…é¡»åŠ æ‹¬å·ã€‚å¯¹äºç‰¹å®šé‡ï¼Œå¯æœ‰å¯æ— ã€‚ç±»å‹ï¼š<code>sizeof(char)</code>, <code>sizeof(float)</code>; ç‰¹å®šé‡ï¼š<code>sizeof 6.28</code>, <code>sizeof name</code></li></ol></li></ol><h2 id="å¸¸é‡å’ŒCé¢„å¤„ç†å™¨">å¸¸é‡å’ŒCé¢„å¤„ç†å™¨<a href="post/c-learn-note#å¸¸é‡å’ŒCé¢„å¤„ç†å™¨"></a></h2><ol><li><p>Cé¢„å¤„ç†å™¨å®šä¹‰å¸¸é‡ï¼š<code>#define NAME value</code>ï¼Œå…¶ä¸­â€œNAMEâ€ä¸ºå‘½ä»¤çš„å¸¸é‡åï¼Œçº¦å®šå¤§å†™ï¼›â€œvalueâ€æ˜¯å¯¹åº”çš„å€¼</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#define <span class="type">BEEP</span> '\a'</span><br><span class="line">#define <span class="type">TEE</span> '<span class="type">T'</span></span><br><span class="line">#define <span class="type">ESC</span> '\<span class="number">033</span>'</span><br><span class="line">#define <span class="type">OOPS</span> <span class="string">"Now you have done it!"</span></span><br></pre></td></tr></table></div></figure></li><li><p><code>const</code>é™å®šç¬¦ï¼ŒC90æ ‡å‡†æ–°å¢è¯¥å…³é”®å­—ï¼Œç”¨äºé™å®šä¸€ä¸ªå˜é‡ä¸ºåªè¯»</p></li><li>æ˜ç¤ºå¸¸é‡ï¼šCå¤´æ–‡ä»¶<code>limits.h</code>å’Œ<code>float.h</code>åˆ†åˆ«æä¾›äº†ä¸æ•´æ•°ç±»å‹å’Œæµ®ç‚¹æ•°ç±»å‹å¤§å°é™åˆ¶ç›¸å…³çš„è¯¦ç»†ä¿¡æ¯<figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;limits.h&gt;</span><br><span class="line">#include &lt;float.h&gt;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    printf(<span class="string">"Some number limits for this system: \n"</span>);</span><br><span class="line">    printf(<span class="string">"Biggest int: %d\n"</span>, <span class="type">INT_MAX</span>);</span><br><span class="line">    printf(<span class="string">"Smallest long long: %lld\n"</span>, <span class="type">LLONG_MIN</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é‡å­¦ä¸€æ¬¡Cè¯­è¨€ï¼Œè®°å½•ä¸€ä¸‹å­¦ä¹ ã€ŠC Primer Plusã€‹çš„ç¬”è®°ï¼Œæ–¹ä¾¿å›å¿†ï¼&lt;/p&gt;
    
    </summary>
    
      <category term="C" scheme="https://blog.xujiaji.com/categories/C/"/>
    
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¬”è®°" scheme="https://blog.xujiaji.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="C" scheme="https://blog.xujiaji.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€ä¸ªé¡¹ç›®å¦‚ä½•ç¼–è¯‘å¤šä¸ªä¸åŒç­¾åã€åŒ…åã€èµ„æºç­‰ï¼Œçš„apkï¼Ÿ</title>
    <link href="https://blog.xujiaji.com/post/android-project-one-for-more/index.html"/>
    <id>https://blog.xujiaji.com/post/android-project-one-for-more/index.html</id>
    <published>2018-10-29T08:15:20.000Z</published>
    <updated>2019-04-08T06:54:02.208Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç®€ä»‹">ç®€ä»‹<a href="post/android-project-one-for-more#ç®€ä»‹"></a></h2><p>å¦‚é¢˜æ‰€ç¤ºï¼æœ¬ç¯‡æ–‡ç« å°±æ˜¯ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ã€‚æ–¹ä¾¿æ‰“åŒ…å’Œè¿è¡Œçš„æ—¶å€™èƒ½åšåˆ°æ— éœ€æ‰‹åŠ¨æ›¿æ¢é…ç½®ï¼Œå³å¯æ‰“åŒ…æƒ³è¦çš„apkã€‚æ‰“åŒ…çš„æ—¶å€™ï¼Œåªéœ€é€‰ä¸€ä¸‹æƒ³æ‰“å“ªç§é…ç½®çš„apkå°±OKå•¦ã€‚ (^o^)/~</p><blockquote><p>å…ˆæ¥çœ‹ï¼Œæœ‰éœ€æ±‚å¦‚ä¸‹ï¼š</p></blockquote><ol><li>åŒä¸€ä¸ªé¡¹ç›®</li><li>ä¸åŒçš„apkå›¾æ ‡</li><li>ä¸åŒçš„æœåŠ¡å™¨åŸŸå</li><li>ä¸åŒçš„åŒ…å</li><li>ä¸åŒçš„åç§°</li><li>ä¸åŒçš„ç­¾å</li><li>ä¸åŒçš„ç¬¬ä¸‰æ–¹key</li><li>ä¸åŒçš„ç‰ˆæœ¬åç‰ˆæœ¬å·</li></ol><blockquote><p>è§£å†³æ€è·¯</p></blockquote><ol><li>å½“ç„¶æœ€ç›´æ¥çš„æ–¹å¼ä¸è¿‡äºæ¯æ¬¡æ‰“ä¸åŒåŒ…çš„æ—¶å€™éƒ½å»æ›¿æ¢å¯¹åº”çš„é…ç½®ï¼Œè¿™ç§æ–¹å¼çš„éº»çƒ¦ä¹‹å¤„ä¸è¨€è€Œå–»ã€‚</li><li>å°†æ‰€æœ‰é…ç½®ï¼Œèµ„æºç­‰éƒ½é…ç½®å…¥é¡¹ç›®ä¸­ï¼Œæ‰“åŒ…çš„æ—¶å€™ï¼Œæ ¹æ®é€‰æ‹©æ¸ é“æ‰“åŒ…ä¸åŒé…ç½®çš„apkã€‚ï¼ˆæœ¬ç¯‡æ–‡ç« å°±æ˜¯è¦è®²æ€ä¹ˆè¿™ä¹ˆåšçš„ï¼‰</li><li>ç›¸ä¿¡è¿˜æœ‰å…¶ä»–çš„ã€‚ã€‚ã€‚</li></ol><h2 id="ç›¸å…³çš„å‡ ä¸ªè¦ç‚¹">ç›¸å…³çš„å‡ ä¸ªè¦ç‚¹<a href="post/android-project-one-for-more#ç›¸å…³çš„å‡ ä¸ªè¦ç‚¹"></a></h2><ol><li><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“<code>productFlavors</code>æ¥é…ç½®æ¸ é“ï¼Œè¿™é‡Œæˆ‘å°†æ¸ é“ç”¨æ¥è¡¨ç¤ºå“ªç§apkï¼Œå¦‚ä¸‹æˆ‘éœ€è¦é…ç½®å››ç§åº”ç”¨:</p><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">productFlavors &#123;</span><br><span class="line">  userquhua &#123;&#125;</span><br><span class="line">  quhua &#123;&#125;</span><br><span class="line">  cuntuba &#123;&#125;</span><br><span class="line">  xemh &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>å¦‚æœæˆ‘ä»¬é€‰æ‹©äº†æŸä¸€ä¸ªæ¸ é“ï¼Œé‚£ä¹ˆè¿è¡Œæ‰“åŒ…çš„æ—¶å€™ä¼šæ ¹æ®æ¸ é“åé€‰æ‹©èµ„æºæ–‡ä»¶ï¼ˆå¯ç»“åˆç¬¬6ç‚¹ä¸€èµ·çœ‹ï¼‰<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/one-for-more/20181029171053.png" alt=""></p></li><li><p>ç­¾åå¯åœ¨<code>signingConfigs</code>ä¸­é…ç½®å¤šä¸ªï¼ˆæˆ‘å°†æ‰€æœ‰ç­¾åæ–‡ä»¶æ”¾åœ¨äº†é¡¹ç›®è·Ÿç›®å½•çš„keyæ–‡ä»¶å¤¹ä¸­ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡<code>signingConfigs</code>æŒ‡å®šé¢„åˆ¶å¥½çš„ç­¾åé…ç½®ã€‚</p><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">signingConfigs &#123;</span><br><span class="line">    userquhuaRelease &#123;</span><br><span class="line">        storeFile file(<span class="string">"../key/xxx1.keystore"</span>)</span><br><span class="line">        storePassword <span class="string">"xxxxxx"</span></span><br><span class="line">        keyAlias <span class="string">"alias"</span></span><br><span class="line">        keyPassword <span class="string">"xxxxxx"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    quhuaRelease &#123;</span><br><span class="line">        storeFile file(<span class="string">"../key/xxx2.keystore"</span>)</span><br><span class="line">        storePassword <span class="string">"xxxxxx"</span></span><br><span class="line">        keyAlias <span class="string">"alias"</span></span><br><span class="line">        keyPassword <span class="string">"xxxxxx"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cuntubaRelease &#123;</span><br><span class="line">        storeFile file(<span class="string">"../key/xxx3.keystore"</span>)</span><br><span class="line">        storePassword <span class="string">"xxxxxx"</span></span><br><span class="line">        keyAlias <span class="string">"alias"</span></span><br><span class="line">        keyPassword <span class="string">"xxxxxx"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    xemhRelease &#123;</span><br><span class="line">        storeFile file(<span class="string">"../key/xxx4.keystore"</span>)</span><br><span class="line">        storePassword <span class="string">"xxxxxx"</span></span><br><span class="line">        keyAlias <span class="string">"alias"</span></span><br><span class="line">        keyPassword <span class="string">"xxxxxx"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>å¯åœ¨build.gradleä¸­é…ç½®åŠ¨æ€é…ç½®javaä»£ç è°ƒç”¨çš„å¸¸é‡æ•°æ®ï¼ˆå¦‚ï¼šé€šè¿‡è¯¥æ–¹å¼æˆ‘ä»¬å¯æ ¹æ®ä¸åŒæ¸ é“åŠ¨æ€é…ç½®ç¬¬ä¸‰æ–¹appidï¼Œæˆ–å…¶ä»–éœ€è¦æ ¹æ®æ¸ é“è€Œæ”¹å˜çš„æ•°æ®ï¼‰</p><ul><li><p>æ¯”å¦‚ï¼šæˆ‘ä»¬åœ¨<code>defaultConfig {}</code> ä¸­å®šä¹‰äº†:</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">buildConfigField &quot;String&quot;, &quot;SERVER_URL&quot;, &apos;&quot;http://xx.xxxx.com/&quot;&apos;</span><br></pre></td></tr></table></div></figure></li><li><p>æ­¤æ—¶ï¼Œæ‚¨çœ‹ä¸€ä¸‹æ¸…å•æ–‡ä»¶ä¸­<code>manifest</code>æ ‡ç­¾é‡Œçš„ï¼Œ<code>package</code>çš„å€¼ï¼Œå‡å¦‚æ˜¯ï¼š</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com.xxx.xx</span><br></pre></td></tr></table></div></figure></li><li><p>é‚£ä¹ˆï¼Œæ‚¨å°±å¯ä»¥åœ¨javaä»£ç ä¸­é€šè¿‡å¯¼å…¥æ–‡ä»¶ï¼š</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import com.xxx.xx.BuildConfig;</span><br></pre></td></tr></table></div></figure></li><li><p>ç„¶åè°ƒç”¨</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BuildConfig.SERVER_URL</span><br></pre></td></tr></table></div></figure></li></ul><p>å®ƒçš„å€¼å°±æ˜¯ä¸Šè¾¹é…ç½®çš„å­—ç¬¦ä¸²ï¼š<code>http://xx.xxxx.com/</code>ã€‚</p><ul><li>æ‚¨å¯ä»¥è¿›å…¥<code>BuildConfig</code>çœ‹ä¸€çœ‹ï¼Œé‡Œé¢è¿˜åŒ…å«äº†ä¸€äº›å½“å‰çš„åŒ…åç‰ˆæœ¬å·ç­‰ä¿¡æ¯ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/one-for-more/20181030234102.png" alt=""></li></ul></li><li><p>åœ¨æ¸ é“é…ç½®é‚£é‡Œå¯ä»¥é…ç½®å¯¹åº”çš„åŒ…åç‰ˆæœ¬åç­¾åç­‰ç­‰<br>å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// çœç•¥å…¶ä»–é…ç½®...</span></span><br><span class="line">android &#123;</span><br><span class="line">  <span class="comment">// çœç•¥å…¶ä»–é…ç½®...</span></span><br><span class="line">  productFlavors &#123;</span><br><span class="line">      userquhua &#123;</span><br><span class="line">          applicationId <span class="string">"com.xxx.xx"</span></span><br><span class="line">          versionCode <span class="number">1</span></span><br><span class="line">          versionName <span class="string">"1.0.0"</span></span><br><span class="line">          signingConfig signingConfigs.userquhuaRelease <span class="comment">// é…ç½®ç­¾å</span></span><br><span class="line"></span><br><span class="line">          String qq_id = <span class="string">'"xxxxxxxxx"'</span> <span class="comment">//é…ç½®qq appid</span></span><br><span class="line">          buildConfigField <span class="string">"String"</span>,           <span class="string">"QQ_ID"</span>, qq_id</span><br><span class="line">          buildConfigField <span class="string">"String"</span>,           <span class="string">"WX_ID"</span>, <span class="string">'"wxxxxxxxxxxxxxxxxx"'</span> <span class="comment">// é…ç½®å¾®ä¿¡appid</span></span><br><span class="line">          manifestPlaceholders = [</span><br><span class="line"><span class="symbol">            qq_id:</span> qq_id,</span><br><span class="line">            <span class="string">JPUSH_PKGNAME :</span> applicationId,</span><br><span class="line">            <span class="string">JPUSH_APPKEY :</span> <span class="string">"xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>, <span class="comment">//JPush ä¸Šæ³¨å†Œçš„åŒ…åå¯¹åº”çš„ Appkey.</span></span><br><span class="line">            <span class="string">JPUSH_CHANNEL :</span> <span class="string">"developer-default"</span>,</span><br><span class="line">          ]</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  buildTypes &#123;</span><br><span class="line">    release &#123;</span><br><span class="line">      <span class="comment">// çœç•¥å…¶ä»–é…ç½®...</span></span><br><span class="line">        signingConfig <span class="literal">null</span>  <span class="comment">// ç½®ç©º</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    debug &#123;</span><br><span class="line">      <span class="comment">// çœç•¥å…¶ä»–é…ç½®...</span></span><br><span class="line">        signingConfig <span class="literal">null</span> <span class="comment">// ç½®ç©º</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><ul><li>è¿™æ ·ï¼Œå¦‚æœæˆ‘ä»¬æ‰“åŒ…userquhuaè¿™ä¸ªæ¸ é“ï¼Œçœ‹ç¬¬2ç‚¹ä¸­ä»‹ç»é€‰æ‹©userquhuaDebugã€‚</li><li>ç„¶åï¼Œæœ€å¥½cleanä¸€ä¸‹é¡¹ç›®ã€ç„¶åæˆ‘ä»¬è¿è¡Œé¡¹ç›®ã€‚</li><li>è¯¥appçš„åŒ…åå°±æ˜¯<code>com.xxx.xx</code>ï¼Œç‰ˆæœ¬å·ä¸º<code>1</code>ï¼Œç‰ˆæœ¬åä¸º<code>1.0.0</code>ã€‚</li><li>é€šè¿‡<code>BuildConfig</code>è°ƒç”¨<code>QQ_ID</code>é™æ€å¸¸é‡ï¼Œå°±æ˜¯è¯¥æ¸ é“é‡Œé…ç½®çš„å€¼ï¼Œ<code>WX_ID</code>åŒç†ã€‚</li><li><code>manifestPlaceholders</code>é…ç½®ä¹Ÿå¯ä»¥è¿™æ ·é…ç½®ã€‚</li><li>ç­¾åé—®é¢˜ç»è¿‡ä¸ªäººåå¤å°è¯•ï¼ˆç„¶ååŠå¤©å°±è¿‡å»äº†ï¿£ã¸ï¿£ï¼‰ï¼Œæœ€ç»ˆç­¾åå¦‚ä¸Šé…ç½®ã€‚<strong>éœ€è¦æ³¨æ„</strong><code>buildTypes</code>ä¸­çš„ç­¾åé…ç½®<code>signingConfig</code>å¦‚æœä¸è®¾ç½®ä¸º<code>null</code>ï¼Œé‚£ä¹ˆæ‰“åŒ…çš„æ˜¯æœ‰è¿˜æ˜¯ä»¥å†…ç½®çš„ç­¾åæ‰“åŒ…ã€‚</li></ul></li><li>èµ„æºæ–‡ä»¶æ›¿æ¢<br>å†çœ‹åˆ°ç¬¬2ç‚¹çš„ä»‹ç»ï¼Œæˆ‘ä»¬é€‰æ‹©è¿è¡Œæ¸ é“åï¼Œä¼šé»˜è®¤åŒ¹é…å¯¹åº”æ¸ é“ä¸‹çš„èµ„æºã€‚ä¸‹é¢æˆ‘å°†<code>xemh</code>æ¸ é“çš„èµ„æºç›®å½•å…¨éƒ¨å±•å¼€ä¸€ä¸‹ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/one-for-more/20181029233306.png" alt=""><ul><li>å¦‚ä¸Šå›¾è¿™æ ·ï¼Œåªéœ€è¦èµ„æºåå­—å’Œappç›®å½•å¯¹åº”çš„æ–‡ä»¶åå­—ä¸€æ ·å³å¯æ›¿æ¢ã€‚</li><li>strings.xmlé‡Œçš„åº”ç”¨åï¼Œåªéœ€è¦å°†å¯¹åº”<code>app_name</code>ä¿®æ”¹æ—¢å¯æ›¿æ¢appä¸‹stringsçš„<code>app_name</code>ï¼Œå…¶ä»–ä¸ç”¨æ›¿æ¢çš„ä¸ç”¨å†™å°±è¡Œã€‚</li></ul></li><li>æ‰“æ­£å¼åŒ…çš„æ—¶å€™é€‰å¥½æ¸ é“ï¼Œå°±å¯ä»¥æ‰“åŒ…ä¸åŒé…ç½®çš„apkï¼Œå½“ç„¶æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤çš„æ–¹å¼ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/one-for-more/20181029234235.png" alt=""></li></ol><h2 id="å…¶ä»–é…ç½®è®°å½•">å…¶ä»–é…ç½®è®°å½•<a href="post/android-project-one-for-more#å…¶ä»–é…ç½®è®°å½•"></a></h2><blockquote><p>è·å–å½“å‰æ—¶é—´</p></blockquote><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">def</span> releaseTime() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Date().format(<span class="string">"yyyy-MM-dd-HH.mm"</span>, TimeZone.getTimeZone(<span class="string">"GMT+8"</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>æ‰“åŒ…çš„æ—¶å€™ï¼Œä¿®æ”¹æ–‡ä»¶åï¼Œä»¥æ–¹ä¾¿åŒºåˆ«æ¸ é“å’Œç‰ˆæœ¬æ‰“åŒ…æ—¶é—´</p></blockquote><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">applicationVariants.all &#123;</span><br><span class="line">    variant -&gt;</span><br><span class="line">        variant.outputs.all &#123;</span><br><span class="line">            outputFileName = <span class="string">"$&#123;variant.productFlavors[0].name&#125;-v$&#123;variant.productFlavors[0].versionName&#125;-$&#123;releaseTime()&#125;.apk"</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><ul><li><code>${variant.productFlavors[0].name}</code>å½“å‰æ¸ é“å</li><li><code>${variant.productFlavors[0].versionName}</code>å½“å‰ç‰ˆæœ¬å</li><li><code>${releaseTime()}</code>å½“å‰æ—¶é—´</li></ul><h2 id="å…¶ä»–éœ€è¦æ³¨æ„äº‹é¡¹">å…¶ä»–éœ€è¦æ³¨æ„äº‹é¡¹<a href="post/android-project-one-for-more#å…¶ä»–éœ€è¦æ³¨æ„äº‹é¡¹"></a></h2><p>å¦‚æœæ‚¨åœ¨æ¸…å•æ–‡ä»¶<code>AndroidManifest.xml</code>ä¸­ï¼Œæœ‰é‚£ç§ä»¥åŒ…åå¼€å¤´å‘½åçš„é‚£ç§ã€‚å› ä¸ºå¦‚æœåŒ…åéƒ½æ”¹äº†ï¼Œæœ‰äº›ä¹Ÿéœ€è¦åŠ¨æ€çš„æ”¹å˜ã€‚å¯ä»¥ç”¨<code>${applicationId}</code>ä»£æ›¿ã€‚åœ¨æ‰“åŒ…çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨æ›¿æ¢æˆå½“å‰åŒ…åã€‚</p><blockquote><p>æ¯”å¦‚ï¼Œç±»ä¼¼ä¸‹é…ç½®ï¼š</p></blockquote><figure class="highlight xml"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">permission</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">"com.xxx.xx.permission.JPUSH_MESSAGE"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:protectionLevel</span>=<span class="string">"signature"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"com.xxx.xx.permission.JPUSH_MESSAGE"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">receiver</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">".push.MyJPushMessageReceiver"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:enabled</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">"false"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"cn.jpush.android.intent.RECEIVE_MESSAGE"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"com.xxx.xx"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">receiver</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">provider</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">"android.support.v4.content.FileProvider"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:authorities</span>=<span class="string">"com.xxx.xx.provider"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:replace</span>=<span class="string">"android:authorities"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:grantUriPermissions</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">"android.support.FILE_PROVIDER_PATHS"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:resource</span>=<span class="string">"@xml/file_paths"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br></pre></td></tr></table></div></figure><blockquote><p>å¯æ”¹ä¸ºï¼š</p></blockquote><figure class="highlight xml"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">permission</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">"$&#123;applicationId&#125;.permission.JPUSH_MESSAGE"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:protectionLevel</span>=<span class="string">"signature"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"$&#123;applicationId&#125;.permission.JPUSH_MESSAGE"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">receiver</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">".push.MyJPushMessageReceiver"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:enabled</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">"false"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"cn.jpush.android.intent.RECEIVE_MESSAGE"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"$&#123;applicationId&#125;"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">receiver</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">provider</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">"android.support.v4.content.FileProvider"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:authorities</span>=<span class="string">"$&#123;applicationId&#125;.provider"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:replace</span>=<span class="string">"android:authorities"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:grantUriPermissions</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">"android.support.FILE_PROVIDER_PATHS"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:resource</span>=<span class="string">"@xml/file_paths"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br></pre></td></tr></table></div></figure><blockquote><p>å½“ç„¶å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä»£ç ä¸­æˆ‘ä»¬ä¹Ÿä¸èƒ½æŠŠåŒ…åå†™æ­»äº†ï¼Œå¯é€šè¿‡<code>BuildConfig</code>å¾—åˆ°å½“å‰åŒ…å</p></blockquote><h2 id="æˆ‘çš„å®Œæ•´é…ç½®ï¼Œä¾›å‚è€ƒ">æˆ‘çš„å®Œæ•´é…ç½®ï¼Œä¾›å‚è€ƒ<a href="post/android-project-one-for-more#æˆ‘çš„å®Œæ•´é…ç½®ï¼Œä¾›å‚è€ƒ"></a></h2><blockquote><p>æœ‰å…³éšç§ä¿¡æ¯çš„éƒ½ç”¨xxxæ›¿æ¢äº†</p></blockquote><ol><li><p>é¡¹ç›®æ ¹ç›®å½•çš„<code>build.gradle</code></p><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Top-level build file where you can add configuration options common to all sub-projects/modules.</span></span><br><span class="line"></span><br><span class="line">buildscript &#123;</span><br><span class="line"></span><br><span class="line">    repositories &#123;</span><br><span class="line">        google()</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath <span class="string">'com.android.tools.build:gradle:3.0.0'</span></span><br><span class="line">        classpath <span class="string">"io.github.prototypez:save-state:0.1.7"</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// <span class="doctag">NOTE:</span> Do not place your application dependencies here; they belong</span></span><br><span class="line">        <span class="comment">// in the individual module build.gradle files</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">allprojects &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        google()</span><br><span class="line">        jcenter()</span><br><span class="line">        maven &#123; url <span class="string">"https://jitpack.io"</span> &#125;</span><br><span class="line">        maven &#123; url <span class="string">'http://oss.jfrog.org/artifactory/oss-snapshot-local/'</span> &#125;</span><br><span class="line">        flatDir &#123;</span><br><span class="line">            dirs <span class="string">'libs'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">task clean(<span class="string">type:</span> Delete) &#123;</span><br><span class="line">    delete rootProject.buildDir</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ext&#123;</span><br><span class="line">    minSdkVersion               = <span class="number">16</span></span><br><span class="line">    targetSdkVersion            = <span class="number">27</span></span><br><span class="line">    compileSdkVersion           = <span class="number">27</span></span><br><span class="line">    buildToolsVersion           = <span class="string">'27.1.1'</span></span><br><span class="line"></span><br><span class="line">    supportLibraryVersion       = <span class="string">'27.1.1'</span></span><br><span class="line">    xmvpVersion                 = <span class="string">'1.2.2'</span></span><br><span class="line">    retrofit2Version            = <span class="string">'2.3.0'</span></span><br><span class="line">    okhttp3Version              = <span class="string">'3.8.1'</span></span><br><span class="line">    butterknifeVersion          = <span class="string">'8.6.0'</span></span><br><span class="line">    rx2Version                  = <span class="string">'2.0.2'</span></span><br><span class="line">    CircleProgressDialogVersion = <span class="string">'1.0.2'</span></span><br><span class="line">    smarttabVersion             = <span class="string">'1.6.1@aar'</span></span><br><span class="line">    adapterHelperVersion        = <span class="string">'2.9.41'</span></span><br><span class="line">    glideVersion                = <span class="string">'4.7.1'</span></span><br><span class="line">    roundedimageviewVersion     = <span class="string">'2.3.0'</span></span><br><span class="line">    eventbusVersion             = <span class="string">'3.0.0'</span></span><br><span class="line">    dispatcherVersion           = <span class="string">'2.4.0'</span></span><br><span class="line">    picture_libraryVersion      = <span class="string">'v2.2.3'</span></span><br><span class="line">    statusbarutilVersion        = <span class="string">'1.5.1'</span></span><br><span class="line">    okhttpUtilsVersion          = <span class="string">'3.8.0'</span></span><br><span class="line">    constraintVersion           = <span class="string">'1.1.3'</span></span><br><span class="line">    flexboxVersion              = <span class="string">'1.0.0'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>appç›®å½•ä¸‹çš„<code>build.gradle</code></p><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">'com.android.application'</span></span><br><span class="line">apply <span class="string">plugin:</span> <span class="string">'save.state'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">def</span> releaseTime() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Date().format(<span class="string">"yyyy-MM-dd-HH.mm"</span>, TimeZone.getTimeZone(<span class="string">"GMT+8"</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion rootProject.compileSdkVersion</span><br><span class="line"><span class="comment">//    buildToolsVersion rootProject.buildToolsVersion</span></span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        minSdkVersion rootProject.minSdkVersion</span><br><span class="line">        targetSdkVersion rootProject.targetSdkVersion</span><br><span class="line"></span><br><span class="line">        testInstrumentationRunner <span class="string">"android.support.test.runner.AndroidJUnitRunner"</span></span><br><span class="line">        multiDexEnabled <span class="literal">true</span></span><br><span class="line">        <span class="comment">// config the JSON processing library</span></span><br><span class="line">        javaCompileOptions &#123;</span><br><span class="line">            annotationProcessorOptions &#123;</span><br><span class="line">                arguments = [ <span class="string">serializer :</span> <span class="string">"gson"</span> ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ndk &#123;</span><br><span class="line">            abiFilters <span class="string">"armeabi-v7a"</span></span><br><span class="line">        &#125;</span><br><span class="line">        renderscriptTargetApi <span class="number">25</span></span><br><span class="line">        renderscriptSupportModeEnabled <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    signingConfigs &#123;</span><br><span class="line">        userquhuaRelease &#123;</span><br><span class="line">            storeFile file(<span class="string">"../key/xxx.keystore"</span>)</span><br><span class="line">            storePassword <span class="string">"xxxxxx"</span></span><br><span class="line">            keyAlias <span class="string">"xxx"</span></span><br><span class="line">            keyPassword <span class="string">"xxxxxx"</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        quhuaRelease &#123;</span><br><span class="line">            storeFile file(<span class="string">"../key/xxx.keystore"</span>)</span><br><span class="line">            storePassword <span class="string">"xxxxxxx"</span></span><br><span class="line">            keyAlias <span class="string">"xxx"</span></span><br><span class="line">            keyPassword <span class="string">"xxxxxxx"</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        cuntubaRelease &#123;</span><br><span class="line">            storeFile file(<span class="string">"../key/xxx.keystore"</span>)</span><br><span class="line">            storePassword <span class="string">"xxxxxxx"</span></span><br><span class="line">            keyAlias <span class="string">"xxx"</span></span><br><span class="line">            keyPassword <span class="string">"xxxxxxx"</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        xemhRelease &#123;</span><br><span class="line">            storeFile file(<span class="string">"../key/xxx.keystore"</span>)</span><br><span class="line">            storePassword <span class="string">"xxxxxxx"</span></span><br><span class="line">            keyAlias <span class="string">"xxx"</span></span><br><span class="line">            keyPassword <span class="string">"xxxxxxx"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    flavorDimensions <span class="string">"default"</span></span><br><span class="line">    productFlavors &#123;</span><br><span class="line">        userquhua &#123;</span><br><span class="line">            applicationId <span class="string">"com.xxx.xx"</span></span><br><span class="line">            versionCode <span class="number">22</span></span><br><span class="line">            versionName <span class="string">"1.7.5"</span></span><br><span class="line">            signingConfig = signingConfigs.userquhuaRelease</span><br><span class="line"></span><br><span class="line">            String qq_id = <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"QQ_ID"</span>, qq_id <span class="comment">// qq appId</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,         <span class="string">"SINA_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// æ–°æµªappId</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"WX_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¾®ä¿¡ appId</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"UM_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å‹ç›Ÿ</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,       <span class="string">"WX_SECRET"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¾®ä¿¡ secret</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"SINA_REDIRECT"</span>, <span class="string">'"http://open.weibo.com/apps/xxxxxx/privilege/oauth"'</span> <span class="comment">// æ–°æµª</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"ADHUB_INIT_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¹¿å‘Šsdkåˆå§‹åŒ–id</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_SPLASH_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¼€å±å¹¿å‘Šid</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_BANNER_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// bannerå¹¿å‘Šid</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,      <span class="string">"SERVER_URL"</span>, <span class="string">'"http://xxx.xxx.com/"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,        <span class="string">"LOGO_URL"</span>, <span class="string">'"http://file.xxx.com/img/xxx.png"'</span></span><br><span class="line"></span><br><span class="line">            manifestPlaceholders = [</span><br><span class="line"><span class="symbol">                    qq_id:</span> qq_id,</span><br><span class="line">                    <span class="string">JPUSH_PKGNAME :</span> applicationId,</span><br><span class="line">                    <span class="string">JPUSH_APPKEY :</span> <span class="string">"xxxxxx"</span>, <span class="comment">//JPush ä¸Šæ³¨å†Œçš„åŒ…åå¯¹åº”çš„ Appkey.</span></span><br><span class="line">                    <span class="string">JPUSH_CHANNEL :</span> <span class="string">"developer-default"</span>, <span class="comment">//æš‚æ—¶å¡«å†™é»˜è®¤å€¼å³å¯.</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        quhua &#123;</span><br><span class="line">            applicationId <span class="string">"com.xxx.xx"</span></span><br><span class="line">            versionCode <span class="number">1</span></span><br><span class="line">            versionName <span class="string">"1.0.0"</span></span><br><span class="line">            signingConfig = signingConfigs.quhuaRelease</span><br><span class="line"></span><br><span class="line">            String qq_id = <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"QQ_ID"</span>, qq_id</span><br><span class="line">            buildConfigField <span class="string">"String"</span>,         <span class="string">"SINA_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"WX_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"UM_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,       <span class="string">"WX_SECRET"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"SINA_REDIRECT"</span>, <span class="string">'"http://open.weibo.com/apps/xxxxxx/privilege/oauth"'</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"ADHUB_INIT_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¹¿å‘Šsdkåˆå§‹åŒ–id</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_SPLASH_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¼€å±å¹¿å‘Šid</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_BANNER_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// bannerå¹¿å‘Šid</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,      <span class="string">"SERVER_URL"</span>, <span class="string">'"http://xx.xxx.com/"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,        <span class="string">"LOGO_URL"</span>, <span class="string">'"http://file.xxx.com/img/xxx.png"'</span></span><br><span class="line"></span><br><span class="line">            manifestPlaceholders = [</span><br><span class="line"><span class="symbol">                    qq_id:</span> qq_id,</span><br><span class="line">                    <span class="string">JPUSH_PKGNAME :</span> applicationId,</span><br><span class="line">                    <span class="string">JPUSH_APPKEY :</span> <span class="string">"xxxxxx"</span>, <span class="comment">//JPush ä¸Šæ³¨å†Œçš„åŒ…åå¯¹åº”çš„ Appkey.</span></span><br><span class="line">                    <span class="string">JPUSH_CHANNEL :</span> <span class="string">"developer-default"</span>, <span class="comment">//æš‚æ—¶å¡«å†™é»˜è®¤å€¼å³å¯.</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        cuntuba &#123;</span><br><span class="line">            applicationId <span class="string">"com.xxx.xx"</span></span><br><span class="line">            versionCode <span class="number">1</span></span><br><span class="line">            versionName <span class="string">"1.0.0"</span></span><br><span class="line">            signingConfig = signingConfigs.cuntubaRelease</span><br><span class="line"></span><br><span class="line">            String qq_id = <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"QQ_ID"</span>, qq_id</span><br><span class="line">            buildConfigField <span class="string">"String"</span>,         <span class="string">"SINA_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"WX_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"UM_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,       <span class="string">"WX_SECRET"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"SINA_REDIRECT"</span>, <span class="string">'"http://open.weibo.com/apps/xxxxxx/privilege/oauth"'</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"ADHUB_INIT_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¹¿å‘Šsdkåˆå§‹åŒ–id</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_SPLASH_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¼€å±å¹¿å‘Šid</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_BANNER_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// bannerå¹¿å‘Šid</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,      <span class="string">"SERVER_URL"</span>, <span class="string">'"http://xxx.xxxx.com/"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,        <span class="string">"LOGO_URL"</span>, <span class="string">'"http://file.xxx.com/img/xxx.png"'</span></span><br><span class="line"></span><br><span class="line">            manifestPlaceholders = [</span><br><span class="line"><span class="symbol">                    qq_id:</span> qq_id,</span><br><span class="line">                    <span class="string">JPUSH_PKGNAME :</span> applicationId,</span><br><span class="line">                    <span class="string">JPUSH_APPKEY :</span> <span class="string">"xxxxxx"</span>, <span class="comment">//JPush ä¸Šæ³¨å†Œçš„åŒ…åå¯¹åº”çš„ Appkey.</span></span><br><span class="line">                    <span class="string">JPUSH_CHANNEL :</span> <span class="string">"developer-default"</span>, <span class="comment">//æš‚æ—¶å¡«å†™é»˜è®¤å€¼å³å¯.</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        xemh &#123;</span><br><span class="line">            applicationId <span class="string">"com.xxx.xx"</span></span><br><span class="line">            versionCode <span class="number">1</span></span><br><span class="line">            versionName <span class="string">"1.0.0"</span></span><br><span class="line">            signingConfig = signingConfigs.xemhRelease</span><br><span class="line"></span><br><span class="line">            String qq_id = <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"QQ_ID"</span>, qq_id</span><br><span class="line">            buildConfigField <span class="string">"String"</span>,         <span class="string">"SINA_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"WX_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,           <span class="string">"UM_ID"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,       <span class="string">"WX_SECRET"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"SINA_REDIRECT"</span>, <span class="string">'"xxxxxx"'</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,   <span class="string">"ADHUB_INIT_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¹¿å‘Šsdkåˆå§‹åŒ–id</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_SPLASH_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// å¼€å±å¹¿å‘Šid</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>, <span class="string">"ADHUB_BANNER_ID"</span>, <span class="string">'"xxxxxx"'</span> <span class="comment">// bannerå¹¿å‘Šid</span></span><br><span class="line"></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,      <span class="string">"SERVER_URL"</span>, <span class="string">'"http://xx.xxx.com/"'</span></span><br><span class="line">            buildConfigField <span class="string">"String"</span>,        <span class="string">"LOGO_URL"</span>, <span class="string">'"http://file.xxxxxx.com/img/xxxxxx.png"'</span></span><br><span class="line"></span><br><span class="line">            manifestPlaceholders = [</span><br><span class="line"><span class="symbol">                    qq_id:</span> qq_id,</span><br><span class="line">                    <span class="string">JPUSH_PKGNAME :</span> applicationId,</span><br><span class="line">                    <span class="string">JPUSH_APPKEY :</span> <span class="string">"xxxxxx"</span>, <span class="comment">//JPush ä¸Šæ³¨å†Œçš„åŒ…åå¯¹åº”çš„ Appkey.</span></span><br><span class="line">                    <span class="string">JPUSH_CHANNEL :</span> <span class="string">"developer-default"</span>, <span class="comment">//æš‚æ—¶å¡«å†™é»˜è®¤å€¼å³å¯.</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    applicationVariants.all &#123;</span><br><span class="line">        variant -&gt;</span><br><span class="line">            variant.outputs.all &#123;</span><br><span class="line">                outputFileName = <span class="string">"$&#123;variant.productFlavors[0].name&#125;-v$&#123;variant.productFlavors[0].versionName&#125;-$&#123;releaseTime()&#125;.apk"</span></span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            <span class="comment">// ä¸æ˜¾ç¤ºLog</span></span><br><span class="line">            buildConfigField <span class="string">"boolean"</span>, <span class="string">"LOG_DEBUG"</span>, <span class="string">"false"</span></span><br><span class="line">            signingConfig <span class="literal">null</span></span><br><span class="line">            minifyEnabled <span class="literal">true</span></span><br><span class="line">            zipAlignEnabled <span class="literal">true</span></span><br><span class="line">            <span class="comment">// ç§»é™¤æ— ç”¨çš„resourceæ–‡ä»¶</span></span><br><span class="line">            shrinkResources <span class="literal">true</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.pro'</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        debug &#123;</span><br><span class="line">            <span class="comment">// æ˜¾ç¤ºLog</span></span><br><span class="line">            buildConfigField <span class="string">"boolean"</span>, <span class="string">"LOG_DEBUG"</span>, <span class="string">"true"</span></span><br><span class="line">            signingConfig <span class="literal">null</span></span><br><span class="line">            minifyEnabled <span class="literal">false</span></span><br><span class="line">            zipAlignEnabled <span class="literal">false</span></span><br><span class="line">            shrinkResources <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    packagingOptions &#123;</span><br><span class="line">        exclude <span class="string">'META-INF/DEPENDENCIES.txt'</span></span><br><span class="line">        exclude <span class="string">'META-INF/NOTICE'</span></span><br><span class="line">        exclude <span class="string">'META-INF/NOTICE.txt'</span></span><br><span class="line">        exclude <span class="string">'META-INF/LICENSE'</span></span><br><span class="line">        exclude <span class="string">'META-INF/LICENSE.txt'</span></span><br><span class="line">    &#125;</span><br><span class="line">    compileOptions &#123;</span><br><span class="line">        targetCompatibility JavaVersion.VERSION_1_8</span><br><span class="line">        sourceCompatibility JavaVersion.VERSION_1_8</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dexOptions &#123;</span><br><span class="line"></span><br><span class="line">        javaMaxHeapSize <span class="string">"4g"</span> <span class="comment">//æ­¤å¤„å¯æ ¹æ®ç”µè„‘æœ¬èº«é…ç½® æ•°å€¼è¶Šå¤§ å½“ç„¶è¶Šå¿«</span></span><br><span class="line"></span><br><span class="line">        preDexLibraries = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">repositories &#123;</span><br><span class="line">    flatDir &#123;</span><br><span class="line">        dirs <span class="string">'libs'</span>, <span class="string">'../adpoymer/libs'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    implementation fileTree(<span class="string">include:</span> [<span class="string">'*.jar'</span>], <span class="string">dir:</span> <span class="string">'libs'</span>)</span><br><span class="line">    implementation <span class="string">"com.android.support:appcompat-v7:$supportLibraryVersion"</span></span><br><span class="line">    implementation <span class="string">"com.android.support:recyclerview-v7:$supportLibraryVersion"</span></span><br><span class="line">    implementation <span class="string">"com.android.support:support-v4:$supportLibraryVersion"</span></span><br><span class="line">    implementation <span class="string">"com.android.support:design:$supportLibraryVersion"</span></span><br><span class="line">    implementation <span class="string">"com.android.support.constraint:constraint-layout:$constraintVersion"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ·»åŠ retrofit2 çš„ä¾èµ– æ·»åŠ è¿™ä¸ªä¾èµ–å°±é»˜è®¤æ·»åŠ äº†okhttpä¾èµ–</span></span><br><span class="line">    compile <span class="string">"com.squareup.retrofit2:retrofit:$retrofit2Version"</span></span><br><span class="line">    compile <span class="string">"com.squareup.retrofit2:converter-gson:$retrofit2Version"</span></span><br><span class="line">    compile <span class="string">"com.squareup.retrofit2:adapter-rxjava2:$retrofit2Version"</span></span><br><span class="line">    compile <span class="string">"com.squareup.okhttp3:logging-interceptor:$okhttp3Version"</span></span><br><span class="line">    compile <span class="string">"com.jakewharton:butterknife:$butterknifeVersion"</span></span><br><span class="line">    annotationProcessor <span class="string">"com.jakewharton:butterknife-compiler:$butterknifeVersion"</span></span><br><span class="line">    compile <span class="string">"io.reactivex.rxjava2:rxandroid:$rx2Version"</span></span><br><span class="line">    compile <span class="string">"com.github.xujiaji:xmvp:$xmvpVersion"</span></span><br><span class="line">    implementation <span class="string">"com.github.autume:CircleProgressDialog:$CircleProgressDialogVersion"</span></span><br><span class="line">    compile <span class="string">"com.ogaclejapan.smarttablayout:library:$smarttabVersion"</span></span><br><span class="line">    compile <span class="string">"com.github.CymChad:BaseRecyclerViewAdapterHelper:$adapterHelperVersion"</span></span><br><span class="line"></span><br><span class="line">    compile <span class="string">"com.github.bumptech.glide:glide:$glideVersion"</span></span><br><span class="line">    annotationProcessor <span class="string">"com.github.bumptech.glide:compiler:$glideVersion"</span></span><br><span class="line"></span><br><span class="line">    compile <span class="string">"com.makeramen:roundedimageview:$roundedimageviewVersion"</span></span><br><span class="line">    compile <span class="string">"org.greenrobot:eventbus:$eventbusVersion"</span></span><br><span class="line">    annotationProcessor <span class="string">"com.github.hotchemi:permissionsdispatcher-processor:$dispatcherVersion"</span></span><br><span class="line">    compile <span class="string">"com.jaeger.statusbarutil:library:$statusbarutilVersion"</span></span><br><span class="line">    compile(<span class="string">"com.github.hotchemi:permissionsdispatcher:$dispatcherVersion"</span>) &#123;</span><br><span class="line">        exclude <span class="string">module:</span> <span class="string">"support-v13"</span></span><br><span class="line">    &#125;</span><br><span class="line">    implementation <span class="string">"com.github.LuckSiege.PictureSelector:picture_library:$picture_libraryVersion"</span></span><br><span class="line">    implementation <span class="string">'me.drakeet.library:crashwoodpecker:2.1.1'</span></span><br><span class="line">    implementation <span class="string">'com.github.chenupt.android:springindicator:1.0.2@aar'</span></span><br><span class="line">    debugImplementation <span class="string">'com.amitshekhar.android:debug-db:1.0.4'</span></span><br><span class="line">    implementation <span class="string">'com.umeng.sdk:common:1.5.3'</span></span><br><span class="line">    implementation <span class="string">'com.umeng.sdk:analytics:7.5.3'</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">'com.liulishuo.filedownloader:library:1.7.5'</span></span><br><span class="line"></span><br><span class="line">    implementation project(<span class="string">':banner'</span>)</span><br><span class="line">    implementation project(<span class="string">':xdialog'</span>)</span><br><span class="line">    implementation project(<span class="string">':shareutil'</span>)</span><br><span class="line">    implementation project(<span class="string">':update'</span>)</span><br><span class="line">    implementation project(<span class="string">':pay'</span>)</span><br><span class="line"><span class="comment">//    implementation project(':adhub')</span></span><br><span class="line">    implementation project(<span class="string">':imagewatcher'</span>)</span><br><span class="line">    implementation files(<span class="string">'libs/lite-orm-1.9.2.jar'</span>)</span><br><span class="line">    implementation <span class="string">'jp.wasabeef:blurry:2.1.1'</span></span><br><span class="line">    implementation <span class="string">"com.google.android:flexbox:$flexboxVersion"</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">'cn.jiguang.sdk:jpush:3.1.6'</span>  <span class="comment">// æ­¤å¤„ä»¥JPush 3.1.6 ç‰ˆæœ¬ä¸ºä¾‹ã€‚</span></span><br><span class="line">    implementation <span class="string">'cn.jiguang.sdk:jcore:1.2.5'</span>  <span class="comment">// æ­¤å¤„ä»¥JCore 1.2.5 ç‰ˆæœ¬ä¸ºä¾‹ã€‚</span></span><br><span class="line"></span><br><span class="line">    compile(<span class="string">name:</span> <span class="string">'sdk-release'</span>, <span class="string">ext:</span> <span class="string">'aar'</span>)</span><br><span class="line">    compile(<span class="string">name:</span> <span class="string">'open_ad_sdk'</span>, <span class="string">ext:</span> <span class="string">'aar'</span>)</span><br><span class="line">    compile(<span class="string">name:</span> <span class="string">'adpoymer-3.4.35'</span>, <span class="string">ext:</span> <span class="string">'aar'</span>)</span><br><span class="line">    implementation <span class="string">'pl.droidsonroids.gif:android-gif-drawable:1.0.+'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ol><h2 id="Demo-åœ°å€">Demo åœ°å€<a href="post/android-project-one-for-more#Demo-åœ°å€"></a></h2><p><a href="https://github.com/xujiaji/OneForAllApk" target="_blank" rel="noopener">https://github.com/xujiaji/OneForAllApk</a></p><h2 id="ç»“æŸ">ç»“æŸ<a href="post/android-project-one-for-more#ç»“æŸ"></a></h2><p>å°±è¿™æ ·å°±å¯ä»¥è§£æ”¾å¤§é‡åŠ³åŠ¨åŠ›å•¦ï¼æ¯æ¬¡é¡¹ç›®æ‰“åŒ…å„ç§è½¯ä»¶ï¼Œé€‰ä¸€ä¸‹å°±ojbkï¼Œå“ˆå“ˆå“ˆ~<br>å¦‚æœæœ‰äº›é…ç½®åœ¨å…¶ä»–æ¸ é“æ²¡æœ‰çš„ï¼Œä¹Ÿå¯é€šè¿‡BuildConfigåœ¨javaä¸­åˆ¤æ–­å¦‚æœæ˜¯æŸæŸæ¸ é“é‚£ä¹ˆå±è”½ã€‚<br>over</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ç®€ä»‹&quot;&gt;ç®€ä»‹&lt;a href=&quot;post/android-project-one-for-more#ç®€ä»‹&quot;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;å¦‚é¢˜æ‰€ç¤ºï¼æœ¬ç¯‡æ–‡ç« å°±æ˜¯ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ã€‚æ–¹ä¾¿æ‰“åŒ…å’Œè¿è¡Œçš„æ—¶å€™èƒ½åšåˆ°æ— éœ€æ‰‹åŠ¨æ›¿æ¢é…ç½®ï¼Œå³å¯æ‰“åŒ…æƒ³è¦çš„apkã€‚æ‰“åŒ…çš„æ—¶å€™ï¼Œåªéœ€é€‰ä¸€ä¸‹æƒ³æ‰“å“ª
      
    
    </summary>
    
      <category term="Android" scheme="https://blog.xujiaji.com/categories/Android/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="é¡¹ç›®é…ç½®" scheme="https://blog.xujiaji.com/tags/%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>XMVPï¼šä¸€ä¸ªé€šè¿‡æ³›å‹å®ç°çš„MVPæ¡†æ¶2å¹´çš„æ¼”åŒ–è·¯</title>
    <link href="https://blog.xujiaji.com/post/xmvp-framework/index.html"/>
    <id>https://blog.xujiaji.com/post/xmvp-framework/index.html</id>
    <published>2018-09-21T10:22:15.000Z</published>
    <updated>2019-04-08T06:57:05.292Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>XMVPæ¡†æ¶æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªæ¡†æ¶ï¼Œåˆšä»Androidèµ·æ­¥ç¬¬ä¸€æ¬¡äº†è§£MVPæ¨¡å¼æ—¶å†³å¿ƒå†™ä¸€ä¸ªè‡ªå·±çš„ä¸œè¥¿æ¡†æ¶ï¼Œåˆ°ç°åœ¨å·²è¿ç”¨åœ¨æˆ‘å†™çš„å¤šä¸ªé¡¹ç›®ä¸­ã€‚è™½ç„¶ä¸¤å¹´äº†ï¼Œä½†æ ¸å¿ƒçš„æ€è·¯æ²¡æœ‰æ”¹å˜ï¼Œåˆ°ç°åœ¨å˜æ¢ä¹Ÿä¸æ˜¯å¤ªå¤šï¼Œç²¾ç®€äº†ä¸€äº›ä»£ç ï¼Œæ·»åŠ äº†ä¸€äº›åŠŸèƒ½ã€‚</p></blockquote><a id="more"></a><h2 id="èµ·æ­¥2016">èµ·æ­¥2016<a href="post/xmvp-framework#èµ·æ­¥2016"></a></h2><p>è¿™æ˜¯ä¸ªåˆšå‡ºç¤¾ä¼šæ‰¾å·¥ä½œç—›è‹¦çš„æ—¶æœŸï¼Œæˆ‘ä¸ªäººä¸å¤ªå–œæ¬¢ç”Ÿæ´»ä¸­éº»çƒ¦çš„äº‹æƒ…ã€‚å®‰é™æ˜¯æˆ‘çš„æœ¬æ€§ï¼Œäºæ˜¯æƒ³å†™ä¸ªå±äºè‡ªå·±çš„æ¡†æ¶ï¼Œä¸ºæœªæ¥åšäº›é“ºå«ã€‚äºæ˜¯ï¼Œä¾¿æœ‰äº†XMVPï¼Œåå­—â€œXâ€æ˜¯è‡­ä¸è¦è„¸çš„åŠ ä¸Šäº†è‡ªå·±åå­—çš„å¼€å¤´å­—æ¯ã€‚</p><h4 id="ç›®æ ‡">ç›®æ ‡<a href="post/xmvp-framework#ç›®æ ‡"></a></h4><p><strong>è¯¥æ¡†æ¶çš„ç›®æ ‡å¾ˆç®€å•ï¼Œä¸ºäº†çœæ‰Viewã€Modelã€Presenterå±‚ä¹‹é—´çš„ä¾èµ–å®ç°è¿‡ç¨‹ï¼Œé€šè¿‡ç®€å•çš„é…ç½®ï¼Œæ¡†æ¶è‡ªåŠ¨å®ç°ä¾èµ–å…³ç³»</strong></p><p>å®ç°çš„åŸç†ï¼šè·å–é…ç½®çš„æ³›å‹ç±»å‹ï¼Œé€šè¿‡åå°„å®ä¾‹åŒ–På±‚å’ŒMå±‚ã€‚</p><h4 id="ä»£ç ">ä»£ç <a href="post/xmvp-framework#ä»£ç "></a></h4><p><strong>1.</strong> å…³é”®èƒ½è®©æˆ‘å¼€å§‹åšè¿™ä¸ªæ¡†æ¶çš„æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><blockquote><p>ä¼ å…¥å¯¹è±¡çš„Classå’Œéœ€è¦è¿‡æ»¤æ³›å‹å¾—çš„åŒ¹é…çš„å¯¹è±¡ï¼Œç„¶åéå†<code>klass</code>ä¸­é…ç½®çš„æ³›å‹åˆ¤æ–­æ˜¯ä¸æ˜¯<code>filterClass</code>çš„å­ç±»ï¼Œå¦‚æœæ˜¯åˆ™æ‰¾åˆ°äº†é…ç½®çš„æ³›å‹ç±»å‹ã€‚</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">Class&lt;T&gt; <span class="title">getGenericClass</span><span class="params">(Class&lt;?&gt; klass, Class&lt;?&gt; filterClass)</span> </span>&#123;</span><br><span class="line">    Type type = klass.getGenericSuperclass(); <span class="comment">// è·å–çˆ¶ç±»Classç±»å‹ï¼Œå®ƒåŒ…å«äº†æ‰€é…ç½®çš„æ³›å‹ç±»å‹</span></span><br><span class="line">    <span class="keyword">if</span> (type == <span class="keyword">null</span> || !(type <span class="keyword">instanceof</span> ParameterizedType)) <span class="keyword">return</span> <span class="keyword">null</span>; <span class="comment">// åˆ¤æ–­æ˜¯å¦æ˜¯æ³›å‹ç±»å‹</span></span><br><span class="line">    ParameterizedType parameterizedType = (ParameterizedType) type;</span><br><span class="line">    Type[] types = parameterizedType.getActualTypeArguments(); <span class="comment">// ç”±äºä¸€ä¸ªç±»å¯èƒ½ä¸æ­¢é…ç½®äº†ä¸€ä¸ªæ³›å‹ï¼Œè·å–è¯¥å¯¹è±¡æ‰€æœ‰æ³›å‹ç±»å‹</span></span><br><span class="line">    <span class="keyword">for</span> (Type t : types) &#123;</span><br><span class="line">        Class&lt;T&gt; tClass = (Class&lt;T&gt;) t;</span><br><span class="line">        <span class="keyword">if</span> (filterClass.isAssignableFrom(tClass)) &#123; <span class="comment">// é€šè¿‡filterClassæ‰¾åˆ°éœ€è¦çš„ç›®æ ‡ç±»å‹</span></span><br><span class="line">            <span class="keyword">return</span> tClass;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>2.</strong> ä½¿ç”¨ä¹Ÿéå¸¸ç®€å•ï¼Œç²¾ç®€ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œ4æ­¥é…ç½®å°±å®ç°äº†MVP</p><ul><li>é¦–å…ˆå®šä¹‰å¥‘çº¦ï¼ˆContractï¼‰ï¼Œå®šä¹‰Viewã€Modelã€Presenterçš„æ¥å£ï¼Œå¹¶ä¸”éƒ½éœ€è¦ç»§æ‰¿è‡ª<code>XContract</code></li><li>åˆ›å»ºModelå®ç°ç±»</li><li>åˆ›å»ºPresenterå®ç°ç±»ç»§æ‰¿<code>XBasePresenter</code>ï¼Œæ³›å‹ä¸­å…³è”Viewæ¥å£å’ŒModelå®ç°ç±»</li><li>åˆ›å»ºViewå®ç°ç±»ç»§æ‰¿<code>XBaseActivity</code>æˆ–å…¶å­ç±»ï¼Œæ³›å‹ä¸­å…³è”Presenterå®ç°ç±»</li></ul><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¥‘çº¦</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HomeContract</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Presenter</span> <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">Presenter</span></span>&#123;&#125;</span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">View</span> <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">View</span></span>&#123;&#125;</span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Model</span> <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">Model</span> </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Må±‚å®ç°</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeModel</span> <span class="keyword">implements</span> <span class="title">HomeContract</span>.<span class="title">Model</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// På±‚å®ç°</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomePresenter</span></span></span><br><span class="line"><span class="class">  <span class="keyword">extends</span> <span class="title">XBasePresenter</span>&lt;<span class="title">HomeContract</span>.<span class="title">View</span>, <span class="title">HomeModel</span>&gt;</span></span><br><span class="line"><span class="class">  <span class="keyword">implements</span> <span class="title">HomeContract</span>.<span class="title">Presenter</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Vå±‚å®ç°</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeActivity</span></span></span><br><span class="line"><span class="class">  <span class="keyword">extends</span> <span class="title">XBaseActivity</span>&lt;<span class="title">HomePresenter</span>&gt;</span></span><br><span class="line"><span class="class">  <span class="keyword">implements</span> <span class="title">HomeContract</span>.<span class="title">View</span> </span>&#123;&#125;</span><br></pre></td></tr></table></div></figure><p><strong>3.</strong> æœ€åˆXMVPæ¡†æ¶åšå‡ºæ—¶å†™çš„ä¸€ç¯‡æ–‡ç«  <a href="https://www.jianshu.com/p/7c71c0d6c150" target="_blank" rel="noopener">å°äº†ä¸€ä¸ªAndroid MVPæ¡†æ¶ï¼Œå°±å«XMVPå§ï¼</a></p><hr><blockquote><p>å°±è¿™æ ·ï¼Œç¬¬ä¸€é˜¶æ®µå®£å‘Šå®Œæ¯•ï¼Œç„¶åå°±æ˜¯ä¼˜åŒ–å’Œä¿®å¤ä¸€äº›bugï¼Œå½“ç„¶ä¸Šé¢çš„<code>getGenericClass</code>è¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯åæœŸä¼˜åŒ–è¿‡çš„ç»“æœã€‚</p></blockquote><h2 id="æƒ³å·æ‡’äº†å°±å¼€å‘äº†MVPManageræ’ä»¶ï¼Œå¿«é€Ÿç”ŸæˆXMVPä»£ç ">æƒ³å·æ‡’äº†å°±å¼€å‘äº†<code>MVPManager</code>æ’ä»¶ï¼Œå¿«é€Ÿç”Ÿæˆ<code>XMVP</code>ä»£ç <a href="post/xmvp-framework#æƒ³å·æ‡’äº†å°±å¼€å‘äº†MVPManageræ’ä»¶ï¼Œå¿«é€Ÿç”ŸæˆXMVPä»£ç "></a></h2><p><img src="https://raw.githubusercontent.com/xujiaji/MVPManager/master/display/banner.png" alt=""><br>ä¹Ÿå°±æ˜¯<code>XMVP</code>æ¡†æ¶å¼€å‘å‡ºæ¥ä¹Ÿå°±1ä¸ªæœˆä¹‹å†…çš„äº‹æƒ…å§ï¼è¿™æ—¶æ„Ÿè§‰å†™å¥‘çº¦ï¼ˆContractï¼‰ï¼Œå†™<code>XMVP</code>å„ä¸ªå®ç°ç±»ï¼Œéƒ½æ˜¯é‡å¤çš„åŠ³åŠ¨åŠ›ï¼Œæ¯ä¸€ä¸ªæ–°çš„ç•Œé¢å°±å¾—å»åˆ›å»ºè¿™ä¹ˆäº›æ–‡ä»¶å¤ªè¿‡è¾›è‹¦ã€‚ç»“æœè™½ç„¶å˜å¾—æœ‰æ¡ç†æœ‰æ¨¡å—ï¼Œä½†æ˜¯å·¥ä½œé‡æœ‰äº›é‡å¤å’Œå¢åŠ ï¼Œæœ‰äº›æ—¶å€™é…ç½®æ³›å‹å¿˜äº†è¿˜éœ€è¦çœ‹ä¹‹å‰æ˜¯æ€ä¹ˆé…ç½®çš„ã€‚</p><p>å½“æ—¶å…¶å®ä¹Ÿæœ‰åˆ›å»ºMVPæ–‡ä»¶çš„æ’ä»¶ä¹‹ç±»çš„ä¸œè¥¿ï¼Œä½†æ˜¯ä¸ç¬¦åˆ<code>XMVP</code>çš„å®æƒ…ï¼Œæ³›å‹è¿˜æ˜¯å¾—è‡ªå·±åŠ¨æ‰‹ï¼Œäºæ˜¯å†³å¿ƒè‡ªå·±å†™ä¸€ä¸ª<code>intellij</code>æ’ä»¶ï¼Œå½“ç„¶åœ¨<code>AS</code>ä¸­ä¹Ÿèƒ½ä½¿ç”¨ã€‚</p><h4 id="åˆ›å»ºMVPä»£ç æˆªå›¾ï¼Œè¿™æ˜¯æœ€æ–°çš„åˆ›å»ºä»£ç ç•Œé¢çš„æˆªå›¾">åˆ›å»ºMVPä»£ç æˆªå›¾ï¼Œè¿™æ˜¯æœ€æ–°çš„åˆ›å»ºä»£ç ç•Œé¢çš„æˆªå›¾<a href="post/xmvp-framework#åˆ›å»ºMVPä»£ç æˆªå›¾ï¼Œè¿™æ˜¯æœ€æ–°çš„åˆ›å»ºä»£ç ç•Œé¢çš„æˆªå›¾"></a></h4><blockquote><p>åœ¨1.0çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†å¯å°†åŒä¸€ä¸ªæ¨¡å—æ”¾ä¸€ä¸ªåŒ…ä¸­æˆ–å°†MVPåˆ†åœ¨å¯¹åº”çš„åŒ…ä¸­çš„é€‰é¡¹ï¼›å¢åŠ äº†å¯ä»¥ä¸æ˜¯XMVPæ¡†æ¶çš„æƒ…å†µä¸‹ä½¿ç”¨</p></blockquote><p><img src="https://github.com/xujiaji/MVPManager/raw/master/display/update_2_0_0.png" alt="" class="article-img"></p><h4 id="è¿™æ˜¯ä¸€å¼ åŠ¨æ€å›¾ï¼Œæ˜¯ä¸€å¼ æ—§ç‰ˆæœ¬çš„æ¼”ç¤ºå›¾ã€‚åªéœ€è¦å’Œä¸Šé¢çš„æˆªå›¾ç»“åˆæ¥çœ‹ä¸€ä¸‹å“¦">è¿™æ˜¯ä¸€å¼ åŠ¨æ€å›¾ï¼Œæ˜¯ä¸€å¼ æ—§ç‰ˆæœ¬çš„æ¼”ç¤ºå›¾ã€‚åªéœ€è¦å’Œä¸Šé¢çš„æˆªå›¾ç»“åˆæ¥çœ‹ä¸€ä¸‹å“¦<a href="post/xmvp-framework#è¿™æ˜¯ä¸€å¼ åŠ¨æ€å›¾ï¼Œæ˜¯ä¸€å¼ æ—§ç‰ˆæœ¬çš„æ¼”ç¤ºå›¾ã€‚åªéœ€è¦å’Œä¸Šé¢çš„æˆªå›¾ç»“åˆæ¥çœ‹ä¸€ä¸‹å“¦"></a></h4><p><img src="https://github.com/xujiaji/MVPManager/raw/master/display/edit_MVPManager.gif" alt="" class="article-img"></p><h4 id="æœ€åè¿˜æœ‰ä¸ªé€†å‘å¢åŠ æˆ–åˆ é™¤XMVPå¥‘çº¦ä¸­å®šä¹‰æ–¹æ³•çš„åŠŸèƒ½">æœ€åè¿˜æœ‰ä¸ªé€†å‘å¢åŠ æˆ–åˆ é™¤XMVPå¥‘çº¦ä¸­å®šä¹‰æ–¹æ³•çš„åŠŸèƒ½<a href="post/xmvp-framework#æœ€åè¿˜æœ‰ä¸ªé€†å‘å¢åŠ æˆ–åˆ é™¤XMVPå¥‘çº¦ä¸­å®šä¹‰æ–¹æ³•çš„åŠŸèƒ½"></a></h4><blockquote><p>ä¼šåŒæ—¶æ›´æ–°å®ç°ç±»çš„æ–¹æ³•ï¼Œæœ¬äººæ˜¯å†™å‡ºè¿™ä¸ªåŠŸèƒ½ï¼Œä½†å‡ ä¹ä¸ç”¨çš„å•¦</p></blockquote><p><img src="https://github.com/xujiaji/MVPManager/raw/master/display/open_change_MVPManager.gif" alt="" class="article-img"></p><h4 id="åˆšåˆšå¼€å‘å‡ºæ¥MVPManagerçš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿå†™äº†ç¯‡æ–‡ç« ä»‹ç»-è¿™ä¸ªASæ’ä»¶èƒ½å¸®ä½ å¿«é€Ÿç®¡ç†MVP">åˆšåˆšå¼€å‘å‡ºæ¥MVPManagerçš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿå†™äº†ç¯‡æ–‡ç« ä»‹ç» <a href="https://www.jianshu.com/p/5d528019a76b" target="_blank" rel="noopener">è¿™ä¸ªASæ’ä»¶èƒ½å¸®ä½ å¿«é€Ÿç®¡ç†MVP</a><a href="post/xmvp-framework#åˆšåˆšå¼€å‘å‡ºæ¥MVPManagerçš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿå†™äº†ç¯‡æ–‡ç« ä»‹ç»-è¿™ä¸ªASæ’ä»¶èƒ½å¸®ä½ å¿«é€Ÿç®¡ç†MVP"></a></h4><hr><blockquote><p>å°±è¿™æ ·ï¼Œç¬¬äºŒé˜¶æ®µç»“æŸäº†ã€‚å…¶ä¸»è¦ç›®çš„å°±æ˜¯ä¸ºäº†è§£å†³MVPé‡å¤é€»è¾‘çš„ä»£ç é‡é—®é¢˜</p></blockquote><h2 id="å®è·µä¸­çš„æ›´æ–°">å®è·µä¸­çš„æ›´æ–°<a href="post/xmvp-framework#å®è·µä¸­çš„æ›´æ–°"></a></h2><p>åœ¨ä¸æ–­çš„å®è·µè¿ç”¨ä¸­ä¹Ÿå‘ç°äº†å¾ˆå¤šæ²¡æœ‰è€ƒè™‘åˆ°æˆ–è€…å¿½ç•¥çš„é—®é¢˜ï¼Œå…¶ä¸­æœ€æ˜ åƒæ·±åˆ»çš„ä¸è¿‡äºæœ‰æ¬¡ä¸Šçº¿åº”ç”¨çš„æ—¶å€™ï¼Œæ··æ·†å±…ç„¶ä¼šå¯¼è‡´æ— æ³•åˆ›å»ºPresenterç†¬å¤œæ‰¾äº†å¾ˆä¹…ã€‚</p><p>è¿˜æœ‰å°±æ˜¯å¿½ç•¥äº†Fragmentæœ‰appåŒ…å’Œv4åŒ…ä¸¤ä¸ªåœ°æ–¹ï¼Œæ¡†æ¶ä¸­åªå†™äº†ä¸€ä¸ªï¼Œè€ƒè™‘çš„éƒ½æ¯”è¾ƒç‰‡é¢ã€‚</p><p>åªæœ‰åœ¨å®è·µä¸­æ‰èƒ½çœŸæ­£çš„è€ƒéªŒï¼Œä¸€ç›´ä»¥æ¥å¤§æ¦‚å°±æˆ‘å’Œå°‘æ•°çš„å°ä¼™ä¼´åœ¨ä½¿ç”¨ã€‚è™½ç„¶ç”¨çš„æ¯”è¾ƒå°‘ï¼Œä½†æ˜¯å†™å‡ºæ¥åå°±è¦å¯¹å®ƒè´Ÿè´£å˜›ï¼</p><h4 id="ä½¿ç”¨ä¸­çš„ä¸€äº›ä¸ªäººæŠ€å·§">ä½¿ç”¨ä¸­çš„ä¸€äº›ä¸ªäººæŠ€å·§<a href="post/xmvp-framework#ä½¿ç”¨ä¸­çš„ä¸€äº›ä¸ªäººæŠ€å·§"></a></h4><p><strong>1.</strong> å¾ˆå¤šæ—¶å€™ï¼ŒActivityå’ŒPresenterï¼Œæ›´æˆ–è€…Modeléƒ½æœ‰å…±ç”¨çš„åœ°æ–¹ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦ä½œå‡ºæå–æŠ½è±¡ã€‚äºæ˜¯æˆ‘ä»¬å°±éœ€è¦ç»§æ‰¿<code>XBaseActivity</code>ã€<code>XBaseFragment</code>ã€<code>XBasePresenter</code>å†åšä¸€å±‚æŠ½è±¡ï¼Œè¿™æ ·å¦‚æœä»¥åä¸æƒ³ç”¨<code>XMVP</code>æ¡†æ¶æœ‰æ›´å¥½çš„é€‰æ‹©ä¹Ÿæ›´å¥½æ›¿æ¢å“ˆã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><blockquote><p>BaseActivity.java</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseActivity</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">XBasePresenter</span>&gt; <span class="keyword">extends</span> <span class="title">XBaseActivity</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onInitCircle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onInitCircle();</span><br><span class="line">    ButterKnife.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>BasePresenter.java</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BasePresenter</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">View</span>, <span class="title">E</span> <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">Model</span>&gt; <span class="keyword">extends</span> <span class="title">XBasePresenter</span>&lt;<span class="title">T</span>, <span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> CompositeDisposable mCompositeDisposable;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">end</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.end();</span><br><span class="line">        <span class="keyword">if</span> (mCompositeDisposable != <span class="keyword">null</span>) &#123;</span><br><span class="line">            mCompositeDisposable.clear();</span><br><span class="line">            mCompositeDisposable = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>å‘ä¸Šé¢è¿™æ ·ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¸­é—´å±‚ï¼Œå¤„ç†ä¸€äº›æˆ‘ä»¬éœ€è¦ç»Ÿä¸€è°ƒç”¨çš„æˆ–å¤„ç†çš„ä¸€äº›ä¸œè¥¿</p><p><strong>2.</strong> å¯¹äºPresenterå›è°ƒModelå¤„ç†åè¿”å›çš„æ•°æ®ç›‘å¬ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªé€šç”¨ç›‘å¬æ¥å£ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">GenericListener</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">success</span><span class="params">(T t)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">error</span><span class="params">(<span class="keyword">int</span> code, String err)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>å¹¶ä¸”ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ªæ¥å£è¿›è¡Œå®ç°ï¼Œæˆ‘ä»¬å¯ä»¥ç»Ÿä¸€å¯¹é”™è¯¯ä¿¡æ¯åšäº›æç¤ºæˆ–å¤„ç†</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericListenerImp</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">GenericListener</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">GenericListenerImp</span><span class="params">(<span class="comment">/*å¯ä»¥ä¼ å…¥è¿›æ¥base viewæˆ–base presenterï¼Œå¦‚æœæœ‰é”™è¯¯å¯ä»¥è°ƒç”¨å¯¹åº”æ–¹æ³•ç»Ÿä¸€å¤„ç†*/</span>)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">error</span><span class="params">(<span class="keyword">int</span> code, String err)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¯¹é”™è¯¯åšå‡ºç»Ÿä¸€å¤„ç†</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>3.</strong> æˆ‘ä»¬æœ€å¸¸ç”¨çš„å°±æ˜¯åˆ·æ–°åŠ è½½åˆ—è¡¨äº†ï¼Œå‡ ä¹æ‰€æœ‰appä¸­éƒ½éœ€è¦ï¼Œå¹¶ä¸”åœ¨åŒä¸€ä¸ªåº”ç”¨ä¸­çš„åŠ è½½é€»è¾‘éƒ½æ˜¯ä¸€æ ·çš„ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥å°†å…¶æŠ½è±¡å‡ºæ¥ï¼Œä½¿ç”¨çš„æ—¶å€™ä¼šéå¸¸æ–¹ä¾¿ã€‚</p><blockquote><p>é¦–å…ˆå®šä¹‰ä¸€ä¸ªåŸºç¡€åˆ·æ–°å¥‘çº¦ï¼Œæ¯ä¸€ä¸ªæœ‰åˆ·æ–°çš„viewçš„æ¥å£éƒ½ç›´æ¥ä»è¿™é‡Œç»§æ‰¿</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BaseRefreshContract</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Presenter</span> <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">Presenter</span> </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * è¯·æ±‚æ•°æ®</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">requestLoadListData</span><span class="params">(<span class="keyword">int</span> page)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * è¯·æ±‚æ›´æ–°åˆ—è¡¨æ•°æ®</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">requestUpdateListData</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">View</span> &lt;<span class="title">X</span>&gt; <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">View</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ›´æ–°åˆ—è¡¨æˆåŠŸ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">updateListSuccess</span><span class="params">(List&lt;X&gt; datas, <span class="keyword">boolean</span> isEnd)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ›´æ–°å¤±è´¥</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">updateListFail</span><span class="params">(String err)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * åŠ è½½æ•°æ®æˆåŠŸ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">loadListDataSuccess</span><span class="params">(List&lt;X&gt; datas, <span class="keyword">int</span> currentPage, <span class="keyword">boolean</span> isEnd)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * åŠ è½½æ•°æ®å¤±è´¥</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> err</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">loadListDataFail</span><span class="params">(String err)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ•°æ®å·²ç»è¢«åŠ è½½å®Œ</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">loadListDateOver</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ç„¶åæŠ½è±¡Viewï¼Œè¿™é‡Œä»¥Activityä¸ºä¾‹ï¼ŒFragmentä¸€è‡´ã€‚æˆ‘ä½¿ç”¨äº†<code>SwipeRefreshLayout</code>ä½œä¸ºåˆ·æ–°ï¼Œ<code>BaseRecyclerViewAdapterHelper</code>å¤„ç†å¡«å……æ•°æ®å’ŒåŠ è½½æ•°æ®</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseRefreshActivity</span>&lt;<span class="title">E</span> ,<span class="title">X</span> <span class="keyword">extends</span> <span class="title">BaseQuickAdapter</span>&lt;<span class="title">E</span>, <span class="title">BaseViewHolder</span>&gt;, <span class="title">T</span> <span class="keyword">extends</span> <span class="title">XBasePresenter</span>&gt; <span class="keyword">extends</span> <span class="title">BaseActivity</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span></span></span><br><span class="line"><span class="class">        <span class="title">BaseRefreshContract</span>.<span class="title">View</span>&lt;<span class="title">E</span>&gt;,</span></span><br><span class="line"><span class="class">        <span class="title">BaseQuickAdapter</span>.<span class="title">RequestLoadMoreListener</span>,</span></span><br><span class="line"><span class="class">        <span class="title">SwipeRefreshLayout</span>.<span class="title">OnRefreshListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> currentPage;<span class="comment">//å½“å‰çš„é¡µé¢</span></span><br><span class="line">    <span class="keyword">protected</span> X mAdapter;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">boolean</span> isEnd;</span><br><span class="line">    <span class="keyword">protected</span> SwipeRefreshLayout swipeLayout;</span><br><span class="line">    <span class="keyword">protected</span> RecyclerView mRecyclerView;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onInitCircle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onInitCircle();</span><br><span class="line">        mAdapter = getAdapter();</span><br><span class="line">        mRecyclerView = getRecyclerView();</span><br><span class="line">        swipeLayout = getSwipeLayout();</span><br><span class="line">        swipeLayout.setOnRefreshListener(<span class="keyword">this</span>);</span><br><span class="line">        mAdapter.setOnLoadMoreListener(<span class="keyword">this</span>, mRecyclerView);</span><br><span class="line">        mRecyclerView.setAdapter(mAdapter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> X <span class="title">getAdapter</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> SwipeRefreshLayout <span class="title">getSwipeLayout</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> RecyclerView <span class="title">getRecyclerView</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°åˆ—è¡¨æˆåŠŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateListSuccess</span><span class="params">(List&lt;E&gt; datas, <span class="keyword">boolean</span> isEnd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.isEnd = isEnd;</span><br><span class="line">        currentPage = <span class="number">1</span>;</span><br><span class="line">        mAdapter.setNewData(datas);</span><br><span class="line">        swipeLayout.setRefreshing(<span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (isEnd) &#123;</span><br><span class="line">            loadListDateOver();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            mAdapter.setEnableLoadMore(<span class="keyword">true</span>);</span><br><span class="line">            mAdapter.loadMoreComplete();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°å¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateListFail</span><span class="params">(String err)</span> </span>&#123;</span><br><span class="line">        swipeLayout.setRefreshing(<span class="keyword">false</span>);</span><br><span class="line">        mAdapter.setEnableLoadMore(<span class="keyword">true</span>);</span><br><span class="line">        ToastUtil.getInstance().showLongT(err);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ è½½æ•°æ®æˆåŠŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadListDataSuccess</span><span class="params">(List&lt;E&gt; datas, <span class="keyword">int</span> currentPage, <span class="keyword">boolean</span> isEnd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.currentPage = currentPage;</span><br><span class="line">        <span class="keyword">this</span>.isEnd = isEnd;</span><br><span class="line">        mAdapter.addData(datas);</span><br><span class="line">        swipeLayout.setEnabled(<span class="keyword">true</span>);</span><br><span class="line">        mAdapter.loadMoreComplete();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ è½½æ•°æ®å¤±è´¥</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> err</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadListDataFail</span><span class="params">(String err)</span> </span>&#123;</span><br><span class="line">        swipeLayout.setEnabled(<span class="keyword">true</span>);</span><br><span class="line">        mAdapter.loadMoreFail();</span><br><span class="line">        ToastUtil.getInstance().showLongT(err);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®å·²ç»è¢«åŠ è½½å®Œ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadListDateOver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mAdapter.loadMoreEnd();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRefresh</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!swipeLayout.isRefreshing())</span><br><span class="line">        &#123;</span><br><span class="line">            swipeLayout.setRefreshing(<span class="keyword">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        getPresenter().requestUpdateListData();</span><br><span class="line">        mAdapter.setEnableLoadMore(<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLoadMoreRequested</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (isEnd) &#123;</span><br><span class="line">            loadListDateOver();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        swipeLayout.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">        getPresenter().requestLoadListData(++currentPage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> BaseRefreshContract.<span class="function">Presenter <span class="title">getPresenter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (presenter <span class="keyword">instanceof</span> BaseRefreshContract.Presenter) &#123;</span><br><span class="line">            <span class="keyword">return</span>  (BaseRefreshContract.Presenter) presenter;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"presenter please extends BaseRefreshContract.Presenter"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ä½¿ç”¨ï¼šå®šä¹‰ä¸€ä¸ªåˆ—è¡¨é¡µé¢çš„å¥‘çº¦</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleDetailContract</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">View</span> <span class="keyword">extends</span> <span class="title">BaseRefreshContract</span>.<span class="title">View</span>&lt;<span class="title">CircleMsgEntity</span>.<span class="title">CommentBean</span>&gt; </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Presenter</span> <span class="keyword">extends</span> <span class="title">BaseRefreshContract</span>.<span class="title">Presenter</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Model</span> <span class="keyword">extends</span> <span class="title">XContract</span>.<span class="title">Model</span> </span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">void</span> <span class="title">catArticleDetails</span><span class="params">(<span class="keyword">int</span> articleId, <span class="keyword">int</span> page, CompositeDisposable cd, NetRequestListener&lt;Result&lt;CircleMsgEntity&gt;&gt; listener)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ä½¿ç”¨ï¼šViewå®ç°å±‚ï¼Œç”±äºè¿™æ˜¯ä¸€ä¸ªå…¬å¸é¡¹ç›®ä¸­çš„ç±»ï¼Œçœç•¥çš„æ‰€æœ‰çš„æ— å…³ä»£ç <br><code>CircleMsgEntity.CommentBean</code> æ˜¯ä¸€ä¸ªAdapter(ArticleCommentAdapter)å¡«å……çš„å®ä½“ç±»<br><code>ArticleCommentAdapter</code> æ˜¯ä¸€ä¸ªç»§æ‰¿BaseRecyclerViewAdapterHelperæ¡†æ¶ä¸­çš„<code>BaseQuickAdapter</code>çš„ç±»ï¼Œå¹¶ä¸”è¯¥ç±»æ˜¯è¿™æ ·çš„ï¼š<code>public class ArticleCommentAdapter extends BaseQuickAdapter&lt;CircleMsgEntity.CommentBean, BaseViewHolder&gt;</code> å¿…é¡»ä¿è¯Activityç¬¬ä¸€ä¸ªæ³›å‹å’ŒAdapterçš„ç¬¬ä¸€ä¸ªæ³›å‹ç±»å‹ä¸€è‡´</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleDetailActivity</span> <span class="keyword">extends</span> <span class="title">BaseRefreshActivity</span>&lt;<span class="title">CircleMsgEntity</span>.<span class="title">CommentBean</span>, <span class="title">ArticleCommentAdapter</span>, <span class="title">ArticleDetailPresenter</span>&gt; <span class="keyword">implements</span> <span class="title">ArticleDetailContract</span>.<span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="meta">@BindView</span>(R.id.recycler)</span><br><span class="line">    RecyclerView recycler;</span><br><span class="line">    <span class="meta">@BindView</span>(R.id.refresh)</span><br><span class="line">    SwipeRefreshLayout refresh;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onInitCircle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onInitCircle();</span><br><span class="line">        onRefresh();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">layoutId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> R.layout.activity_article_detail;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> ArticleCommentAdapter <span class="title">getAdapter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArticleCommentAdapter(ArticleCommentAdapter.TYPE_NORMAL);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> SwipeRefreshLayout <span class="title">getSwipeLayout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        refresh.setColorSchemeResources(R.color.yellow);</span><br><span class="line">        <span class="keyword">return</span> refresh;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> RecyclerView <span class="title">getRecyclerView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        recycler.setLayoutManager(<span class="keyword">new</span> LinearLayoutManager(<span class="keyword">this</span>));</span><br><span class="line">        <span class="keyword">return</span> recycler;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ä½¿ç”¨ï¼š Presenterå®ç°å±‚</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleDetailPresenter</span> <span class="keyword">extends</span> <span class="title">BasePresenter</span>&lt;<span class="title">ArticleDetailContract</span>.<span class="title">View</span>,<span class="title">ArticleDetailModel</span>&gt; <span class="keyword">implements</span> <span class="title">ArticleDetailContract</span>.<span class="title">Presenter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.start();</span><br><span class="line">        mCompositeDisposable = <span class="keyword">new</span> CompositeDisposable();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestLoadListData</span><span class="params">(<span class="keyword">int</span> page)</span> </span>&#123;</span><br><span class="line">        model.catArticleDetails(view.getArticleId(), page, mCompositeDisposable, <span class="keyword">new</span> NetRequestListener&lt;Result&lt;CircleMsgEntity&gt;&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">success</span><span class="params">(Result&lt;CircleMsgEntity&gt; circleMsgEntityResult)</span> </span>&#123;</span><br><span class="line">                ResultListBean&lt;List&lt;CircleMsgEntity.CommentBean&gt;&gt; resultListBean = circleMsgEntityResult.getData().getCommentList();</span><br><span class="line">                view.loadListDataSuccess(resultListBean.getList(), resultListBean.getPage(), resultListBean.getPage() &gt;= resultListBean.getPagecount());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">error</span><span class="params">(String err)</span> </span>&#123;</span><br><span class="line">                view.loadListDataFail(err);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestUpdateListData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        model.catArticleDetails(view.getArticleId(), <span class="number">1</span>, mCompositeDisposable, <span class="keyword">new</span> NetRequestListener&lt;Result&lt;CircleMsgEntity&gt;&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">success</span><span class="params">(Result&lt;CircleMsgEntity&gt; circleMsgEntityResult)</span> </span>&#123;</span><br><span class="line">                ResultListBean&lt;List&lt;CircleMsgEntity.CommentBean&gt;&gt; resultListBean = circleMsgEntityResult.getData().getCommentList();</span><br><span class="line">                view.updateListSuccess(resultListBean.getList(), resultListBean.getPage() &gt;= resultListBean.getPagecount());</span><br><span class="line">                view.displayArticleDetail(circleMsgEntityResult.getData());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">error</span><span class="params">(String err)</span> </span>&#123;</span><br><span class="line">                view.updateListFail(err);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>Modelå±‚ï¼Œå»è¯·æ±‚åˆ—è¡¨æ•°æ®</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArticleDetailModel</span> <span class="keyword">implements</span> <span class="title">ArticleDetailContract</span>.<span class="title">Model</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">catArticleDetails</span><span class="params">(<span class="keyword">int</span> articleId, <span class="keyword">int</span> page, CompositeDisposable cd, NetRequestListener&lt;Result&lt;CircleMsgEntity&gt;&gt; listener)</span> </span>&#123;</span><br><span class="line">        Observer&lt;Result&lt;CircleMsgEntity&gt;&gt; observer = ModelHelper.getObserver(cd, listener, <span class="keyword">true</span>); <span class="comment">// å¯¹rxjavaè¿”å›çš„æ•°æ®è¿›è¡Œç»Ÿä¸€å¤„ç†</span></span><br><span class="line">        Http.getInstance().getArticleDetails(articleId, page, observer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸æ–­çš„å¤ç”¨<code>BaseRefreshActivity</code>ã€<code>ArticleDetailContract</code>æ¥è®©åˆ·æ–°åŠ è½½ç»Ÿä¸€ï¼Œå½“ç„¶åœ¨æ‚¨å®é™…çš„ä½¿ç”¨è¿‡ç¨‹ä¸­è‚¯å®šè¿˜éœ€è¦è°ƒæ•´ã€‚è¿™é‡Œåªç»™æˆ‘äº†æˆ‘è‡ªå·±çš„ä¸€äº›æ€è·¯å’Œå®ç°æ–¹å¼ã€‚</p><blockquote><p>å¦‚æœæˆ‘ä»¬éœ€è¦å…¶ä»–çš„æŠ½è±¡æ—¶ï¼Œåªéœ€è¦æ³¨æ„åƒåˆ·æ–°ä¸€æ ·å°†æ³›å‹ç»§æ‰¿å…³ç³»æ ‡å‡†ä¸Šå°±å¯ä»¥å•¦ã€‚å¦‚æœModelä¹Ÿå¯ä»¥æŠ½å–å‡ºæ¥ï¼Œå¤ç”¨æ—¶åªéœ€è¦ç»§æ‰¿æŠ½è±¡å‡ºæ¥çš„Modelã€‚</p></blockquote><h2 id="ç›®å‰">ç›®å‰<a href="post/xmvp-framework#ç›®å‰"></a></h2><p>ç›®å‰XMVPæ¡†æ¶å·²æ›´æ–°åˆ°<code>1.2.2</code>ï¼ŒåºŸå¼ƒäº†ä¸€äº›ä»¥å‰çš„æ–¹æ³•ï¼ˆå½“ç„¶ç°åœ¨è¿˜èƒ½ç”¨ï¼‰ã€‚æ·»åŠ äº†æ›´å¤šViewå±‚çš„è¾…åŠ©æ–¹æ³•ï¼Œä¸ºäº†å·ä¸ªæ‡’ï¼Œå°±ç›´æ¥å±•ç¤ºæ–°å¢çš„æ–¹æ³•ä»£ç å•¦ï¼</p><blockquote><p>åŸºæœ¬å‘¨æœŸ</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * author: xujiaji</span></span><br><span class="line"><span class="comment"> * created on: 2018/9/4 10:57</span></span><br><span class="line"><span class="comment"> * description: å®šä¹‰Viewç›¸å…³å‘¨æœŸ &lt;br /&gt; Define View related Cycle</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">XViewCycle</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨ super &#123;<span class="doctag">@link</span> android.app.Activity#onCreate(Bundle)&#125;ä¹‹å‰è¢«è°ƒç”¨              &lt;br /&gt;  will be called before super class &#123;<span class="doctag">@link</span> android.app.Activity#onCreate(Bundle)&#125; called</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onBeforeCreateCircle</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨ super &#123;<span class="doctag">@link</span> android.app.Activity#onCreate(Bundle)&#125;ä¹‹å‰è¢«è°ƒç”¨ï¼Œå¹¶ä¸”æœ‰Bundle &lt;br /&gt;  will be called before super class &#123;<span class="doctag">@link</span> android.app.Activity#onCreate(Bundle)&#125; called</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> savedInstanceState è¯¥å‚æ•°ä¸å¯èƒ½ä¸ºnull                                  &lt;br /&gt; this parameter cannot be null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onBundleHandle</span><span class="params">(@NonNull Bundle savedInstanceState)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å¸ƒå±€çš„id                                &lt;br /&gt; get layout id</span></span><br><span class="line"><span class="comment">     * åœ¨ &#123;<span class="doctag">@link</span> #onBeforeCreateCircle &#125;ä¹‹åè¢«è°ƒç”¨ &lt;br /&gt; will be called after &#123;<span class="doctag">@link</span> #onBeforeCreateCircle &#125; called</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> xmlå¸ƒå±€id                         &lt;br /&gt; xml layout id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">layoutId</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  åœ¨è¿™é‡Œé¢è¿›è¡Œåˆå§‹åŒ–                    &lt;br /&gt; initialize here</span></span><br><span class="line"><span class="comment">     *  åœ¨ &#123;<span class="doctag">@link</span> #layoutId()&#125; ä¹‹åè¢«è°ƒç”¨   &lt;br /&gt; will be called after &#123;<span class="doctag">@link</span> #layoutId()&#125; called</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onInitCircle</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿™é‡Œé¢å†™ç›‘å¬äº‹ä»¶                       &lt;br /&gt; write listens event here</span></span><br><span class="line"><span class="comment">     * åœ¨ &#123;<span class="doctag">@link</span> #onInitCircle()&#125; ä¹‹åè¢«è°ƒç”¨ &lt;br /&gt; will be called after &#123;<span class="doctag">@link</span> #onInitCircle()&#125; called</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onListenerCircle</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>Activiyä¸­</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * author: xujiaji</span></span><br><span class="line"><span class="comment"> * created on: 2018/9/11 15:05</span></span><br><span class="line"><span class="comment"> * description: å®šä¹‰Activity Viewç›¸å…³å‘¨æœŸ &lt;br /&gt; Define Activity View related Cycle</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">XActivityCycle</span> <span class="keyword">extends</span> <span class="title">XViewCycle</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤„ç†ä¸Šä¸ªé¡µé¢ä¼ é€’è¿‡æ¥çš„æ•°æ® &lt;br /&gt; Handle the data passed from the previous page</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onIntentHandle</span><span class="params">(@NonNull Intent intent)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>Fragmentä¸­</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * author: xujiaji</span></span><br><span class="line"><span class="comment"> * created on: 2018/9/4 10:57</span></span><br><span class="line"><span class="comment"> * description: å®šä¹‰Fragment Viewç›¸å…³å‘¨æœŸ &lt;br /&gt; Define Fragment View related Cycle</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">XFragViewCycle</span> <span class="keyword">extends</span> <span class="title">XViewCycle</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤„ç†&#123;<span class="doctag">@link</span> Fragment#getArguments()&#125; çš„å€¼ï¼Œå¦‚æœæœ‰æ‰ä¼šè°ƒç”¨  &lt;br /&gt; Handle the value of &#123;<span class="doctag">@link</span> Fragment#getArguments()&#125; , if it is there, it will be called</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bundle</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onArgumentsHandle</span><span class="params">(@NonNull Bundle bundle)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onVisible</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onInvisible</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onLazyLoad</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¿½ç•¥&#123;<span class="doctag">@link</span> #isFirstLoad() &#125;çš„å€¼ï¼Œå¼ºåˆ¶åˆ·æ–°æ•°æ®ï¼Œä½†ä»è¦æ»¡è¶³ &#123;<span class="doctag">@link</span> #isFragmentVisible()&#125; &amp;&amp; &#123;<span class="doctag">@link</span> #isPrepared()&#125; &lt;br /&gt;</span></span><br><span class="line"><span class="comment">     * Ignore the value of &#123;<span class="doctag">@link</span> #isFirstLoad() &#125; to force refresh data, but still satisfy &#123;<span class="doctag">@link</span> #isFragmentVisible()&#125; &amp;&amp; &#123;<span class="doctag">@link</span> #isPrepared()&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setForceLoad</span><span class="params">(<span class="keyword">boolean</span> forceLoad)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isForceLoad</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isPrepared</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isFirstLoad</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isFragmentVisible</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦æ˜¯åœ¨ViewPagerä¸­ï¼Œé»˜è®¤ä¸ºtrue</span></span><br><span class="line"><span class="comment">     * whether in ViewPager, default is true</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isInViewPager</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>å¯ä»¥çœ‹åˆ°Fragmentä¸­å®šä¹‰çš„æ–¹æ³•æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œå› ä¸ºç”±äºæ‡’åŠ è½½æ¯”è¾ƒå¸¸ç”¨ï¼Œæ–°å¢äº†æ‡’åŠ è½½ã€‚æˆ‘ä»¬å¦‚æœéœ€è¦åŠ è½½æ•°æ®ï¼Œå¯ç›´æ¥åœ¨<code>onLazyLoad()</code>æ–¹æ³•ä¸­è¿›è¡Œã€‚</p><blockquote><p>éœ€è¦æ³¨æ„ï¼šå¦‚æœFragmentä¸æ˜¯å’ŒViewPagerç»“åˆï¼Œéœ€è¦å°†<code>isInViewPager</code>è¿”å›falseï¼Œé»˜è®¤è¿”å›çš„trueã€‚å¦‚æœä¸è¿™æ ·ï¼Œå¯èƒ½ä¼šå¯¼è‡´é€šè¿‡FragmentMangeræäº¤çš„Fragmentæ— æ³•è°ƒç”¨åˆ°<code>onLazyLoad</code>æ–¹æ³•ã€‚</p></blockquote><h2 id="æœ€å">æœ€å<a href="post/xmvp-framework#æœ€å"></a></h2><p>é€šè¿‡å†™è¿™ä¸ªæ¡†æ¶å­¦åˆ°äº†æ€è€ƒå¾ˆå¤šä¸œè¥¿ï¼Œå¹¶ä¸”åæœŸä¹Ÿä¼šç»§ç»­æ›´æ–°ï¼Œæˆ‘è‡ªå·±å†™é¡¹ç›®ä¸­ä¹Ÿåœ¨ä½¿ç”¨ã€‚å¯èƒ½æœ‰äº›åœ°æ–¹è€ƒè™‘çš„ä¸å……è¶³ï¼Œè°¢è°¢å¤§å®¶ä¹Ÿå¯ä»¥æå»ºè®®ã€‚å½“ç„¶è¿™åªæ˜¯MVPçš„ä¸€ç§å®ç°æ€è·¯ï¼Œå…¶ä»–çš„è¿˜æ˜¯æœ‰å¾ˆå¤šçš„ï¼Œè¿™é‡Œå¤§å®¶ä¹Ÿè®¸éƒ½æœ‰ä¸€å®šäº†è§£å“ˆã€‚</p><p>XMVPåœ°å€ï¼š<a href="https://github.com/xujiaji/XMVP" target="_blank" rel="noopener">https://github.com/xujiaji/XMVP</a></p><p>æ¬¢è¿å¤§å®¶Starã€Forkã€PR (ã€ƒâ€™â–½â€™ã€ƒ)</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;XMVPæ¡†æ¶æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªæ¡†æ¶ï¼Œåˆšä»Androidèµ·æ­¥ç¬¬ä¸€æ¬¡äº†è§£MVPæ¨¡å¼æ—¶å†³å¿ƒå†™ä¸€ä¸ªè‡ªå·±çš„ä¸œè¥¿æ¡†æ¶ï¼Œåˆ°ç°åœ¨å·²è¿ç”¨åœ¨æˆ‘å†™çš„å¤šä¸ªé¡¹ç›®ä¸­ã€‚è™½ç„¶ä¸¤å¹´äº†ï¼Œä½†æ ¸å¿ƒçš„æ€è·¯æ²¡æœ‰æ”¹å˜ï¼Œåˆ°ç°åœ¨å˜æ¢ä¹Ÿä¸æ˜¯å¤ªå¤šï¼Œç²¾ç®€äº†ä¸€äº›ä»£ç ï¼Œæ·»åŠ äº†ä¸€äº›åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Android" scheme="https://blog.xujiaji.com/categories/Android/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="Library" scheme="https://blog.xujiaji.com/tags/Library/"/>
    
  </entry>
  
  <entry>
    <title>iOS Objective-C Learn Note</title>
    <link href="https://blog.xujiaji.com/post/iOS-Objective-C-Learn/index.html"/>
    <id>https://blog.xujiaji.com/post/iOS-Objective-C-Learn/index.html</id>
    <published>2018-09-05T10:11:24.000Z</published>
    <updated>2018-11-02T07:20:12.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æºä»£ç æ–‡ä»¶æ‰©å±•åå¯¹æ¯”">æºä»£ç æ–‡ä»¶æ‰©å±•åå¯¹æ¯”<a href="post/iOS-Objective-C-Learn#æºä»£ç æ–‡ä»¶æ‰©å±•åå¯¹æ¯”"></a></h2><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left"></th><th>å¤´æ–‡ä»¶</th><th>å®ç°æ–‡ä»¶</th></tr></thead><tbody><tr><td style="text-align:left">cè¯­è¨€</td><td>.h</td><td>.c</td></tr><tr><td style="text-align:left">c++è¯­è¨€</td><td>.h</td><td>.cpp</td></tr><tr><td style="text-align:left">ocè¯­è¨€</td><td>.h</td><td>.m</td></tr><tr><td style="text-align:left">oc&amp;c++</td><td>.h</td><td>.mm</td></tr></tbody></table></div></div><h2 id="ç±»çš„å®šä¹‰">ç±»çš„å®šä¹‰<a href="post/iOS-Objective-C-Learn#ç±»çš„å®šä¹‰"></a></h2><blockquote><p>å®šä¹‰ä¸€ä¸ª<code>SimpleClass</code>ç±»</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">SimpleClass</span>: <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><h2 id="ç±»çš„å±æ€§ç”³æ˜">ç±»çš„å±æ€§ç”³æ˜<a href="post/iOS-Objective-C-Learn#ç±»çš„å±æ€§ç”³æ˜"></a></h2><blockquote><p>é€šè¿‡<code>@property</code></p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> <span class="built_in">NSString</span> *firstName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> <span class="built_in">NSString</span> *lastName;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‡é’ˆç±»å‹ï¼Œæ˜¯ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="keyword">@property</span> <span class="built_in">NSNumber</span> *yearOfBirth;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŸºç¡€ç±»å‹ï¼Œæ˜¯ä¸€ä¸ªå€¼ç±»å‹</span></span><br><span class="line"><span class="keyword">@property</span> <span class="keyword">int</span> yearOfBirth;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸€ä¸ªåªè¯»çš„å±æ€§</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>) <span class="built_in">NSString</span> *firstName;</span><br></pre></td></tr></table></div></figure><h2 id="å‡å·æ–¹æ³•å’ŒåŠ å·æ–¹æ³•ï¼ˆæœ¬è´¨å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰">å‡å·æ–¹æ³•å’ŒåŠ å·æ–¹æ³•ï¼ˆæœ¬è´¨å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰<a href="post/iOS-Objective-C-Learn#å‡å·æ–¹æ³•å’ŒåŠ å·æ–¹æ³•ï¼ˆæœ¬è´¨å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰"></a></h2><ol><li>å‡å·æ–¹æ³•ï¼ˆæ™®é€šæ–¹æ³•åˆç§°å¯¹è±¡æ–¹æ³•ï¼‰</li><li>åŠ å·æ–¹æ³•ï¼ˆç±»æ–¹æ³•ï¼Œåˆç§°é™æ€æ–¹æ³•ï¼‰</li></ol><h2 id="å®Œæ•´çš„ä¾‹å­">å®Œæ•´çš„ä¾‹å­<a href="post/iOS-Objective-C-Learn#å®Œæ•´çš„ä¾‹å­"></a></h2><blockquote><p>æ¥å£<code>XYZPerson.h</code></p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">XYZPerson</span>: <span class="title">NSObject</span></span></span><br><span class="line">-(<span class="keyword">void</span>)sayHello;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>å®ç°<code>XYZPerson.m</code></p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"XYZPerson.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">XYZPerson</span></span></span><br><span class="line">-(<span class="keyword">void</span>)sayHello &#123;</span><br><span class="line">  <span class="comment">// åŠ äº†@ç¬¦å·ï¼Œè¡¨ç¤ºæ˜¯OCç±»å‹çš„å­—ç¬¦ä¸²ã€‚ä¸åŠ è¡¨ç¤ºæ˜¯çº¯Cè¯­è¨€çš„å­—ç¬¦æ•°ç»„</span></span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"Hello, World!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><h2 id="ç®€å•çš„ç¨‹åº">ç®€å•çš„ç¨‹åº<a href="post/iOS-Objective-C-Learn#ç®€å•çš„ç¨‹åº"></a></h2><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        <span class="comment">// insert code here...</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Hello, World!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="åŸºæœ¬æ•°æ®ç±»å‹">åŸºæœ¬æ•°æ®ç±»å‹<a href="post/iOS-Objective-C-Learn#åŸºæœ¬æ•°æ®ç±»å‹"></a></h2><div class="article-bounded"><div class="article-table"><table><thead><tr><th>ç±»å‹</th><th style="text-align:right">è¿›åˆ¶ä½</th><th style="text-align:right">ä¾‹å­</th></tr></thead><tbody><tr><td>int</td><td style="text-align:right">32ä½</td><td style="text-align:right">int a = 0;</td></tr><tr><td>float</td><td style="text-align:right">32ä½</td><td style="text-align:right">float f = 1.0;</td></tr><tr><td>double</td><td style="text-align:right">64ä½</td><td style="text-align:right">double num;</td></tr><tr><td>char</td><td style="text-align:right">8ä½</td><td style="text-align:right">char c = â€˜Aâ€™;</td></tr></tbody></table></div></div><h2 id="å…¶ä»–ç±»å‹">å…¶ä»–ç±»å‹<a href="post/iOS-Objective-C-Learn#å…¶ä»–ç±»å‹"></a></h2><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>NSString</td><td>@â€hello worldâ€</td></tr><tr><td>â€œhello worldâ€</td><td>Cè¯­è¨€å­—ç¬¦ä¸²ç±»å‹</td></tr></tbody></table></div></div><h2 id="é™å®šè¯">é™å®šè¯<a href="post/iOS-Objective-C-Learn#é™å®šè¯"></a></h2><div class="article-bounded"><div class="article-table"><table><thead><tr><th>é™å®šè¯</th><th style="text-align:right">ä¾‹å­</th><th>æè¿°</th></tr></thead><tbody><tr><td>long</td><td style="text-align:right">long a;</td><td>//å®Œæ•´å†™æ³•ä¸ºï¼šlong int a;å…¶å®ç°åœ¨intå·²ç»32ä½äº†å°±ç›¸å½“äºint a;</td></tr><tr><td>long long</td><td style="text-align:right">long long int a;</td><td></td></tr><tr><td>short</td><td style="text-align:right">short int a; short a;</td><td>// 16ä½æ•´å‹</td></tr><tr><td>unsigned</td><td style="text-align:right">unsigned int a;</td><td>// æ— ç¬¦å·</td></tr><tr><td>signed</td><td style="text-align:right">signed int a;</td><td>// æœ‰ç¬¦å·</td></tr></tbody></table></div></div><h2 id="ç®—æœ¯è¡¨è¾¾å¼ä¸è¿ç®—ç¬¦">ç®—æœ¯è¡¨è¾¾å¼ä¸è¿ç®—ç¬¦<a href="post/iOS-Objective-C-Learn#ç®—æœ¯è¡¨è¾¾å¼ä¸è¿ç®—ç¬¦"></a></h2><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:right">åç§°</th><th style="text-align:left">è¡¨ç¤º</th></tr></thead><tbody><tr><td style="text-align:right">èµ‹å€¼</td><td style="text-align:left"><code>=</code></td></tr><tr><td style="text-align:right">ä¸€å…ƒè¿ç®—ç¬¦</td><td style="text-align:left"><code>++</code> <code>--</code></td></tr><tr><td style="text-align:right">äºŒå…ƒè¿ç®—ç¬¦</td><td style="text-align:left"><code>+</code> <code>-</code> <code>*</code> <code>/</code> <code>%</code></td></tr><tr><td style="text-align:right">ä¸‰ç›®è¿ç®—ç¬¦</td><td style="text-align:left">2 &gt; 3 <code>?</code> YES <code>:</code> NO</td></tr></tbody></table></div></div><h2 id="ifè¯­å¥ï¼ˆé0å°±æ˜¯çœŸï¼‰"><code>if</code>è¯­å¥ï¼ˆé0å°±æ˜¯çœŸï¼‰<a href="post/iOS-Objective-C-Learn#ifè¯­å¥ï¼ˆé0å°±æ˜¯çœŸï¼‰"></a></h2><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:right"></th><th style="text-align:left">å€¼</th></tr></thead><tbody><tr><td style="text-align:right">çœŸ</td><td style="text-align:left"><code>YES</code> <code>æ‰€æœ‰é0çš„å€¼</code></td></tr><tr><td style="text-align:right">å‡</td><td style="text-align:left"><code>NO</code> <code>0</code></td></tr></tbody></table></div></div><blockquote><p>ç®€å•ä¾‹å­</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> a = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> b = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (a &gt; b) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"è¿™å¥è¯æ˜¯çœŸçš„"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"è¿™å¥è¯æ˜¯å‡çš„ %hhd"</span>, <span class="literal">NO</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="goto-è·³è½¬è¯­å¥ï¼Œè·³è½¬çš„å‰é¢å®šä¹‰çš„æ ‡ç­¾å¤„"><code>goto</code> è·³è½¬è¯­å¥ï¼Œè·³è½¬çš„å‰é¢å®šä¹‰çš„æ ‡ç­¾å¤„<a href="post/iOS-Objective-C-Learn#goto-è·³è½¬è¯­å¥ï¼Œè·³è½¬çš„å‰é¢å®šä¹‰çš„æ ‡ç­¾å¤„"></a></h2><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å®šä¹‰æ ‡ç­¾a</span></span><br><span class="line">    a:</span><br><span class="line">        i ++;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"içš„å€¼ä¸º%d"</span>, i);</span><br><span class="line"><span class="comment">//        if(i &lt; 5) goto a;</span></span><br><span class="line">        <span class="keyword">if</span> (i &lt; <span class="number">5</span>) &#123;</span><br><span class="line">            <span class="keyword">goto</span> a; <span class="comment">// è·³è½¬åˆ°æ ‡ç­¾a</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">goto</span> b; <span class="comment">// è·³è½¬åˆ°æ ‡ç­¾b</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"============"</span>); <span class="comment">// ç”±äºä¸Šé¢ç›´æ¥è·³è½¬åˆ°äº†bæ ‡ç­¾ï¼Œå› æ­¤è¯¥è¯­å¥å¾—ä¸åˆ°æ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line">    b:&#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"è·³åˆ°bäº†"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment">// 2018-09-05 22:23:53.800654+0800 les1[971:104767] içš„å€¼ä¸º1</span></span><br><span class="line"><span class="comment">// 2018-09-05 22:23:53.800827+0800 les1[971:104767] içš„å€¼ä¸º2</span></span><br><span class="line"><span class="comment">// 2018-09-05 22:23:53.800858+0800 les1[971:104767] içš„å€¼ä¸º3</span></span><br><span class="line"><span class="comment">// 2018-09-05 22:23:53.800876+0800 les1[971:104767] içš„å€¼ä¸º4</span></span><br><span class="line"><span class="comment">// 2018-09-05 22:23:53.800889+0800 les1[971:104767] içš„å€¼ä¸º5</span></span><br><span class="line"><span class="comment">// 2018-09-05 22:23:53.800902+0800 les1[971:104767] è·³åˆ°bäº†</span></span><br></pre></td></tr></table></div></figure><h2 id="while-å¾ªç¯è¯­å¥"><code>while</code> å¾ªç¯è¯­å¥<a href="post/iOS-Objective-C-Learn#while-å¾ªç¯è¯­å¥"></a></h2><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; <span class="number">5</span>) &#123;</span><br><span class="line">            i++;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"Hello world! i = %d"</span>, i);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">// è¾“å‡º</span></span><br><span class="line"><span class="comment">// Hello world! i = 1</span></span><br><span class="line"><span class="comment">// Hello world! i = 2</span></span><br><span class="line"><span class="comment">// Hello world! i = 3</span></span><br><span class="line"><span class="comment">// Hello world! i = 4</span></span><br><span class="line"><span class="comment">// Hello world! i = 5</span></span><br></pre></td></tr></table></div></figure><h2 id="do-while-å¾ªç¯ï¼Œè‡³å°‘æ‰§è¡Œä¸€æ¬¡"><code>do</code> <code>while</code> å¾ªç¯ï¼Œè‡³å°‘æ‰§è¡Œä¸€æ¬¡<a href="post/iOS-Objective-C-Learn#do-while-å¾ªç¯ï¼Œè‡³å°‘æ‰§è¡Œä¸€æ¬¡"></a></h2><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"hello!"</span>);</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment">// hello!</span></span><br></pre></td></tr></table></div></figure><h2 id="for-å¾ªç¯"><code>for</code> å¾ªç¯<a href="post/iOS-Objective-C-Learn#for-å¾ªç¯"></a></h2><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"i = %d"</span>, i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡º</span></span><br><span class="line"><span class="comment">// i = 1</span></span><br><span class="line"><span class="comment">// i = 2</span></span><br><span class="line"><span class="comment">// i = 3</span></span><br><span class="line"><span class="comment">// i = 4</span></span><br><span class="line"><span class="comment">// i = 5</span></span><br></pre></td></tr></table></div></figure><h2 id="å¾ªç¯æ§åˆ¶breakã€continue">å¾ªç¯æ§åˆ¶<code>break</code>ã€<code>continue</code><a href="post/iOS-Objective-C-Learn#å¾ªç¯æ§åˆ¶breakã€continue"></a></h2><ul><li>breakï¼š ç»ˆæ­¢å¾ªç¯</li><li>continue: è·³è¿‡å½“å‰å¾ªç¯</li></ul><h2 id="switchåˆ†æ”¯è¯­å¥"><code>switch</code>åˆ†æ”¯è¯­å¥<a href="post/iOS-Objective-C-Learn#switchåˆ†æ”¯è¯­å¥"></a></h2><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">switch</span> (i) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"i = 0"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"i = 1"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"i = 2"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"i = 3"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"NO"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="å‡½æ•°çš„åŸºæœ¬å†™æ³•">å‡½æ•°çš„åŸºæœ¬å†™æ³•<a href="post/iOS-Objective-C-Learn#å‡½æ•°çš„åŸºæœ¬å†™æ³•"></a></h2><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * æ±‚é¢ç§¯çš„å‡½æ•°</span></span><br><span class="line"><span class="comment"> * ä¼ å…¥å€¼ï¼Œè®¡ç®—å¹¶è¿”å›é¢ç§¯å€¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a * b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ— å‚æ— è¿”å›çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    NSLog(@<span class="string">"this is a test!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</span> </span>&#123;</span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        NSLog(@<span class="string">"value = %f"</span>, area(<span class="number">5.0</span>, <span class="number">3.0</span>));</span><br><span class="line">        show();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="mainå‡½æ•°ä¸­çš„é»˜è®¤å‚æ•°">mainå‡½æ•°ä¸­çš„é»˜è®¤å‚æ•°<a href="post/iOS-Objective-C-Learn#mainå‡½æ•°ä¸­çš„é»˜è®¤å‚æ•°"></a></h2><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"argc = %d"</span>, argc);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; argc; i++) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"%s"</span>, argv[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ç»ˆç«¯è¿è¡Œ</p></blockquote><figure class="highlight sh"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ ls -l</span><br><span class="line">total 56</span><br><span class="line">-rwxr-xr-x@ 1 username  staff  27984  9  5 23:21 les1</span><br><span class="line"></span><br><span class="line">$ ./les1</span><br><span class="line">2018-09-05 23:28:27.313 les1[1369:176584] argc = 1</span><br><span class="line">2018-09-05 23:28:27.313 les1[1369:176584] ./les1</span><br><span class="line"></span><br><span class="line">$ ./les1 -a -b -c</span><br><span class="line">2018-09-05 23:28:39.782 les1[1370:176617] argc = 4</span><br><span class="line">2018-09-05 23:28:39.782 les1[1370:176617] ./les1</span><br><span class="line">2018-09-05 23:28:39.782 les1[1370:176617] -a</span><br><span class="line">2018-09-05 23:28:39.782 les1[1370:176617] -b</span><br><span class="line">2018-09-05 23:28:39.782 les1[1370:176617] -c</span><br></pre></td></tr></table></div></figure><h2 id="åˆ›å»ºç±»">åˆ›å»ºç±»<a href="post/iOS-Objective-C-Learn#åˆ›å»ºç±»"></a></h2><blockquote><p>å¤´æ–‡ä»¶<code>People.h</code></p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">People</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>å®ç°æ–‡ä»¶<code>People.m</code></p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">People</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><h2 id="å®ä¾‹åŒ–å¯¹è±¡">å®ä¾‹åŒ–å¯¹è±¡<a href="post/iOS-Objective-C-Learn#å®ä¾‹åŒ–å¯¹è±¡"></a></h2><ol><li>å¯¼å…¥ç±»çš„å¤´æ–‡ä»¶</li><li><code>[]</code>ä¸­å†™å‡½æ•°çš„è°ƒç”¨</li><li><code>alloc</code> å‡½æ•°ä¸ºå¯¹è±¡åˆ†é…å†…å­˜ç©ºé—´</li><li><code>init</code> å‡½æ•°è¿›è¡Œåˆå§‹åŒ–æ“ä½œ</li></ol><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span> // å¯¼å…¥ç±»å¤´æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        <span class="comment">// å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">        <span class="comment">// [] å‡½æ•°çš„è°ƒç”¨</span></span><br><span class="line">        <span class="comment">// [ç±»å æ–¹æ³•å]</span></span><br><span class="line">        <span class="comment">// [å¯¹è±¡å æ–¹æ³•å]</span></span><br><span class="line">        <span class="comment">// alloc - ä¸ºå¯¹è±¡åˆ†é…å†…å­˜ç©ºé—´</span></span><br><span class="line">        <span class="comment">// init - è¿›è¡Œåˆå§‹åŒ–æ“ä½œ</span></span><br><span class="line">        People * p1 = [[People alloc] init];</span><br><span class="line">        People * p2 = [[People alloc] init];</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="å±æ€§å’Œæˆå‘˜å˜é‡">å±æ€§å’Œæˆå‘˜å˜é‡<a href="post/iOS-Objective-C-Learn#å±æ€§å’Œæˆå‘˜å˜é‡"></a></h2><ol><li>ç±»å†…ä½¿ç”¨æˆå‘˜å˜é‡ã€ç±»å¤–ä½¿ç”¨å±æ€§</li><li>å®šä¹‰æˆå‘˜å˜é‡ï¼Œæ­¤æ—¶å¤–éƒ¨æ— æ³•è®¿é—®ã€‚å¦‚æœè¦è®©å¤–éƒ¨å¯è®¿é—®éœ€è¦åŠ ä¸Šï¼ˆä¸å»ºè®®ï¼‰ï¼š@public</li><li>å±æ€§æ˜¯ä¸ºäº†è®©ç±»å¤–å¯ä»¥è®¿é—®æˆå‘˜å˜é‡</li><li>å±æ€§å°±æ˜¯æˆå‘˜å˜é‡çš„å¤–éƒ¨æ¥å£</li><li>å¯å°†å±æ€§æ‹†å¼€ï¼Œå†™æˆ<code>get</code>å’Œ<code>set</code>ä¸¤éƒ¨åˆ†</li></ol><blockquote><p>People.h</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç±»å†…ä½¿ç”¨æˆå‘˜å˜é‡ã€ç±»å¤–ä½¿ç”¨å±æ€§</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">People</span> : <span class="title">NSObject</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰æˆå‘˜å˜é‡ï¼Œæ­¤æ—¶å¤–éƒ¨æ— æ³•è®¿é—®ã€‚å¦‚æœè¦è®©å¤–éƒ¨å¯è®¿é—®éœ€è¦åŠ ä¸Šï¼š@public</span></span><br><span class="line">    <span class="comment">// @public</span></span><br><span class="line">    <span class="comment">// NSString * _peopleName; // å¦‚æœå®šä¹‰äº†è¯¥æˆå‘˜å˜é‡çš„å±æ€§ï¼Œé‚£ä¹ˆå¯ä»¥ä¸å†™ã€‚ç¼–è¯‘å™¨ä¼šä¸ºæˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå«_peopleNameçš„æˆå‘˜å˜é‡</span></span><br><span class="line">    <span class="keyword">int</span> _peopleAge;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å±æ€§æ˜¯ä¸ºäº†è®©ç±»å¤–å¯ä»¥è®¿é—®æˆå‘˜å˜é‡</span></span><br><span class="line"><span class="comment">// å±æ€§å°±æ˜¯æˆå‘˜å˜é‡çš„å¤–éƒ¨æ¥å£</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>)<span class="built_in">NSString</span> * peopleName;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†å±æ€§æ‹†å¼€</span></span><br><span class="line">- (<span class="keyword">void</span>) setAge:(<span class="keyword">int</span>) age;</span><br><span class="line">- (<span class="keyword">int</span>) getAge;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>People.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span></span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">int</span> _peopleSex; <span class="comment">// ä¹Ÿå¯ä»¥å°†æˆå‘˜å˜é‡å®šä¹‰åœ¨mæ–‡ä»¶ä¸­ï¼Œæ²¡ä»€ä¹ˆåŒºåˆ«</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">People</span></span></span><br><span class="line">- (<span class="keyword">instancetype</span>)init</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        _peopleName = <span class="string">@"å¼ ä¸‰"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>) setAge:(<span class="keyword">int</span>) age</span><br><span class="line">&#123;</span><br><span class="line">    _peopleAge = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">int</span>) getAge</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> _peopleAge;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>main.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span></span></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        People * p1 = [[People alloc] init];</span><br><span class="line">        p1.peopleName = <span class="string">@"æå››"</span>; <span class="comment">// é€šè¿‡å±æ€§è®¾ç½®åå­—</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"p1 name %@"</span>, [p1 peopleName]); <span class="comment">// é€šè¿‡å±æ€§è·å–åå­—</span></span><br><span class="line">        [p1 setAge:<span class="number">23</span>]; <span class="comment">// é€šè¿‡å‡½æ•°è®¾ç½®å¹´é¾„</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"p1 age %d"</span>, [p1 getAge]); <span class="comment">// é€šè¿‡å‡½æ•°è·å–å¹´é¾„</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="å‡½æ•°">å‡½æ•°<a href="post/iOS-Objective-C-Learn#å‡½æ•°"></a></h2><ol><li>è°ƒç”¨æ–¹æ³•æ˜¯ç”¨ä¸­æ‹¬å·</li><li><code>-</code>ã€<code>+</code> æ–¹æ³•çš„ç±»å‹ï¼ˆå‡å·ä»£è¡¨å¯¹è±¡æ–¹æ³•ï¼ŒåŠ å·ä»£è¡¨ç±»æ–¹æ³•ï¼‰</li><li>åŠ å·æ–¹æ³•å’Œå‡å·æ–¹æ³•ä¹‹é—´çš„ç›¸äº’è°ƒç”¨é€»è¾‘å’Œjavaä¸€æ ·</li><li>æ–¹æ³•åï¼šå»æ‰æ–¹æ³•ç±»å‹å’Œå‚æ•°ç±»å‹å°±æ˜¯æ–¹æ³•å</li><li><code>(int)</code> è¿”å›å€¼ç±»å‹<code>int</code></li><li><code>:(int) x</code>     ä»£è¡¨æ–¹æ³•æœ‰å‚æ•°ï¼Œå‚æ•°ç±»å‹<code>int</code>ï¼Œå‚æ•°å<code>x</code></li></ol><blockquote><p>People.h</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">People</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> ç”³æ˜æ–¹æ³•</span></span><br><span class="line"><span class="comment"> -ã€+ æ–¹æ³•çš„ç±»å‹ï¼ˆå‡å·ä»£è¡¨å¯¹è±¡æ–¹æ³•ï¼ŒåŠ å·ä»£è¡¨ç±»æ–¹æ³•ï¼‰</span></span><br><span class="line"><span class="comment"> åŠ å·æ–¹æ³•å’Œå‡å·æ–¹æ³•ä¹‹é—´çš„ç›¸äº’è°ƒç”¨é€»è¾‘å’Œjavaä¸€æ ·</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">(int) è¿”å›å€¼ç±»å‹</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> :(int) x     ä»£è¡¨æ–¹æ³•æœ‰å‚æ•°ï¼Œå‚æ•°ç±»å‹intï¼Œå‚æ•°åx</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> æ–¹æ³•åï¼šå»æ‰æ–¹æ³•ç±»å‹å’Œå‚æ•°ç±»å‹å°±æ˜¯æ–¹æ³•å</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">int</span>) report;</span><br><span class="line">+ (<span class="keyword">void</span>) report1;</span><br><span class="line">- (<span class="keyword">int</span>) showWithA:(<span class="keyword">int</span>) a;</span><br><span class="line">- (<span class="keyword">int</span>) showWithA:(<span class="keyword">int</span>) a andB:(<span class="keyword">int</span>) b;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>People.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">People</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *_name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> *_name1;</span><br><span class="line">- (<span class="keyword">int</span>)report</span><br><span class="line">&#123;</span><br><span class="line">    _name = <span class="string">@"abc"</span>;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"-å·æ–¹æ³•:report"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">22</span>;</span><br><span class="line">&#125;</span><br><span class="line">+ (<span class="keyword">void</span>)report1</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//     _name = @"abc"; ç¼–è¯‘é”™è¯¯ï¼Œ+å·æ–¹æ³•ç›¸å½“äºjavaä¸­çš„é™æ€æ–¹æ³•</span></span><br><span class="line">    _name1 = <span class="string">@"abc"</span>;<span class="comment">//é™æ€æ–¹æ³•å¯è°ƒç”¨é™æ€å˜é‡</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"+å·æ–¹æ³•ï¼šreport1"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">int</span>) showWithA:(<span class="keyword">int</span>) a</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">int</span>) showWithA:(<span class="keyword">int</span>) a andB:(<span class="keyword">int</span>) b&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>main.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        <span class="comment">// [] è°ƒç”¨æ–¹æ³•</span></span><br><span class="line">        People *p1 = [[People alloc] init];</span><br><span class="line"><span class="comment">//        NSLog(@"return value %d", [p1 report]);</span></span><br><span class="line"><span class="comment">//        [People report1];</span></span><br><span class="line">        <span class="keyword">int</span> a1 = [p1 showWithA:<span class="number">10</span>];</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"a1 = %d"</span>, a1);</span><br><span class="line">        <span class="keyword">int</span> a2 = [p1 showWithA:<span class="number">10</span> andB:<span class="number">20</span>];</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"a2 = %d"</span>, a2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="åˆå§‹åŒ–å‡½æ•°">åˆå§‹åŒ–å‡½æ•°<a href="post/iOS-Objective-C-Learn#åˆå§‹åŒ–å‡½æ•°"></a></h2><blockquote><p>People.h</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">People</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–æ–¹æ³•</span></span><br><span class="line"><span class="comment">//- (id) init;//ä»»æ„ç±»å‹</span></span><br><span class="line"><span class="comment">//è™½ç„¶ä¸Šé¢çš„ä¹Ÿå¯ä»¥ä½†æ˜¯æ¨èä¸‹é¢</span></span><br><span class="line">- (<span class="keyword">instancetype</span>) init; <span class="comment">// å½“å‰ç±»å‹ï¼Œå½“å‰æ˜¯Peopleç±»å‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è‡ªå®šä¹‰åˆå§‹åŒ–æ–¹æ³•</span></span><br><span class="line">- (<span class="keyword">instancetype</span>) initPeople:(<span class="built_in">NSString</span> *) name age:(<span class="keyword">int</span>) age;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>People.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">People</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> _age;</span><br><span class="line">    <span class="keyword">int</span> _name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é‡å†™åˆå§‹åŒ–æ–¹æ³•</span></span><br><span class="line">- (<span class="keyword">instancetype</span>)init</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        _age = <span class="number">23</span>;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"age = %d"</span>, _age);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)initPeople:(<span class="built_in">NSString</span> *)name age:(<span class="keyword">int</span>)age</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        _age = age;</span><br><span class="line">        _name = name;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"age = %d, name = %@"</span>, _age, name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>main.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"People.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        People *p1 = [[People alloc] init];</span><br><span class="line">        People * p2 = [[People alloc] initPeople:<span class="string">@"xu"</span> age:<span class="number">24</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>è¾“å‡º</p></blockquote><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age = 23</span><br><span class="line">age = 24, name = xu</span><br></pre></td></tr></table></div></figure><h2 id="å°è£…">å°è£…<a href="post/iOS-Objective-C-Learn#å°è£…"></a></h2><blockquote><p>è®¿é—®ä¿®é¥°ç¬¦</p></blockquote><div class="article-bounded"><div class="article-table"><table><thead><tr><th>å£°æ˜</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>@public</code></td><td>å…¬æœ‰çš„ï¼Œ åœ¨ç±»ä¸­å’Œç±»å¤–éƒ½å¯ä»¥ä½¿ç”¨å¹¶ä¸”å¯ä»¥è¢«ç»§æ‰¿</td></tr><tr><td><code>@private</code></td><td>ç§æœ‰çš„ï¼Œåœ¨ç±»ä¸­å¯ä»¥ä½¿ç”¨ï¼Œç±»å¤–æ— æ³•è°ƒç”¨ï¼Œä¸å¯ä»¥è¢«ç»§æ‰¿</td></tr><tr><td><code>@protected</code></td><td>å—ä¿æŠ¤çš„ï¼ˆé»˜è®¤ï¼‰ï¼Œåœ¨ç±»ä¸­å¯ä»¥ä½¿ç”¨ï¼Œç±»å¤–æ— æ³•è°ƒç”¨ï¼Œä½†æ˜¯å¯ä»¥è¢«ç»§æ‰¿</td></tr><tr><td><code>@package</code></td><td>æ¡†æ¶æƒé™ï¼Œåœ¨æ¡†æ¶å†…ç›¸å½“äºå—ä¿æŠ¤ï¼Œåœ¨æ¡†æ¶å¤–ç›¸å½“äºç§æœ‰</td></tr></tbody></table></div></div><blockquote><p>æ–¹æ³•æ˜¯æ²¡æœ‰è®¿é—®ä¿®é¥°ç¬¦çš„åŒcè¯­è¨€ä¸€æ ·ï¼Œå¦‚æœä¸æƒ³è®©å¤–éƒ¨è®¿é—®ï¼Œå»æ‰<code>.h</code>ä¸­çš„æ–¹æ³•å®šä¹‰å°±å¯ä»¥äº†ã€‚</p></blockquote><blockquote><p>MyClass.h</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyClass</span> : <span class="title">NSObject</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">@public</span></span><br><span class="line">    <span class="keyword">int</span> _classInt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> * className;</span><br><span class="line">-(<span class="keyword">void</span>) report;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>MyClass.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"MyClass.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MyClass</span></span></span><br><span class="line">- (<span class="keyword">void</span>)report</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"class name = %@"</span>, _className);</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"class name = %d"</span>, _classInt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>main.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MyClass.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        MyClass *c = [[MyClass alloc] init];</span><br><span class="line">        c.className = <span class="string">@"My Class"</span>;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨æŒ‡å‘æ¥è°ƒç”¨ç±»ä¸­çš„å…¬æœ‰æˆå‘˜å˜é‡</span></span><br><span class="line">        c-&gt;_classInt = <span class="number">22</span>;</span><br><span class="line">        [c report];</span><br><span class="line">    &#125;ÃŸ</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="ç»§æ‰¿">ç»§æ‰¿<a href="post/iOS-Objective-C-Learn#ç»§æ‰¿"></a></h2><blockquote><p>interface æ—¶å€™ å†’å· ä»£è¡¨ç»§æ‰¿</p></blockquote><blockquote><p>çˆ¶ç±»</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyClass</span> : <span class="title">NSObject</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> _claseInt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> * name;</span><br><span class="line">- (<span class="keyword">void</span>) report;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MyClass.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MyClass</span></span></span><br><span class="line">- (<span class="keyword">void</span>)report</span><br><span class="line">&#123;</span><br><span class="line">    _claseInt = <span class="number">23</span>;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"name = %@, value = %d"</span>, _name, _claseInt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>å­ç±»</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"MyClass.h"</span></span></span><br><span class="line"><span class="comment">// interface æ—¶å€™ å†’å· ä»£è¡¨ç»§æ‰¿</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MySubClass</span> : <span class="title">MyClass</span></span></span><br><span class="line">-(<span class="keyword">void</span>) show;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MySubClass.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MySubClass</span></span></span><br><span class="line">- (<span class="keyword">void</span>)show</span><br><span class="line">&#123;</span><br><span class="line">    _claseInt = <span class="number">100</span>;</span><br><span class="line">    [<span class="keyword">self</span> report];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>main.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MyClass.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MySubClass.h"</span></span></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        MyClass *c = [[MyClass alloc] init];</span><br><span class="line">        c.name = <span class="string">@"xu"</span>;</span><br><span class="line">        [c report];</span><br><span class="line"></span><br><span class="line">        MySubClass *sc = [[MySubClass alloc] init];</span><br><span class="line">        sc.name = <span class="string">@"xu"</span>;</span><br><span class="line"><span class="comment">//        [sc report];</span></span><br><span class="line">        [sc show];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>è¾“å‡º</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name = xu, value = <span class="number">23</span></span><br><span class="line">name = xu, value = <span class="number">23</span></span><br></pre></td></tr></table></div></figure><h2 id="å¤šæ€">å¤šæ€<a href="post/iOS-Objective-C-Learn#å¤šæ€"></a></h2><blockquote><p>çˆ¶ç±»<code>Printer.h</code>  <code>Printer.m</code></p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Printer</span> : <span class="title">NSObject</span></span></span><br><span class="line">- (<span class="keyword">void</span>) print;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Printer.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Printer</span></span></span><br><span class="line">- (<span class="keyword">void</span>)print</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"æˆ‘æ˜¯ä¸€ä¸ªæ‰“å°æœº"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>å­ç±»<code>ColorPrinter.h</code>  <code>ColorPrinter.m</code></p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"Printer.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ColorPrinter</span> : <span class="title">Printer</span></span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ColorPrinter.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ColorPrinter</span></span></span><br><span class="line">- (<span class="keyword">void</span>)print</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> print]; <span class="comment">// å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"æˆ‘æ˜¯ä¸€ä¸ªå½©è‰²æ‰“å°æœº"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></div></figure><blockquote><p>main.m</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ColorPrinter.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        ColorPrinter *cp = [[ColorPrinter alloc] init];</span><br><span class="line">        [cp print];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// çˆ¶ç±»å¯ä»¥å¼•ç”¨å­ç±»å‹</span></span><br><span class="line">        Printer * p = [[ColorPrinter alloc] init];</span><br><span class="line">        [p print];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>è¾“å‡º</p></blockquote><figure class="highlight objc"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘æ˜¯ä¸€ä¸ªæ‰“å°æœº</span><br><span class="line">æˆ‘æ˜¯ä¸€ä¸ªå½©è‰²æ‰“å°æœº</span><br><span class="line">æˆ‘æ˜¯ä¸€ä¸ªæ‰“å°æœº</span><br><span class="line">æˆ‘æ˜¯ä¸€ä¸ªå½©è‰²æ‰“å°æœº</span><br></pre></td></tr></table></div></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;æºä»£ç æ–‡ä»¶æ‰©å±•åå¯¹æ¯”&quot;&gt;æºä»£ç æ–‡ä»¶æ‰©å±•åå¯¹æ¯”&lt;a href=&quot;post/iOS-Objective-C-Learn#æºä»£ç æ–‡ä»¶æ‰©å±•åå¯¹æ¯”&quot;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;div class=&quot;article-bounded&quot;&gt;&lt;div class=&quot;article-tabl
      
    
    </summary>
    
      <category term="iOS" scheme="https://blog.xujiaji.com/categories/iOS/"/>
    
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¬”è®°" scheme="https://blog.xujiaji.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="iOS" scheme="https://blog.xujiaji.com/tags/iOS/"/>
    
      <category term="Objective-C" scheme="https://blog.xujiaji.com/tags/Objective-C/"/>
    
  </entry>
  
  <entry>
    <title>Git Commit Standard</title>
    <link href="https://blog.xujiaji.com/post/Git-Commit-Standard/index.html"/>
    <id>https://blog.xujiaji.com/post/Git-Commit-Standard/index.html</id>
    <published>2018-09-05T02:21:44.000Z</published>
    <updated>2019-04-08T06:55:24.990Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€ä¸‹Gitçš„æäº¤è§„èŒƒï¼Œæ–¹ä¾¿ä»¥åæŸ¥é˜…</p><a id="more"></a><h2 id="æäº¤å‘½ä»¤">æäº¤å‘½ä»¤<a href="post/Git-Commit-Standard#æäº¤å‘½ä»¤"></a></h2><ol><li><code>git commit -m &quot;æäº¤ä¿®æ”¹ä¿¡æ¯&quot;</code>ï¼Œè¿™æ ·è¿™åªèƒ½æœ‰ä¸€è¡Œä¿¡æ¯</li><li><code>git commit</code>ï¼Œä¼šè¿›å…¥<code>vi</code>æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå¯å†™å¤šè¡Œã€‚</li></ol><h2 id="æäº¤ä¿¡æ¯çš„æ ¼å¼">æäº¤ä¿¡æ¯çš„æ ¼å¼<a href="post/Git-Commit-Standard#æäº¤ä¿¡æ¯çš„æ ¼å¼"></a></h2><blockquote><p>æ¯æ¬¡æäº¤ä¿¡æ¯éƒ½åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ï¼šHeaderã€Bodyå’ŒFooterã€‚å…¶ä¸­ï¼ŒHeader æ˜¯å¿…éœ€çš„ï¼ŒBody å’Œ Footer å¯ä»¥çœç•¥ã€‚</p></blockquote><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</span><br><span class="line">// ç©ºä¸€è¡Œ</span><br><span class="line">&lt;body&gt;</span><br><span class="line">// ç©ºä¸€è¡Œ</span><br><span class="line">&lt;footer&gt;</span><br></pre></td></tr></table></div></figure><blockquote><p>æ–‡å­—æè¿°</p></blockquote><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># æ ‡é¢˜è¡Œï¼š50ä¸ªå­—ç¬¦ä»¥å†…ï¼Œæè¿°ä¸»è¦å˜æ›´å†…å®¹</span><br><span class="line">#</span><br><span class="line"># ä¸»ä½“å†…å®¹ï¼šæ›´è¯¦ç»†çš„è¯´æ˜æ–‡æœ¬ï¼Œå»ºè®®72ä¸ªå­—ç¬¦ä»¥å†…ã€‚ éœ€è¦æè¿°çš„ä¿¡æ¯åŒ…æ‹¬:</span><br><span class="line">#</span><br><span class="line"># * ä¸ºä»€ä¹ˆè¿™ä¸ªå˜æ›´æ˜¯å¿…é¡»çš„? å®ƒå¯èƒ½æ˜¯ç”¨æ¥ä¿®å¤ä¸€ä¸ªbugï¼Œå¢åŠ ä¸€ä¸ªfeatureï¼Œæå‡æ€§èƒ½ã€å¯é æ€§ã€ç¨³å®šæ€§ç­‰ç­‰</span><br><span class="line"># * ä»–å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜? å…·ä½“æè¿°è§£å†³é—®é¢˜çš„æ­¥éª¤</span><br><span class="line"># * æ˜¯å¦å­˜åœ¨å‰¯ä½œç”¨ã€é£é™©?</span><br><span class="line">#</span><br><span class="line"># å°¾éƒ¨ï¼šå¦‚æœéœ€è¦çš„åŒ–å¯ä»¥æ·»åŠ ä¸€ä¸ªé“¾æ¥åˆ°issueåœ°å€æˆ–è€…å…¶å®ƒæ–‡æ¡£ï¼Œæˆ–è€…å…³é—­æŸä¸ªissueã€‚</span><br></pre></td></tr></table></div></figure><h2 id="lt-type-gt"><code>&lt;type&gt;</code><a href="post/Git-Commit-Standard#lt-type-gt"></a></h2><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">Value</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left">feat</td><td style="text-align:left">featureæ–°åŠŸèƒ½</td></tr><tr><td style="text-align:left">fix</td><td style="text-align:left">ä¿®å¤bug</td></tr><tr><td style="text-align:left">doc</td><td style="text-align:left">ä»…ä»…ä¿®æ”¹äº†æ–‡æ¡£ï¼Œæ¯”å¦‚README, CHANGELOG, CONTRIBUTEç­‰ç­‰</td></tr><tr><td style="text-align:left">style</td><td style="text-align:left">ä»£ç æ ¼å¼æ”¹å˜ï¼Œä¸æ”¹å˜ä»£ç é€»è¾‘</td></tr><tr><td style="text-align:left">refactor</td><td style="text-align:left">ä»£ç é‡æ„ï¼Œæ²¡æœ‰åŠ æ–°åŠŸèƒ½æˆ–è€…ä¿®å¤bug</td></tr><tr><td style="text-align:left">perf</td><td style="text-align:left">ä¼˜åŒ–ç›¸å…³ï¼Œæ¯”å¦‚æå‡æ€§èƒ½ã€ä½“éªŒ</td></tr><tr><td style="text-align:left">test</td><td style="text-align:left">æµ‹è¯•ç”¨ä¾‹ï¼ŒåŒ…æ‹¬å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ç­‰</td></tr><tr><td style="text-align:left">chore</td><td style="text-align:left">æ”¹å˜æ„å»ºæµç¨‹ã€æˆ–è€…å¢åŠ ä¾èµ–åº“ã€å·¥å…·ç­‰</td></tr><tr><td style="text-align:left">revert</td><td style="text-align:left">å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬</td></tr></tbody></table></div></div><h2 id="lt-scope-gt"><code>&lt;scope&gt;</code><a href="post/Git-Commit-Standard#lt-scope-gt"></a></h2><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:left">Value</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left">all</td><td style="text-align:left">è¡¨ç¤ºå½±å“é¢å¤§ ï¼Œå¦‚ä¿®æ”¹äº†ç½‘ç»œæ¡†æ¶  ä¼šå¯¹çœŸä¸ªç¨‹åºäº§ç”Ÿå½±å“</td></tr><tr><td style="text-align:left">loation</td><td style="text-align:left">è¡¨ç¤ºå½±å“å°ï¼ŒæŸä¸ªå°å°çš„åŠŸèƒ½</td></tr><tr><td style="text-align:left">module</td><td style="text-align:left">è¡¨ç¤ºä¼šå½±å“æŸä¸ªæ¨¡å— å¦‚ç™»å½•æ¨¡å—ã€é¦–é¡µæ¨¡å— ã€ç”¨æˆ·ç®¡ç†æ¨¡å—ç­‰ç­‰</td></tr></tbody></table></div></div><h2 id="lt-subject-gt"><code>&lt;subject&gt;</code><a href="post/Git-Commit-Standard#lt-subject-gt"></a></h2><ol><li>subjectæ˜¯ commit ç›®çš„çš„ç®€çŸ­æè¿°ï¼Œä¸è¶…è¿‡50ä¸ªå­—ç¬¦ã€‚</li><li>ä»¥åŠ¨è¯å¼€å¤´ï¼Œç¬¬ä¸€ä¸ªå­—æ¯å°å†™ï¼Œä½¿ç”¨ç¬¬ä¸€äººç§°ç°åœ¨æ—¶ï¼Œæ¯”å¦‚changeï¼Œè€Œä¸æ˜¯changedæˆ–changes<br>ç¬¬ä¸€ä¸ªå­—æ¯å°å†™</li><li>ç»“å°¾ä¸åŠ å¥å·â€.â€</li></ol><h2 id="lt-body-gt"><code>&lt;body&gt;</code><a href="post/Git-Commit-Standard#lt-body-gt"></a></h2><p>å¯¹æœ¬æ¬¡ commit çš„è¯¦ç»†æè¿°ï¼Œå¯ä»¥åˆ†æˆå¤šè¡Œã€‚</p><h2 id="lt-footer-gt"><code>&lt;footer&gt;</code><a href="post/Git-Commit-Standard#lt-footer-gt"></a></h2><ol><li><p>å¹¶è”Issueï¼Œæœ¬æ¬¡æäº¤å¦‚æœå’Œæ‘¸ä¸ªissueæœ‰å…³ç³»åˆ™éœ€è¦å†™ä¸Šè¿™ä¸ªï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Issue #1, #2, #3</span><br></pre></td></tr></table></div></figure></li><li><p>å…³é—­ Issueï¼Œå¦‚æœå½“å‰æäº¤ä¿¡æ¯è§£å†³äº†æŸä¸ªissueï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ Footer éƒ¨åˆ†å…³é—­è¿™ä¸ª issueï¼Œå…³é—­çš„æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Close #1, #2, #3</span><br></pre></td></tr></table></div></figure></li></ol><h2 id="å®Œæ•´ä¾‹å­">å®Œæ•´ä¾‹å­<a href="post/Git-Commit-Standard#å®Œæ•´ä¾‹å­"></a></h2><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">feat(all): add login</span><br><span class="line"></span><br><span class="line">add login in project</span><br><span class="line"></span><br><span class="line">- qq login</span><br><span class="line">- weixin login</span><br><span class="line">- sina login</span><br><span class="line"></span><br><span class="line">Issue #1, #2</span><br><span class="line">Close #1, #2</span><br></pre></td></tr></table></div></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•ä¸€ä¸‹Gitçš„æäº¤è§„èŒƒï¼Œæ–¹ä¾¿ä»¥åæŸ¥é˜…&lt;/p&gt;
    
    </summary>
    
      <category term="å·¥å…·" scheme="https://blog.xujiaji.com/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="Git" scheme="https://blog.xujiaji.com/tags/Git/"/>
    
      <category term="ç¬”è®°" scheme="https://blog.xujiaji.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>iOSç”¨UISegmentedControlè®¾è®¡ä¸€ä¸ªé¡¶éƒ¨åˆ†é¡µå¯¼èˆª-Swiftï¼ˆç¿»è¯‘æ–‡ï¼‰</title>
    <link href="https://blog.xujiaji.com/post/ios-uisegmented-design/index.html"/>
    <id>https://blog.xujiaji.com/post/ios-uisegmented-design/index.html</id>
    <published>2018-07-23T06:36:32.000Z</published>
    <updated>2019-04-08T06:55:47.295Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>åŸæ–‡ï¼šã€Š<a href="https://www.codementor.io/kevinfarst/designing-a-button-bar-style-uisegmentedcontrol-in-swift-cg6cf0dok" target="_blank" rel="noopener">Designing a Button Bar-Style UISegmentedControl in Swift</a>ã€‹</p></blockquote><a id="more"></a><p>æˆ‘æ­£åœ¨åšä¸€ä¸ªé¡¹ç›®ï¼Œé¡¹ç›®é‡Œé¢æˆ‘æƒ³ç”¨<code>UISegmentedControl</code>åšä¸€ä¸ªç®€æ´çš„â€œåº•éƒ¨æ¡å½¢æ ·å¼â€çš„è®¾è®¡ã€‚å®ƒæ²¡æœ‰è¾¹æ¡†ï¼Œæ‰€é€‰ä¸‹æ–¹æœ‰ä¸€ä¸ªå°é•¿æ¡ï¼Œå½“ä½ é€‰æ‹©ä¸€ä¸ªå…ƒç´ åä»–ä¼šç›¸åº”çš„ç§»åŠ¨è¿‡å»ã€‚æˆ‘æ‰¾åˆ°å‡ ä¸ªéå¸¸å¥½çš„ç¬¬ä¸‰æ–¹åº“æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æˆ‘åœ¨è¿™äº›ç±»åº“ä¸Šé‡åˆ°äº†ä¸€äº›éº»çƒ¦ï¼Œäºæ˜¯æˆ‘å°è¯•è‡ªå·±åšã€‚æˆ‘ä»¥è‡ªåŠ¨å¸ƒå±€çº¦æŸï¼Œä»¥swiftä»£ç æ–¹å¼æ„å»ºè§†å›¾ï¼Œå¹¶ä¸ºäº†ç®€å•èµ·è§ï¼Œå°†æ‰€æœ‰ä¸»é¢˜å†…è”å®Œæˆã€‚</p><h2 id="å‡†å¤‡å¼€å§‹">å‡†å¤‡å¼€å§‹<a href="post/ios-uisegmented-design#å‡†å¤‡å¼€å§‹"></a></h2><p>æˆ‘ä»¬åœ¨Swift playgroundä¸­åšè¿™äº›äº‹æƒ…ï¼Œå› æ­¤è®©æˆ‘ä»¬ä»åŸºæœ¬çš„ä¸œè¥¿å¼€å§‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„UIViewå¹¶ä¸”æ·»åŠ ä¸€ä¸ªå¸¦æœ‰3ä¸ªç‰‡æ®µçš„UISegmentedControlï¼Œå¦å¤–éœ€è¦æ³¨æ„ï¼Œæˆ‘æ„å»ºçº¦æŸçš„æ–¹å¼æ˜¯å‡è®¾æ‰€æœ‰ç‰‡æ®µé•¿åº¦æƒ³ç­‰çš„æƒ…å†µã€‚å¦‚æœä¸æ˜¯çš„è¯ï¼Œä¼šå¯¼è‡´åº•éƒ¨é•¿æ¡åœ¨ç›¸åº”çš„ä½ç½®ä¸Šå˜å¾—å¤ªå®½æˆ–ä¸å¤Ÿå®½ã€‚</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> PlaygroundSupport</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®¹å™¨View</span></span><br><span class="line"><span class="keyword">let</span> view = <span class="type">UIView</span>(frame: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: <span class="number">400</span>, height: <span class="number">100</span>))</span><br><span class="line">view.backgroundColor = .white</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> segmentedControl = <span class="type">UISegmentedControl</span>()</span><br><span class="line"><span class="comment">// æ·»åŠ ç‰‡æ®µ</span></span><br><span class="line">segmentedControl.insertSegment(withTitle: <span class="string">"One"</span>, at: <span class="number">0</span>, animated: <span class="literal">true</span>)</span><br><span class="line">segmentedControl.insertSegment(withTitle: <span class="string">"Two"</span>, at: <span class="number">1</span>, animated: <span class="literal">true</span>)</span><br><span class="line">segmentedControl.insertSegment(withTitle: <span class="string">"Three"</span>, at: <span class="number">2</span>, animated: <span class="literal">true</span>)</span><br><span class="line"><span class="comment">// è®©ç¬¬ä¸€ä¸ªç‰‡æ®µé»˜è®¤é€‰ä¸­</span></span><br><span class="line">segmentedControl.selectedSegmentIndex = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®ä¸ºfalseï¼Œæˆ‘ä»¬æ‰èƒ½ä½¿ç”¨è‡ªåŠ¨å¸ƒå±€çº¦æŸ</span></span><br><span class="line">segmentedControl.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ UISegmentedControlåˆ°å®¹å™¨View</span></span><br><span class="line">view.addSubview(segmentedControl)</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¦æŸåˆ°å®¹å™¨çš„é¡¶éƒ¨</span></span><br><span class="line">segmentedControl.topAnchor.constraint(equalTo: view.topAnchor).isActive = <span class="literal">true</span></span><br><span class="line"><span class="comment">// é™åˆ¶ä¸ºå®¹å™¨viewçš„å®½åº¦</span></span><br><span class="line">segmentedControl.widthAnchor.constraint(equalTo: view.widthAnchor).isActive = <span class="literal">true</span></span><br><span class="line"><span class="comment">// è®¾ç½®é«˜åº¦</span></span><br><span class="line">segmentedControl.heightAnchor.constraint(equalToConstant: <span class="number">40</span>).isActive = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="type">PlaygroundPage</span>.current.liveView = view</span><br></pre></td></tr></table></div></figure><p>æ­¤æ—¶å®æ—¶çª—å£å·²ç»ä¸ºæˆ‘ä»¬å±•ç¤ºäº†åŸºæœ¬çš„<code>UISegmentedControl</code>ã€‚ä¸è¦å¿˜è®°å°†<code>isActive</code>å±æ€§é™„åŠ åˆ°æ¯ä¸ªè‡ªåŠ¨å¸ƒå±€çº¦æŸï¼Œå…¶å€¼ä¸ºtrueï¼Œå¦åˆ™ä»–ä»¬å°†ä¸èµ·ä½œç”¨ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/ios-uisegmented-design/basic-uisegmentedcontrol.png" alt="Basic UISegmentedControl"></p><h2 id="é¢œè‰²ã€å­—ä½“å’Œè¾¹æ¡†Oh-Myï¼">é¢œè‰²ã€å­—ä½“å’Œè¾¹æ¡†Oh Myï¼<a href="post/ios-uisegmented-design#é¢œè‰²ã€å­—ä½“å’Œè¾¹æ¡†Oh-Myï¼"></a></h2><p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬åˆ é™¤æ‰<code>backgroundColor</code>å’Œ<code>tintColor</code>ï¼Œåˆ é™¤åè¾¹æ¡†å’Œå·²é€‰æ‹©çš„ç‰‡æ®µèƒŒæ™¯é¢œè‰²å°†ä¼šæ¶ˆå¤±ã€‚<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ° selectedSegmentIndexä¸‹é¢</span></span><br><span class="line">segmentedControl.backgroundColor = .clear</span><br><span class="line">segmentedControl.tintColor = .clear</span><br></pre></td></tr></table></div></figure></p><p>å¦‚æœä½ çœ‹å®æ—¶çª—å£ï¼Œæˆ‘ä»¬åˆ é™¤äº†<code>tintColor</code>åï¼Œ<code>UISegmentedControl</code>å·²ç»æ¶ˆå¤±ï¼Œç°åœ¨æ²¡æœ‰é¢œè‰²äº†ã€‚è¦æ¢å¤æ ‡ç­¾ï¼Œè®©æˆ‘ä»¬æ›´æ”¹æ‰€é€‰ç‰‡æ®µå’Œæœªé€‰ç‰‡æ®µçš„å­—ä½“ã€æ–‡æœ¬é¢œè‰²å’Œå¤§å°ã€‚<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ è¿™äº›ä»£ç åˆ° segmentedControl.tintColor = .clear å</span></span><br><span class="line">segmentedControl.setTitleTextAttributes([</span><br><span class="line">    <span class="type">NSAttributedStringKey</span>.font: <span class="type">UIFont</span>(name: <span class="string">"DINCondensed-Bold"</span>, size: <span class="number">18</span>)!,</span><br><span class="line">    <span class="type">NSAttributedStringKey</span>.foregroundColor: <span class="type">UIColor</span>.lightGray</span><br><span class="line">    ], <span class="keyword">for</span>: .normal)</span><br><span class="line"></span><br><span class="line">segmentedControl.setTitleTextAttributes([</span><br><span class="line">    <span class="type">NSAttributedStringKey</span>.font : <span class="type">UIFont</span>(name: <span class="string">"DINCondensed-Bold"</span>, size: <span class="number">18</span>)!,</span><br><span class="line">    <span class="type">NSAttributedStringKey</span>.foregroundColor: <span class="type">UIColor</span>.orange</span><br><span class="line">    ], <span class="keyword">for</span>: .selected)</span><br></pre></td></tr></table></div></figure></p><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/ios-uisegmented-design/change-color-font.png" alt="change-color-font"><br>åˆ°è¿™å„¿å·®ä¸å¤šäº†ï¼ç°åœ¨æˆ‘ä»¬å¿…é¡»åœ¨æ‰€é€‰æ®µä¸‹æ–¹æ·»åŠ ä¸€ä¸ªé•¿æ¡æ ã€‚</p><h2 id="ä¸ºé€‰å®šç‰‡æ®µåº•éƒ¨æ·»åŠ é•¿æ¡">ä¸ºé€‰å®šç‰‡æ®µåº•éƒ¨æ·»åŠ é•¿æ¡<a href="post/ios-uisegmented-design#ä¸ºé€‰å®šç‰‡æ®µåº•éƒ¨æ·»åŠ é•¿æ¡"></a></h2><p>è¿™ä¸ªé•¿æ¡åªæ˜¯ä¸€ä¸ªç®€å•çš„UIViewï¼Œç„¶åå°†å…¶<code>backgroundColor</code>ä¸å…¶æ‰€é€‰ç‰‡æ®µå­—ä½“çš„é¢œè‰²ç›¸åŒ¹é…ã€‚æˆ‘ä»¬å°†é€‰æ‹©çš„ç‰‡æ®µå­—ä½“é¢œè‰²å’Œé•¿æ¡éƒ½è®¾ç½®ä¸ºæ©™è‰²ã€‚å¹¶ä¸”æˆ‘ä»¬è¦ä¸ºé•¿æ¡è®¾ç½®<code>translatesAutoresizingMaskIntoConstraints</code>ä¸ºfalseã€‚<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> buttonBar = <span class="type">UIView</span>()</span><br><span class="line"><span class="comment">// è®¾ç½®ä¸ºfalseï¼Œæˆ‘ä»¬æ‰èƒ½ä½¿ç”¨è‡ªåŠ¨å¸ƒå±€çº¦æŸ</span></span><br><span class="line">buttonBar.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></span><br><span class="line">buttonBar.backgroundColor = <span class="type">UIColor</span>.orange</span><br></pre></td></tr></table></div></figure></p><p>æ¥ä¸‹æ¥ï¼Œå°†<code>buttonBar</code>ä½œä¸ºå­Viewæ·»åŠ åˆ°å®¹å™¨viewä¸­<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ åˆ° view.addSubview(segmentedControl)ä¹‹å</span></span><br><span class="line">view.addSubview(buttonBar)</span><br></pre></td></tr></table></div></figure></p><p>æœ€ç»ˆï¼Œæˆ‘ä»¬éœ€è¦ç»™å®ƒä¸ªå®½åº¦ã€é«˜åº¦å’Œä½ç½®ï¼Œåœ¨<code>segmentedControl</code>ä¹‹åæ·»åŠ è¿™äº›çº¦æŸ<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// çº¦æŸå®ƒçš„é¡¶éƒ¨ä½ç½®åœ¨ç‰‡æ®µçš„åº•éƒ¨ä½ç½®</span></span><br><span class="line">buttonBar.topAnchor.constraint(equalTo: segmentedControl.bottomAnchor).isActive = <span class="literal">true</span></span><br><span class="line"><span class="comment">// è®¾ç½®é•¿æ¡çš„é«˜åº¦</span></span><br><span class="line">buttonBar.heightAnchor.constraint(equalToConstant: <span class="number">5</span>).isActive = <span class="literal">true</span></span><br><span class="line"><span class="comment">// çº¦æŸå®ƒçš„å·¦ä¾§å’Œç‰‡æ®µçš„å·¦ä¾§é‡åˆ</span></span><br><span class="line">buttonBar.leftAnchor.constraint(equalTo: segmentedControl.leftAnchor).isActive = <span class="literal">true</span></span><br><span class="line"><span class="comment">// çº¦æŸå®ƒçš„å®½åº¦ = ç‰‡æ®µå®¹å™¨å®½åº¦ / ç‰‡æ®µä¸ªæ•°</span></span><br><span class="line">buttonBar.widthAnchor.constraint(equalTo: segmentedControl.widthAnchor, multiplier: <span class="number">1</span> / <span class="type">CGFloat</span>(segmentedControl.numberOfSegments)).isActive = <span class="literal">true</span></span><br></pre></td></tr></table></div></figure></p><p>æ­£å¦‚æœ€åé‚£æ¡æ³¨é‡Šæ‰€è¯´ï¼Œæˆ‘ä»¬éœ€è¦é•¿æ¡çš„å®½åº¦ä¸º<code>segmentedControl</code>çš„å®½åº¦é™¤ä»¥ç‰‡æ®µä¸ªä¸ªæ•°ã€‚è¿™ä¿è¯äº†é•¿æ¡å®½åº¦å°†ä¸å•ä¸ªç‰‡æ®µçš„å®½åº¦å®Œå…¨åŒ¹é…ï¼ŒåŒæ ·è¿™é‡Œæ˜¯å‡è®¾æ‰€æœ‰çš„æ®µéƒ½æ˜¯æƒ³ç­‰çš„å®½åº¦ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/ios-uisegmented-design/added-bar.png" alt="added-bar"><br>åˆå§‹è§†å›¾ç°åœ¨å·²å®Œæˆï¼æœ€åä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦è®©é•¿æ¡éšæ‰€é€‰çš„ç‰‡æ®µç§»åŠ¨ã€‚</p><h2 id="é•¿æ¡æ åŠ¨ç”»">é•¿æ¡æ åŠ¨ç”»<a href="post/ios-uisegmented-design#é•¿æ¡æ åŠ¨ç”»"></a></h2><p>å½“æ‰€é€‰ç‰‡æ®µå‘ç”Ÿæ”¹å˜æ—¶ï¼Œ<code>segmentedControl</code>éœ€è¦è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ¥å¤„ç†é•¿æ¡æ åœ¨xè½´ä¸Šçš„ä½ç½®è½¬æ¢ï¼Œä½¿å…¶è·‘åˆ°é€‰æ‹©çš„ç‰‡æ®µä¸‹æ–¹ã€‚å®šä¹‰ä¸ª<code>Responder</code>ç±»ï¼Œå¹¶æ·»åŠ æ–¹æ³•ï¼Œç„¶ååœ¨<code>segmentedControl</code>å˜é‡ä¸Šæ·»åŠ å›è°ƒï¼Œ<code>segmentedControl</code>çš„å€¼æ”¹å˜æ—¶ä¼šè§¦å‘ã€‚<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨importå£°æ˜ä¸‹æ–¹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Responder</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">segmentedControlValueChanged</span><span class="params">(<span class="number">_</span> sender: UISegmentedControl)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> responder = <span class="type">Responder</span>()</span><br><span class="line">...</span><br><span class="line"><span class="comment">// åœ¨PlaygroundPage.current.liveView = viewå£°æ˜çš„ä¸Šæ–¹</span></span><br><span class="line">segmentedControl.addTarget(responder, action: #selector(responder.segmentedControlValueChanged(<span class="number">_</span>:)), <span class="keyword">for</span>: <span class="type">UIControlEvents</span>.valueChanged)</span><br></pre></td></tr></table></div></figure></p><p>ä¸€å®šè¦ç¡®ä¿<code>sender</code>ä½œä¸ºæ–¹æ³•å‚æ•°ç±»å‹ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨è°ƒç”¨å‡½æ•°æ—¶è®¿é—®å®ƒã€‚æœ€åè®©æˆ‘ä»¬æ¥å®Œæˆæœ€åä¸€å—æ‹¼å›¾ï¼Œ<code>buttonBar</code>åœ¨xè½´çš„ç§»åŠ¨ï¼Œå®ƒå°†ç§»åŠ¨åˆ°è¢«é€‰ä¸­çš„ç‰‡æ®µä¸‹<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">segmentedControlValueChanged</span><span class="params">(<span class="number">_</span> sender: UISegmentedControl)</span></span> &#123;</span><br><span class="line">  <span class="type">UIView</span>.animate(withDuration: <span class="number">0.3</span>) &#123;</span><br><span class="line">      buttonBar.frame.origin.x = (segmentedControl.frame.width / <span class="type">CGFloat</span>(segmentedControl.numberOfSegments)) * <span class="type">CGFloat</span>(segmentedControl.selectedSegmentIndex)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p>é•¿æ¡å› è¯¥å»çš„xè½´ä½ç½® = (<code>segmentedControl</code>çš„å®½åº¦ / ç‰‡æ®µä¸ªæ•°) * å½“å‰ç‰‡æ®µçš„ä¸‹æ ‡</p><p>ç§ç§ï¼æˆ‘ä»¬çš„åŠ¨ç”»æŒ‰é’®æ å‡ºæ¥äº†<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/ios-uisegmented-design/display.gif" alt="finished"></p><h2 id="ç»“è®º">ç»“è®º<a href="post/ios-uisegmented-design#ç»“è®º"></a></h2><p>æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« æ‰€æä¾›çš„ä¿¡æ¯ï¼Œèƒ½ä½œä¸ºä½ åœ¨çœ‹äº†è®¸å¤šç±»åº“æˆ–iOSåº”ç”¨åçš„ä¸€ä¸ªDIYè§£å†³æ–¹æ¡ˆã€‚ä½ å¯ä»¥å°†è¿™é‡Œçš„<code>UISegmentedControl</code>è¿æ¥åˆ°<code>UIPageViewController</code>æˆ–<code>UIScrollView</code>ä½œä¸ºåˆ†æ®µå†…å®¹ç›´æ¥ç§»åŠ¨çš„æ–¹å¼ã€‚ä½ è¿™å¯ä»¥åœ¨<a href="https://gist.github.com/kfarst/9f8a1eb59cce2004b15f0b682c92eeed" target="_blank" rel="noopener">è¿™é‡Œ</a>æ‰¾åˆ°playgroudä»£ç åœ¨Github Gistï¼Œç¥æ‚¨iOSå¼€å‘é¡ºåˆ©ï¼</p><hr><blockquote><p>è¡¥å……è¯´æ˜ï¼šä¸‹é¢é“¾æ¥åˆ°çš„æ˜¯æˆ‘åœ¨ç»ƒä¹ çš„æ—¶å€™å†™çš„ä»£ç ï¼Œä¾›å‚è€ƒï¼</p></blockquote><p><a href="https://github.com/xujiaji/Learn-iOS/blob/master/TabSegmentedControl.playground/Contents.swift" target="_blank" rel="noopener">https://github.com/xujiaji/Learn-iOS/blob/master/TabSegmentedControl.playground/Contents.swift</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;åŸæ–‡ï¼šã€Š&lt;a href=&quot;https://www.codementor.io/kevinfarst/designing-a-button-bar-style-uisegmentedcontrol-in-swift-cg6cf0dok&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Designing a Button Bar-Style UISegmentedControl in Swift&lt;/a&gt;ã€‹&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="iOS" scheme="https://blog.xujiaji.com/categories/iOS/"/>
    
    
      <category term="ç¿»è¯‘" scheme="https://blog.xujiaji.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
      <category term="iOS" scheme="https://blog.xujiaji.com/tags/iOS/"/>
    
      <category term="UI" scheme="https://blog.xujiaji.com/tags/UI/"/>
    
      <category term="Swift" scheme="https://blog.xujiaji.com/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>iOSå¼€å‘-é›¶ç¢ç¬”è®°</title>
    <link href="https://blog.xujiaji.com/post/ios-study-note/index.html"/>
    <id>https://blog.xujiaji.com/post/ios-study-note/index.html</id>
    <published>2018-07-16T00:08:16.000Z</published>
    <updated>2019-10-14T15:55:36.881Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€äº›iOSå­¦ä¹ è¿‡ç¨‹ä¸­çš„ç¬”è®°<br><a id="more"></a></p><h1 id="iOSå¼€å‘-é›¶ç¢ç¬”è®°">iOSå¼€å‘-é›¶ç¢ç¬”è®°<a href="post/ios-study-note#iOSå¼€å‘-é›¶ç¢ç¬”è®°"></a></h1><h2 id="åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„">åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„<a href="post/ios-study-note#åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„"></a></h2><ol><li>AppDelegate.swift:ç”Ÿå‘½å‘¨æœŸåŠå˜é‡çš„å®šä¹‰</li><li>ViewController.swift: MVCçš„C</li><li>Assets.xcasset:æ”¾èµ„æºæ–‡ä»¶ï¼Œå¦‚å›¾ç‰‡ç­‰</li><li>info.plistï¼šé…ç½®æ–‡ä»¶</li><li>xxxTest: å•å…ƒæµ‹è¯•</li><li>Products:ç”Ÿæˆçš„æ–‡ä»¶</li><li>Main.storyboard: è§†å›¾</li></ol><h2 id="å¿«æ·æ·»åŠ æ³¨é‡Š">å¿«æ·æ·»åŠ æ³¨é‡Š<a href="post/ios-study-note#å¿«æ·æ·»åŠ æ³¨é‡Š"></a></h2><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">option + command + /</span><br></pre></td></tr></table></div></figure><h2 id="å…³é—­è½¯é”®ç›˜">å…³é—­è½¯é”®ç›˜<a href="post/ios-study-note#å…³é—­è½¯é”®ç›˜"></a></h2><blockquote><p>å…³é—­ä»£ç </p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">textField.resignFirstResponder()</span><br></pre></td></tr></table></div></figure><blockquote><p>å…³é—­æ–¹å¼1ï¼š<br>åœ¨Controllerä¸­é‡å†™touchesEnded()æ–¹æ³•ï¼Œç„¶ååœ¨è¿™é‡Œé¢å…³é—­è½¯ä»¶ç›˜ï¼Œæ„æ€æ˜¯ç‚¹å‡»ç©ºç™½å¤„å…³é—­</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">touchesEnded</span><span class="params">(<span class="number">_</span> touches: Set&lt;UITouch&gt;, with event: UIEvent?)</span></span> &#123;</span><br><span class="line">    name.resignFirstResponder()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>å…³é—­æ–¹å¼2ï¼š<br>ç‚¹å‡»ä¸‹ä¸€æ­¥æ—¶ï¼Œå…³é—­è½¯é”®ç›˜ï¼›<br>Controllerå®ç°UITextFieldDelegateåè®®ï¼›<br>å®ç°UITextFieldDelegateåè®®ä¸­çš„textFieldShouldReturnæ–¹æ³•ï¼›</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">textFieldShouldReturn</span><span class="params">(<span class="number">_</span> textField: UITextField)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    textField.resignFirstResponder()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="UIDatePickeré€‰æ‹©æ—¶é—´åè®¡ç®—å¹´é¾„">UIDatePickeré€‰æ‹©æ—¶é—´åè®¡ç®—å¹´é¾„<a href="post/ios-study-note#UIDatePickeré€‰æ‹©æ—¶é—´åè®¡ç®—å¹´é¾„"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">calAge</span><span class="params">(by datePicker: UIDatePicker)</span></span> -&gt; <span class="type">Int</span>? &#123;</span><br><span class="line">    <span class="keyword">let</span> gregorian = <span class="type">NSCalendar</span>(calendarIdentifier: .gregorian)</span><br><span class="line">    <span class="keyword">let</span> now = <span class="type">Date</span>()</span><br><span class="line">    <span class="keyword">let</span> components = gregorian?.components(<span class="type">NSCalendar</span>.<span class="type">Unit</span>.year, from: datePicker.date, to: now, options: <span class="type">NSCalendar</span>.<span class="type">Options</span>.<span class="keyword">init</span>(rawValue: <span class="number">0</span>))</span><br><span class="line">    <span class="keyword">return</span> components?.year</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="é¡µé¢è·³è½¬ï¼Œä¼ é€’æ•°æ®">é¡µé¢è·³è½¬ï¼Œä¼ é€’æ•°æ®<a href="post/ios-study-note#é¡µé¢è·³è½¬ï¼Œä¼ é€’æ•°æ®"></a></h2><p>æœ‰ä¸¤ä¸ªControllerï¼šViewControllerå’ŒGalleryViewControllerã€‚ä»ViewControllerè·³è½¬åˆ°GalleryViewControllerã€‚<br>ViewControlleré‡å†™æ–¹æ³•ï¼šprepareï¼Œè¯¥æ–¹æ³•åœ¨é¡µé¢è·³è½¬æ—¶ä¼šè¢«è°ƒç”¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨é‡Œé¢åˆ¤æ–­æ˜¯è·³è½¬åˆ°å“ªä¸ªé¡µé¢ã€‚</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">prepare</span><span class="params">(<span class="keyword">for</span> segue: UIStoryboardSegue, sender: <span class="keyword">Any</span>?)</span></span> &#123;</span><br><span class="line">    <span class="comment">// éœ€è¦ç»™Segueå–å</span></span><br><span class="line">    <span class="keyword">if</span> segue.identifier == <span class="string">"GoToGallery"</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> index = beautyPicker.selectedRow(inComponent: <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">var</span> imageName: <span class="type">String</span>?</span><br><span class="line">        <span class="keyword">switch</span> index &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            imageName = <span class="string">"fangbingbing"</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            imageName = <span class="string">"libingbing"</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            imageName = <span class="string">"wangfei"</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            imageName = <span class="string">"yangmi"</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            imageName = <span class="string">"zhouxu"</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            imageName = <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¾—åˆ°ä¸‹ä¸€ä¸ªé¡µé¢çš„Controller</span></span><br><span class="line">        <span class="keyword">let</span> vc = segue.destination <span class="keyword">as</span>! <span class="type">GalleryViewController</span></span><br><span class="line">        vc.imageName = imageName</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="é€šè¿‡å›¾ç‰‡æ–‡ä»¶åè®¾ç½®å›¾ç‰‡">é€šè¿‡å›¾ç‰‡æ–‡ä»¶åè®¾ç½®å›¾ç‰‡<a href="post/ios-study-note#é€šè¿‡å›¾ç‰‡æ–‡ä»¶åè®¾ç½®å›¾ç‰‡"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">beautyImage.image = <span class="type">UIImage</span>(named: imageName)</span><br></pre></td></tr></table></div></figure><h2 id="unwind-segueå…³é—­é¡µé¢">unwind segueå…³é—­é¡µé¢<a href="post/ios-study-note#unwind-segueå…³é—­é¡µé¢"></a></h2><p>å…³é—­é¡µé¢åï¼ŒControllerå¯ä»¥è·å¾—ä¸Šä¸ªé¡µé¢ä¼ å›æ¥çš„å€¼<br>è¯¥æ–¹æ³•å†™åœ¨å‰ä¸€ä¸ªé¡µé¢<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">closedPrePage</span><span class="params">(segue: UIStoryboardSegue)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"closed"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><h2 id="TableViewä¸‹ç§»ä¸€ä¸ªçŠ¶æ€æ çš„é«˜åº¦è§£å†³">TableViewä¸‹ç§»ä¸€ä¸ªçŠ¶æ€æ çš„é«˜åº¦è§£å†³<a href="post/ios-study-note#TableViewä¸‹ç§»ä¸€ä¸ªçŠ¶æ€æ çš„é«˜åº¦è§£å†³"></a></h2><ol><li><p>æ–¹æ³•ä¸€</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> #available(iOS <span class="number">11.0</span>, *) &#123;</span><br><span class="line">    tableView.contentInsetAdjustmentBehavior = .never</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>æ–¹æ³•äºŒï¼Œå†…å®¹ä¸Šéƒ¨åˆ†åŒºåŸŸå‘ä¸Šåç§»ä¸€ä¸ªçŠ¶æ€æ çš„é«˜åº¦</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">collectionView?.contentInset.top = -<span class="type">UIApplication</span>.shared.statusBarFrame.height</span><br></pre></td></tr></table></div></figure></li></ol><h2 id="TableView-æ·»åŠ åˆ·æ–°">TableView æ·»åŠ åˆ·æ–°<a href="post/ios-study-note#TableView-æ·»åŠ åˆ·æ–°"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> refreshControl = <span class="type">UIRefreshControl</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–åˆ·æ–°</span></span><br><span class="line">refreshControl.backgroundColor = <span class="type">UIColor</span>.blue <span class="comment">//è®¾ç½®åˆ·æ–°çš„èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">refreshControl.attributedTitle = <span class="type">NSAttributedString</span>(string: <span class="string">"åˆ·æ–°ä¸€ä¸‹ï¼š\(Data())"</span>, attributes: [<span class="type">NSAttributedStringKey</span>.foregroundColor: <span class="type">UIColor</span>.white]) <span class="comment">// è®¾ç½®å­—ä½“é¢œè‰²</span></span><br><span class="line">refreshControl.tintColor = <span class="type">UIColor</span>.green <span class="comment">// åŠ è½½èŠèŠ±é¢œè‰²</span></span><br><span class="line">refreshControl.tintAdjustmentMode = .dimmed <span class="comment">// è‰²å½©è°ƒæ•´æ¨¡å¼</span></span><br><span class="line">refreshControl.addTarget(<span class="keyword">self</span>, action: #selector(addcount), <span class="keyword">for</span>: .valueChanged) <span class="comment">//æ·»åŠ æ–¹æ³•ç›®æ ‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ è¯¥åˆ·æ–°</span></span><br><span class="line">tableView.refreshControl = refreshControl</span><br></pre></td></tr></table></div></figure><p>åˆ·æ–°æ–¹æ³•</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">addcount</span><span class="params">()</span></span> &#123;</span><br><span class="line">    dataArrary.append(contentsOf: dataArrary)</span><br><span class="line">    tableView.reloadData()</span><br><span class="line">    refreshControl.endRefreshing()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="å‘é¡¹ç›®æ·»åŠ å­—ä½“">å‘é¡¹ç›®æ·»åŠ å­—ä½“<a href="post/ios-study-note#å‘é¡¹ç›®æ·»åŠ å­—ä½“"></a></h2><p><a href="https://developer.apple.com/documentation/uikit/text_display_and_fonts/adding_a_custom_font_to_your_app" target="_blank" rel="noopener">https://developer.apple.com/documentation/uikit/text_display_and_fonts/adding_a_custom_font_to_your_app</a></p><p>ç”±äºiOSçš„ç”¨çš„å­—ä½“åç§°å¹¶ä¸æ˜¯æ–‡ä»¶åç§°ï¼Œè€Œæ˜¯å­—ä½“æœ¬èº«åç§°ã€‚<br>ä¸‹é¢ä»£ç æœç´¢æ‰€æœ‰å­—ä½“ï¼Œç„¶åæˆ‘ä»¬åœ¨æ§åˆ¶å°ï¼Œæ‰¾åˆ°å¤šå‡ºæ¥çš„åç§°ã€‚</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> family: <span class="type">String</span> <span class="keyword">in</span> <span class="type">UIFont</span>.familyNames</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(family)"</span>)</span><br><span class="line">    <span class="keyword">for</span> names: <span class="type">String</span> <span class="keyword">in</span> <span class="type">UIFont</span>.fontNames(forFamilyName: family)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"== \(names)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="è®¾ç½®tabbar-å­—ä½“å’Œå­—ä½“å¤§å°">è®¾ç½®tabbar å­—ä½“å’Œå­—ä½“å¤§å°<a href="post/ios-study-note#è®¾ç½®tabbar-å­—ä½“å’Œå­—ä½“å¤§å°"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">    <span class="keyword">let</span> appearance = <span class="type">UITabBarItem</span>.appearance()</span><br><span class="line">    appearance.setTitleTextAttributes([<span class="type">NSAttributedStringKey</span>.font: <span class="type">UIFont</span>(name: <span class="string">"Ubuntu-Light"</span>, size: <span class="number">9</span>)!], <span class="keyword">for</span>: .normal)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="UIButton-ç›¸å…³">UIButton ç›¸å…³<a href="post/ios-study-note#UIButton-ç›¸å…³"></a></h2><h3 id="UIButton-isEnabled-falseåå›¾ç‰‡æŒ‰é’®çš„èƒŒæ™¯å›¾ç‰‡è¢«æ”¹å˜">UIButton<code>.isEnabled = false</code>åå›¾ç‰‡æŒ‰é’®çš„èƒŒæ™¯å›¾ç‰‡è¢«æ”¹å˜<a href="post/ios-study-note#UIButton-isEnabled-falseåå›¾ç‰‡æŒ‰é’®çš„èƒŒæ™¯å›¾ç‰‡è¢«æ”¹å˜"></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UIButton</span>.adjustsImageWhenDisabled = <span class="literal">false</span></span><br></pre></td></tr></table></div></figure><h3 id="æ‰©å±•æ·»åŠ åœ†è§’ã€è¾¹æ¡†ã€è¾¹æ¡†é¢œè‰²">æ‰©å±•æ·»åŠ åœ†è§’ã€è¾¹æ¡†ã€è¾¹æ¡†é¢œè‰²<a href="post/ios-study-note#æ‰©å±•æ·»åŠ åœ†è§’ã€è¾¹æ¡†ã€è¾¹æ¡†é¢œè‰²"></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@IBDesignable</span> <span class="class"><span class="keyword">extension</span> <span class="title">UIButton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@IBInspectable</span> <span class="keyword">var</span> borderWidth: <span class="type">CGFloat</span> &#123;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            layer.borderWidth = newValue</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> layer.borderWidth</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@IBInspectable</span> <span class="keyword">var</span> cornerRadius: <span class="type">CGFloat</span> &#123;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            layer.cornerRadius = newValue</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> layer.cornerRadius</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@IBInspectable</span> <span class="keyword">var</span> borderColor: <span class="type">UIColor</span>? &#123;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> uiColor = newValue <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">            layer.borderColor = uiColor.cgColor</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> color = layer.borderColor <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">UIColor</span>(cgColor: color)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="æ‰©å±•å›¾ç‰‡åœ¨ä¸Šï¼Œæ–‡å­—åœ¨ä¸‹">æ‰©å±•å›¾ç‰‡åœ¨ä¸Šï¼Œæ–‡å­—åœ¨ä¸‹<a href="post/ios-study-note#æ‰©å±•å›¾ç‰‡åœ¨ä¸Šï¼Œæ–‡å­—åœ¨ä¸‹"></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIButton</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">alignVertical</span><span class="params">(spacing: CGFloat = <span class="number">6.0</span>, imageBottom: CGFloat = <span class="number">0.0</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> imageSize = <span class="keyword">self</span>.imageView?.image?.size,</span><br><span class="line">            <span class="keyword">let</span> text = <span class="keyword">self</span>.titleLabel?.text,</span><br><span class="line">            <span class="keyword">let</span> font = <span class="keyword">self</span>.titleLabel?.font</span><br><span class="line">            <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">        <span class="keyword">self</span>.titleEdgeInsets = <span class="type">UIEdgeInsets</span>(top: <span class="number">0.0</span>, <span class="keyword">left</span>: -imageSize.width, bottom: -(imageSize.height + spacing), <span class="keyword">right</span>: <span class="number">0.0</span>)</span><br><span class="line">        <span class="keyword">let</span> labelString = <span class="type">NSString</span>(string: text)</span><br><span class="line">        <span class="keyword">let</span> titleSize = labelString.size(withAttributes: [<span class="type">NSAttributedStringKey</span>.font: font])</span><br><span class="line">        <span class="keyword">self</span>.imageEdgeInsets = <span class="type">UIEdgeInsets</span>(top: -(titleSize.height + spacing), <span class="keyword">left</span>: <span class="number">0.0</span>, bottom: imageBottom, <span class="keyword">right</span>: -titleSize.width)</span><br><span class="line">        <span class="keyword">let</span> edgeOffset = <span class="built_in">abs</span>(titleSize.height - imageSize.height) / <span class="number">2.0</span>;</span><br><span class="line">        <span class="keyword">self</span>.contentEdgeInsets = <span class="type">UIEdgeInsets</span>(top: edgeOffset, <span class="keyword">left</span>: <span class="number">0.0</span>, bottom: edgeOffset, <span class="keyword">right</span>: <span class="number">0.0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="ç»™UIButtonå›¾ç‰‡æŸ“è‰²">ç»™UIButtonå›¾ç‰‡æŸ“è‰²<a href="post/ios-study-note#ç»™UIButtonå›¾ç‰‡æŸ“è‰²"></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> button = <span class="type">UIButton</span>(type: .custom)</span><br><span class="line"><span class="keyword">let</span> image = <span class="type">UIImage</span>(named: <span class="string">"image_name"</span>)?.withRenderingMode(.alwaysTemplate)</span><br><span class="line">button.setImage(image, <span class="keyword">for</span>: .normal)</span><br><span class="line">button.tintColor = <span class="type">UIColor</span>.red</span><br></pre></td></tr></table></div></figure><h2 id="UITableViewæˆ–UICollectionViewè¢«TabBaré®ç›–">UITableViewæˆ–UICollectionViewè¢«TabBaré®ç›–<a href="post/ios-study-note#UITableViewæˆ–UICollectionViewè¢«TabBaré®ç›–"></a></h2><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/ios-note/note-screen1.png" alt="" class="article-img"></p><h2 id="UITableViewè°ƒç”¨reloadDataå¯¼è‡´ç§»åŠ¨åˆ°åˆ—è¡¨é¡¶éƒ¨å¤±æ•ˆ">UITableViewè°ƒç”¨<code>reloadData</code>å¯¼è‡´ç§»åŠ¨åˆ°åˆ—è¡¨é¡¶éƒ¨å¤±æ•ˆ<a href="post/ios-study-note#UITableViewè°ƒç”¨reloadDataå¯¼è‡´ç§»åŠ¨åˆ°åˆ—è¡¨é¡¶éƒ¨å¤±æ•ˆ"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UIView</span>.animate(withDuration: <span class="number">0</span>, animations: &#123;</span><br><span class="line">    <span class="keyword">self</span>.tableView.contentOffset = <span class="type">CGPoint</span>.zero</span><br><span class="line">&#125;, completion: &#123; <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">self</span>.tableView.reloadData()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></div></figure><h2 id="NavigationBarå¯¼è‡´CollectionViewCellæˆ–TableViewCellåç§»">NavigationBarå¯¼è‡´CollectionViewCellæˆ–TableViewCellåç§»<a href="post/ios-study-note#NavigationBarå¯¼è‡´CollectionViewCellæˆ–TableViewCellåç§»"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.collectionView?.contentInsetAdjustmentBehavior = .automatic</span><br></pre></td></tr></table></div></figure><h2 id="è·å–appç‰ˆæœ¬">è·å–appç‰ˆæœ¬<a href="post/ios-study-note#è·å–appç‰ˆæœ¬"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// è·å–ç‰ˆæœ¬å</span></span><br><span class="line"><span class="keyword">let</span> appVersion = <span class="type">Bundle</span>.main.infoDictionary![<span class="string">"CFBundleShortVersionString"</span>] <span class="keyword">as</span>? <span class="type">String</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/// è·å–ç‰ˆæœ¬å·</span></span><br><span class="line"><span class="keyword">let</span> versionNumber = <span class="type">Bundle</span>.main.infoDictionary![<span class="string">"CFBundleVersion"</span>] <span class="keyword">as</span>? <span class="type">String</span></span><br></pre></td></tr></table></div></figure><h2 id="æ‰“å¼€ç½‘é¡µæœ¬è½¯ä»¶çš„appstore">æ‰“å¼€ç½‘é¡µæœ¬è½¯ä»¶çš„appstore<a href="post/ios-study-note#æ‰“å¼€ç½‘é¡µæœ¬è½¯ä»¶çš„appstore"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App Store URL.</span></span><br><span class="line"><span class="keyword">let</span> appStoreLink = <span class="string">"https://itunes.apple.com/cn/app/id1144351773?mt=8"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* First create a URL, then check whether there is an installed app that can</span></span><br><span class="line"><span class="comment"> open it on the device. */</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> url = <span class="type">URL</span>(string: appStoreLink), <span class="type">UIApplication</span>.shared.canOpenURL(url) &#123;</span><br><span class="line">    <span class="comment">// Attempt to open the URL.</span></span><br><span class="line">    <span class="type">UIApplication</span>.shared.<span class="keyword">open</span>(url, options: [:], completionHandler: &#123;(success: <span class="type">Bool</span>) <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> success &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Launching \(url) was successful"</span>)</span><br><span class="line">        &#125;&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="è®¾ç½®åœ†å½¢å±•ç¤ºå›¾åƒ">è®¾ç½®åœ†å½¢å±•ç¤ºå›¾åƒ<a href="post/ios-study-note#è®¾ç½®åœ†å½¢å±•ç¤ºå›¾åƒ"></a></h2><ol><li>è®¾ç½®<code>UIImageView</code>å®½åº¦å’Œé«˜åº¦ï¼Œå‡å¦‚è®¾ç½®ä¸º60*60</li><li>è®¾ç½®è¿è¡Œæ—¶å±æ€§ï¼Œè®¾ç½®åœ†å¼§ä¸º30ï¼ˆæ­£æ–¹å½¢è¾¹é•¿åº¦ä¸€åŠï¼‰<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/ios-note/20181102144521.png" alt=""></li><li>å‹¾é€‰<code>Clip to Bounds</code>ï¼Œ<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/ios-note/20181102145029.png" alt=""></li></ol><h2 id="UIScrollViewå¡«å……åˆ°é¡¶éƒ¨ï¼ˆå»æ‰çŠ¶æ€æ åˆ°ç©ºç™½é—´è·ï¼‰">UIScrollViewå¡«å……åˆ°é¡¶éƒ¨ï¼ˆå»æ‰çŠ¶æ€æ åˆ°ç©ºç™½é—´è·ï¼‰<a href="post/ios-study-note#UIScrollViewå¡«å……åˆ°é¡¶éƒ¨ï¼ˆå»æ‰çŠ¶æ€æ åˆ°ç©ºç™½é—´è·ï¼‰"></a></h2><ol><li><code>Content Insets</code> é€‰æ‹©<code>Never</code></li><li>å»æ‰é€‰ä¸­çš„<code>Safe Area Relative Margins</code><br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/ios-note/20181225153159.png" alt=""></li></ol><h2 id="UIImage-é«˜æ–¯æ¨¡ç³Šæ‰©å±•">UIImage é«˜æ–¯æ¨¡ç³Šæ‰©å±•<a href="post/ios-study-note#UIImage-é«˜æ–¯æ¨¡ç³Šæ‰©å±•"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIImage</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">blurred</span><span class="params">(radius: CGFloat)</span></span> -&gt; <span class="type">UIImage</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> ciContext = <span class="type">CIContext</span>(options: <span class="literal">nil</span>)</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> cgImage = cgImage <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="keyword">self</span> &#125;</span><br><span class="line">        <span class="keyword">let</span> inputImage = <span class="type">CIImage</span>(cgImage: cgImage)</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> ciFilter = <span class="type">CIFilter</span>(name: <span class="string">"CIGaussianBlur"</span>) <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="keyword">self</span> &#125;</span><br><span class="line">        ciFilter.setValue(inputImage, forKey: kCIInputImageKey)</span><br><span class="line">        ciFilter.setValue(radius, forKey: <span class="string">"inputRadius"</span>)</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> resultImage = ciFilter.value(forKey: kCIOutputImageKey) <span class="keyword">as</span>? <span class="type">CIImage</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="keyword">self</span> &#125;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> cgImage2 = ciContext.createCGImage(resultImage, from: inputImage.extent) <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="keyword">self</span> &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">UIImage</span>(cgImage: cgImage2)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="ä¸¤ä¸ªUIImage-åˆå¹¶æ‰©å±•">ä¸¤ä¸ªUIImage åˆå¹¶æ‰©å±•<a href="post/ios-study-note#ä¸¤ä¸ªUIImage-åˆå¹¶æ‰©å±•"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIImage</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">overlayWith</span><span class="params">(image: UIImage, posX: CGFloat, posY: CGFloat)</span></span> -&gt; <span class="type">UIImage</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> newWidth = size.width &lt; posX + image.size.width ? posX + image.size.width : size.width</span><br><span class="line">    <span class="keyword">let</span> newHeight = size.height &lt; posY + image.size.height ? posY + image.size.height : size.height</span><br><span class="line">    <span class="keyword">let</span> newSize = <span class="type">CGSize</span>(width: newWidth, height: newHeight)</span><br><span class="line"></span><br><span class="line">    <span class="type">UIGraphicsBeginImageContextWithOptions</span>(newSize, <span class="literal">false</span>, <span class="number">0.0</span>)</span><br><span class="line">    draw(<span class="keyword">in</span>: <span class="type">CGRect</span>(origin: <span class="type">CGPoint</span>.zero, size: size))</span><br><span class="line">    image.draw(<span class="keyword">in</span>: <span class="type">CGRect</span>(origin: <span class="type">CGPoint</span>(x: posX, y: posY), size: image.size))</span><br><span class="line">    <span class="keyword">let</span> newImage = <span class="type">UIGraphicsGetImageFromCurrentImageContext</span>()!</span><br><span class="line">    <span class="type">UIGraphicsEndImageContext</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> newImage</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="SDWebImageView-ä¸‹è½½å›¾ç‰‡">SDWebImageView ä¸‹è½½å›¾ç‰‡<a href="post/ios-study-note#SDWebImageView-ä¸‹è½½å›¾ç‰‡"></a></h2><ol><li><p>æ–¹å¼ä¸€</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">img.sd_setImage(with: <span class="type">URL</span>(string: <span class="string">"http://url"</span>),</span><br><span class="line">  placeholderImage: #imageLiteral(resourceName: <span class="string">"default_square"</span>)) &#123; image, error, cacheType, url <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>æ–¹å¼äºŒ</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">SDWebImageDownloader</span></span><br><span class="line">  .shared()</span><br><span class="line">  .downloadImage(with: <span class="type">URL</span>(string: <span class="string">"http://url"</span>),</span><br><span class="line">    options: <span class="type">SDWebImageDownloaderOptions</span>.<span class="keyword">init</span>(rawValue: <span class="number">0</span>),</span><br><span class="line">    progress: <span class="literal">nil</span>,</span><br><span class="line">    completed: &#123; image, data, error, finished <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">if</span> finished &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></div></figure></li></ol><h2 id="AVPlayerViewController-è§†é¢‘æ’­æ”¾">AVPlayerViewController è§†é¢‘æ’­æ”¾<a href="post/ios-study-note#AVPlayerViewController-è§†é¢‘æ’­æ”¾"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> AVKit</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">playVideoByUrl</span><span class="params">(string: String)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> videoURL = <span class="type">URL</span>(string: string)</span><br><span class="line">    <span class="keyword">let</span> player = <span class="type">AVPlayer</span>(url: videoURL!)</span><br><span class="line">    <span class="keyword">let</span> playerViewController = <span class="type">AVPlayerViewController</span>()</span><br><span class="line">    playerViewController.player = player</span><br><span class="line">    <span class="keyword">self</span>.present(playerViewController, animated: <span class="literal">true</span>) &#123;</span><br><span class="line">        playerViewController.player!.play()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="ä¸ºUIImageViewæ·»åŠ çš„ç‚¹å‡»æ‰‹åŠ¿æ— æ•ˆ">ä¸ºUIImageViewæ·»åŠ çš„ç‚¹å‡»æ‰‹åŠ¿æ— æ•ˆ<a href="post/ios-study-note#ä¸ºUIImageViewæ·»åŠ çš„ç‚¹å‡»æ‰‹åŠ¿æ— æ•ˆ"></a></h2><ol><li>å‹¾é€‰ä¸Š<code>User Interaction Enabled</code><br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/ios-note/20181226174028.png" alt=""></li><li>ä»£ç ä¸­è®¾ç½®<code>uiimageview.userInteractionEnabled = true</code></li></ol><h2 id="PHAssetè·å–æ–‡ä»¶è·¯å¾„">PHAssetè·å–æ–‡ä»¶è·¯å¾„<a href="post/ios-study-note#PHAssetè·å–æ–‡ä»¶è·¯å¾„"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">PHAsset</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">getURL</span><span class="params">(completionHandler : @escaping <span class="params">(<span class="params">(<span class="number">_</span> responseURL : URL?)</span></span></span></span> -&gt; <span class="type">Void</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">self</span>.mediaType == .image &#123;</span><br><span class="line">            <span class="keyword">let</span> options: <span class="type">PHContentEditingInputRequestOptions</span> = <span class="type">PHContentEditingInputRequestOptions</span>()</span><br><span class="line">            options.canHandleAdjustmentData = &#123;(adjustmeta: <span class="type">PHAdjustmentData</span>) -&gt; <span class="type">Bool</span> <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">self</span>.requestContentEditingInput(with: options, completionHandler: &#123;(contentEditingInput: <span class="type">PHContentEditingInput</span>?, info: [<span class="type">AnyHashable</span> : <span class="type">Any</span>]) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">                completionHandler(contentEditingInput!.fullSizeImageURL <span class="keyword">as</span> <span class="type">URL</span>?)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> <span class="keyword">self</span>.mediaType == .video &#123;</span><br><span class="line">            <span class="keyword">let</span> options: <span class="type">PHVideoRequestOptions</span> = <span class="type">PHVideoRequestOptions</span>()</span><br><span class="line">            options.version = .original</span><br><span class="line">            <span class="type">PHImageManager</span>.<span class="keyword">default</span>().requestAVAsset(forVideo: <span class="keyword">self</span>, options: options, resultHandler: &#123;(asset: <span class="type">AVAsset</span>?, audioMix: <span class="type">AVAudioMix</span>?, info: [<span class="type">AnyHashable</span> : <span class="type">Any</span>]?) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">let</span> urlAsset = asset <span class="keyword">as</span>? <span class="type">AVURLAsset</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> localVideoUrl: <span class="type">URL</span> = urlAsset.url <span class="keyword">as</span> <span class="type">URL</span></span><br><span class="line">                    completionHandler(localVideoUrl)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    completionHandler(<span class="literal">nil</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="UIView-ç›¸å…³">UIView ç›¸å…³<a href="post/ios-study-note#UIView-ç›¸å…³"></a></h2><h3 id="é€šè¿‡UIViewè·å–çˆ¶UIViewController">é€šè¿‡UIViewè·å–çˆ¶UIViewController<a href="post/ios-study-note#é€šè¿‡UIViewè·å–çˆ¶UIViewController"></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> parentViewController: <span class="type">UIViewController</span>? &#123;</span><br><span class="line">        <span class="keyword">var</span> parentResponder: <span class="type">UIResponder</span>? = <span class="keyword">self</span></span><br><span class="line">        <span class="keyword">while</span> parentResponder != <span class="literal">nil</span> &#123;</span><br><span class="line">            parentResponder = parentResponder!.next</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> viewController = parentResponder <span class="keyword">as</span>? <span class="type">UIViewController</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> viewController</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="String-ç›¸å…³">String ç›¸å…³<a href="post/ios-study-note#String-ç›¸å…³"></a></h2><h3 id="htmlçš„å­—ç¬¦ä¸²ï¼Œå°†ä»£ç è½¬æˆå¯¹åº”æ•ˆæœ">htmlçš„å­—ç¬¦ä¸²ï¼Œå°†ä»£ç è½¬æˆå¯¹åº”æ•ˆæœ<a href="post/ios-study-note#htmlçš„å­—ç¬¦ä¸²ï¼Œå°†ä»£ç è½¬æˆå¯¹åº”æ•ˆæœ"></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">String</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> htmlToAttributedString: <span class="type">NSAttributedString</span>? &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> data = data(using: .utf8) <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="type">NSAttributedString</span>() &#125;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">try</span> <span class="type">NSAttributedString</span>(data: data, options: [.documentType: <span class="type">NSAttributedString</span>.<span class="type">DocumentType</span>.html, .characterEncoding:<span class="type">String</span>.<span class="type">Encoding</span>.utf8.rawValue], documentAttributes: <span class="literal">nil</span>)</span><br><span class="line">        &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">NSAttributedString</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> htmlToString: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> htmlToAttributedString?.string ?? <span class="string">""</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…">æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…<a href="post/ios-study-note#æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…"></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">String</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">matchingStrings</span><span class="params">(regex: String)</span></span> -&gt; [<span class="type">String</span>] &#123;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> regex = <span class="keyword">try</span> <span class="type">NSRegularExpression</span>(pattern: regex)</span><br><span class="line">            <span class="keyword">let</span> results = regex.matches(<span class="keyword">in</span>: <span class="keyword">self</span>,</span><br><span class="line">                                        range: <span class="type">NSRange</span>(<span class="keyword">self</span>.startIndex..., <span class="keyword">in</span>: <span class="keyword">self</span>))</span><br><span class="line">            <span class="keyword">return</span> results.<span class="built_in">map</span> &#123;</span><br><span class="line">                <span class="type">String</span>(<span class="keyword">self</span>[<span class="type">Range</span>($<span class="number">0</span>.range, <span class="keyword">in</span>: <span class="keyword">self</span>)!])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> <span class="keyword">let</span> error &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"invalid regex: \(error.localizedDescription)"</span>)</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="Dataæ‹¼æ¥æ•°æ®">Dataæ‹¼æ¥æ•°æ®<a href="post/ios-study-note#Dataæ‹¼æ¥æ•°æ®"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Data</span> </span>&#123;</span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">append</span><span class="params">(<span class="number">_</span> string: String, using encoding: String.Encoding = .utf8)</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> data = string.data(using: encoding) &#123;</span><br><span class="line">            append(data)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="æ‰“ä¹±æ•°ç»„é¡ºåº">æ‰“ä¹±æ•°ç»„é¡ºåº<a href="post/ios-study-note#æ‰“ä¹±æ•°ç»„é¡ºåº"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Array</span></span>&#123;</span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">randamArray</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">var</span> list = <span class="keyword">self</span></span><br><span class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> <span class="number">0</span>..&lt;list.<span class="built_in">count</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> newIndex = <span class="type">Int</span>(arc4random_uniform(<span class="type">UInt32</span>(list.<span class="built_in">count</span>-index))) + index</span><br><span class="line">            <span class="keyword">if</span> index != newIndex &#123;</span><br><span class="line">                list.swapAt(index, newIndex)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">self</span> = list</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="UIImageç›¸å…³">UIImageç›¸å…³<a href="post/ios-study-note#UIImageç›¸å…³"></a></h2><h3 id="é«˜æ–¯æ¨¡ç³Šå›¾ç‰‡">é«˜æ–¯æ¨¡ç³Šå›¾ç‰‡<a href="post/ios-study-note#é«˜æ–¯æ¨¡ç³Šå›¾ç‰‡"></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIImage</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">blurred</span><span class="params">(radius: CGFloat)</span></span> -&gt; <span class="type">UIImage</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> ciContext = <span class="type">CIContext</span>(options: <span class="literal">nil</span>)</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> cgImage = cgImage <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="keyword">self</span> &#125;</span><br><span class="line">        <span class="keyword">let</span> inputImage = <span class="type">CIImage</span>(cgImage: cgImage)</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> ciFilter = <span class="type">CIFilter</span>(name: <span class="string">"CIGaussianBlur"</span>) <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="keyword">self</span> &#125;</span><br><span class="line">        ciFilter.setValue(inputImage, forKey: kCIInputImageKey)</span><br><span class="line">        ciFilter.setValue(radius, forKey: <span class="string">"inputRadius"</span>)</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> resultImage = ciFilter.value(forKey: kCIOutputImageKey) <span class="keyword">as</span>? <span class="type">CIImage</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="keyword">self</span> &#125;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> cgImage2 = ciContext.createCGImage(resultImage, from: inputImage.extent) <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="keyword">self</span> &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">UIImage</span>(cgImage: cgImage2)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="ä¸¤å¼ å›¾ç‰‡å åŠ æˆä¸€å¼ å›¾ç‰‡">ä¸¤å¼ å›¾ç‰‡å åŠ æˆä¸€å¼ å›¾ç‰‡<a href="post/ios-study-note#ä¸¤å¼ å›¾ç‰‡å åŠ æˆä¸€å¼ å›¾ç‰‡"></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIImage</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">overlayWith</span><span class="params">(image: UIImage, posX: CGFloat, posY: CGFloat)</span></span> -&gt; <span class="type">UIImage</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> newWidth = size.width &lt; posX + image.size.width ? posX + image.size.width : size.width</span><br><span class="line">        <span class="keyword">let</span> newHeight = size.height &lt; posY + image.size.height ? posY + image.size.height : size.height</span><br><span class="line">        <span class="keyword">let</span> newSize = <span class="type">CGSize</span>(width: newWidth, height: newHeight)</span><br><span class="line"></span><br><span class="line">        <span class="type">UIGraphicsBeginImageContextWithOptions</span>(newSize, <span class="literal">false</span>, <span class="number">0.0</span>)</span><br><span class="line">        draw(<span class="keyword">in</span>: <span class="type">CGRect</span>(origin: <span class="type">CGPoint</span>.zero, size: size))</span><br><span class="line">        image.draw(<span class="keyword">in</span>: <span class="type">CGRect</span>(origin: <span class="type">CGPoint</span>(x: posX, y: posY), size: image.size))</span><br><span class="line">        <span class="keyword">let</span> newImage = <span class="type">UIGraphicsGetImageFromCurrentImageContext</span>()!</span><br><span class="line">        <span class="type">UIGraphicsEndImageContext</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> newImage</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="ç¼©æ”¾å›¾ç‰‡">ç¼©æ”¾å›¾ç‰‡<a href="post/ios-study-note#ç¼©æ”¾å›¾ç‰‡"></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIImage</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">scaled</span><span class="params">(withSize size: CGSize)</span></span> -&gt; <span class="type">UIImage</span> &#123;</span><br><span class="line">        <span class="type">UIGraphicsBeginImageContextWithOptions</span>(size, <span class="literal">false</span>, <span class="number">0.0</span>)</span><br><span class="line">        <span class="keyword">defer</span> &#123; <span class="type">UIGraphicsEndImageContext</span>() &#125;</span><br><span class="line">        draw(<span class="keyword">in</span>: <span class="type">CGRect</span>(x: <span class="number">0.0</span>, y: <span class="number">0.0</span>, width: size.width, height: size.height))</span><br><span class="line">        <span class="keyword">return</span> <span class="type">UIGraphicsGetImageFromCurrentImageContext</span>()!</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="Jsonç›¸å…³">Jsonç›¸å…³<a href="post/ios-study-note#Jsonç›¸å…³"></a></h2><h3 id="Jsonç¼–ç ">Jsonç¼–ç <a href="post/ios-study-note#Jsonç¼–ç "></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">JSONEncoder</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// å°†å®ä½“ç±»è½¬æ¢æˆJsonæ•°æ®</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">toJson</span>&lt;T: Encodable&gt;<span class="params">(<span class="number">_</span> entity: T)</span></span> -&gt; <span class="type">String</span>? &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> encodedData = <span class="keyword">try</span>? encode(entity) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">String</span>(data: encodedData, encoding: .utf8)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="Jsonè§£ç ">Jsonè§£ç <a href="post/ios-study-note#Jsonè§£ç "></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">JSONDecoder</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">from</span>&lt;T: Decodable&gt;<span class="params">(<span class="number">_</span> type: T.<span class="keyword">Type</span>, json: String)</span></span> -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">try</span> decode(type, from: json.data(using: .utf8)!)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="è¯·æ±‚å­—æ®µç¼–ç ä¸ºå­—ç¬¦ä¸²ï¼Œå½¢å¼å¦‚ï¼škey-value-amp-key-value-amp-key-value">è¯·æ±‚å­—æ®µç¼–ç ä¸ºå­—ç¬¦ä¸²ï¼Œå½¢å¼å¦‚ï¼škey=value&amp;key=value&amp;key=value<a href="post/ios-study-note#è¯·æ±‚å­—æ®µç¼–ç ä¸ºå­—ç¬¦ä¸²ï¼Œå½¢å¼å¦‚ï¼škey-value-amp-key-value-amp-key-value"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Dictionary</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">percentEscaped</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">map</span> &#123; (key, value) <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">let</span> escapedKey = <span class="string">"\(key)"</span>.addingPercentEncoding(withAllowedCharacters: .urlQueryValueAllowed) ?? <span class="string">""</span></span><br><span class="line">            <span class="keyword">let</span> escapedValue = <span class="string">"\(value)"</span>.addingPercentEncoding(withAllowedCharacters: .urlQueryValueAllowed) ?? <span class="string">""</span></span><br><span class="line">            <span class="keyword">return</span> escapedKey + <span class="string">"="</span> + escapedValue</span><br><span class="line">            &#125;</span><br><span class="line">            .joined(separator: <span class="string">"&amp;"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">CharacterSet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> urlQueryValueAllowed: <span class="type">CharacterSet</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> generalDelimitersToEncode = <span class="string">":#[]@"</span> <span class="comment">// does not include "?" or "/" due to RFC 3986 - Section 3.4</span></span><br><span class="line">        <span class="keyword">let</span> subDelimitersToEncode = <span class="string">"!$&amp;'()*+,;="</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> allowed = <span class="type">CharacterSet</span>.urlQueryAllowed</span><br><span class="line">        allowed.remove(charactersIn: <span class="string">"\(generalDelimitersToEncode)\(subDelimitersToEncode)"</span>)</span><br><span class="line">        <span class="keyword">return</span> allowed</span><br><span class="line">    &#125;()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="UIViewController-ç›¸å…³">UIViewController ç›¸å…³<a href="post/ios-study-note#UIViewController-ç›¸å…³"></a></h2><h3 id="æ·»åŠ å­UIViewController">æ·»åŠ å­UIViewController<a href="post/ios-study-note#æ·»åŠ å­UIViewController"></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// æ·»åŠ å­ViewController</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">addSubController</span><span class="params">(child: UIViewController, to: UIView? = <span class="literal">nil</span>)</span></span> &#123;</span><br><span class="line">        addChildViewController(child)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> to = to &#123;</span><br><span class="line">            child.view.frame = to.frame</span><br><span class="line">            to.addSubview(child.view)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            child.view.frame = view.frame</span><br><span class="line">            view.addSubview(child.view)</span><br><span class="line">        &#125;</span><br><span class="line">        child.didMove(toParentViewController: <span class="keyword">self</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="ç§»é™¤å­UIViewController">ç§»é™¤å­UIViewController<a href="post/ios-study-note#ç§»é™¤å­UIViewController"></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">    <span class="comment">/// ç§»é™¤å­ViewController</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">removeSubController</span><span class="params">(child: UIViewController)</span></span> &#123;</span><br><span class="line">        child.willMove(toParentViewController: <span class="literal">nil</span>)</span><br><span class="line">        child.removeFromParentViewController()</span><br><span class="line">        child.view.removeFromSuperview()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="å…³é—­é¡µé¢">å…³é—­é¡µé¢<a href="post/ios-study-note#å…³é—­é¡µé¢"></a></h3><h4 id="å…³é—­å½“å‰é¡µé¢">å…³é—­å½“å‰é¡µé¢<a href="post/ios-study-note#å…³é—­å½“å‰é¡µé¢"></a></h4><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">    <span class="comment">/// å…³é—­å½“å‰é¡µé¢</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">closePage</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h4 id="å…³é—­æ‰€æœ‰é¡µé¢ï¼Œé™¤å¼€æœ€ä¸‹çº§çš„é‚£ä¸ªé¡µé¢">å…³é—­æ‰€æœ‰é¡µé¢ï¼Œé™¤å¼€æœ€ä¸‹çº§çš„é‚£ä¸ªé¡µé¢<a href="post/ios-study-note#å…³é—­æ‰€æœ‰é¡µé¢ï¼Œé™¤å¼€æœ€ä¸‹çº§çš„é‚£ä¸ªé¡µé¢"></a></h4><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">closeAllPage</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">//è·å–æ ¹VC</span></span><br><span class="line">        <span class="keyword">var</span> rootVC = <span class="keyword">self</span>.presentingViewController</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">let</span> parent = rootVC?.presentingViewController &#123;</span><br><span class="line">            rootVC = parent</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//é‡Šæ”¾æ‰€æœ‰ä¸‹çº§è§†å›¾</span></span><br><span class="line">        rootVC?.dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="æ˜¾ç¤ºå’Œå…³é—­èŠèŠ±ç­‰å¾…åŠ è½½">æ˜¾ç¤ºå’Œå…³é—­èŠèŠ±ç­‰å¾…åŠ è½½<a href="post/ios-study-note#æ˜¾ç¤ºå’Œå…³é—­èŠèŠ±ç­‰å¾…åŠ è½½"></a></h3><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">displaySpinner</span>(<span class="title">onView</span> : <span class="title">UIView</span>) -&gt; <span class="title">UIView</span> </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> spinnerView = <span class="type">UIView</span>.<span class="keyword">init</span>(frame: onView.bounds)</span><br><span class="line">        spinnerView.backgroundColor = <span class="type">UIColor</span>.<span class="keyword">init</span>(red: <span class="number">0.5</span>, green: <span class="number">0.5</span>, blue: <span class="number">0.5</span>, alpha: <span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">let</span> ai = <span class="type">UIActivityIndicatorView</span>.<span class="keyword">init</span>(activityIndicatorStyle: .whiteLarge)</span><br><span class="line">        ai.startAnimating()</span><br><span class="line">        ai.center = spinnerView.center</span><br><span class="line"></span><br><span class="line">        <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">            spinnerView.addSubview(ai)</span><br><span class="line">            onView.addSubview(spinnerView)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> spinnerView</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">removeSpinner</span>(<span class="title">spinner</span> :<span class="title">UIView</span>) </span>&#123;</span><br><span class="line">        <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">            spinner.removeFromSuperview()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>æ˜¾ç¤º</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> sp = <span class="type">UIViewController</span>.displaySpinner(onView: <span class="keyword">self</span>.view)</span><br></pre></td></tr></table></div></figure><blockquote><p>å…³é—­</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UIViewController</span>.removeSpinner(spinner: sp)</span><br></pre></td></tr></table></div></figure><h2 id="IAP-å†…è´­">IAP å†…è´­<a href="post/ios-study-note#IAP-å†…è´­"></a></h2><blockquote><p>ä½¿ç”¨</p></blockquote><ol><li>é™¤ä»£ç å¤–çš„å†…è´­å‡†å¤‡å·¥åºå·²OK</li><li>è·å–äº§å“æ•°æ®ï¼šé€šè¿‡<code>IAPHelper.shared.fetchAvailableProducts</code>ä»è‹¹æœæœåŠ¡å™¨è·å–æ‰€æœ‰ä¼ å…¥çš„äº§å“idçš„äº§å“ä¿¡æ¯ï¼Œä¼ å…¥çš„å‚æ•°æ˜¯äº§å“çš„idå­—ç¬¦ä¸²æ•°ç»„</li><li><p>æ”¯ä»˜ï¼š<code>IAPHelper.shared.purchase(id: id)</code>ï¼Œidæ˜¯äº§å“id</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">IAPHelper</span>.shared.purchase(id: selectItem!.product_id) &#123;alert, product, transaction <span class="keyword">in</span></span><br><span class="line">  <span class="keyword">if</span> alert == .purchased &#123; <span class="comment">//è´­ä¹°æˆåŠŸ</span></span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">let</span> receiptUrl = <span class="type">Bundle</span>.main.appStoreReceiptURL, <span class="keyword">let</span> receiptData = <span class="type">NSData</span>(contentsOf: receiptUrl) &#123;</span><br><span class="line">          <span class="keyword">let</span> receiptString = receiptData.base64EncodedString(options: <span class="type">NSData</span>.<span class="type">Base64EncodingOptions</span>(rawValue: <span class="number">0</span>))</span><br><span class="line">          <span class="comment">// å¯¹receiptStringåŠ å¯†å­—ç¬¦ä¸²è¿›è¡ŒéªŒè¯</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> alert == .restored &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> alert == .purchasing &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ol><blockquote><p>IAPHelper ä»£ç </p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> StoreKit</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">IAPHelperAlertType</span></span>&#123;</span><br><span class="line">    <span class="keyword">case</span> disabled</span><br><span class="line">    <span class="keyword">case</span> restored</span><br><span class="line">    <span class="keyword">case</span> purchased</span><br><span class="line">    <span class="keyword">case</span> purchasing</span><br><span class="line">    <span class="keyword">case</span> setProductIds</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">message</span><span class="params">()</span></span> -&gt; <span class="type">String</span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> .setProductIds: <span class="keyword">return</span> <span class="string">"æœªè®¾ç½®äº§å“idï¼Œè¯·è°ƒç”¨ fetchAvailableProducts()"</span></span><br><span class="line">        <span class="keyword">case</span> .disabled: <span class="keyword">return</span> <span class="string">"è´­ä¹°å·²å–æ¶ˆ"</span></span><br><span class="line">        <span class="keyword">case</span> .restored: <span class="keyword">return</span> <span class="string">"æ‚¨å·²æˆåŠŸæ¢å¤è´­ä¹°"</span></span><br><span class="line">        <span class="keyword">case</span> .purchased: <span class="keyword">return</span> <span class="string">"æ‚¨å·²æˆåŠŸè´­ä¹°æ­¤å•†å“"</span></span><br><span class="line">        <span class="keyword">case</span> .purchasing: <span class="keyword">return</span> <span class="string">"æ­£åœ¨è´­ä¹°..."</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IAPHelper</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> shared = <span class="type">IAPHelper</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">override</span> <span class="keyword">init</span>() &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fileprivate</span> <span class="keyword">var</span> productID = <span class="string">""</span></span><br><span class="line">    <span class="keyword">fileprivate</span> <span class="keyword">var</span> productsRequest = <span class="type">SKProductsRequest</span>()</span><br><span class="line">    <span class="keyword">fileprivate</span> <span class="keyword">var</span> productDict = [<span class="type">String</span>:<span class="type">SKProduct</span>]()</span><br><span class="line">    <span class="keyword">fileprivate</span> <span class="keyword">var</span> fetchProductCompletion: (([<span class="type">SKProduct</span>])-&gt;<span class="type">Void</span>)?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fileprivate</span> <span class="keyword">var</span> productToPurchase: <span class="type">SKProduct</span>?</span><br><span class="line">    <span class="keyword">var</span> purchaseProductCompletion: ((<span class="type">IAPHelperAlertType</span>, <span class="type">SKProduct</span>?, <span class="type">SKPaymentTransaction</span>?) -&gt; <span class="type">Void</span>)?</span><br><span class="line"></span><br><span class="line">    <span class="comment">// MARK: - è´­ä¹°äº§å“</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">canMakePurchases</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span> &#123;  <span class="keyword">return</span> <span class="type">SKPaymentQueue</span>.canMakePayments()  &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">purchase</span><span class="params">(id: String, completion: @escaping <span class="params">(<span class="params">(IAPHelperAlertType, SKProduct?, SKPaymentTransaction?)</span></span></span></span>-&gt;<span class="type">Void</span>)) &#123;</span><br><span class="line">        <span class="keyword">self</span>.purchaseProductCompletion = completion</span><br><span class="line">        <span class="keyword">self</span>.productToPurchase = productDict[id]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> product = <span class="keyword">self</span>.productToPurchase <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="type">IAPHelperAlertType</span>.setProductIds.message())</span><br><span class="line">            <span class="built_in">fatalError</span>(<span class="type">IAPHelperAlertType</span>.setProductIds.message())</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">self</span>.canMakePurchases() &#123;</span><br><span class="line">            <span class="keyword">let</span> payment = <span class="type">SKPayment</span>(product: product)</span><br><span class="line">            <span class="type">SKPaymentQueue</span>.<span class="keyword">default</span>().add(<span class="keyword">self</span>)</span><br><span class="line">            <span class="type">SKPaymentQueue</span>.<span class="keyword">default</span>().add(payment)</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"é‡‡è´­äº§å“: \(product.productIdentifier)"</span>)</span><br><span class="line">            productID = product.productIdentifier</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            completion(.disabled, <span class="literal">nil</span>, <span class="literal">nil</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// MARK: - æ¢å¤è´­ä¹°</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">restorePurchase</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="type">SKPaymentQueue</span>.<span class="keyword">default</span>().add(<span class="keyword">self</span>)</span><br><span class="line">        <span class="type">SKPaymentQueue</span>.<span class="keyword">default</span>().restoreCompletedTransactions()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// MARK: - è·å–å¯ç”¨çš„iapäº§å“</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fetchAvailableProducts</span><span class="params">(by ids: [String], completion: @escaping <span class="params">(<span class="params">([SKProduct])</span></span></span></span>-&gt;<span class="type">Void</span>))&#123;</span><br><span class="line">        <span class="keyword">self</span>.fetchProductCompletion = completion</span><br><span class="line">        <span class="comment">// æŠŠæ‚¨çš„IAPäº§å“idæ”¾åˆ°è¿™é‡Œé¢</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> !ids.isEmpty <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"æ²¡æœ‰è®¾ç½®äº§å“id"</span>)</span><br><span class="line">            <span class="built_in">fatalError</span>(<span class="type">IAPHelperAlertType</span>.setProductIds.message())</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        productsRequest = <span class="type">SKProductsRequest</span>(productIdentifiers: <span class="type">Set</span>(ids))</span><br><span class="line">        productsRequest.delegate = <span class="keyword">self</span></span><br><span class="line">        productsRequest.start()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">IAPHelper</span>: <span class="title">SKProductsRequestDelegate</span>, <span class="title">SKPaymentTransactionObserver</span></span>&#123;</span><br><span class="line">    <span class="comment">// MARK: - è¯·æ±‚IAPäº§å“</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">productsRequest</span> <span class="params">(<span class="number">_</span> request:SKProductsRequest, didReceive response:SKProductsResponse)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (response.products.<span class="built_in">count</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> product <span class="keyword">in</span> response.products &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"product.productIdentifier = \(product.productIdentifier)"</span>)</span><br><span class="line">                <span class="keyword">self</span>.productDict[product.productIdentifier] = product</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">self</span>.fetchProductCompletion?(response.products)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">paymentQueueRestoreCompletedTransactionsFinished</span><span class="params">(<span class="number">_</span> queue: SKPaymentQueue)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.purchaseProductCompletion?(.restored, <span class="literal">nil</span>, <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// MARK:- IAPä»˜æ¬¾é˜Ÿåˆ—</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">paymentQueue</span><span class="params">(<span class="number">_</span> queue: SKPaymentQueue, updatedTransactions transactions: [SKPaymentTransaction])</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"è°ƒç”¨äº†å‡ æ¬¡å•Šï¼ï¼ï¼"</span>)</span><br><span class="line">        <span class="keyword">for</span> transaction:<span class="type">AnyObject</span> <span class="keyword">in</span> transactions &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> trans = transaction <span class="keyword">as</span>? <span class="type">SKPaymentTransaction</span> &#123;</span><br><span class="line">                <span class="keyword">switch</span> trans.transactionState &#123;</span><br><span class="line">                <span class="keyword">case</span> .purchased:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">"äº§å“å·²è´­ä¹°"</span>)</span><br><span class="line">                    <span class="type">SKPaymentQueue</span>.<span class="keyword">default</span>().finishTransaction(transaction <span class="keyword">as</span>! <span class="type">SKPaymentTransaction</span>)</span><br><span class="line">                    <span class="keyword">self</span>.purchaseProductCompletion?(.purchased, <span class="keyword">self</span>.productToPurchase, trans)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> .failed:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">"äº§å“è´­ä¹°å¤±è´¥\(trans.error.debugDescription)"</span>)</span><br><span class="line">                    <span class="type">SKPaymentQueue</span>.<span class="keyword">default</span>().finishTransaction(transaction <span class="keyword">as</span>! <span class="type">SKPaymentTransaction</span>)</span><br><span class="line">                    <span class="keyword">self</span>.purchaseProductCompletion?(.disabled, <span class="keyword">self</span>.productToPurchase, trans)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">case</span> .purchasing:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">"æ­£åœ¨è´­ä¹°..."</span>)</span><br><span class="line">                    <span class="keyword">self</span>.purchaseProductCompletion?(.purchasing, <span class="keyword">self</span>.productToPurchase, trans)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">case</span> .restored:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">"äº§å“å·²æ¢å¤è´­ä¹°"</span>)</span><br><span class="line">                    <span class="type">SKPaymentQueue</span>.<span class="keyword">default</span>().finishTransaction(transaction <span class="keyword">as</span>! <span class="type">SKPaymentTransaction</span>)</span><br><span class="line">                    <span class="keyword">self</span>.purchaseProductCompletion?(.restored, <span class="keyword">self</span>.productToPurchase, trans)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">default</span>: <span class="keyword">break</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="åˆ¤æ–­é€€æ ¼ç¬¦â€-bâ€">åˆ¤æ–­é€€æ ¼ç¬¦â€\bâ€<a href="post/ios-study-note#åˆ¤æ–­é€€æ ¼ç¬¦â€-bâ€"></a></h2><p><a href="https://stackoverflow.com/a/29505548/9724892" target="_blank" rel="noopener">https://stackoverflow.com/a/29505548/9724892</a></p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">textField</span><span class="params">(textField: UITextField, shouldChangeCharactersInRange range: NSRange, replacementString string: String)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> char = string.cString(using: <span class="type">String</span>.<span class="type">Encoding</span>.utf8) &#123;</span><br><span class="line">        <span class="keyword">let</span> isBackSpace = strcmp(char, <span class="string">"\\b"</span>)</span><br><span class="line">        <span class="keyword">if</span> (isBackSpace == -<span class="number">92</span>) &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Backspace was pressed"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="CocoaPodså•ç‹¬ä¸ºä¸€äº›åº“è®¾ç½®ç‰ˆæœ¬">CocoaPodså•ç‹¬ä¸ºä¸€äº›åº“è®¾ç½®ç‰ˆæœ¬<a href="post/ios-study-note#CocoaPodså•ç‹¬ä¸ºä¸€äº›åº“è®¾ç½®ç‰ˆæœ¬"></a></h2><p>åœ¨Podfileæœ«å°¾åŠ å…¥</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">swift_versions_of_pods = &#123; 'swiftScan' =&gt; '<span class="number">4.0</span>', '<span class="type">CWActionSheet'</span> =&gt; '<span class="number">4.0</span>' &#125;</span><br><span class="line">post_install <span class="keyword">do</span> |installer|</span><br><span class="line">  installer.pods_project.targets.each <span class="keyword">do</span> |target|</span><br><span class="line">    defined_swift_version = swift_versions_of_pods[target.name]</span><br><span class="line">    next <span class="keyword">if</span> defined_swift_version.blank?</span><br><span class="line">    target.build_configurations.each <span class="keyword">do</span> |config|</span><br><span class="line">      config.build_settings['<span class="type">SWIFT_VERSION'</span>] = defined_swift_version</span><br><span class="line">    end</span><br><span class="line">  end</span><br><span class="line">end</span><br></pre></td></tr></table></div></figure><h2 id="ä»£ç ä¸­ä¸ºlabelæ·»åŠ ç‚¹å‡»äº‹ä»¶">ä»£ç ä¸­ä¸ºlabelæ·»åŠ ç‚¹å‡»äº‹ä»¶<a href="post/ios-study-note#ä»£ç ä¸­ä¸ºlabelæ·»åŠ ç‚¹å‡»äº‹ä»¶"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">    <span class="keyword">let</span> tap = <span class="type">UITapGestureRecognizer</span>(target: <span class="keyword">self</span>, action: #selector(tapFunction))</span><br><span class="line">    label.isUserInteractionEnabled = <span class="literal">true</span></span><br><span class="line">    label.addGestureRecognizer(tap)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">tapFunction</span><span class="params">(sender: UITapGestureRecognizer)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"tap working"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="éœ€è¦ç»™æ‰‹åŠ¿ä¼ å…¥é¢å¤–çš„æ•°æ®">éœ€è¦ç»™æ‰‹åŠ¿ä¼ å…¥é¢å¤–çš„æ•°æ®<a href="post/ios-study-note#éœ€è¦ç»™æ‰‹åŠ¿ä¼ å…¥é¢å¤–çš„æ•°æ®"></a></h2><ol><li><p>åˆ›å»ºä¸€ä¸ªtapæ‰‹åŠ¿å­ç±»</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TopicUITapGestureRecognizer</span> : <span class="title">UITapGestureRecognizer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> id = <span class="type">Int</span>()</span><br><span class="line">    <span class="keyword">var</span> title = <span class="type">String</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>å¤„ç†æ•°æ®</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">tapFunction</span><span class="params">(sender: TopicUITapGestureRecognizer)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"ç‚¹å‡»äº†: \(sender.id), \(sender.title)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>æ·»åŠ äº‹ä»¶è®¾ç½®æ•°æ®</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tap = <span class="type">TopicUITapGestureRecognizer</span>(target: <span class="keyword">self</span>, action: #selector(tapFunction))</span><br><span class="line">tap.id = topic.id ?? <span class="number">0</span></span><br><span class="line">tap.title = topic.topic ?? <span class="string">""</span></span><br><span class="line">label.isUserInteractionEnabled = <span class="literal">true</span></span><br><span class="line">label.addGestureRecognizer(tap)</span><br></pre></td></tr></table></div></figure></li></ol><h2 id="å½“Swiftçš„æšä¸¾ç±»å‹ä¼ å…¥æ•°ç»„åˆ°OCä¸­æ—¶æŠ¥é”™">å½“Swiftçš„æšä¸¾ç±»å‹ä¼ å…¥æ•°ç»„åˆ°OCä¸­æ—¶æŠ¥é”™<a href="post/ios-study-note#å½“Swiftçš„æšä¸¾ç±»å‹ä¼ å…¥æ•°ç»„åˆ°OCä¸­æ—¶æŠ¥é”™"></a></h2><p>å¼‚å¸¸ä¿¡æ¯</p><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">'<span class="type">NSInvalidArgumentException'</span>, reason: '-[__SwiftValue iconNormal]: unrecognized</span><br></pre></td></tr></table></div></figure><p>è§£å†³: ä¼ å…¥æšä¸¾ç±»å‹<code>.rawValue</code></p><p><a href="https://stackoverflow.com/questions/39643394/swift-3-error-swiftvalue-unsignedintegervalue-unrecognized-selector/" target="_blank" rel="noopener">https://stackoverflow.com/questions/39643394/swift-3-error-swiftvalue-unsignedintegervalue-unrecognized-selector/</a></p><h2 id="è·å–Appç¼“å­˜å¤§å°ã€æ¸…ç†Appç¼“å­˜">è·å–Appç¼“å­˜å¤§å°ã€æ¸…ç†Appç¼“å­˜<a href="post/ios-study-note#è·å–Appç¼“å­˜å¤§å°ã€æ¸…ç†Appç¼“å­˜"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppCacheCleanUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// è·å–appç¼“å­˜å¤§å°</span></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">getCacheSize</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="comment">// å–å‡ºcacheæ–‡ä»¶å¤¹ç›®å½•</span></span><br><span class="line">        <span class="keyword">let</span> cachePath = <span class="type">NSSearchPathForDirectoriesInDomains</span>(.cachesDirectory, .userDomainMask, <span class="literal">true</span>).first</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å–å‡ºæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰æ–‡ä»¶æ•°ç»„</span></span><br><span class="line">        <span class="keyword">let</span> fileArr = <span class="type">FileManager</span>.<span class="keyword">default</span>.subpaths(atPath: cachePath!)</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¿«é€Ÿæšä¸¾å‡ºæ‰€æœ‰æ–‡ä»¶å è®¡ç®—æ–‡ä»¶å¤§å°</span></span><br><span class="line">        <span class="keyword">var</span> size = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> fileArr! &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æŠŠæ–‡ä»¶åæ‹¼æ¥åˆ°è·¯å¾„ä¸­</span></span><br><span class="line">            <span class="keyword">let</span> path = cachePath! + (<span class="string">"/\(file)"</span>)</span><br><span class="line">            <span class="comment">// å–å‡ºæ–‡ä»¶å±æ€§</span></span><br><span class="line">            <span class="keyword">let</span> floder = <span class="keyword">try</span>! <span class="type">FileManager</span>.<span class="keyword">default</span>.attributesOfItem(atPath: path)</span><br><span class="line">            <span class="comment">// ç”¨å…ƒç»„å–å‡ºæ–‡ä»¶å¤§å°å±æ€§</span></span><br><span class="line">            <span class="keyword">for</span> (key, fileSize) <span class="keyword">in</span> floder &#123;</span><br><span class="line">                <span class="comment">// ç´¯åŠ æ–‡ä»¶å¤§å°</span></span><br><span class="line">                <span class="keyword">if</span> key == <span class="type">FileAttributeKey</span>.size &#123;</span><br><span class="line">                    size += (fileSize <span class="keyword">as</span> <span class="type">AnyObject</span>).integerValue</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> totalCache = <span class="type">Double</span>(size) / <span class="number">1024.00</span> / <span class="number">1024.00</span></span><br><span class="line">        <span class="keyword">return</span> <span class="type">String</span>(format: <span class="string">"%.2f"</span>, totalCache)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/// æ¸…ç†appç¼“å­˜æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">clearCache</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> cachePath = <span class="type">NSSearchPathForDirectoriesInDomains</span>(.cachesDirectory, .userDomainMask, <span class="literal">true</span>).first</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å–å‡ºæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰æ–‡ä»¶æ•°ç»„</span></span><br><span class="line">        <span class="keyword">let</span> fileArr = <span class="type">FileManager</span>.<span class="keyword">default</span>.subpaths(atPath: cachePath!)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// éå†åˆ é™¤</span></span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> fileArr! &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> path = cachePath?.appendingFormat(<span class="string">"/\(file)"</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="type">FileManager</span>.<span class="keyword">default</span>.fileExists(atPath: path!) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">do</span> &#123;</span><br><span class="line">                    <span class="keyword">try</span> <span class="type">FileManager</span>.<span class="keyword">default</span>.removeItem(atPath: path!)</span><br><span class="line">                &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•ä¸€äº›iOSå­¦ä¹ è¿‡ç¨‹ä¸­çš„ç¬”è®°&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="https://blog.xujiaji.com/categories/iOS/"/>
    
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¬”è®°" scheme="https://blog.xujiaji.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="iOS" scheme="https://blog.xujiaji.com/tags/iOS/"/>
    
      <category term="Swift" scheme="https://blog.xujiaji.com/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>Swiftå­¦ä¹ ç¬”è®°</title>
    <link href="https://blog.xujiaji.com/post/swift-study-note/index.html"/>
    <id>https://blog.xujiaji.com/post/swift-study-note/index.html</id>
    <published>2018-07-09T13:21:34.000Z</published>
    <updated>2018-12-25T15:23:05.699Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€äº›swiftçš„åŸºæœ¬ç‰¹æ€§ï¼Œä»¥ä¾¿ä½¿ç”¨çš„æ—¶å€™æ–¹ä¾¿æŸ¥é˜…ã€‚<br><a id="more"></a></p><p>å­¦ä¹ åœ°å€ï¼š<a href="https://www.imooc.com/t/108955" target="_blank" rel="noopener">https://www.imooc.com/t/108955</a></p><h2 id="å…ƒç»„">å…ƒç»„<a href="post/swift-study-note#å…ƒç»„"></a></h2><blockquote><p>å®šä¹‰ï¼šå¯æ”¾å…¥å„ç§ç±»å‹æ•°æ®ï¼Œå…ƒç»„é•¿åº¦è‡ªç”±</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> point = (<span class="number">5</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">var</span> httpResponse = (<span class="number">404</span>, <span class="string">"Not Found"</span>)</span><br></pre></td></tr></table></div></figure><blockquote><p>å¯å…ˆé¢„å®šç±»å‹æ¥å®šä¹‰</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> point2: (<span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>) = (<span class="number">10</span>, <span class="number">5</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">var</span> httpResponse2: (<span class="type">Int</span>, <span class="type">String</span>) = (<span class="number">200</span>, <span class="string">"OK"</span>)</span><br><span class="line"><span class="keyword">let</span> point4: (x: <span class="type">Int</span>, y: <span class="type">Int</span>) = (<span class="number">10</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></div></figure><blockquote><p>å–å€¼</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¬¬ä¸€ç§æ–¹å¼</span></span><br><span class="line"><span class="keyword">var</span> point = (<span class="number">5</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">var</span>(xx, yy) = point</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬äºŒç§æ–¹å¼</span></span><br><span class="line">point.<span class="number">0</span></span><br><span class="line">point.<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸‰ç§æ–¹å¼</span></span><br><span class="line"><span class="keyword">let</span> point3 = (x: <span class="number">3</span>, y: <span class="number">2</span>)</span><br><span class="line">point3.x</span><br><span class="line">point3.y</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬å››ç§æ–¹å¼ï¼ˆåªå–ç›¸å…³æ•°æ® æ˜¯å¦ç™»å½•ï¼‰</span></span><br><span class="line"><span class="keyword">let</span> loginResult = (<span class="literal">true</span>, <span class="string">"xujiaji"</span>)</span><br><span class="line"><span class="keyword">let</span> (isLoginSuccess, <span class="number">_</span> ) = loginResult</span><br></pre></td></tr></table></div></figure><h2 id="printæ‰“å°">printæ‰“å°<a href="post/swift-study-note#printæ‰“å°"></a></h2><blockquote><p>æ­£å¸¸æƒ…å†µä¸‹</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">"a message"</span>)</span><br></pre></td></tr></table></div></figure><blockquote><p>æ‹¼æ¥ï¼Œï¼ˆç»“æœï¼š1 2 3 4ï¼‰</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></div></figure><blockquote><p>æ’å€¼ï¼šåœ¨æ‹¼æ¥çš„ä¸­é—´æ’å…¥å€¼ï¼Œé»˜è®¤æ˜¯ç©ºæ ¼</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»“æœï¼š1-2-3-4</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, separator:<span class="string">"-"</span>)</span><br></pre></td></tr></table></div></figure><blockquote><p>ç»“å°¾ï¼šé»˜è®¤æ˜¯å›è½¦â€œ<code>\n</code>â€</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»“æœï¼š1 -- 2 -- 3 -- 4:)hello</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, separator:<span class="string">" -- "</span>, terminator:<span class="string">":)"</span>)</span><br></pre></td></tr></table></div></figure><blockquote><p>å¦ä¸€ç§æ‹¼æ¥æ–¹å¼ï¼š<code>\()</code></p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> y = <span class="number">2</span>, z = <span class="number">4</span></span><br><span class="line"><span class="comment">// ç»“æœï¼š2 * 4 = 8</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"\(y) * \(z) = \(y*z)"</span>)</span><br></pre></td></tr></table></div></figure><h2 id="ifæ¡ä»¶åˆ¤æ–­">ifæ¡ä»¶åˆ¤æ–­<a href="post/swift-study-note#ifæ¡ä»¶åˆ¤æ–­"></a></h2><blockquote><p>åŸºæœ¬ç”¨æ³•ï¼Œæ¡ä»¶å¿…é¡»æ˜¯Boolç±»å‹ï¼Œå¯å†™è¡¨è¾¾å¼ï¼Œä½†ç»“æœå¿…é¡»æ˜¯Bool</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> imTrue:<span class="type">Bool</span> = <span class="literal">true</span></span><br><span class="line"><span class="keyword">let</span> imFalse = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> imFalse &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"I'm True"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"I'm False"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>æ”¯æŒä¸‰ç›®è¿ç®—ç¬¦</p></blockquote><h2 id="forå¾ªç¯">forå¾ªç¯<a href="post/swift-study-note#forå¾ªç¯"></a></h2><blockquote><p>åŸºæœ¬ç”¨æ³•</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»2æ‰“å°åˆ°10</span></span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> <span class="number">2</span>...<span class="number">10</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(index)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>å‰é—­åå¼€ï¼Œç»å¸¸ç”¨äºå¾ªç¯æ•°ç»„</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»0æ‰“å°åˆ°9</span></span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="number">10</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(index)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ä¸‹åˆ’çº¿å¿½ç•¥å€¼</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">1</span>...<span class="number">10</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>åå‘éå†</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»“æœï¼šä»10æ‰“å°åˆ°1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> (<span class="number">1</span>...<span class="number">10</span>).reversed() &#123;</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>strideï¼Œ<code>from</code>å¼€å§‹æ•°ï¼Œ<code>to</code>ç»“å°¾æ•°ï¼ˆä¸åŒ…æ‹¬ç»“å°¾æ•°ï¼‰ï¼Œ<code>through</code>ç»“å°¾æ•°ï¼ˆåŒ…æ‹¬ç»“å°¾æ•°ï¼‰ï¼Œ<code>by</code>æ¯æ¬¡å¾ªç¯çš„è·¨åº¦(å¯ä»¥æ˜¯æµ®ç‚¹æ•°)</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»“æœï¼š 0 2 4 6 8</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">stride</span>(from: <span class="number">0</span>, to: <span class="number">10</span>, by: <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»“æœï¼š0 2 4 6 8 10</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">stride</span>(from: <span class="number">0</span>, through: <span class="number">10</span>, by: <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»“æœï¼šä»10éå†åˆ°1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">stride</span>(from: <span class="number">10</span>, to: <span class="number">0</span>, by: -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="whileå¾ªç¯">whileå¾ªç¯<a href="post/swift-study-note#whileå¾ªç¯"></a></h2><blockquote><p>å’Œjavaæ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œåªæ˜¯æ²¡æœ‰å°æ‹¬å·</p></blockquote><blockquote><p>è‡³å°‘æ‰§è¡Œä¸€æ¬¡å¾ªç¯ï¼Œç›¸å½“äºjavaä¸­çš„do while</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">repeat</span> &#123;</span><br><span class="line">  è¯­å¥</span><br><span class="line">&#125; <span class="keyword">while</span> æ¡ä»¶</span><br></pre></td></tr></table></div></figure><h2 id="switch">switch<a href="post/swift-study-note#switch"></a></h2><p><strong>1.</strong> æ³¨æ„switch caseä¸­ä¸ç”¨å†™<code>break</code>ï¼Œ <code>case</code>åå¯ä»¥åŒ¹é…å¤šä¸ªå€¼é€—å·éš”å¼€<br><strong>2.</strong> ä¸å¯ä»¥ç©·ä¸¾ï¼ˆæ˜¯å¦çŸ¥é“æ‰€æœ‰å¯èƒ½æ€§ï¼‰ï¼Œå¿…é¡»åŠ ä¸Š<code>default:</code>å¦‚æœæ²¡æœ‰è¯­å¥å¯ä»¥ç”¨<code>break</code>æ˜¾ç¤ºè·³å‡ºæˆ–<code>()</code>è¡¨ç¤ºç©ºè¯­å¥<br><strong>3.</strong> å¯ä»¥ç”¨å­—ç¬¦ä¸²ï¼Œæµ®ç‚¹æ•°ï¼Œå¸ƒå°”ç­‰swiftåŸºç¡€æ•°æ®ç»“æ„<br><strong>4.</strong> <code>case</code>åé¢å¯ä»¥è·ŸåŒºé—´ï¼Œå¦‚ <code>1 ..&lt; 60</code><br><strong>5.</strong> <code>case</code>è¿˜å¯ä»¥å¯¹å…ƒç»„è¿›è¡Œåˆ¤æ–­ï¼Œå¹¶ä¸”å…ƒç»„å¯ä»¥é€šè¿‡<code>_</code>è¿›è¡Œå¿½ç•¥ï¼›å…ƒç»„ä¸­è¿˜å¯ä»¥ç”¨åŒºé—´ï¼Œå¦‚<code>case (-2...2, -2...2):</code>ï¼›è¿˜å¯ä»¥å’Œå…ƒç»„è§£åŒ…ä¸€èµ·ç”¨ï¼Œå¦‚<code>case (let x, let y):</code><br><strong>6.</strong> è¯­å¥ç»“æŸååŠ ä¸Š<code>fallthrough</code>å…³é”®å­—ï¼Œå¯è®©æ¡ä»¶å‘ä¸‹åˆ¤æ–­<br><strong>7.</strong> <code>case</code>ä¸­ç”¨<code>where</code>å¯ä»¥åŠ ä¸Šæ¡ä»¶åˆ¤æ–­è¿›è¡Œé™åˆ¶<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> point = (<span class="number">3</span>, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">switch</span> point &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span>(x, y) <span class="keyword">where</span> x == y:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"It's on the line x == y!"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span>(x, y) <span class="keyword">where</span> x == -y:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"It's on the line x == -y"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span>(x, y):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"It's just an ordinary point."</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"The point is (\(x), \(y)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>8.</strong> switch caseè¿˜å¯ä»¥ç”¨if case æ¥ç®€åŒ–ä»£ç <br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> age = <span class="number">19</span></span><br><span class="line"><span class="keyword">switch</span> age &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">10</span>...<span class="number">19</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"You're a teenage."</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"You're not a teenage."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨ if case ç®€åŒ–å</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">case</span> <span class="number">10</span>...<span class="number">19</span> = age &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"You're a teenage."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿˜å¯ä»¥åŠ ä¸Šwhereæ¡ä»¶åˆ¤æ–­ï¼Œwhereå¯ç›´æ¥çœç•¥é€šè¿‡é€—å·éš”å¼€</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">case</span> <span class="number">10</span>...<span class="number">19</span> = age, age &gt;= <span class="number">18</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"You're a teenage and in a college"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>9.</strong> <code>case</code>å…³é”®å­—è¿˜å¯ä»¥ç”¨äºfor<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">100</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">3</span> == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨caseæ¥å†™</span></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">case</span> <span class="keyword">let</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">100</span> <span class="keyword">where</span> i%<span class="number">3</span> == <span class="number">0</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><h2 id="æ§åˆ¶è½¬ç§»">æ§åˆ¶è½¬ç§»<a href="post/swift-study-note#æ§åˆ¶è½¬ç§»"></a></h2><blockquote><p>ç»™å¾ªç¯èµ·åå­—</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¡¨ç¤ºå¦‚æœå¾—åˆ°ç»“æœï¼Œä¸ä»…breakå†…éƒ¨å¾ªç¯ï¼Œä¹Ÿç»“æŸå¤–éƒ¨å¾ªç¯</span></span><br><span class="line">findAnswer: <span class="keyword">for</span> m <span class="keyword">in</span> <span class="number">1</span>...<span class="number">300</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="number">1</span>...<span class="number">300</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> m*m*m*m - n*n == <span class="number">15</span>*m*n &#123;</span><br><span class="line">            <span class="built_in">print</span>(m, n)</span><br><span class="line">            <span class="keyword">break</span> findAnswer</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="guard">guard<a href="post/swift-study-note#guard"></a></h2><blockquote><p>å®ˆå«ï¼Œå¦‚æœæ¡ä»¶ä¸æˆç«‹ï¼Œé‚£ä¹ˆå°†ä¼šæ‰§è¡Œelse</p></blockquote><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fun</span><span class="params">(money:Int, price: Int, capacity:Int, volume: Int)</span></span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> money &gt;= price <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Not enough money"</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">guard</span> capacity &gt;= volume <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Not enough capacity"</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"I can buy it"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="å­—ç¬¦ä¸²">å­—ç¬¦ä¸²<a href="post/swift-study-note#å­—ç¬¦ä¸²"></a></h2><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"Hello, playground"</span></span><br></pre></td></tr></table></div></figure><p><strong>1.</strong> åˆ¤æ–­æ˜¯å¦ä¸ºç©º<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> emptyString = <span class="string">""</span></span><br><span class="line">emptyString.isEmpty</span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> æ’å€¼<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">"xujiaji"</span></span><br><span class="line"><span class="keyword">let</span> age = <span class="number">24</span></span><br><span class="line"><span class="keyword">let</span> height = <span class="number">1.7</span></span><br><span class="line"><span class="keyword">let</span> s = <span class="string">"My name is \(name). I'm \(age) years old. I'm \(height) meters tall."</span></span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> å¾ªç¯å­—ç¬¦ä¸²<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="built_in">c</span> <span class="keyword">in</span> str &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">c</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>4.</strong> å£°æ˜å­—ç¬¦<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mark: <span class="type">Character</span> = <span class="string">"!"</span></span><br></pre></td></tr></table></div></figure></p><p><strong>5.</strong> æ‹¼æ¥å­—ç¬¦<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str.append(mark)</span><br></pre></td></tr></table></div></figure></p><p><strong>6.</strong> å­—ç¬¦ä¸²é•¿åº¦<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str.<span class="built_in">count</span></span><br></pre></td></tr></table></div></figure></p><p><strong>7.</strong> å¾—åˆ°å­—ç¬¦ä¸²å¼€å¤´ä¸‹æ ‡ï¼š <code>str.startIndex</code> ï¼›å¾—åˆ°æœ«å°¾ä¸‹æ ‡ï¼š<code>str.endIndex</code><br><strong>8.</strong> å¾—åˆ°å­—ç¬¦ä¸²å‰5ä¸ªå­—ç¬¦ï¼ˆ<code>offsetBy</code>è¡¨ç¤ºåç§»é‡ï¼‰<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str[str.index(str.startIndex, offsetBy: <span class="number">5</span>)]</span><br></pre></td></tr></table></div></figure></p><p><strong>9.</strong> å¾—åˆ°å­—ç¬¦ä¸²æŸä¸‹æ ‡çš„å‰ä¸€ä¸ªå­—ç¬¦æˆ–åä¸€ä¸ªå­—ç¬¦<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> spaceIndex = str.index(str.startIndex, offsetBy: <span class="number">6</span>)</span><br><span class="line">str[str.index(before: spaceIndex)]</span><br><span class="line">str[str.index(after: spaceIndex)]</span><br></pre></td></tr></table></div></figure></p><p><strong>10.</strong> å¾—åˆ°å¼€å§‹åˆ°<code>spaceIndex</code>ä¸‹æ ‡ä¹‹é—´çš„å­—ç¬¦ä¸²<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str[str.startIndex..&lt;spaceIndex]</span><br></pre></td></tr></table></div></figure></p><p><strong>11.</strong> å¾—åˆ°ä¸€ä¸ªä¸‹æ ‡èŒƒå›´<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span>  range = startIndex..&lt;str.index(before: spaceIndex)</span><br></pre></td></tr></table></div></figure></p><p><strong>12.</strong> å°†ä¸Šé¢èŒƒå›´æ›¿æ¢æˆHi<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str.replaceSubrange(range, with: <span class="string">"Hi"</span>)</span><br></pre></td></tr></table></div></figure></p><p><strong>13.</strong> æœ«å°¾æ’å…¥é—®å·<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str.insert(<span class="string">"?"</span>, at: str.endIndex)</span><br></pre></td></tr></table></div></figure></p><p><strong>14.</strong> ç§»é™¤å¯¹åº”ä¸‹æ ‡çš„å­—ç¬¦<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str.remove(at: str.index(before: str.endIndex))</span><br></pre></td></tr></table></div></figure></p><p><strong>15.</strong> ç§»é™¤æŸä¸ªä¸‹æ ‡èŒƒå›´å­—ç¬¦<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str.removeSubrange(str.index(str.endIndex, offsetBy:-<span class="number">2</span>)..&lt;str.endIndex)</span><br></pre></td></tr></table></div></figure></p><p><strong>16.</strong> å¤§å°å†™è½¬æ¢<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è½¬å¤§å†™</span></span><br><span class="line">str.uppercased()</span><br><span class="line"><span class="comment">// è½¬å°å†™</span></span><br><span class="line">str.lowercased()</span><br><span class="line"><span class="comment">// é¦–å­—å¤§å†™</span></span><br><span class="line">str.capitalized</span><br></pre></td></tr></table></div></figure></p><p><strong>17.</strong> æ˜¯å¦åŒ…å«<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ˜¯å¦åŒ…å«Hi</span></span><br><span class="line">str.<span class="built_in">contains</span>(<span class="string">"Hi"</span>)</span><br><span class="line"><span class="comment">// å‰ç¼€æ˜¯å¦æ˜¯Hi</span></span><br><span class="line">str.hasPrefix(<span class="string">"Hi"</span>)</span><br><span class="line"><span class="comment">// åç¼€æ˜¯å¦æ˜¯!!</span></span><br><span class="line">str.hasSuffix(<span class="string">"!!"</span>)</span><br></pre></td></tr></table></div></figure></p><p><strong>18.</strong> æ ¼å¼åŒ–å­—ç¬¦ä¸²<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»“æœï¼š 0.33333...</span></span><br><span class="line"><span class="keyword">let</span> ss0 = <span class="string">"one third is \(1.0/3.0)"</span></span><br><span class="line"><span class="comment">// ç»“æœï¼š 0.33</span></span><br><span class="line"><span class="keyword">let</span> ss1 = <span class="type">String</span>(format: <span class="string">"one third is %.2f"</span>, <span class="number">1.0</span>/<span class="number">3.0</span>)</span><br><span class="line"><span class="comment">// ç»“æœï¼š 0.33</span></span><br><span class="line"><span class="keyword">let</span> ss2 = <span class="type">NSString</span>(format: <span class="string">"one third is %.2f"</span>, <span class="number">1.0</span>/<span class="number">3.0</span>) <span class="keyword">as</span> <span class="type">String</span></span><br></pre></td></tr></table></div></figure></p><p><strong>19.</strong> å­—ç¬¦ä¸²æˆªå–<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ss3:<span class="type">NSString</span> = <span class="string">"one third is 0.33"</span></span><br><span class="line"><span class="comment">// ä»ä¸‹æ ‡4å¼€å§‹æˆªå–åˆ°æœ€å</span></span><br><span class="line">ss3.substring(from: <span class="number">4</span>)</span><br><span class="line"><span class="comment">// ä»å¼€å§‹æˆªå–åˆ°ä¸‹æ ‡3</span></span><br><span class="line">ss3.substring(to: <span class="number">3</span>)</span><br><span class="line"><span class="comment">// æˆªå–ä¸‹æ ‡ä»4å¼€å§‹ï¼Œæˆªå–5ä¸ªé•¿åº¦</span></span><br><span class="line">ss3.substring(with: <span class="type">NSMakeRange</span>(<span class="number">4</span>, <span class="number">5</span>))</span><br></pre></td></tr></table></div></figure></p><p><strong>20.</strong> String å’Œ NSStringçš„åŒºåˆ«</p><blockquote><p>æœ‰ä¸€ä¸ªè¡¨æƒ…çš„æ—¶å€™Stringé•¿åº¦ä¸º1ï¼Œ NSStringé•¿åº¦ä¸º2</p></blockquote><p><strong>21.</strong> å»é™¤å‰åå¤šä½™æ— æ•ˆå­—ç¬¦<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s6 = <span class="string">"   --- Hello -----    "</span> <span class="keyword">as</span> <span class="type">NSString</span></span><br><span class="line"><span class="comment">// å»é™¤å‰åç©ºæ ¼å’Œä¸‹åˆ’çº¿</span></span><br><span class="line">s6.trimmingCharacters(<span class="keyword">in</span>: <span class="type">CharacterSet</span>(charactersIn: <span class="string">" -"</span>))</span><br></pre></td></tr></table></div></figure></p><h2 id="Optional">Optional<a href="post/swift-study-note#Optional"></a></h2><p><strong>1.</strong> å®šä¹‰å¯é€‰å‹<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> errorCode: <span class="type">Int</span>? = <span class="number">404</span></span><br><span class="line">errorCode = <span class="literal">nil</span></span><br><span class="line"><span class="keyword">var</span> imOptional: <span class="type">String</span>? = <span class="literal">nil</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> å…·ä½“ç±»å‹å¯ä»¥èµ‹å€¼ç»™å¯é€‰é¡¹å‹ï¼Œä½†åè¿‡æ¥å¯é€‰å‹æ˜¯ä¸èƒ½èµ‹å€¼ç»™å…·ä½“ç±»å‹çš„ã€‚<br><strong>3.</strong> å¼ºåˆ¶è§£åŒ…ï¼Œä½†ä¸èƒ½ä¸º<code>nil</code>å¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> errorCode: <span class="type">Int</span>? = <span class="literal">nil</span></span><br><span class="line">errorCode = <span class="number">404</span></span><br><span class="line"><span class="comment">// errorCode! å¼ºåˆ¶è§£åŒ…</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"code"</span>, errorCode!)</span><br></pre></td></tr></table></div></figure></p><p><strong>4.</strong> åŠ ä¸Š<code>nil</code>åˆ¤æ–­<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¬¬ä¸€ç§å†™æ³•</span></span><br><span class="line"><span class="keyword">var</span> errorCode: <span class="type">String</span>? = <span class="literal">nil</span></span><br><span class="line"><span class="keyword">if</span> errorCode != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="string">"The errorCode is "</span> + errorCode!</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="string">"No error"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬äºŒç§å†™æ³•ï¼ˆç®€åŒ–ï¼‰ï¼Œç”¨ä¸¤ä¸ªé—®å·</span></span><br><span class="line"><span class="string">"The errorCode is \(errorCode ?? "</span>no error<span class="string">")"</span></span><br></pre></td></tr></table></div></figure></p><p><strong>5.</strong> å¯é€‰å‹è§£åŒ…<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> errorCode: <span class="type">String</span>? = <span class="string">"404"</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> errorCode = errorCode &#123;</span><br><span class="line">    <span class="string">"The errorCode is "</span> + errorCode</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="string">"No error"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> errorMessage: <span class="type">String</span>? = <span class="string">"Not found"</span></span><br><span class="line"><span class="comment">// errorCodeæœ‰å€¼ï¼Œå¹¶ä¸”errorMessageæœ‰å€¼</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> errorCode = errorCode, <span class="keyword">let</span> errorMessage = errorMessage &#123;</span><br><span class="line">    <span class="string">"The errorCode is "</span> + errorCode + <span class="string">"\nThe errorMessage is "</span> + errorMessage</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// errorCodeæœ‰å€¼ï¼Œå¹¶ä¸”errorMessageæœ‰å€¼ï¼Œå¹¶ä¸”errorCodeç­‰äº404</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> errorCode = errorCode, <span class="keyword">let</span> <span class="number">_</span> = errorMessage, errorCode == <span class="string">"404"</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Page not found"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>6.</strong> å¯é€‰å‹è°ƒç”¨<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> errorMessage: <span class="type">String</span>? = <span class="string">"Not Found"</span></span><br><span class="line"><span class="comment">// æ™®é€šåˆ¤æ–­è°ƒç”¨</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> errorMessage = errorMessage &#123;</span><br><span class="line">    errorMessage.uppercased()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ?. æ–¹å¼è°ƒç”¨ï¼Œå’Œä¸Šé¢æ•ˆæœæ˜¯ä¸€æ ·çš„</span></span><br><span class="line">errorMessage?.uppercased()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸ç”¨å†™â€œ? =â€æ–¹å¼ï¼Œå¯é€‰å‹çš„è°ƒç”¨çš„ç»“æœä¹Ÿæ˜¯å¯é€‰å‹çš„</span></span><br><span class="line"><span class="keyword">var</span> uppercaseErrorMessage = errorMessage?.uppercased()</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¹Ÿå¯ä»¥è°ƒç”¨åï¼Œå¦‚æœå­˜åœ¨ä½¿ç”¨è¯¥å¯¹è±¡</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> errorMessage = errorMessage?.uppercased() &#123;</span><br><span class="line">    errorMessage</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>6.</strong> å®é™…è¿ç”¨<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ageInput: <span class="type">String</span> = <span class="string">"16"</span></span><br><span class="line"><span class="keyword">var</span> age = <span class="type">Int</span>(ageInput) <span class="comment">// è¿”å›çš„æ˜¯ï¼šInt?</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> age = <span class="type">Int</span>(ageInput), age &lt; <span class="number">20</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"You're a teenage"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>7.</strong> éšå¼å¯é€‰ç±»å‹ï¼Œè¿ç”¨åœ¨èƒ½è‚¯å®šçš„è¡¨ç¤ºæœ‰å€¼çš„æƒ…å†µä¸‹<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åé¢è·Ÿï¼è¡¨ç¤ºæ˜¯éšå¼å¯é€‰ç±»å‹</span></span><br><span class="line"><span class="keyword">var</span> errorMessage: <span class="type">String</span>! = <span class="literal">nil</span></span><br><span class="line">errorMessage = <span class="string">"Not Found"</span></span><br><span class="line"><span class="string">"The message is "</span> + errorMessage</span><br><span class="line"></span><br><span class="line">errorMessage = <span class="literal">nil</span></span><br><span class="line"><span class="comment">// ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ‰€ä»¥éšå¼å¯é€‰ç±»å‹å±é™©çš„</span></span><br><span class="line"><span class="comment">//"The message is " + errorMessage</span></span><br></pre></td></tr></table></div></figure></p><h2 id="Array">Array<a href="post/swift-study-note#Array"></a></h2><p><strong>1.</strong> ç©ºæ•°ç»„çš„å®šä¹‰<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ‰æ•°æ®æ—¶çš„å®šä¹‰ï¼Œ æ³¨æ„ç±»å‹å¿…é¡»ç»Ÿä¸€</span></span><br><span class="line"><span class="keyword">var</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="keyword">var</span> vowels = [<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>]</span><br><span class="line"><span class="comment">// å®šä¹‰çš„æ—¶ç¡®å®šå¥½ç±»å‹</span></span><br><span class="line"><span class="comment">//var numbers: [Int] = [0,1,2,3,4,5]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ç©ºæ•°ç»„</span></span><br><span class="line"><span class="keyword">var</span> emptyArr1:[<span class="type">Int</span>] = []</span><br><span class="line"><span class="keyword">var</span> emptyArr2:<span class="type">Array</span>&lt;<span class="type">Int</span>&gt; = []</span><br><span class="line"><span class="keyword">var</span> emptyArr3 = [<span class="type">Int</span>]()</span><br><span class="line"><span class="keyword">var</span> emptyArr4 = <span class="type">Array</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰æ—¶ç»Ÿä¸€èµ‹å€¼</span></span><br><span class="line"><span class="keyword">var</span> allZeros = <span class="type">Array</span>&lt;<span class="type">Int</span>&gt;(repeating: <span class="number">0</span>, <span class="built_in">count</span>: <span class="number">5</span>) <span class="comment">// [0, 0, 0, 0, 0]</span></span><br><span class="line"><span class="keyword">var</span> allZeros2 = [<span class="type">Int</span>](repeating: <span class="number">0</span>, <span class="built_in">count</span>: <span class="number">5</span>) <span class="comment">// [0, 0, 0, 0, 0]</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> æ•°ç»„æŸ¥è¯¢åŸºæœ¬ä½¿ç”¨æ–¹å¼<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="keyword">var</span> vowels = [<span class="string">"A"</span>, <span class="string">"E"</span>, <span class="string">"I"</span>, <span class="string">"O"</span>, <span class="string">"U"</span>]</span><br><span class="line"><span class="keyword">var</span> emptyArr = [<span class="type">Int</span>]()</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æ•°ç»„é•¿åº¦</span></span><br><span class="line">vowels.<span class="built_in">count</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">numbers.isEmpty <span class="comment">// false</span></span><br><span class="line">emptyArr.isEmpty <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–é¦–å…ƒç´ æˆ–æœ«å…ƒç´ </span></span><br><span class="line">vowels.first <span class="comment">// "A"</span></span><br><span class="line">vowels.last <span class="comment">// "U"</span></span><br><span class="line">emptyArr.first <span class="comment">// nil</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯é€‰å‹è§£åŒ…</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> firstVomel = vowels.first &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"The first vowel is "</span> + firstVomel)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼ºåˆ¶è§£åŒ…ï¼Œç”±è‡ªå·±ä¿è¯å®‰å…¨</span></span><br><span class="line">vowels.first!</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æ•°ç»„çš„æœ€å¤§å€¼æˆ–æœ€å°å€¼</span></span><br><span class="line">numbers.<span class="built_in">min</span>()</span><br><span class="line">numbers.<span class="built_in">max</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»åŸæ•°ç»„ä¸­å–å‡ºå­æ•°ç»„</span></span><br><span class="line">numbers[<span class="number">2</span>..&lt;<span class="number">4</span>] <span class="comment">// [3, 4]</span></span><br><span class="line">numbers[<span class="number">2</span>..&lt;numbers.<span class="built_in">count</span>] <span class="comment">// [3, 4, 5]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒ…å«</span></span><br><span class="line">vowels.<span class="built_in">contains</span>(<span class="string">"A"</span>) <span class="comment">// true</span></span><br><span class="line">vowels.<span class="built_in">contains</span>(<span class="string">"B"</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–ä¸‹æ ‡</span></span><br><span class="line">vowels.index(of: <span class="string">"E"</span>) <span class="comment">// 1</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> index = vowels.index(of: <span class="string">"E"</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"E is vowel in position \(index+1)."</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"E is not a vowel."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡ä¸‹æ ‡éå†</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;numbers.<span class="built_in">count</span> &#123;</span><br><span class="line">    numbers[i]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´æ¥éå†å…ƒç´ </span></span><br><span class="line"><span class="keyword">for</span> number <span class="keyword">in</span> numbers &#123;</span><br><span class="line">    <span class="built_in">print</span>(number)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒæ—¶éå†ä¸‹æ ‡å’Œå…ƒç´ </span></span><br><span class="line"><span class="keyword">for</span> (i, vowel) <span class="keyword">in</span> vowels.enumerated() &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(i + 1): \(vowel)"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¯”è¾ƒï¼Œä¸javaä¸åŒï¼Œswiftæ¯”è¾ƒçš„æ˜¯å…ƒç´ </span></span><br><span class="line"><span class="keyword">var</span> oneToFive = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">numbers == oneToFive <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”±äºæ¯”è¾ƒæ•°ç»„æ—¶ä¸å…ƒç´ çš„é¡ºåºæœ‰å…³ï¼Œæ‰€ä»¥ä¸‹æ–¹ç»“æœä¸ºfalse</span></span><br><span class="line"><span class="keyword">var</span> oneToFive2 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>]</span><br><span class="line">numbers == oneToFive2 <span class="comment">// false</span></span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> æ•°ç»„æ’å…¥å€¼çš„åŸºæœ¬æ“ä½œ<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> courses = [<span class="string">"A course"</span>, <span class="string">"B course"</span>, <span class="string">"C course"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ å…ƒç´ </span></span><br><span class="line">courses.append(<span class="string">"D course"</span>) <span class="comment">//["A course", "B course", "C course", "D course"]</span></span><br><span class="line"></span><br><span class="line">courses += [<span class="string">"E course"</span>] <span class="comment">//["A course", "B course", "C course", "D course", "E course"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¹æ®ä½ç½®æ’å…¥å…ƒç´ </span></span><br><span class="line">courses.insert(<span class="string">"a course"</span>, at: <span class="number">1</span>) <span class="comment">//["A course", "a course", "B course", "C course", "D course", "E course"]</span></span><br></pre></td></tr></table></div></figure></p><p><strong>4.</strong> æ•°ç»„åˆ é™¤å…ƒç´ çš„åŸºæœ¬æ“ä½œ<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> courses = [<span class="string">"A course"</span>, <span class="string">"B course"</span>, <span class="string">"C course"</span>, <span class="string">"D course"</span>]</span><br><span class="line"><span class="comment">// åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">courses.removeLast() <span class="comment">//"D course"</span></span><br><span class="line"><span class="comment">// åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">courses.removeFirst() <span class="comment">//"A course"</span></span><br><span class="line">courses <span class="comment">// ["B course", "C course"]</span></span><br><span class="line"><span class="comment">// ä»ä¸‹æ ‡0å¼€å§‹åˆ é™¤1ä¸ª</span></span><br><span class="line">courses.removeSubrange(<span class="number">0</span>..&lt;<span class="number">1</span>) <span class="comment">//["C course"]</span></span><br><span class="line"><span class="comment">// åˆ é™¤æ‰€æœ‰å…ƒç´ </span></span><br><span class="line">courses.removeAll()</span><br></pre></td></tr></table></div></figure></p><p><strong>5.</strong> ä¿®æ”¹å…ƒç´ çš„åŸºæœ¬æ“ä½œ<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> courses = [<span class="string">"A course"</span>, <span class="string">"B course"</span>, <span class="string">"C course"</span>, <span class="string">"D course"</span>]</span><br><span class="line"><span class="comment">// ä¿®æ”¹ä¸‹æ ‡ä¸º0çš„å…ƒç´ </span></span><br><span class="line">courses[<span class="number">0</span>] = <span class="string">"1 course"</span></span><br><span class="line">courses <span class="comment">// ["1 course", "B course", "C course", "D course"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹ä¸‹æ ‡1åˆ°2çš„å…ƒç´ </span></span><br><span class="line">courses[<span class="number">1</span>...<span class="number">2</span>] = [<span class="string">"2 course"</span>, <span class="string">"3 course"</span>]</span><br><span class="line">courses <span class="comment">// ["1 course", "2 course", "3 course", "D course"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå¹¶å¹¶ä¿®æ”¹0åˆ°2çš„å…ƒç´ </span></span><br><span class="line">courses[<span class="number">0</span>...<span class="number">2</span>] = [<span class="string">"A course"</span>]</span><br><span class="line">courses <span class="comment">// ["A course", "D course"]</span></span><br></pre></td></tr></table></div></figure></p><h2 id="NSArray">NSArray<a href="post/swift-study-note#NSArray"></a></h2><p><strong>1.</strong> NSArrayæ˜¯ä¸€ä¸ªç±»ï¼ŒArrayæ˜¯ä¸€ä¸ªç»“æ„<br><strong>2.</strong> NSArrayé‡Œå¯ä»¥æ”¾ä¸åŒç±»å‹çš„å…ƒç´ ï¼Œå¦‚ï¼š<code>var arr: NSArray = [1, &quot;Hello&quot;, 3.0]</code></p><h2 id="Dict">Dict<a href="post/swift-study-note#Dict"></a></h2><p><strong>1.</strong> å­—å…¸çš„åˆå§‹åŒ–å’ŒæŸ¥è¯¢çš„åŸºæœ¬ä½¿ç”¨æ–¹å¼<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªæœ‰æ•°æ®çš„å­—å…¸</span></span><br><span class="line"><span class="keyword">var</span> dict = [<span class="string">"swift"</span>: <span class="string">"é›¨ç‡•ï¼›å¿«é€Ÿ"</span>, <span class="string">"python"</span>: <span class="string">"å¤§èŸ’"</span>, <span class="string">"java"</span>:<span class="string">"çˆªå“‡å²›"</span>, <span class="string">"groovy"</span>: <span class="string">"ç»å¦™çš„ï¼›æ—¶é«¦çš„"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºç©ºå­—å…¸</span></span><br><span class="line"><span class="keyword">var</span> emptyDict1: [<span class="type">String</span>:<span class="type">Int</span>] = [:]</span><br><span class="line"><span class="keyword">var</span> emptyDict2: <span class="type">Dictionary</span>&lt;<span class="type">Int</span>, <span class="type">String</span>&gt; = [:]</span><br><span class="line"><span class="keyword">var</span> emptyDict3 = [<span class="type">String</span>:<span class="type">String</span>]()</span><br><span class="line"><span class="keyword">var</span> emptyDict4 = <span class="type">Dictionary</span>&lt;<span class="type">Int</span>, <span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡keyè·å–å­—å…¸æ•°æ®</span></span><br><span class="line">dict[<span class="string">"swift"</span>] <span class="comment">// "é›¨ç‡•ï¼›å¿«é€Ÿ"</span></span><br><span class="line">dict[<span class="string">"C++"</span>] <span class="comment">// nil</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯é€‰å‹è§£åŒ…</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> value = dict[<span class="string">"swift"</span>] &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"swift çš„æ„æ€æ˜¯ï¼š\(value)"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å­—å…¸æ•°æ®çš„æ•°é‡</span></span><br><span class="line">dict.<span class="built_in">count</span> <span class="comment">// 4</span></span><br><span class="line"></span><br><span class="line">dict.isEmpty <span class="comment">// false</span></span><br><span class="line">emptyDict1.isEmpty <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//éå†æ‰€æœ‰key</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> dict.keys &#123;</span><br><span class="line">    <span class="built_in">print</span>(key)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éå†æ‰€æœ‰value</span></span><br><span class="line"><span class="keyword">for</span> value <span class="keyword">in</span> dict.values &#123;</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éå†keyå’Œvalue</span></span><br><span class="line"><span class="keyword">for</span> (key, value) <span class="keyword">in</span> dict &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(key): \(value)"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸¤ä¸ªå­—å…¸å¯¹æ¯”ï¼šæ¯”è¾ƒçš„keyå’Œå¯¹åº”çš„valueï¼Œç”±äºå­—å…¸æ˜¯æ— åºçš„ï¼Œå› æ­¤ä¸‹æ–¹ç­‰å¼ä¹Ÿæˆç«‹</span></span><br><span class="line"><span class="keyword">let</span> dict1 = [<span class="number">1</span>: <span class="string">"A"</span>, <span class="number">2</span>: <span class="string">"B"</span>, <span class="number">3</span>: <span class="string">"C"</span>]</span><br><span class="line"><span class="keyword">let</span> dict2 = [<span class="number">1</span>: <span class="string">"A"</span>, <span class="number">3</span>: <span class="string">"C"</span>, <span class="number">2</span>: <span class="string">"B"</span>]</span><br><span class="line">dict1 == dict2 <span class="comment">// true</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> å­—å…¸çš„ä¿®æ”¹å’Œåˆ é™¤<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// letçš„å­—å…¸ä¸å¯ä¿®æ”¹</span></span><br><span class="line"><span class="keyword">var</span> user = [<span class="string">"name"</span>: <span class="string">"xujiaji"</span>, <span class="string">"password"</span>: <span class="string">"123456"</span>, <span class="string">"occupation"</span>: <span class="string">"programmer"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹å€¼</span></span><br><span class="line">user[<span class="string">"occupation"</span>] = <span class="string">"freelancer"</span></span><br><span class="line"><span class="comment">// è°ƒç”¨æ–¹æ³•ä¿®æ”¹å€¼ä¼šè¿”å›ä¹‹å‰çš„å€¼</span></span><br><span class="line">user.updateValue(<span class="string">"abcdefg"</span>, forKey: <span class="string">"password"</span>) <span class="comment">// "123456"</span></span><br><span class="line">user <span class="comment">//["name": "xujiaji", "password": "abcdefg", "occupation": "freelancer"]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> oldPassword = user.updateValue(<span class="string">"abcdefg"</span>, forKey: <span class="string">"password"</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> oldPassword = oldPassword, <span class="keyword">let</span> newPassword = user[<span class="string">"password"</span>], oldPassword == newPassword &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"æ³¨æ„ï¼šä¿®æ”¹åçš„å¯†ç å’Œä¹‹å‰çš„ä¸€æ ·ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´æ¥æ·»åŠ æ–°çš„keyå’Œvalue</span></span><br><span class="line">user[<span class="string">"email"</span>] = <span class="string">"jiajixu@qq.com"</span></span><br><span class="line">user <span class="comment">// ["name": "xujiaji", "occupation": "freelancer", "email": "jiajixu@qq.com", "password": "abcdefg"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡æ–¹æ³•æ·»åŠ æ–°çš„keyå’Œvalue</span></span><br><span class="line">user.updateValue(<span class="string">"https://blog.xujiaji.com"</span>, forKey: <span class="string">"website"</span>) <span class="comment">// nil</span></span><br><span class="line">user <span class="comment">// ["name": "xujiaji", "occupation": "freelancer", "email": "jiajixu@qq.com", "password": "abcdefg", "website": "https://blog.xujiaji.com"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤keyå’Œvalue</span></span><br><span class="line">user[<span class="string">"website"</span>] = <span class="literal">nil</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡è°ƒç”¨æ–¹æ³•åˆ é™¤keyå’Œvalue</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> email = user.removeValue(forKey: <span class="string">"email"</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"ç”µå­é‚®ç®±\(email)åˆ é™¤æˆåŠŸ"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤æ‰€æœ‰æ•°æ®</span></span><br><span class="line">user.removeAll()</span><br></pre></td></tr></table></div></figure></p><h2 id="Set">Set<a href="post/swift-study-note#Set"></a></h2><p><strong>1.</strong> åˆå§‹åŒ–å’ŒåŸºæœ¬ä½¿ç”¨<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªæœ‰æ•°æ®çš„Seté›†åˆï¼Œå’Œæ•°ç»„å®šä¹‰æ–¹å¼å·®ä¸å¤šï¼Œä½†æ˜¯åŠ ä¸Šäº†ç±»å‹ç”³æ˜</span></span><br><span class="line"><span class="keyword">var</span> skillsOfA: <span class="type">Set</span>&lt;<span class="type">String</span>&gt; = [<span class="string">"swift"</span>, <span class="string">"OC"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºç©ºSeté›†åˆ</span></span><br><span class="line"><span class="keyword">var</span> emptySet1: <span class="type">Set</span>&lt;<span class="type">String</span>&gt; = []</span><br><span class="line"><span class="keyword">var</span> emptySet2 = <span class="type">Set</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="comment">//é›†åˆæ˜¯æ— åºçš„ï¼Œå¹¶ä¸”æ²¡æœ‰é‡å¤</span></span><br><span class="line"><span class="keyword">var</span> vowels = <span class="type">Set</span>([<span class="string">"A"</span>, <span class="string">"E"</span>, <span class="string">"I"</span>, <span class="string">"O"</span>, <span class="string">"U"</span>, <span class="string">"U"</span>]) <span class="comment">//&#123;"O", "A", "I", "U", "E"&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> skillsOfB: <span class="type">Set</span> = [<span class="string">"HTML"</span>, <span class="string">"CSS"</span>, <span class="string">"JavaScript"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// é›†åˆå…ƒç´ ä¸ªæ•°</span></span><br><span class="line">skillsOfA.<span class="built_in">count</span> <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">set</span>: <span class="type">Set</span> = [<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>]</span><br><span class="line"><span class="keyword">set</span>.<span class="built_in">count</span> <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é›†åˆæ˜¯å¦ä¸ºç©º</span></span><br><span class="line">skillsOfB.isEmpty <span class="comment">// false</span></span><br><span class="line">emptySet1.isEmpty <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¿«é€Ÿè·å–é›†åˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">skillsOfA.first <span class="comment">// "swift"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒ…å«</span></span><br><span class="line">skillsOfA.<span class="built_in">contains</span>(<span class="string">"swift"</span>) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// éå†</span></span><br><span class="line"><span class="keyword">for</span> skill <span class="keyword">in</span> skillsOfB &#123;</span><br><span class="line">    <span class="built_in">print</span>(skill)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¯”è¾ƒçš„å€¼ï¼Œå’Œé¡ºåºæ— å…³</span></span><br><span class="line"><span class="keyword">let</span> setA: <span class="type">Set</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">let</span> setB: <span class="type">Set</span> = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">setA == setB <span class="comment">// true</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> å…ƒç´ çš„æ’å…¥å’Œåˆ é™¤<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> skillsOfA: <span class="type">Set</span>&lt;<span class="type">String</span>&gt; = [<span class="string">"swift"</span>, <span class="string">"OC"</span>]</span><br><span class="line"><span class="keyword">var</span> skillsOfB: <span class="type">Set</span>&lt;<span class="type">String</span>&gt; = [<span class="string">"HTML"</span>, <span class="string">"CSS"</span>, <span class="string">"Javacript"</span>]</span><br><span class="line"><span class="keyword">var</span> skillsOfC: <span class="type">Set</span>&lt;<span class="type">String</span>&gt; = []</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ å…ƒç´ </span></span><br><span class="line">skillsOfC.insert(<span class="string">"swift"</span>)</span><br><span class="line">skillsOfC.insert(<span class="string">"HTML"</span>)</span><br><span class="line">skillsOfC.insert(<span class="string">"CSS"</span>)</span><br><span class="line">skillsOfC <span class="comment">//&#123;"swift", "CSS", "HTML"&#125;</span></span><br><span class="line"><span class="comment">// é‡å¤æ·»åŠ </span></span><br><span class="line">skillsOfC.insert(<span class="string">"CSS"</span>)</span><br><span class="line">skillsOfC <span class="comment">//&#123;"swift", "CSS", "HTML"&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤å…ƒç´ </span></span><br><span class="line">skillsOfC.remove(<span class="string">"CSS"</span>)</span><br><span class="line">skillsOfC <span class="comment">//&#123;"swift", "HTML"&#125;</span></span><br><span class="line"><span class="comment">// åˆ é™¤æ²¡æœ‰çš„å…ƒç´ </span></span><br><span class="line">skillsOfC.remove(<span class="string">"Javascript"</span>) <span class="comment">//nil</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> <span class="number">_</span> = skillsOfC.remove(<span class="string">"HTML"</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"HTML is removed"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> é›†åˆä¹‹é—´çš„æ“ä½œï¼šå¹¶é›†ã€äº¤é›†ã€å‡é›†ã€å¼‚æˆ–<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> skillsOfA: <span class="type">Set</span>&lt;<span class="type">String</span>&gt; = [<span class="string">"swift"</span>, <span class="string">"OC"</span>]</span><br><span class="line"><span class="keyword">var</span> skillsOfB: <span class="type">Set</span>&lt;<span class="type">String</span>&gt; = [<span class="string">"HTML"</span>, <span class="string">"CSS"</span>, <span class="string">"Javacript"</span>, <span class="string">"Java"</span>]</span><br><span class="line"><span class="keyword">var</span> skillsOfC: <span class="type">Set</span>&lt;<span class="type">String</span>&gt; = [<span class="string">"swift"</span>, <span class="string">"Java"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¹¶é›†</span></span><br><span class="line">skillsOfA.union(skillsOfC) <span class="comment">//&#123;"swift", "OC", "Java"&#125;</span></span><br><span class="line">skillsOfA <span class="comment">//&#123;"swift", "OC"&#125;</span></span><br><span class="line"><span class="comment">// å¹¶é›†æ“ä½œåæ”¹å˜skillsOfAçš„å€¼</span></span><br><span class="line">skillsOfA.formUnion(skillsOfC) <span class="comment">//&#123;"swift", "OC", "Java"&#125;</span></span><br><span class="line">skillsOfA <span class="comment">//&#123;"swift", "OC", "Java"&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// äº¤é›†</span></span><br><span class="line">skillsOfB.intersection(skillsOfC) <span class="comment">// &#123;"Java"&#125;</span></span><br><span class="line">skillsOfB <span class="comment">// &#123;"Java", "HTML", "CSS", "Javacript"&#125;</span></span><br><span class="line">skillsOfB.formIntersection(skillsOfC) <span class="comment">// &#123;"Java"&#125;</span></span><br><span class="line">skillsOfB <span class="comment">// &#123;"Java"&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡é›†</span></span><br><span class="line">skillsOfA.subtracting(skillsOfC)</span><br><span class="line">skillsOfA <span class="comment">// &#123;"swift", "OC", "Java"&#125;</span></span><br><span class="line">skillsOfA.subtract(skillsOfC)</span><br><span class="line">skillsOfA <span class="comment">// &#123;"OC"&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼‚æˆ–</span></span><br><span class="line">skillsOfA.symmetricDifference(skillsOfC)</span><br><span class="line">skillsOfA <span class="comment">// &#123;"OC"&#125;</span></span><br><span class="line">skillsOfA.formSymmetricDifference(skillsOfC)</span><br><span class="line">skillsOfA <span class="comment">// &#123;"OC", "swift", "Java"&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯æ“ä½œæ•°ç»„</span></span><br><span class="line">skillsOfA.union([<span class="string">"Java"</span>, <span class="string">"Android"</span>])</span><br></pre></td></tr></table></div></figure></p><p><strong>4.</strong> é›†åˆä¸­çš„å­é›†ï¼Œè¶…é›†åˆç›¸ç¦»çš„åˆ¤æ–­<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> skillsOfA: <span class="type">Set</span>&lt;<span class="type">String</span>&gt; = [<span class="string">"swift"</span>, <span class="string">"OC"</span>]</span><br><span class="line"><span class="keyword">var</span> skillsOfB: <span class="type">Set</span>&lt;<span class="type">String</span>&gt; = [<span class="string">"HTML"</span>, <span class="string">"CSS"</span>, <span class="string">"Javacript"</span>, <span class="string">"Java"</span>]</span><br><span class="line"><span class="keyword">var</span> skillsOfC: <span class="type">Set</span>&lt;<span class="type">String</span>&gt; = [<span class="string">"swift"</span>, <span class="string">"Java"</span>]</span><br><span class="line"><span class="keyword">var</span> skillsOfD: <span class="type">Set</span> = [<span class="string">"swift"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜¯å¦æ˜¯å­é›†ï¼ˆDæ˜¯å¦åŒ…å«Aï¼‰</span></span><br><span class="line">skillsOfD.isSubset(of: skillsOfA) <span class="comment">// true</span></span><br><span class="line"><span class="comment">// æ˜¯å¦æ˜¯çœŸå­é›† ï¼ˆDæ˜¯å¦åŒ…å«Aï¼Œå¹¶ä¸”D != Aï¼‰</span></span><br><span class="line">skillsOfD.isStrictSubset(of: skillsOfA) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜¯å¦æ˜¯è¶…é›†ï¼ˆä¸å­é›†ç›¸åï¼‰</span></span><br><span class="line">skillsOfA.isSuperset(of: skillsOfD) <span class="comment">// true</span></span><br><span class="line"><span class="comment">// æ˜¯å¦æ˜¯çœŸè¶…é›†</span></span><br><span class="line">skillsOfA.isStrictSuperset(of: skillsOfD) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ¤æ–­ç›¸ç¦»(ä¸¤é›†åˆæ²¡æœ‰å…±æœ‰å…ƒç´ )</span></span><br><span class="line">skillsOfA.isDisjoint(with: skillsOfB) <span class="comment">// true</span></span><br><span class="line">skillsOfA.isDisjoint(with: skillsOfC) <span class="comment">// false</span></span><br></pre></td></tr></table></div></figure></p><h2 id="Function">Function<a href="post/swift-study-note#Function"></a></h2><h3 id="å‚æ•°éƒ¨åˆ†">å‚æ•°éƒ¨åˆ†<a href="post/swift-study-note#å‚æ•°éƒ¨åˆ†"></a></h3><p><strong>1.</strong> æ–¹æ³•çš„åŸºæœ¬å®šä¹‰<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  å‡½æ•°çš„åŸºæœ¬æ„å»º</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sayHelloTo</span><span class="params">(name: String)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Hello "</span> + name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨</span></span><br><span class="line">sayHelloTo(name: <span class="string">"xujiaji"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡æ·»åŠ ä¸‹åˆ’çº¿ï¼Œè°ƒç”¨çš„æ—¶å€™å¯ä»¥çœç•¥å‚æ•°å</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sayHelloTo</span><span class="params">(<span class="number">_</span> name: String)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Hello "</span> + name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sayHelloTo(<span class="string">"xujiaji"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å‚æ•°ä¸­åŒ…å«å¯é€‰å‹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sayHelloTo</span><span class="params">(name: String?)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Hello "</span> + (name ?? <span class="string">"Guest"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> nickname: <span class="type">String</span>? = <span class="literal">nil</span></span><br><span class="line">sayHelloTo(name: nickname)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ²¡æœ‰å‚æ•°ä¸æ²¡æœ‰è¿”å›å€¼çš„å‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printHello</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Hello"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ˜¾ç¤ºçš„è¯´æ˜æ²¡æœ‰è¿”å›å€¼</span></span><br><span class="line"><span class="comment">//func printHello() -&gt; () &#123;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">// Void = ()</span></span><br><span class="line"><span class="comment">//func printHello() -&gt; Void &#123;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> å†™ä¸€ä¸ªå¾—åˆ°æ•°ç»„ä¸­æœ€å¤§å’Œæœ€å°å€¼çš„æ–¹æ³•<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">findMaxAndMin</span><span class="params">(numbers: [Int])</span></span> -&gt; (<span class="built_in">max</span>: <span class="type">Int</span>, <span class="built_in">min</span>: <span class="type">Int</span>)? &#123;</span><br><span class="line">    <span class="keyword">guard</span> !numbers.isEmpty <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> minValue = numbers[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">var</span> maxValue = numbers[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> number <span class="keyword">in</span> numbers &#123;</span><br><span class="line">        minValue = <span class="built_in">min</span>(minValue, number)</span><br><span class="line">        maxValue = <span class="built_in">max</span>(maxValue, number)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (maxValue, minValue)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> scores: [<span class="type">Int</span>]? = [<span class="number">202</span>, <span class="number">1234</span>, <span class="number">5678</span>, <span class="number">334</span>, <span class="number">982</span>, <span class="number">555</span>]</span><br><span class="line">scores = scores ?? []</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> result = findMaxAndMin(numbers: scores!) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"The max value is \(result.max)"</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"The min value is \(result.min)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> æ–¹æ³•çš„å¤–éƒ¨å‚æ•°åå’Œå†…éƒ¨å‚æ•°å<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸€èˆ¬å†™æ³•ï¼Œå†…éƒ¨å‚æ•°ååŒæ—¶ä¹Ÿæ˜¯å¤–éƒ¨å‚æ•°å</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sayHelloTo</span><span class="params">(name: String, greeting: String)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"\(greeting), \(name)"</span></span><br><span class="line">&#125;</span><br><span class="line">sayHelloTo(name: <span class="string">"Playground"</span>, greeting: <span class="string">"Hello"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸ºå‚æ•°æä¾›å¤–éƒ¨å‚æ•°åï¼Œè®©è¯­ä¹‰æ›´åŠ çš„æ˜ç¡®</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sayHello</span><span class="params">(to name: String, withGreetingWord greeting: String)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"\(greeting), \(name)"</span></span><br><span class="line">&#125;</span><br><span class="line">sayHello(to: <span class="string">"Playground"</span>, withGreetingWord: <span class="string">"Hello"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸€ä¸ªè®¡ç®—ä¹˜æ³•çš„æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">mutiply</span><span class="params">(num1: Int, x num2: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> num1 * num2</span><br><span class="line">&#125;</span><br><span class="line">mutiply(num1: <span class="number">4</span>, x: <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸‹æ–¹ä¹˜æ³•è™½è¯­ä¹‰æ˜ç¡®ä½†æ˜¯ï¼Œç¡®æ˜¾å¾—å¤æ‚ï¼Œç›´æ¥ä¼ å…¥ä¸¤ä¸ªå€¼ä¼šæ›´åŠ å¾—å½“ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹åˆ’çº¿å¿½ç•¥å‚æ•°å</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">mutiply</span><span class="params">(<span class="number">_</span> num1: Int, <span class="number">_</span> num2: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> num1 * num2</span><br><span class="line">&#125;</span><br><span class="line">mutiply(<span class="number">4</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></div></figure></p><p><strong>4.</strong> é»˜è®¤å‚æ•°å’Œå¯å˜å‚æ•°<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é»˜è®¤å‚æ•°çš„ä½¿ç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sayHello</span><span class="params">(to name: String = <span class="string">"Playground"</span>, withGreetingWord greeting: String = <span class="string">"Hello"</span>, punctuation: String = <span class="string">"!"</span>)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"\(greeting), \(name)\(punctuation)"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sayHello() <span class="comment">// "Hello, Playground!"</span></span><br><span class="line">sayHello(to: <span class="string">"Bob"</span>) <span class="comment">// "Hello, Bob!"</span></span><br><span class="line">sayHello(to: <span class="string">"Bob"</span>, withGreetingWord: <span class="string">"Bye"</span>) <span class="comment">//"Bye, Bob!"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯å˜å‚æ•°çš„ä½¿ç”¨</span></span><br><span class="line"><span class="comment">// è®¡ç®—å¹³å±€å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">mean</span><span class="params">(<span class="number">_</span> numbers: Double ... )</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> sum: <span class="type">Double</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> number <span class="keyword">in</span> numbers &#123;</span><br><span class="line">        sum += number</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum / <span class="type">Double</span>(numbers.<span class="built_in">count</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mean(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3.4</span>, <span class="number">7.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// printæ˜¯ä¸€ä¸ªéå¸¸å¥½çš„æœ‰é»˜è®¤å‚æ•°å’Œå¯å˜å‚æ•°çš„å‡½æ•°ï¼Œå¯å˜å‚æ•°ä¸ä¸€å®šæ”¾åœ¨æœ€å</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Hello"</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, separator: <span class="string">","</span>, terminator: <span class="string">"."</span>) <span class="comment">// "Hello,1,2,3."</span></span><br></pre></td></tr></table></div></figure></p><p><strong>5.</strong> å¸¸é‡å‚æ•°ã€å˜é‡å‚æ•°<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡½æ•°çš„å‚æ•°é»˜è®¤éƒ½æ˜¯ä¸å¯å˜çš„</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">toBinary</span><span class="params">(<span class="number">_</span> num: Int)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="comment">// è®©ä¼ å…¥çš„å‚æ•°numç§°ä¸ºå¯å˜å‚æ•°</span></span><br><span class="line">    <span class="keyword">var</span> num = num</span><br><span class="line">    <span class="keyword">var</span> res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">repeat</span> &#123;</span><br><span class="line">        res = <span class="type">String</span>(num%<span class="number">2</span>) + res</span><br><span class="line">        num /= <span class="number">2</span></span><br><span class="line">    &#125; <span class="keyword">while</span> num != <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">toBinary(<span class="number">12</span>) <span class="comment">// "1100"</span></span><br></pre></td></tr></table></div></figure></p><p><strong>6.</strong> inout<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// var å‚æ•°æ˜¯å€¼ä¼ é€’ï¼Œä¸èƒ½å»¶ç»­åˆ°å‡½æ•°ä½“å¤–é¢</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">100</span></span><br><span class="line">toBinary(x)</span><br><span class="line">x</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœéœ€è¦å»¶ç»­åˆ°å¤–é¢</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swapTwoInt</span><span class="params">(a: <span class="keyword">inout</span> Int, b: <span class="keyword">inout</span> Int)</span></span> &#123;</span><br><span class="line"><span class="comment">//    let t: Int = a</span></span><br><span class="line"><span class="comment">//    a = b</span></span><br><span class="line"><span class="comment">//    b = t</span></span><br><span class="line"><span class="comment">// é€šè¿‡å…ƒç»„å¯ç›´æ¥äº¤æ¢å€¼</span></span><br><span class="line">    (a, b) = (b, a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a: <span class="type">Int</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> b: <span class="type">Int</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼ å…¥aå’Œbçš„å¼•ç”¨</span></span><br><span class="line">swapTwoInt(a: &amp;a, b: &amp;b)</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line"></span><br><span class="line"><span class="comment">// swiftæä¾›çš„äº¤æ¢æ–¹æ³•</span></span><br><span class="line"><span class="built_in">swap</span>(&amp;a, &amp;b)</span><br><span class="line">a</span><br><span class="line">b</span><br></pre></td></tr></table></div></figure></p><h3 id="ç±»å‹éƒ¨åˆ†">ç±»å‹éƒ¨åˆ†<a href="post/swift-study-note#ç±»å‹éƒ¨åˆ†"></a></h3><p><strong>1.</strong> å‡½æ•°ç±»å‹çš„åŸºæœ¬æ¦‚å¿µ<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡½æ•°ç±»å‹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(<span class="number">_</span> a: Int, <span class="number">_</span> b: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ³•ä¹Ÿå¯ä»¥èµ‹å€¼</span></span><br><span class="line"><span class="keyword">let</span> anotherAdd = add</span><br><span class="line"><span class="comment">// ä¹Ÿå¯ä»¥å£°æ˜ç±»å‹</span></span><br><span class="line"><span class="comment">// let anotherAdd: (Int,Int)-&gt;Int = add</span></span><br><span class="line">anotherAdd(<span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sayHello</span><span class="params">(to name: String)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Hello, \(name)!"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> anotherSayHello1 = sayHello</span><br><span class="line"><span class="keyword">let</span> anotherSayHello2: (<span class="type">String</span>) -&gt; () = sayHello</span><br><span class="line"><span class="keyword">let</span> anotherSayHello3: (<span class="type">String</span>) -&gt; <span class="type">Void</span> = sayHello</span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> å¦‚ä½•ä½¿ç”¨å‡½æ•°ç±»å‹ï¼Ÿ<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr: [<span class="type">Int</span>] = []</span><br><span class="line"><span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="number">100</span> &#123;</span><br><span class="line">    arr.append(<span class="type">Int</span>(arc4random() % <span class="number">1000</span>))</span><br><span class="line">&#125;</span><br><span class="line">arr</span><br><span class="line"></span><br><span class="line"><span class="comment">// é»˜è®¤æ’åº</span></span><br><span class="line">arr.<span class="built_in">sort</span>()</span><br><span class="line">arr</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨æ’åºä¸­ä½¿ç”¨å‡½æ•°å‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">biggerNumberFirst</span><span class="params">(<span class="number">_</span> a: Int, <span class="number">_</span> b: Int)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a &gt; b</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ’åºä½¿ç”¨æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„è§„åˆ™</span></span><br><span class="line">arr.<span class="built_in">sort</span>(by: biggerNumberFirst)</span><br><span class="line">arr</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">cmpByNumberString</span><span class="params">(<span class="number">_</span> a: Int, <span class="number">_</span> b: Int)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">String</span>(a) &lt; <span class="type">String</span>(b)</span><br><span class="line">&#125;</span><br><span class="line">arr.<span class="built_in">sort</span>(by: cmpByNumberString)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">near500</span><span class="params">(<span class="number">_</span> a: Int, <span class="number">_</span> b: Int)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span>(a - <span class="number">500</span>) &lt; <span class="built_in">abs</span>(b - <span class="number">500</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿”å›æ’åºç»“æœï¼Œæ’åºä¸ä¼šå½±å“arrçš„é¡ºåº</span></span><br><span class="line">arr.sorted(by: near500)</span><br><span class="line">arr</span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> å®šä¹‰å‡½æ•°ç±»å‹å‚æ•°<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">changeScores</span><span class="params">(<span class="number">_</span> scores: <span class="keyword">inout</span> [Int], by changeScore: <span class="params">(Int)</span></span></span>-&gt;<span class="type">Int</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (i, score) <span class="keyword">in</span> scores.enumerated() &#123;</span><br><span class="line">        <span class="comment">// ä¸éœ€è¦çŸ¥é“æ–¹æ³•çš„å…·ä½“å®šä¹‰</span></span><br><span class="line">        scores[i] = changeScore(score)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">change1</span><span class="params">(score: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Int</span>(sqrt(<span class="type">Double</span>(score)) * <span class="number">10</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">change2</span><span class="params">(score: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> score + <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> scores1 = [<span class="number">36</span>, <span class="number">61</span>, <span class="number">78</span>, <span class="number">89</span>, <span class="number">99</span>]</span><br><span class="line">changeScores(&amp;scores1, by: change1) <span class="comment">// [60, 78, 88, 94, 99]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> scores2 = [<span class="number">88</span>, <span class="number">101</span>, <span class="number">124</span>, <span class="number">137</span>, <span class="number">150</span>]</span><br><span class="line">changeScores(&amp;scores2, by: change2) <span class="comment">// [91, 104, 127, 140, 153]</span></span><br></pre></td></tr></table></div></figure></p><p><strong>4.</strong> é«˜é˜¶å‡½æ•°mapã€filterã€reduce<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">change</span><span class="params">(num: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> num + <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> numbers = [<span class="number">65</span>, <span class="number">91</span>, <span class="number">45</span>, <span class="number">89</span>, <span class="number">99</span>]</span><br><span class="line"><span class="comment">// map</span></span><br><span class="line">numbers.<span class="built_in">map</span>(change) <span class="comment">//[67, 93, 47, 91, 101]</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">isPassOrFail</span><span class="params">(num: Int)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> num &lt; <span class="number">60</span> ? <span class="string">"Fail"</span> : <span class="string">"Pass"</span></span><br><span class="line">&#125;</span><br><span class="line">numbers.<span class="built_in">map</span>(isPassOrFail) <span class="comment">//["Pass", "Pass", "Fail", "Pass", "Pass"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// filter</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fail</span><span class="params">(num: Int)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> num &lt; <span class="number">60</span></span><br><span class="line">&#125;</span><br><span class="line">numbers.<span class="built_in">filter</span>(fail) <span class="comment">//[45]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// reduce</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(num1: Int, num2: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> num1 + num2</span><br><span class="line">&#125;</span><br><span class="line">numbers.<span class="built_in">reduce</span>(<span class="number">0</span>, add) <span class="comment">//389</span></span><br><span class="line">numbers.<span class="built_in">reduce</span>(<span class="number">0</span>, +) <span class="comment">//389</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">concatenate</span><span class="params">(str: String, num: Int)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> str + <span class="type">String</span>(num) + <span class="string">" "</span></span><br><span class="line">&#125;</span><br><span class="line">numbers.<span class="built_in">reduce</span>(<span class="string">""</span>, concatenate) <span class="comment">//"65 91 45 89 99 "</span></span><br></pre></td></tr></table></div></figure></p><p><strong>5.</strong> å‡½æ•°ä½œä¸ºå‡½æ•°çš„è¿”å›ç±»å‹<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">tier1MailFee</span><span class="params">(weight: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> * weight</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">tier2MailFee</span><span class="params">(weight: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span> * weight</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">feeByUnitPrice</span><span class="params">(price: Int, weight: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="comment">// å‡½æ•°ä½œä¸ºå‡½æ•°çš„è¿”å›ç±»å‹</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">chooseMailFee</span><span class="params">(by weight: Int)</span></span> -&gt; (<span class="type">Int</span>) -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> weight &lt;= <span class="number">10</span> ? tier1MailFee : tier2MailFee</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> mailFeeByWeight = chooseMailFee(by: weight)</span><br><span class="line">    <span class="keyword">return</span> mailFeeByWeight(weight) + price * weight</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">feeByUnitPrice(price: <span class="number">50</span>, weight: <span class="number">8</span>)</span><br></pre></td></tr></table></div></figure></p><h2 id="é—­åŒ…">é—­åŒ…<a href="post/swift-study-note#é—­åŒ…"></a></h2><p><strong>1.</strong> åŸºæœ¬ä½¿ç”¨æ–¹å¼<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">8</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¹‹å‰çš„å†™æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">bigger</span><span class="params">(a: Int, b: Int)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a &gt; b</span><br><span class="line">&#125;</span><br><span class="line">arr.<span class="built_in">sort</span>(by: bigger) <span class="comment">// [8, 5, 4, 3, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é—­åŒ…çš„å†™æ³•</span></span><br><span class="line">arr.<span class="built_in">sort</span>(by: &#123; (a: <span class="type">Int</span>, b: <span class="type">Int</span>) -&gt; <span class="type">Bool</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> a &gt;  b</span><br><span class="line">&#125;) <span class="comment">// [8, 5, 4, 3, 2]</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> ä¸Šé¢çš„ä»£ç å¯ç®€å†™<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœé—­åŒ…åªæœ‰ä¸€è¡Œä»£ç ï¼Œå¯æ”¾åœ¨åŒä¸€è¡Œ</span></span><br><span class="line">arr.<span class="built_in">sort</span>(by: &#123; (a: <span class="type">Int</span>, b: <span class="type">Int</span>) -&gt; <span class="type">Bool</span> <span class="keyword">in</span> <span class="keyword">return</span> a &gt; b &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”±äºè‡ªåŠ¨ä¼šå¾—åˆ°å‚æ•°å’Œè¿”å›å€¼ç±»å‹ï¼Œ å¯è¿™æ ·å†™</span></span><br><span class="line">arr.<span class="built_in">sort</span>(by: &#123; a, b <span class="keyword">in</span> <span class="keyword">return</span> a &gt; b&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”±äºçŸ¥é“éœ€è¦returnï¼Œå¯ç®€å†™ä¸º</span></span><br><span class="line">arr.<span class="built_in">sort</span>(by: &#123; a, b <span class="keyword">in</span> a &gt; b&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”±äºå‚æ•°æ˜¯ä¸€ä¸ªå…ƒç»„ï¼Œå…ƒç»„æœ‰æ ‡è¯†ï¼Œå¯ç®€å†™ä¸º</span></span><br><span class="line">arr.<span class="built_in">sort</span>(by: &#123; $<span class="number">0</span> &gt; $<span class="number">1</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”±äºâ€œ&gt;â€æœ¬èº«å°±æ˜¯ä¸€ä¸ªå‡½æ•°</span></span><br><span class="line">arr.<span class="built_in">sort</span>(by: &gt;)</span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> ç»“å°¾é—­åŒ…çš„ä½¿ç”¨<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">arr.<span class="built_in">sort</span>(by: &#123; a, b <span class="keyword">in</span> <span class="keyword">return</span> a &gt; b &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœå‡½æ•°å‚æ•°åœ¨æœ€åï¼Œæˆ‘ä»¬å¯ä»¥æ˜¯ä½¿ç”¨ç»“å°¾é—­åŒ…</span></span><br><span class="line">arr.<span class="built_in">sort</span>() &#123; a, b <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> a &gt; b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœæ²¡æœ‰å…¶ä»–å‚æ•°ï¼Œå¯å°†å°æ‹¬å·å¤œçœç•¥äº†</span></span><br><span class="line">arr.<span class="built_in">sort</span> &#123; a, b <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> a &gt; b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†æ•°ç»„ä¸­çš„åè¿›åˆ¶æ•°å­—å…¨éƒ¨æ”¹ä¸ºäºŒè¿›åˆ¶</span></span><br><span class="line">arr.<span class="built_in">map</span>&#123; number -&gt; <span class="type">String</span> <span class="keyword">in</span></span><br><span class="line">    <span class="comment">// å°†numberçš„ä¸å¯å˜æ”¹ä¸ºå¯å˜</span></span><br><span class="line">    <span class="keyword">var</span> number = number</span><br><span class="line">    <span class="keyword">var</span> res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">repeat</span> &#123;</span><br><span class="line">        res = <span class="type">String</span>(number % <span class="number">2</span>) + res</span><br><span class="line">        number /= <span class="number">2</span></span><br><span class="line">    &#125; <span class="keyword">while</span> number != <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>4.</strong> å°¾é—­åŒ…åœ¨IOSåŠ¨ç”»ä¸­çš„è¿ç”¨<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> showView = <span class="type">UIView</span>(frame: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: <span class="number">300</span>, height: <span class="number">300</span>))</span><br><span class="line"><span class="keyword">let</span> rectangle = <span class="type">UIView</span>(frame: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: <span class="number">50</span>, height: <span class="number">50</span>))</span><br><span class="line">rectangle.center = showView.center</span><br><span class="line">rectangle.backgroundColor = <span class="type">UIColor</span>.red</span><br><span class="line">showView.addSubview(rectangle)</span><br><span class="line"></span><br><span class="line"><span class="type">UIView</span>.animate(withDuration: <span class="number">2.0</span>) &#123;</span><br><span class="line">    rectangle.backgroundColor = <span class="type">UIColor</span>.blue</span><br><span class="line">    rectangle.frame = showView.frame</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> PlaygroundSupport</span><br><span class="line"><span class="type">PlaygroundPage</span>.current.liveView = showView</span><br></pre></td></tr></table></div></figure></p><p><strong>5.</strong> é—­åŒ…ï¼Œå†…å®¹æ•è·<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ•°å€¼æ•è·</span></span><br><span class="line"><span class="comment">// ç”³æ˜å˜é‡</span></span><br><span class="line"><span class="keyword">var</span> num = <span class="number">300</span></span><br><span class="line">arr.<span class="built_in">sort</span>&#123; a , b <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">abs</span>(a-num) &lt; <span class="built_in">abs</span>(b-num)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>6.</strong> é—­åŒ…å’Œå‡½æ•°æ˜¯å¼•ç”¨ç±»å‹<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">runningMetersWithMetersPerDay</span><span class="params">(<span class="number">_</span> metersPerDay: Int)</span></span> -&gt; () -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> totalMeters = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        totalMeters += metersPerDay</span><br><span class="line">        <span class="keyword">return</span> totalMeters</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> planA = runningMetersWithMetersPerDay(<span class="number">2000</span>)</span><br><span class="line"><span class="comment">// æ³¨æ„æ¯æ¬¡éƒ½ä¸æ˜¯ä»0å¼€å§‹ç›¸åŠ ï¼Œå› ä¸ºè¿”å›çš„æ˜¯é—­åŒ…çš„å¼•ç”¨</span></span><br><span class="line">planA() <span class="comment">//2000</span></span><br><span class="line">planA() <span class="comment">//4000</span></span><br><span class="line">planA() <span class="comment">//6000</span></span><br></pre></td></tr></table></div></figure></p><h2 id="enum">enum<a href="post/swift-study-note#enum"></a></h2><p><strong>1.</strong> æšä¸¾çš„åŸºæœ¬ä½¿ç”¨<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰æšä¸¾ç±»å‹</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Month</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">January</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">February</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">March</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">April</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">May</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">June</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">July</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">August</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">September</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">October</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">November</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">December</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰æšä¸¾ä¹Ÿå¯ä»¥å†™æˆä¸€è¡Œ</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Season</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Spring</span>, <span class="type">Summer</span>, <span class="type">Autumn</span>, <span class="type">Winter</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœç¡®å®šäº†æšä¸¾ç±»å‹ï¼Œåˆ™å¯ä»¥çœç•¥æšä¸¾åå­—ï¼Œå¦‚ï¼šMonth.March å†™æˆ .March</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">season</span><span class="params">(month: Month)</span></span> -&gt; <span class="type">Season</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> month &#123;</span><br><span class="line">    <span class="keyword">case</span> .<span class="type">March</span>, .<span class="type">April</span>, .<span class="type">May</span>:</span><br><span class="line">        <span class="keyword">return</span> .<span class="type">Spring</span></span><br><span class="line">    <span class="keyword">case</span> .<span class="type">June</span>, .<span class="type">July</span>, .<span class="type">August</span>:</span><br><span class="line">        <span class="keyword">return</span> .<span class="type">Summer</span></span><br><span class="line">    <span class="keyword">case</span> .<span class="type">September</span>, .<span class="type">October</span>, .<span class="type">November</span>:</span><br><span class="line">        <span class="keyword">return</span> .<span class="type">Autumn</span></span><br><span class="line">    <span class="keyword">case</span> .<span class="type">December</span>, .<span class="type">January</span>, .<span class="type">February</span>:</span><br><span class="line">        <span class="keyword">return</span> .<span class="type">Spring</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">season(month: <span class="type">Month</span>.<span class="type">April</span>) <span class="comment">//Spring</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> æšä¸¾çš„åŸå§‹å€¼<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// enum Month: Int è¡¨åMonthçš„åŸå§‹å€¼æ˜¯intç±»å‹çš„ï¼Œå¹¶ä¸”åŸå§‹å€¼ä¼šè‡ªåŠ¨é€’å¢</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Month</span>: <span class="title">Int</span></span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">January</span> = <span class="number">1</span>, <span class="type">Febuary</span>, <span class="type">March</span>, <span class="type">April</span>, <span class="type">May</span>, <span class="type">June</span>, <span class="type">July</span>, <span class="type">August</span>, <span class="type">September</span>, <span class="type">October</span>, <span class="type">November</span>, <span class="type">December</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›è·ç¦»æ–°çš„ä¸€å¹´è¿˜æœ‰å¤šå°‘ä¸ªæœˆï¼ŒrawValueå¾—åˆ°åŸå§‹å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">monthBeforeNewYear</span><span class="params">(month: Month)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">12</span> - month.rawValue</span><br><span class="line">&#125; <span class="comment">// 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯ä»¥é€šè¿‡åŸå§‹å€¼è·å–åˆ°å¯¹åº”çš„æšä¸¾å€¼</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> theMonth = <span class="type">Month</span>(rawValue: <span class="number">8</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(monthBeforeNewYear(month: theMonth)) months before New Year!"</span>) <span class="comment">//4 months before New Year!</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// raw valueä¸ºæ•´å‹çš„æšä¸¾ç±»å‹ï¼Œå¦‚æœä¸æ˜¾ç¤ºç»™å‡ºæ•´å‹å€¼ï¼Œåˆ™ä»0å¼€å§‹</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Grade</span>: <span class="title">Int</span></span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">F</span>,<span class="type">E</span>,<span class="type">D</span>,<span class="type">C</span>,<span class="type">B</span>,<span class="type">A</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æšä¸¾ç±»å‹çš„raw valueå€¼ä¸ä¸€å®šæ˜¯é¡ºåºçš„</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Coin</span>: <span class="title">Int</span></span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Penny</span> = <span class="number">1</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">Nickel</span> = <span class="number">5</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">Dime</span> = <span class="number">10</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">Quarter</span> = <span class="number">25</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> coin: <span class="type">Coin</span> = .<span class="type">Quarter</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"It's \(coin.rawValue) cents"</span>) <span class="comment">//It's 25 cents</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨Stringä½œä¸ºraw valueï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰ç¡®å®šåŸå§‹å€¼ï¼Œé‚£ä¹ˆswiftä¼šè‡ªåŠ¨ä»¥æšä¸¾å€¼çš„åå­—ä½œä¸ºåŸå§‹å€¼</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">ProgrammingLanguage2</span>: <span class="title">String</span></span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Swift</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">ObjectiveC</span> = <span class="string">"Objective-C"</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">C</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">Java</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> myFavoriteLanguage2: <span class="type">ProgrammingLanguage2</span> = .<span class="type">Swift</span></span><br><span class="line"><span class="built_in">print</span>( <span class="string">"\(myFavoriteLanguage2.rawValue) is my favorite language."</span>) <span class="comment">//Swift is my favorite language.</span></span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> å¹¶è”å€¼<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// Associate Value å’Œ Raw value åªèƒ½å­˜åœ¨ä¸€ä¸ª</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">ATMStatus</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Success</span>(<span class="type">Int</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Error</span>(<span class="type">String</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Waiting</span> <span class="comment">// ä¹Ÿå¯ä»¥æ²¡æœ‰Associate Value</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½™é¢</span></span><br><span class="line"><span class="keyword">var</span> balance = <span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–ATMStatus</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">withdraw</span><span class="params">(amount: Int)</span></span> -&gt; <span class="type">ATMStatus</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> balance &gt;= amount &#123;</span><br><span class="line">        balance -= amount</span><br><span class="line">        <span class="keyword">return</span> .<span class="type">Success</span>(balance)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> .<span class="type">Error</span>(<span class="string">"Not enough money"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£åŒ…ç›¸åº”çš„ Associate Valueï¼Œä¹Ÿå¯å¿½ç•¥ï¼Œå°±åƒ.Waitingé‚£æ ·å°±è¡Œäº†</span></span><br><span class="line"><span class="keyword">switch</span> withdraw(amount: <span class="number">100</span>) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Success</span>(newBlance):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(newBlance) Yuan left in your account"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Error</span>(errorMesssage):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Error:\(errorMesssage)"</span>)</span><br><span class="line"><span class="keyword">case</span> .<span class="type">Waiting</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Waiting for processing"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>4.</strong> æœ‰å¤šä¸ªå¹¶è”å€¼çš„æƒ…å†µ<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Associate valueå…¶å®åªæœ‰ä¸€ä¸ªï¼Œå…¶å®ä¸‹é¢è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªå…ƒç»„ï¼Œå¹¶ä¸”ä¸ºå…ƒç»„ç±»å‹å–äº†ä¸ªåå­—</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Square</span>(side: <span class="type">Double</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Rectangle</span>(width: <span class="type">Double</span>, height: <span class="type">Double</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Circle</span>(centerx: <span class="type">Double</span>, centery: <span class="type">Double</span>, radius: <span class="type">Double</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Point</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–ä¸€äº›å›¾å½¢</span></span><br><span class="line"><span class="keyword">let</span> square = <span class="type">Shape</span>.<span class="type">Square</span>(side: <span class="number">10</span>)</span><br><span class="line"><span class="keyword">let</span> rectangle = <span class="type">Shape</span>.<span class="type">Rectangle</span>(width: <span class="number">20</span>, height: <span class="number">30</span>)</span><br><span class="line"><span class="keyword">let</span> circle = <span class="type">Shape</span>.<span class="type">Circle</span>(centerx: <span class="number">0</span>, centery: <span class="number">0</span>, radius: <span class="number">15</span>)</span><br><span class="line"><span class="keyword">let</span> point = <span class="type">Shape</span>.<span class="type">Point</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¡ç®—è¡¨é¢ç§¯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">area</span><span class="params">(shape: Shape)</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> shape &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Square</span>(side):</span><br><span class="line">        <span class="keyword">return</span> side * side</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Rectangle</span>(width, height):</span><br><span class="line">        <span class="keyword">return</span> width * height</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Circle</span>(<span class="number">_</span>, <span class="number">_</span>, r): <span class="comment">// é€šè¿‡ä¸‹åˆ’çº¿å¿½ç•¥ä¸ç”¨çš„å‚æ•°</span></span><br><span class="line">        <span class="keyword">return</span> .pi * r * r</span><br><span class="line">    <span class="keyword">case</span> .<span class="type">Point</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¾—å‡ºè¡¨é¢ç§¯çš„ç»“æœ</span></span><br><span class="line">area(shape: square)</span><br><span class="line">area(shape: rectangle)</span><br><span class="line">area(shape: circle)</span><br><span class="line">area(shape: point)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ====================================================================</span></span><br><span class="line"><span class="comment">// enumå¯ä»¥æœ‰æ–¹æ³•</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Shape</span></span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Square</span>(side: <span class="type">Double</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Rectangle</span>(width: <span class="type">Double</span>, height: <span class="type">Double</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Circle</span>(centerx: <span class="type">Double</span>, centery: <span class="type">Double</span>, radius: <span class="type">Double</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Point</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">area</span><span class="params">()</span></span> -&gt; <span class="type">Double</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Square</span>(side):</span><br><span class="line">            <span class="keyword">return</span> side*side</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Rectangle</span>( width , height ):</span><br><span class="line">            <span class="keyword">return</span> width * height</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Circle</span>( <span class="number">_</span> , <span class="number">_</span> , r ):</span><br><span class="line">            <span class="comment">//swift 2: return M_PI*r*r</span></span><br><span class="line">            <span class="comment">//swift3ä¸­PIæ”¾åœ¨äº†Doubleç±»ä¸‹ã€‚è¿™æ ·æ˜¯ä¸æ˜¯æ›´æ–¹ä¾¿è®°å¿†ï¼Ÿ</span></span><br><span class="line">            <span class="keyword">return</span> .pi*r*r      <span class="comment">//swift 3</span></span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Point</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">let</span> square = <span class="type">Shape</span>.<span class="type">Square</span>(side: <span class="number">10</span>)</span><br><span class="line">square.area()</span><br></pre></td></tr></table></div></figure></p><p><strong>5.</strong> å¯é€‰å‹å®é™…ä¸Šæ˜¯æšä¸¾ç±»å‹<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> age: <span class="type">Int</span>? = <span class="number">17</span></span><br><span class="line"><span class="built_in">print</span>(age!)</span><br><span class="line">age = <span class="literal">nil</span></span><br><span class="line"><span class="comment">// å¯ä»¥çœ‹åˆ°å¯é€‰ç±»å‹å¯ä»¥é€šè¿‡æšä¸¾çš„æ–¹å¼èµ‹å€¼</span></span><br><span class="line">age = .some(<span class="number">2</span>) <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> website: <span class="type">Optional</span>&lt;<span class="type">String</span>&gt; = <span class="type">Optional</span>.some(<span class="string">"blog.xujiaji.com"</span>)</span><br><span class="line">website = .<span class="keyword">none</span> <span class="comment">// nil</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»¥enumçš„è§’åº¦æ¥è¿›è¡Œè§£åŒ…</span></span><br><span class="line"><span class="keyword">switch</span> website &#123;</span><br><span class="line"><span class="keyword">case</span> .<span class="keyword">none</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"No website"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .some(website):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"The website is \(website)"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»¥Optionalçš„æ–¹å¼è§£åŒ…</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> website = website &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"The website is \(website)"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"No website"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>6.</strong> æšä¸¾çš„é€’å½’è°ƒç”¨<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æšä¸¾é€’å½’ï¼Œä½¿ç”¨indirectå…³é”®å­—ã€‚ä¹Ÿå¯ä»¥ç›´æ¥åŠ åœ¨enumå…³é”®å­—åé¢ï¼ˆå¦‚ï¼šenum indirect ArithmeticExpressionï¼‰ï¼Œæ­¤æ—¶caseå…³é”®å­—å‰é¢å°±ä¸å¿…åŠ äº†</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">ArithmeticExpression</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Number</span>(<span class="type">Int</span>)</span><br><span class="line">    <span class="keyword">indirect</span> <span class="keyword">case</span> <span class="type">Addition</span>(<span class="type">ArithmeticExpression</span>, <span class="type">ArithmeticExpression</span>)</span><br><span class="line">    <span class="keyword">indirect</span> <span class="keyword">case</span> <span class="type">Multiplication</span>(<span class="type">ArithmeticExpression</span>, <span class="type">ArithmeticExpression</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¡ç®— (5 + 4) * 2</span></span><br><span class="line"><span class="keyword">let</span> five = <span class="type">ArithmeticExpression</span>.<span class="type">Number</span>(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">let</span> four = <span class="type">ArithmeticExpression</span>.<span class="type">Number</span>(<span class="number">4</span>)</span><br><span class="line"><span class="keyword">let</span> sum = <span class="type">ArithmeticExpression</span>.<span class="type">Addition</span>(five, four)</span><br><span class="line"><span class="keyword">let</span> two = <span class="type">ArithmeticExpression</span>.<span class="type">Number</span>(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">let</span> prouct = <span class="type">ArithmeticExpression</span>.<span class="type">Multiplication</span>(sum, two)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">evaluate</span><span class="params">(<span class="number">_</span> expression: ArithmeticExpression)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> expression &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Number</span>(value):</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Addition</span>(<span class="keyword">left</span>, <span class="keyword">right</span>):</span><br><span class="line">        <span class="keyword">return</span> evaluate(<span class="keyword">left</span>) + evaluate(<span class="keyword">right</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Multiplication</span>(<span class="keyword">left</span>, <span class="keyword">right</span>):</span><br><span class="line">        <span class="keyword">return</span> evaluate(<span class="keyword">left</span>) * evaluate(<span class="keyword">right</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¡ç®—ç»“æœ</span></span><br><span class="line">evaluate(prouct)</span><br></pre></td></tr></table></div></figure></p><p><strong>7.</strong> æšä¸¾æ˜¯å€¼ç±»å‹</p><h2 id="struct">struct<a href="post/swift-study-note#struct"></a></h2><p><strong>1.</strong> ç»“æ„ä½“çš„åŸºæœ¬ä½¿ç”¨<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªç»“æ„ä½“</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Location</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> latitude: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">let</span> longitude: <span class="type">Double</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–ç»“æ„ä½“</span></span><br><span class="line"><span class="keyword">let</span> appleHeadQuarterLocation = <span class="type">Location</span>(latitude: <span class="number">37.3230</span>, longitude: -<span class="number">122.0322</span>)</span><br><span class="line"><span class="keyword">let</span> googleHeadQuarterLocation: <span class="type">Location</span> = <span class="type">Location</span>(latitude: <span class="number">37.4220</span>, longitude: -<span class="number">122.0841</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–å±æ€§å€¼</span></span><br><span class="line">appleHeadQuarterLocation.latitude</span><br><span class="line">googleHeadQuarterLocation.longitude</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»“æ„ä½“ä¸­æœ‰ç»“æ„ä½“</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Place</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> location: <span class="type">Location</span></span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> googleHeadQuarter = <span class="type">Place</span>(location: googleHeadQuarterLocation, name: <span class="string">"Google"</span>)</span><br><span class="line"><span class="comment">// å› ä¸ºå£°æ˜çš„æ˜¯varï¼Œæ‰€ä»¥å¯ä¿®æ”¹</span></span><br><span class="line">googleHeadQuarter.name = <span class="string">"G"</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> ç»“æ„ä½“çš„åˆå§‹åŒ–<br>ç»“æ„ä½“é‡å®šä¹‰çš„å¸¸é‡æˆ–å˜é‡éƒ½å¿…é¡»åˆå§‹åŒ–ã€‚å¯é€‰å‹å¯ä»¥ä¸ç”¨åˆå§‹åŒ–ï¼Œå› ä¸ºé»˜è®¤åˆå§‹å€¼ä¸º<code>nil</code>ï¼Œè¯•äº†ä¸‹å¯é€‰å‹éœ€è¦æ˜¯varï¼Œå¦‚æœæ˜¯letï¼Œåˆ™å¿…é¡»ç›´æ¥èµ‹å€¼ã€‚<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Location</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> latitude: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">let</span> longitude: <span class="type">Double</span></span><br><span class="line">    <span class="comment">// è‡ªå®šä¹‰æ„é€ ï¼Œ å½“è‡ªå·±å†™äº†æ„é€ å‡½æ•°åå°±æ²¡æœ‰äº†é»˜è®¤çš„æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="keyword">init</span>(coordinateString: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> commaIndex = coordinateString.range(of: <span class="string">","</span>)!.lowerBound <span class="comment">//å¾—åˆ°é€—å·çš„ä¸‹æ ‡</span></span><br><span class="line">        <span class="keyword">let</span> firstElement = coordinateString[..&lt;commaIndex]</span><br><span class="line">        <span class="keyword">let</span> secondElement = coordinateString[coordinateString.index(after: commaIndex)...]</span><br><span class="line">        latitude = <span class="type">Double</span>(firstElement)!</span><br><span class="line">        longitude = <span class="type">Double</span>(secondElement)!</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å½“æ²¡æœ‰é»˜è®¤çš„æ„é€ çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±æ·»åŠ è¿™ä¸ªæ„é€ </span></span><br><span class="line">    <span class="keyword">init</span>(latitude: <span class="type">Double</span>, longitude: <span class="type">Double</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.latitude = latitude</span><br><span class="line">        <span class="keyword">self</span>.longitude = longitude</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        latitude = <span class="number">0.0</span></span><br><span class="line">        longitude = <span class="number">0.0</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é»˜è®¤åˆå§‹å€¼ä¸ºnil</span></span><br><span class="line">    <span class="keyword">var</span> placeName: <span class="type">String</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(latitude: <span class="type">Double</span>, longitude: <span class="type">Double</span>, placeName: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.latitude = latitude</span><br><span class="line">        <span class="keyword">self</span>.longitude = longitude</span><br><span class="line">        <span class="keyword">self</span>.placeName = placeName</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> location = <span class="type">Location</span>(coordinateString: <span class="string">"111.1234,222.3333"</span>)</span><br><span class="line">location.latitude <span class="comment">// 111.1234</span></span><br><span class="line">location.placeName <span class="comment">// nil</span></span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> å¤±è´¥çš„æ„é€ å‡½æ•°</p><ul><li>å°±æ˜¯è¯´æ„é€ å‡½æ•°å¯ä»¥æ˜¯å¤±è´¥çš„ï¼Œå½“æˆ‘ä»¬<code>return nil</code>æ—¶å€™ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åˆå§‹åŒ–ç»“æ„ä½“çš„æ—¶å€™å¾—åˆ°çš„æ˜¯å¯é€‰å‹</li><li>ç”¨guardå¯ä»¥è½»æ¾ç®€åŒ–if elseåµŒå¥—çš„åˆ¤æ–­ä»£ç </li></ul><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Location</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> latitude: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">let</span> longitude: <span class="type">Double</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>?(coordinateString: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> commaIndex = coordinateString.range(of: <span class="string">","</span>)?.lowerBound <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> firstElement = <span class="type">Double</span>(coordinateString[..&lt;commaIndex]) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> secondElement = <span class="type">Double</span>(coordinateString[coordinateString.index(after: commaIndex)...]) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        latitude = firstElement</span><br><span class="line">        longitude = secondElement</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><ul><li>guardè¿˜å¯ä»¥å°†ä¸Šé¢çš„ä»£ç ä¼˜åŒ–</li></ul><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Location</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> latitude: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">let</span> longitude: <span class="type">Double</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>?(coordinateString: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">guard</span></span><br><span class="line">            <span class="keyword">let</span> commaIndex = coordinateString.range(of: <span class="string">","</span>)?.lowerBound,</span><br><span class="line">            <span class="keyword">let</span> firstElement = <span class="type">Double</span>(coordinateString[..&lt;commaIndex]),</span><br><span class="line">            <span class="keyword">let</span> secondElement = <span class="type">Double</span>(coordinateString[coordinateString.index(after: commaIndex)...])</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">        latitude = firstElement</span><br><span class="line">        longitude = secondElement</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p><strong>4.</strong> ç»“æ„ä½“ä¸­å¯å®šä¹‰æ–¹æ³•ï¼Œ è¿™é‡Œç›´æ¥åœ¨ä¸Šé¢ä»£ç ä¸­æ·»åŠ æ–¹æ³•<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Location</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printLocation</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"The Location is \(self.latitude), \(self.longitude)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">isNorth</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.latitude &gt; <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">isSouth</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> !<span class="keyword">self</span>.isNorth()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">distanceTo</span><span class="params">(location: Location)</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sqrt(pow(<span class="keyword">self</span>.latitude - location.latitude, <span class="number">2</span>) + pow(<span class="keyword">self</span>.longitude - location.longitude, <span class="number">2</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>5.</strong> ç»“æ„ä½“æ˜¯å€¼ç±»å‹çš„ï¼Œå°±æ˜¯å½“åšå€¼æ¥å‡ºæ¥ï¼Œèµ‹å€¼å³æ˜¯æ‹·è´<br><strong>6.</strong> Int, Float, Double, Bool, String, Array, Dictionary, Set ç­‰éƒ½æ˜¯ç»“æ„ä½“</p><h2 id="class">class<a href="post/swift-study-note#class"></a></h2><p><strong>1.</strong> ç±»çš„åŸºæœ¬ä½¿ç”¨æ–¹å¼<br>ç±»ä¸åƒç»“æ„ä½“ä¸€æ ·ï¼Œç±»ä¸èƒ½è‡ªåŠ¨åˆå§‹åŒ–ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è‡ªå·±ä¸ºå˜é‡èµ‹å€¼<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> firstName: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> lastName: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(firstName: <span class="type">String</span>, lastName: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.firstName = firstName</span><br><span class="line">        <span class="keyword">self</span>.lastName = lastName</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç±»å’Œç»“æ„ä½“ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥å®šä¹‰å¯ä»¥å¤±è´¥çš„æ„é€ </span></span><br><span class="line">    <span class="keyword">init</span>?(fullName: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> spaceIndex = fullName.range(of: <span class="string">" "</span>)?.lowerBound <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">        firstName = <span class="type">String</span>(fullName[..&lt;spaceIndex])</span><br><span class="line">        lastName = <span class="type">String</span>(fullName[fullName.index(after: spaceIndex)...])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fullName</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"\(self.firstName) \(self.lastName)"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person1 = <span class="type">Person</span>(firstName: <span class="string">"Alexander"</span>, lastName: <span class="string">"Hamilton"</span>)</span><br><span class="line">person1.fullName() <span class="comment">// "Alexander Hamilton"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person2 = <span class="type">Person</span>(fullName: <span class="string">"Jiaji Xu"</span>)</span><br><span class="line">person2?.firstName <span class="comment">//"Jiaji"</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> ç±»æ˜¯å¼•ç”¨ç±»å‹<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person1 = <span class="type">Person</span>(name: <span class="string">"Tom"</span>)</span><br><span class="line">person1.name <span class="comment">// Tom</span></span><br><span class="line"><span class="keyword">let</span> person2 = person1</span><br><span class="line">person2.name = <span class="string">"Bob"</span></span><br><span class="line">person2.name <span class="comment">// Bob</span></span><br><span class="line">person1.name <span class="comment">// Bob</span></span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> æ–¹æ³•çš„å¯å˜å’Œä¸å¯å˜</p><ul><li>ç±»çš„æ–¹æ³•ä¸­å¯æ”¹å˜å˜é‡çš„å€¼</li></ul><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> career: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>, career: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">        <span class="keyword">self</span>.career = career</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">change</span><span class="params">(career: String)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.career = career</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> person = <span class="type">Person</span>(name: <span class="string">"Bob"</span>, career: <span class="string">"Developer"</span>)</span><br><span class="line">person.change(career: <span class="string">"Teacher"</span>)</span><br></pre></td></tr></table></div></figure><ul><li>ç»“æ„ä½“ç”±äºæ˜¯å€¼ä¼ é€’ï¼Œæ‰€ä»¥ä¸å¯æ”¹å˜å˜é‡çš„å€¼ï¼Œåƒä¸Šé¢å†™ä¼šæŠ¥é”™ï¼Œæç¤ºimmutableï¼ˆä¸å¯å˜ï¼‰ã€‚ä½†æ˜¯å¯ä»¥ä¸ºæ–¹æ³•åŠ ä¸Šå…³é”®å­—<code>mutating</code>ï¼Œæ¯æ¬¡æ”¹å˜éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å‰¯æœ¬è¦†ç›–æ—§çš„å€¼</li></ul><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Switch</span></span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">On</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">Off</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">click</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="keyword">self</span>&#123;</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">On</span>:</span><br><span class="line">            <span class="keyword">self</span> = .<span class="type">Off</span></span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Off</span>:</span><br><span class="line">            <span class="keyword">self</span> = .<span class="type">On</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> button = <span class="type">Switch</span>.<span class="type">Off</span></span><br><span class="line">button.click()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> button2 = <span class="type">Switch</span>.<span class="type">On</span></span><br><span class="line"></span><br><span class="line">button == button2</span><br></pre></td></tr></table></div></figure><p><strong>4.</strong> ç±»ä¸ç±»ä¹‹é—´çš„ç­‰ä»·ï¼Œæ¯”è¾ƒä¸¤ä¸ªå˜é‡æ˜¯å¦æŒ‡å‘çš„åŒä¸€ä¸ªä¸œè¥¿<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person1 = <span class="type">Person</span>(name: <span class="string">"Bob"</span>)</span><br><span class="line"><span class="keyword">let</span> person2 = person1</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸èƒ½ä½¿ç”¨â€œ==â€åˆ¤æ–­ï¼š</span></span><br><span class="line"><span class="comment">// person1 == person2</span></span><br><span class="line">person1 === person2 <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person3 = <span class="type">Person</span>(name: <span class="string">"Bob"</span>)</span><br><span class="line">person1 === person3 <span class="comment">// false</span></span><br><span class="line">person1 !== person3 <span class="comment">// true</span></span><br></pre></td></tr></table></div></figure></p><p><strong>5.</strong> ä»€ä¹ˆæ—¶å€™ç”¨ç±»ä»€ä¹ˆæ—¶å€™ç”¨ç»“æ„ä½“</p><ul><li>æŠŠç»“æ„ä½“çœ‹ä½œæ˜¯å€¼<ul><li>ä½ç½® ï¼ˆç»çº¬åº¦ï¼‰</li><li>åæ ‡ ï¼ˆäºŒç»´ï¼Œä¸‰ç»´åæ ‡ï¼‰</li><li>æ¸©åº¦</li><li>â€¦</li></ul></li><li>æŠŠç±»çœ‹ä½œæ˜¯ç‰©ä½“<ul><li>äºº</li><li>è½¦</li><li>åŠ¨ç‰©</li><li>â€¦</li></ul></li><li>å¦‚æœä¸å¸Œæœ›æ¯æ¬¡ä¼ é€’éƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„å‰¯æœ¬ï¼Œé‚£ä¹ˆå°±ç”¨ç±»ï¼Œå¦åˆ™ç”¨ç»“æ„ä½“</li><li>ç±»å¯ä»¥è¢«ç»§æ‰¿</li><li>ç»“æ„ä½“æ¯”ç±»æ›´åŠ â€œè½»é‡çº§â€</li></ul><h2 id="å±æ€§å’Œæ–¹æ³•">å±æ€§å’Œæ–¹æ³•<a href="post/swift-study-note#å±æ€§å’Œæ–¹æ³•"></a></h2><p><strong>1.</strong> è®¡ç®—å‹å±æ€§ï¼šè‡ªåŠ¨æ›´å…·å…¶ä»–ä¿¡æ¯è®¡ç®—å‡ºå€¼<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">var</span> y = <span class="number">0.0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Size</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> width = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">var</span> height = <span class="number">0.0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> origin: <span class="type">Point</span></span><br><span class="line">    <span class="keyword">var</span> size: <span class="type">Size</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(origin: <span class="type">Point</span>, size: <span class="type">Size</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.origin = origin</span><br><span class="line">        <span class="keyword">self</span>.size = size</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å†™æ³•ä¸€</span></span><br><span class="line"><span class="comment">//    var center: Point &#123;</span></span><br><span class="line"><span class="comment">//        let centerX = origin.x + size.width / 2</span></span><br><span class="line"><span class="comment">//        let centerY = origin.y + size.height / 2</span></span><br><span class="line"><span class="comment">//        return Point(x: centerX, y: centerY)</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å†™æ³•äºŒ</span></span><br><span class="line"><span class="comment">//    var center: Point &#123;</span></span><br><span class="line"><span class="comment">//        get &#123;</span></span><br><span class="line"><span class="comment">//            let centerX = origin.x + size.width / 2</span></span><br><span class="line"><span class="comment">//            let centerY = origin.y + size.height / 2</span></span><br><span class="line"><span class="comment">//            return Point(x: centerX, y: centerY)</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å†™æ³•ä¸‰ï¼šä¸Šé¢çš„å†™æ³•æ˜¯åªè¯»çš„ï¼Œæ— æ³•ä¸ºcenterèµ‹å€¼ã€‚å¦‚æœè¦èµ‹å€¼ï¼Œåˆ™éœ€è¦äº›setter</span></span><br><span class="line">    <span class="keyword">var</span> center: <span class="type">Point</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">get</span>&#123;</span><br><span class="line">            <span class="keyword">let</span> centerX = origin.x + size.width/<span class="number">2</span></span><br><span class="line">            <span class="keyword">let</span> centerY = origin.y + size.height/<span class="number">2</span></span><br><span class="line">            <span class="keyword">return</span> <span class="type">Point</span>(x: centerX, y: centerY)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// (newCenter)å¯ä»¥è¢«çœç•¥</span></span><br><span class="line">        <span class="comment">// åœ¨setterçš„&#123;&#125;ä¸­ç”¨é»˜è®¤åç§°newValueä»£æ›¿ä¼ å…¥å€¼</span></span><br><span class="line">        <span class="keyword">set</span>(newCenter)&#123;</span><br><span class="line">            origin.x = newCenter.x - size.width/<span class="number">2</span></span><br><span class="line">            origin.y = newCenter.y - size.height/<span class="number">2</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> rect = <span class="type">Rectangle</span>(origin: <span class="type">Point</span>(), size: <span class="type">Size</span>(width: <span class="number">10</span>, height: <span class="number">5</span>))</span><br><span class="line">rect.center</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†™æ³•ä¸‰å¯ä¸ºcenterèµ‹å€¼ï¼Œå¹¶ä¸”ä¼šè‡ªåŠ¨æ”¹å˜åæ ‡</span></span><br><span class="line">rect.center = <span class="type">Point</span>(x: <span class="number">10</span>, y: <span class="number">10</span>)</span><br><span class="line">rect</span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> ç±»å‹å±æ€§ï¼ˆType Propertyï¼‰ï¼Œé™æ€å˜é‡<br>å°±å’Œjavaä¸­çš„é™æ€å˜é‡å·®ä¸å¤šï¼Œå†™æ³•ä¹Ÿä¸€æ ·ï¼Œä¸è¿‡å¿…é¡»é€šè¿‡ç±»å‹åè·å–<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Player</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰ç±»å‹å±æ€§ï¼Œä¸èƒ½é€šè¿‡self.æ¥å¼•ç”¨ï¼Œç±»ä¸­ä¹Ÿä¸å¯ç›´æ¥å¼•ç”¨</span></span><br><span class="line">    <span class="comment">// ä¸è®ºåˆ›å»ºå¤šå°‘ä¸ªå®ä¾‹ï¼Œéƒ½åªå­˜åœ¨ä¸€ä¸ªè¯¥å˜é‡</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> highestScore = <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> ç±»å‹æ–¹æ³•ï¼ˆType Methodï¼‰ï¼Œé™æ€æ–¹æ³•ï¼Œè¿™é‡Œä¸¾äº†ä¸€ä¸ªåˆ›å»ºå•ä½çŸ©é˜µçš„ç±»å‹æ–¹æ³•<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> m: [[<span class="type">Int</span>]]</span><br><span class="line">    <span class="keyword">var</span> row: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> col: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>?(<span class="number">_</span> arr2d: [[<span class="type">Int</span>]]) &#123;</span><br><span class="line">        <span class="keyword">guard</span> arr2d.<span class="built_in">count</span> &gt; <span class="number">0</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> row = arr2d.<span class="built_in">count</span></span><br><span class="line">        <span class="keyword">let</span> col = arr2d[<span class="number">0</span>].<span class="built_in">count</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>..&lt;row &#123;</span><br><span class="line">            <span class="keyword">if</span> arr2d[i].<span class="built_in">count</span> != row &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.m = arr2d</span><br><span class="line">        <span class="keyword">self</span>.row = row</span><br><span class="line">        <span class="keyword">self</span>.col = col</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">identityMatrix</span><span class="params">(n: Int)</span></span> -&gt; <span class="type">Matrix</span>? &#123;</span><br><span class="line">        <span class="keyword">if</span> n &lt; <span class="number">0</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> arr2d: [[<span class="type">Int</span>]] = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;n &#123;</span><br><span class="line">            <span class="keyword">var</span> row = [<span class="type">Int</span>](repeating: <span class="number">0</span>, <span class="built_in">count</span>: n)</span><br><span class="line">            row[i] = <span class="number">1</span></span><br><span class="line">            arr2d.append(row)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Matrix</span>(arr2d)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printMatrix</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;row &#123;</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="number">0</span>..&lt;col &#123;</span><br><span class="line">                <span class="built_in">print</span>(m[i][j], terminator: <span class="string">"\t"</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">print</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> m = <span class="type">Matrix</span>([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line">m?.printMatrix()</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´æ¥é€šè¿‡ç±»å‹åç›´æ¥è°ƒç”¨</span></span><br><span class="line"><span class="keyword">let</span> e = <span class="type">Matrix</span>.identityMatrix(n: <span class="number">6</span>)</span><br><span class="line">e?.printMatrix()</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¾“å‡º</span></span><br><span class="line"><span class="comment">//1    2</span></span><br><span class="line"><span class="comment">//3    4</span></span><br><span class="line"><span class="comment">//1    0    0    0    0    0</span></span><br><span class="line"><span class="comment">//0    1    0    0    0    0</span></span><br><span class="line"><span class="comment">//0    0    1    0    0    0</span></span><br><span class="line"><span class="comment">//0    0    0    1    0    0</span></span><br><span class="line"><span class="comment">//0    0    0    0    1    0</span></span><br><span class="line"><span class="comment">//0    0    0    0    0    1</span></span><br></pre></td></tr></table></div></figure></p><p><strong>4.</strong> å±æ€§è§‚å¯Ÿå™¨</p><ul><li>æ³¨æ„willSetå’ŒdidSetä¸ä¼šåœ¨å˜é‡ç›´æ¥åˆå§‹åŒ–å’Œæ„é€ æ–¹æ³•ä¸­è¢«è°ƒç”¨</li><li>ä¸€ä¸ªç”µç¯çš„æ¡ˆä¾‹</li></ul><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">class LightBulb &#123;</span><br><span class="line">    static let maxCurrent = 30</span><br><span class="line">    var current = 0 &#123;</span><br><span class="line">        // å¯ä»¥ä¸å£°æ˜å˜é‡ånewCurrentï¼Œå¯ç›´æ¥ä½¿ç”¨newValue</span><br><span class="line">        // å¦‚å…¶åï¼Œæ­¤æ—¶æ˜¯åœ¨è®¾ç½®æ–°å€¼ä¹‹å‰è¢«è°ƒç”¨</span><br><span class="line">        willSet(newCurrent) &#123;</span><br><span class="line">            // æ­¤æ—¶ï¼Œ currentè¿˜æ˜¯ä»¥å‰çš„å€¼</span><br><span class="line">            print(&quot;|\(current)-\(newCurrent)| = \(abs(current - newCurrent))&quot;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Property observer å¯ä»¥ç”¨æ¥é™åˆ¶å€¼æˆ–æ ¼å¼</span><br><span class="line">        // ä¹Ÿå¯ä»¥ç”¨æ¥å¹¶è”é€»è¾‘</span><br><span class="line">        // å¯ä»¥ä¸å£°æ˜å˜é‡oldCurrentï¼Œå¯ç›´æ¥ä½¿ç”¨oldValueè·å–åŸæ¥çš„å€¼</span><br><span class="line">        // å¦‚å…¶åï¼Œæ­¤æ—¶æ˜¯å·²ç»è®¾ç½®å¥½æ–°çš„å€¼åè¢«è°ƒç”¨</span><br><span class="line">        didSet(oldCurrent) &#123;</span><br><span class="line">            if current == LightBulb.maxCurrent &#123;</span><br><span class="line">                print(&quot;Pay attention, the current value get to the maxinum point.&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">            else if current &gt; LightBulb.maxCurrent&#123;</span><br><span class="line">                print(&quot;Current too high, falling back to previous setting.&quot;)</span><br><span class="line">                current = oldCurrent</span><br><span class="line">            &#125;</span><br><span class="line">            print(&quot;The current is \(current)&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let bulb = LightBulb()</span><br><span class="line">bulb.current = 20</span><br><span class="line">bulb.current = 30</span><br><span class="line">bulb.current = 40</span><br><span class="line"></span><br><span class="line">//ç»“æœ</span><br><span class="line">//|0-20| = 20</span><br><span class="line">//The current is 20</span><br><span class="line">//|20-30| = 10</span><br><span class="line">//Pay attention, the current value get to the maxinum point.</span><br><span class="line">//The current is 30</span><br><span class="line">//|30-40| = 10</span><br><span class="line">//Current too high, falling back to previous setting.</span><br><span class="line">//The current is 30</span><br></pre></td></tr></table></div></figure><ul><li>ä¸€ä¸ªä¸»é¢˜åˆ‡æ¢çš„æ¡ˆä¾‹</li></ul><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Theme</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">DayMode</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">NightMode</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UI</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> fontColor: <span class="type">UIColor</span>!</span><br><span class="line">    <span class="keyword">var</span> backgroundColor: <span class="type">UIColor</span>!</span><br><span class="line">    <span class="keyword">var</span> themeMode: <span class="type">Theme</span> = .<span class="type">DayMode</span> &#123;</span><br><span class="line">        <span class="comment">// æ¯å½“æ”¹å˜äº†ä¸»é¢˜çš„æ—¶å€™ï¼Œå°±å»æ”¹å˜å¯¹åº”çš„é…è‰²</span></span><br><span class="line">        <span class="keyword">didSet</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>.changeMode(themeMode)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="keyword">self</span>.themeMode = .<span class="type">DayMode</span></span><br><span class="line">        <span class="keyword">self</span>.changeMode(themeMode)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”±äºå¤šå¤„ç”¨åˆ°äºæ˜¯æå–å‡ºæ¥</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">changeMode</span><span class="params">(<span class="number">_</span> newMode: Theme)</span></span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> newMode &#123;</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">DayMode</span>:</span><br><span class="line">            fontColor = <span class="type">UIColor</span>.black</span><br><span class="line">            backgroundColor = <span class="type">UIColor</span>.white</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">NightMode</span>:</span><br><span class="line">            fontColor = <span class="type">UIColor</span>.white</span><br><span class="line">            backgroundColor = <span class="type">UIColor</span>.black</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ui = <span class="type">UI</span>()</span><br><span class="line">ui.themeMode</span><br><span class="line">ui.fontColor <span class="comment">//  é»‘</span></span><br><span class="line">ui.backgroundColor <span class="comment">// ç™½</span></span><br><span class="line"></span><br><span class="line">ui.themeMode = .<span class="type">NightMode</span></span><br><span class="line">ui.fontColor <span class="comment">// ç™½</span></span><br><span class="line">ui.backgroundColor <span class="comment">// é»‘</span></span><br></pre></td></tr></table></div></figure><p><strong>5.</strong> å»¶è¿Ÿå±æ€§ï¼ˆLazy Propertyï¼‰<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClosedRange</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> start: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">let</span> end: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¯æ¬¡è°ƒç”¨éƒ½ä¼šé‡æ–°è®¡ç®—</span></span><br><span class="line">    <span class="keyword">var</span> width: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> end - start + <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨æ‡’åŠ è½½ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨æ˜¯æ‰ä¼šè®¡ç®—ï¼Œè§£å†³èµ„æºé‡å¤è®¡ç®—æˆ–è¯»å–ç­‰é—®é¢˜</span></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> sum: <span class="type">Int</span> = &#123;</span><br><span class="line">        <span class="keyword">var</span> res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">self</span>.start...<span class="keyword">self</span>.end &#123;</span><br><span class="line">            res += i</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>?(start: <span class="type">Int</span>, end: <span class="type">Int</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> start &gt; end &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">self</span>.start = start</span><br><span class="line">        <span class="keyword">self</span>.end = end</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> range = <span class="type">ClosedRange</span>(start: <span class="number">0</span>, end: <span class="number">10_000</span>) &#123;</span><br><span class="line">    range.width</span><br><span class="line">    range.sum</span><br><span class="line">    range.sum</span><br><span class="line">    range.sum</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>6.</strong> è®¿é—®æ§åˆ¶</p><ul><li><code>private</code> ç§æœ‰è®¿é—®æ§åˆ¶ï¼Œæ ‡è¯†äº†çš„å˜é‡å’Œæ–¹æ³•åªèƒ½åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­æ‰èƒ½è®¿é—®</li><li><code>internal</code> é»˜è®¤è®¿é—®æ§åˆ¶ï¼ŒåŒä¸€ä¸ªç›®å½•ä¸‹å¯è®¿é—®</li><li><code>public</code> å…¬æœ‰è®¿é—®æ§åˆ¶ï¼Œæ ‡è¯†åä»»ä½•åœ°æ–¹éƒ½å¯è®¿é—®</li></ul><p><strong>7.</strong> å•ä¾‹æ¨¡å¼<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Sourcesæ–‡ä»¶å¤¹ä¸­ GameManager.swift</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GameManager</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">let</span> defaultManager = <span class="type">GameManager</span>()</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> score = <span class="number">0</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> level = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">init</span>() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">addScore</span><span class="params">()</span></span> &#123;</span><br><span class="line">        score += <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»æ–‡ä»¶ä¸­</span></span><br><span class="line"><span class="keyword">let</span> gameManager = <span class="type">GameManager</span>.defaultManager</span><br><span class="line">gameManager.addScore()</span><br><span class="line">gameManager.score <span class="comment">// 10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> gm = <span class="type">GameManager</span>.defaultManager</span><br><span class="line">gm.addScore()</span><br><span class="line">gm.score <span class="comment">// 20</span></span><br></pre></td></tr></table></div></figure></p><h2 id="ç»§æ‰¿å’Œæ„é€ å‡½æ•°">ç»§æ‰¿å’Œæ„é€ å‡½æ•°<a href="post/swift-study-note#ç»§æ‰¿å’Œæ„é€ å‡½æ•°"></a></h2><p><strong>1.</strong> ç»§æ‰¿åŸºæœ¬ä½¿ç”¨æ–¹å¼<br>ç»§æ‰¿æŸä¸ªç±»ä½¿ç”¨å†’å·â€:â€è·Ÿä¸Šç»§æ‰¿çš„ç±»<br>ç»§æ‰¿å¯ä»¥ä½¿ç”¨çˆ¶ç±»ä¸­éç§æœ‰çš„å±æ€§ï¼ˆä¸åœ¨ä¸€ä¸ªæ–‡ä»¶çš„æƒ…å†µä¸‹ï¼‰<br><code>final</code>å…³é”®å­—å¯ä»¥è®©è¯¥ç±»ä¸å†æœ‰å­ç±»<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Avatar</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> life = <span class="number">100</span> <span class="comment">// è¡€æ¡</span></span><br><span class="line">    <span class="keyword">var</span> isAlive: <span class="type">Bool</span> = <span class="literal">true</span> <span class="comment">// æ˜¯å¦å­˜æ´»</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¢«æ”»å‡»æ—¶è°ƒç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">beAttacked</span><span class="params">(attack: Int)</span></span> &#123;</span><br><span class="line">        life -= attack</span><br><span class="line">        <span class="keyword">if</span> life &lt;= <span class="number">0</span> &#123;</span><br><span class="line">            isAlive = <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»§æ‰¿</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>: <span class="title">Avatar</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> leve = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> player = <span class="type">User</span>(name: <span class="string">"Jiaji"</span>)</span><br><span class="line">player.name</span><br><span class="line">player.life</span><br><span class="line">player.beAttacked(attack: <span class="number">20</span>)</span><br><span class="line">player.life</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨finalï¼Œè¡¨ç¤ºæœ€ç»ˆçš„ç±»ï¼Œé˜»æ­¢è¿›ä¸€æ­¥çš„ç»§æ‰¿</span></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Magician</span>: <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> magic = <span class="number">100</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> å¤šæ€<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç®€åŒ–å¤§é‡ä»£ç </span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Avatar</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>: <span class="title">Avatar</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Magician</span>: <span class="title">User</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Monster</span>: <span class="title">Avatar</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤šæ€</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printName</span><span class="params">(avatar: Avatar)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"name is \(avatar.name)"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> user = <span class="type">User</span>(name: <span class="string">"Bob"</span>)</span><br><span class="line"><span class="keyword">let</span> user2 = <span class="type">Magician</span>(name: <span class="string">"Tom"</span>)</span><br><span class="line"><span class="keyword">let</span> mons = <span class="type">Monster</span>(name: <span class="string">"no1"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åªè¦éƒ½æ˜¯ç»§æ‰¿Avataré‚£ä¹ˆå°±å¯ä»¥ä¼ å…¥è¿™ä¸ªæ–¹æ³•ï¼Œ ä¸åœ¨ä¹å…·ä½“çš„ç±»</span></span><br><span class="line">printName(avatar: user)</span><br><span class="line">printName(avatar: user2)</span><br><span class="line">printName(avatar: mons)</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»“æœ</span></span><br><span class="line"><span class="comment">//name is Bob</span></span><br><span class="line"><span class="comment">//name is Tom</span></span><br><span class="line"><span class="comment">//name is no1</span></span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> é‡è½½ï¼Œ é€šè¿‡å…³é”®å­—<code>override</code>å³å¯å¤å†™çˆ¶ç±»ä¸­çš„æˆå‘˜<br>ç§æœ‰æˆå‘˜æ— æ³•è¦†å†™ï¼›<br>finalæˆå‘˜æ— æ³•è¦†å†™ï¼›<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SuperClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"This is SuperClass"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fun1</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"SuperClass fun1()"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ‡è®°äº†finalåï¼Œæ— æ³•è¢«å­ç±»è¦†å†™</span></span><br><span class="line">    <span class="keyword">final</span> <span class="function"><span class="keyword">func</span> <span class="title">fun2</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"SuperClass fun2()"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubClass</span>: <span class="title">SuperClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"This is SubClass"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">fun1</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"SubClass fun1()"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> claz = <span class="type">SuperClass</span>()</span><br><span class="line"><span class="keyword">let</span> claz2 = <span class="type">SubClass</span>()</span><br><span class="line"><span class="keyword">let</span> arr: [<span class="type">SuperClass</span>] = [claz, claz2]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">c</span> <span class="keyword">in</span> arr &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">c</span>.description)</span><br><span class="line">    <span class="built_in">c</span>.fun1()</span><br><span class="line">    <span class="built_in">c</span>.fun2()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»“æœ</span></span><br><span class="line"><span class="comment">//This is SuperClass</span></span><br><span class="line"><span class="comment">//SuperClass fun1()</span></span><br><span class="line"><span class="comment">//SuperClass fun2()</span></span><br><span class="line"><span class="comment">//This is SubClass</span></span><br><span class="line"><span class="comment">//SubClass fun1()</span></span><br><span class="line"><span class="comment">//SuperClass fun2()</span></span><br></pre></td></tr></table></div></figure></p><p><strong>4.</strong> å­ç±»æ„é€ ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ </p><ul><li>å¿…é¡»å°†å­ç±»åˆå§‹åŒ–å®Œæˆï¼Œæ‰èƒ½è°ƒç”¨çˆ¶ç±»æ„é€ åˆå§‹åŒ–çˆ¶ç±»</li><li>é€šè¿‡<code>super.init</code>è°ƒç”¨çˆ¶ç±»æ„é€ </li></ul><p><strong>5.</strong> ä¸¤æ®µå¼æ„é€ </p><ul><li>ç¬¬ä¸€æ®µï¼šæ„é€ åˆå€¼<ul><li>åœ¨æ‰€æœ‰å˜é‡æ²¡æœ‰åˆå§‹åŒ–å®Œæˆä¹‹å‰ï¼Œä¸èƒ½è°ƒç”¨å…¶ä»–æ–¹æ³•</li><li>çˆ¶ç±»çš„æˆå‘˜å˜é‡ï¼Œå³ä½¿æœ‰åˆå§‹å€¼ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨</li><li>å¯ä»¥æ¶‰åŠé€»è¾‘ï¼Œä½†é€»è¾‘ä¸èƒ½æ¶‰åŠåˆ°self</li><li>é™æ€çš„å¯ä»¥ä½¿ç”¨</li></ul></li><li>è°ƒç”¨superæ„é€ (å¦‚æœéœ€è¦çš„è¯)</li><li>ç¬¬äºŒæ®µï¼šæ‰€æœ‰æˆå‘˜å˜é‡åˆå§‹åŒ–å®Œæˆä»¥åï¼Œè¿›è¡Œæˆå‘˜å˜é‡ç›¸å…³çš„é€»è¾‘è°ƒæ•´</li></ul><p><strong>6.</strong> æ–¹ä¾¿çš„æ„é€ å‡½æ•°å’ŒæŒ‡å®šçš„æ„é€ å‡½æ•°<br>ä¸€èˆ¬çš„æ„é€ å°±æ˜¯æŒ‡å®šçš„æ„é€ å‡½æ•°ï¼›<br>åŠ äº†convenienceçš„æ„é€ å°±æ˜¯æ–¹ä¾¿çš„æ„é€ å‡½æ•°ï¼Œæ–¹ä¾¿çš„æ„é€ å‡½æ•°åªèƒ½selfè°ƒç”¨è¯¥ç±»çš„æŒ‡å®šæ„é€ å‡½æ•°ï¼›<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Avatar</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="comment">// è¿™ç§å«åšæŒ‡å®šæ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>: <span class="title">Avatar</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¿™ç§å«åšæŒ‡å®šæ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(name: name)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿™ç§å«åšæ–¹ä¾¿çš„æ„é€ å‡½æ•°ï¼Œconvenienceç›´æ¥ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼šæ–¹ä¾¿</span></span><br><span class="line">    <span class="comment">// æ–¹ä¾¿çš„æ„é€ å‡½æ•°åªèƒ½è°ƒç”¨è¯¥ç±»è‡ªèº«çš„æ„é€ å‡½æ•°ï¼Œä¸èƒ½è°ƒç”¨superçš„</span></span><br><span class="line">    <span class="comment">// è¦è°ƒç”¨è¯¥ç±»è‡ªèº«çš„æ„é€ ï¼Œå¿…é¡»åŠ ä¸Šconvenience</span></span><br><span class="line">    <span class="keyword">convenience</span> <span class="keyword">init</span>(firstName: <span class="type">String</span>, lastName: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(name: <span class="string">"\(firstName) \(lastName)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>7.</strong> å­ç±»æ„é€ å‡½æ•°çš„ç»§æ‰¿<br>å¦‚æœå­ç±»æ²¡æœ‰å®ç°ä»»ä½•çˆ¶ç±»çš„æŒ‡å®šæ„é€ å‡½æ•°ï¼Œåˆ™è‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»çš„æ‰€æœ‰æŒ‡å®šæ„é€ å‡½æ•°ï¼›<br>å¦‚æœå­ç±»å®ç°äº†çˆ¶ç±»æ‰€æœ‰çš„æŒ‡å®šæ„é€ å‡½æ•°ï¼Œåˆ™è‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»çš„æ‰€æœ‰ä¾¿åˆ©æ„é€ å‡½æ•°ï¼›<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Avatar</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    init(num: Int) &#123;</span></span><br><span class="line"><span class="comment">//        self.name = String(num)</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">convenience</span> <span class="keyword">init</span>(firstName: <span class="type">String</span>, lastName: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(name: <span class="string">"\(firstName) \(lastName)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®ç°äº†çˆ¶ç±»æ‰€æœ‰æŒ‡å®šæ„é€ çš„æƒ…å†µä¸‹ï¼Œå¦‚æœæƒ³çœ‹æ²¡æœ‰å®ç°å®Œçš„æƒ…å†µï¼Œå°†Avataræ³¨é‡Šçš„ä»£ç æ”¾å¼€</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>: <span class="title">Avatar</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> group: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>, group: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.group = group</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(name: name)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">convenience</span> <span class="keyword">init</span>(group: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> name = <span class="type">User</span>.generateUserName()</span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(name: name, group: group)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">convenience</span> <span class="keyword">override</span> <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(name: name, group: <span class="string">""</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">generateUserName</span><span class="params">()</span></span> -&gt; <span class="type">String</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Player"</span> + <span class="type">String</span>(<span class="type">Int</span>(arc4random()%<span class="number">1_000_000</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ²¡æœ‰å®ç°ä»»ä½•æŒ‡å®šæ„é€ çš„æƒ…å†µ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Monster</span>: <span class="title">Avatar</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å­ç±»æ²¡æœ‰å®ç°ä»»ä½•çˆ¶ç±»æ„é€ çš„æƒ…å†µ,è‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»çš„æ‰€æœ‰æŒ‡å®šæ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="comment">// å¯ç›´æ¥ç”¨selfè°ƒç”¨ï¼Œç›¸å½“äºMonsterå·²ç»æœ‰äº†init(name: type)</span></span><br><span class="line">    <span class="keyword">convenience</span> <span class="keyword">init</span>(type: <span class="type">String</span>)&#123;</span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(name: type)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦‚æœå°†Avatarä¸­çš„init(num: Int)çš„æ„é€ çš„æ³¨é‡Šè§£å¼€è¯¥å¥å®ä¾‹åŒ–å°†ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ”¾å¼€åï¼Œå­ç±»Userå¹¶æ²¡æœ‰å®ç°çˆ¶ç±»çš„init(num: Int)</span></span><br><span class="line"><span class="keyword">let</span> user = <span class="type">User</span>(firstName: <span class="string">"John"</span>, lastName: <span class="string">"Snow"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼å®ä¾‹åŒ–ï¼Œå…¶ä¸­ç¬¬äºŒç§ç»§æ‰¿è‡ªçˆ¶ç±»ï¼Œç¬¬ä¸‰ç§çˆ¶ç±»çš„æ–¹ä¾¿æ„é€ èƒ½ç›´æ¥ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">let</span> zombie = <span class="type">Monster</span>(type: <span class="string">"Zombie"</span>)</span><br><span class="line"><span class="keyword">let</span> zombie2 = <span class="type">Monster</span>(name: <span class="string">"Zombie"</span>)</span><br><span class="line"><span class="keyword">let</span> zombie3 = <span class="type">Monster</span>(firstName: <span class="string">"Mr."</span>, lastName: <span class="string">"Zombie"</span>)</span><br></pre></td></tr></table></div></figure></p><p><strong>8.</strong> requiredæ„é€ <br><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">class Avatar &#123;</span><br><span class="line">    var name: String</span><br><span class="line">    // è¡¨ç¤ºå­ç±»å¿…é¡»å®ç°è¯¥æ„é€ æ–¹æ³•</span><br><span class="line">    required init(name: String) &#123;</span><br><span class="line">        self.name = name</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    init(num: Int) &#123;</span><br><span class="line">        self.name = String(num)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å¦‚æœæ²¡æœ‰å®ç°ä»»ä½•çˆ¶ç±»æŒ‡å®šæ„é€ ï¼Œé‚£ä¹ˆé»˜è®¤ä¼šå®ç°æ‰€æœ‰çˆ¶ç±»æŒ‡å®šæ„é€ </span><br><span class="line">class NPC:Avatar &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class User: Avatar &#123;</span><br><span class="line">    override init(num: Int) &#123;</span><br><span class="line">        super.init(num: num)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // å¦‚æœé‡å†™äº†ä¸€ä¸ªçˆ¶ç±»æ„é€ ï¼ˆå¦‚ä¸Šé¢çš„æ„é€ ï¼‰ï¼Œé‚£ä¹ˆå¿…é¡»å®ç°çˆ¶ç±»å¼ºåˆ¶è¦å®ç°çš„æ„é€ </span><br><span class="line">    required init(name: String) &#123;</span><br><span class="line">        super.init(name: name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>9.</strong> ç»“æ„ä½“ä¸­çš„æ„é€ <br>ç”±äºç»“æ„ä½“ä¸­æ²¡æœ‰ç»§æ‰¿çš„å…³ç³»ï¼Œæ‰€ä»¥ä¸ç”¨ç”³æ˜æ˜¯æ–¹ä¾¿çš„æ„é€ è¡¨ç¤ºè¦è°ƒç”¨è‡ªå·±çš„æ„é€ ã€‚<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TestInit</span> </span>&#123;</span><br><span class="line">    <span class="keyword">init</span>(a: <span class="type">Int</span>) &#123;&#125;</span><br><span class="line">    <span class="keyword">init</span>(b: <span class="type">Int</span>, <span class="built_in">c</span>: <span class="type">Int</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(a: b + <span class="built_in">c</span>) <span class="comment">// ç›´æ¥selfè°ƒç”¨å°±è¡Œäº†</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><h2 id="æ–‡æ¡£æ³¨é‡Š">æ–‡æ¡£æ³¨é‡Š<a href="post/swift-study-note#æ–‡æ¡£æ³¨é‡Š"></a></h2><p><strong>1.</strong> å¤šè¡Œæ–‡æ¡£æ³¨é‡Š<br><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">å¤šè¡Œæ–‡æ¡£æ³¨é‡Š</span><br><span class="line">å¤šè¡Œæ–‡æ¡£æ³¨é‡Š</span><br><span class="line">*/</span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> å•è¡Œæ–‡æ¡£æ³¨é‡Šï¼Œå¤šä¸ªå•è¡Œåˆåœ¨ä¸€èµ·å’Œå¤šè¡Œæ•ˆæœä¸€æ ·<br><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/// å•è¡Œæ–‡æ¡£æ³¨é‡Š</span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> ä½¿ç”¨çš„æ˜¯Markdownæ ¼å¼ä¹¦å†™<br><strong>4.</strong> å‚æ•°æ³¨é‡Š1<br><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/// - Parameter item1: This is item1</span><br><span class="line">/// - Parameter item2: This is item2</span><br><span class="line">func show2(item1: String, item2: String) &#123;&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>5.</strong> å‚æ•°æ³¨é‡Š2<br><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/// - Parameters:</span><br><span class="line">///   - item1: This is item1</span><br><span class="line">///   - item2: This is item2</span><br><span class="line">func show2(item1: String, item2: String) &#123;&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>6.</strong> è¿”å›ä¿¡æ¯ã€å¼‚å¸¸ä¿¡æ¯æ³¨é‡Š<br><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/// - Returns: the result String.</span><br><span class="line">/// - Throws: nil error</span><br><span class="line">func show1() throws -&gt; String &#123;</span><br><span class="line">    return &quot;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>7.</strong> ä¸€äº›å¯¹äºç®—æ³•æˆ–å…¶ä»–ç”¨é€”çš„ä¸€äº›å…³é”®å­—<br><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/// å¯¹äºç®—æ³•æˆ–å…¶ä»–ç”¨é€”çš„ä¸€äº›å…³é”®å­— `Precondition`, `Postcondition`, `Requires`, `Invariant`, `Complexity`, `Important` and `Warning`.</span><br><span class="line">///</span><br><span class="line">/// å‡è®¾è¿™æ˜¯ä¸€ä¸ªç®—æ³•</span><br><span class="line">///</span><br><span class="line">/// - Precondition: å‰ç½®æ¡ä»¶</span><br><span class="line">/// - Postcondition: åç½®æ¡ä»¶</span><br><span class="line">/// - Requires: ç®—æ³•æ‰€éœ€è¦çš„å†…å®¹</span><br><span class="line">/// - Invariant: å¾ªç¯ä¸å˜é‡</span><br><span class="line">/// - Complexity: å¤æ‚åº¦</span><br><span class="line">/// - Important: ä¸€äº›é‡è¦çš„ä¿¡æ¯</span><br><span class="line">/// - Warning: ä¸€äº›è­¦å‘Šä¿¡æ¯</span><br><span class="line">/// - Attention: ä¸€äº›è­¦å‘Šä¿¡æ¯</span><br><span class="line">/// - Note: ä¸€äº›ç›¸åº”çš„è®°å½•</span><br><span class="line">/// - Remark: ä¸€äº›è¯„è®º</span><br><span class="line">///</span><br><span class="line">/// - Parameter object: The algorithm will use this single object to change the world.</span><br><span class="line">/// - Throws: `MyError.JustImpossible` if the algorithm&apos;s precondition can not be satisfied.</span><br><span class="line">/// - Returns: the object contains all the information in the universe.</span><br><span class="line">func mysteriousAlgorithm(object: AnyObject) &#123;</span><br><span class="line">    return</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>8.</strong> ä¸€äº›å…ƒä¿¡æ¯<br><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/// - Author: ä½œè€…</span><br><span class="line">/// - Author: å‡ ä¸ªäººä¸€èµ·å®Œæˆ...</span><br><span class="line">/// - Copyright: ç‰ˆæƒä¿¡æ¯</span><br><span class="line">/// - Date: æ—¶é—´</span><br><span class="line">/// - Since: é¡¹ç›®èµ·å§‹æ—¥æœŸ</span><br><span class="line">/// - Version: å¯¹åº”çš„ç‰ˆæœ¬å·</span><br><span class="line">func show() &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>9.</strong> MARK</p><ul><li>åˆ†å‰²ç±»è§†å›¾</li></ul><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// MARK: -</span><br></pre></td></tr></table></div></figure><ul><li>æ·»åŠ åˆ†å‰²ç±»è§†å›¾å¹¶æ·»åŠ è¯¥åŒºåŸŸæ ‡é¢˜</li></ul><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// MARK: - Methods</span><br></pre></td></tr></table></div></figure><p><strong>10.</strong> TODO<br>åœ¨ç±»è§†å›¾ä¸­å»ºç«‹ä»»åŠ¡æé†’<br><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// TODO: ä»¥ååœ¨è¿™é‡Œè¦å¹²å˜›å¹²å˜›</span><br></pre></td></tr></table></div></figure></p><p><strong>11.</strong> FIXME<br>éœ€è¦ä¿®å¤ï¼Œä½†å æ—¶æ— å…³ç´§è¦ï¼Œåœ¨ç±»è§†å›¾ä¸­ä¼šæœ‰æé†’<br><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// FIXME: Support Swift 2.2</span><br></pre></td></tr></table></div></figure></p><h2 id="ä¸‹æ ‡">ä¸‹æ ‡<a href="post/swift-study-note#ä¸‹æ ‡"></a></h2><p><strong>1.</strong> åŸºæœ¬ä½¿ç”¨æ–¹å¼<br>å¯ä»¥è‡ªå·±å®šä¹‰ä¸‹æ ‡çš„ç±»å‹ï¼Œå¦‚åŒæ•°ç»„å’Œå­—å…¸ä¸€æ ·è®¿é—®æ–¹å¼ï¼›<br>éœ€è¦å…³é”®å­—<code>subscript</code>ï¼›<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Vector3</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x: <span class="type">Double</span> = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">var</span> y: <span class="type">Double</span> = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">var</span> z: <span class="type">Double</span> = <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‚æ•°ç±»å‹å¯ä»¥éšæ„æŒ‡å®š</span></span><br><span class="line">    <span class="comment">// éœ€è¦æœ‰ä¸ªè¿”å›å€¼</span></span><br><span class="line">    <span class="comment">// å¦‚æœéœ€è¦é€šè¿‡ä¸‹æ ‡æ¥è®¾ç½®å€¼ï¼Œåˆ™éœ€è¦æ·»åŠ set</span></span><br><span class="line">    <span class="keyword">subscript</span>(index: <span class="type">Int</span>) -&gt; <span class="type">Double</span>? &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">switch</span> index &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>: <span class="keyword">return</span> x</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>: <span class="keyword">return</span> y</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>: <span class="keyword">return</span> z</span><br><span class="line">            <span class="keyword">default</span>: <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> newValue = newValue <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">switch</span> index &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>: x = newValue</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>: y = newValue</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>: z = newValue</span><br><span class="line">            <span class="keyword">default</span>: <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">subscript</span>(axis: <span class="type">String</span>) -&gt; <span class="type">Double</span>? &#123;</span><br><span class="line">        <span class="keyword">switch</span> axis &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"x"</span>, <span class="string">"X"</span>: <span class="keyword">return</span> x</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"y"</span>, <span class="string">"Y"</span>: <span class="keyword">return</span> y</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"z"</span>, <span class="string">"Z"</span>: <span class="keyword">return</span> z</span><br><span class="line">        <span class="keyword">default</span>: <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> v = <span class="type">Vector3</span>(x: <span class="number">1.0</span>, y: <span class="number">2.0</span>, z: <span class="number">3.0</span>)</span><br><span class="line">v[<span class="number">0</span>] <span class="comment">// 1</span></span><br><span class="line"><span class="comment">// æ·»åŠ äº†setæ‰èƒ½è®¾ç½®å€¼</span></span><br><span class="line">v[<span class="number">0</span>] = <span class="number">100.0</span> <span class="comment">// 100</span></span><br><span class="line">v[<span class="string">"x"</span>] <span class="comment">// 100</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> å¤šç»´ä¸‹æ ‡<br>å¯å®šä¹‰å¤šä¸ªä¸‹æ ‡ï¼›<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> data: [[<span class="type">Double</span>]]</span><br><span class="line">    <span class="keyword">let</span> r: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">let</span> <span class="built_in">c</span>: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(row: <span class="type">Int</span>, col: <span class="type">Int</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.r = row</span><br><span class="line">        <span class="keyword">self</span>.<span class="built_in">c</span> = col</span><br><span class="line">        <span class="keyword">self</span>.data = [[<span class="type">Double</span>]]()</span><br><span class="line">        <span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">0</span>..&lt;r &#123;</span><br><span class="line">            <span class="keyword">let</span> aRow = <span class="type">Array</span>(repeating: <span class="number">0.0</span>, <span class="built_in">count</span>: col)</span><br><span class="line">            data.append(aRow)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å›ç¡®åˆ‡æœ‰å€¼</span></span><br><span class="line">    <span class="keyword">subscript</span>(x: <span class="type">Int</span>, y: <span class="type">Int</span>) -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">get</span>&#123;</span><br><span class="line">            <span class="built_in">assert</span>( x &gt;= <span class="number">0</span> &amp;&amp; x &lt; r &amp;&amp; y &gt;= <span class="number">0</span> &amp;&amp; y &lt; <span class="built_in">c</span> , <span class="string">"Index Out of Range"</span>)</span><br><span class="line">            <span class="keyword">return</span> data[x][y]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">set</span>&#123;</span><br><span class="line">            <span class="built_in">assert</span>( x &gt;= <span class="number">0</span> &amp;&amp; x &lt; r &amp;&amp; y &gt;= <span class="number">0</span> &amp;&amp; y &lt; <span class="built_in">c</span> , <span class="string">"Index Out of Range"</span>)</span><br><span class="line">            data[x][y] = newValue</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæƒ³ä½¿ç”¨ m[1][1]</span></span><br><span class="line">    <span class="keyword">subscript</span>(row: <span class="type">Int</span>) -&gt; [<span class="type">Double</span>]&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">get</span>&#123;</span><br><span class="line">            <span class="built_in">assert</span>( row &gt;= <span class="number">0</span> &amp;&amp; row &lt; r , <span class="string">"Index Out of Range"</span>)</span><br><span class="line">            <span class="keyword">return</span> data[row]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">set</span>(vector)&#123;</span><br><span class="line">            <span class="built_in">assert</span>( vector.<span class="built_in">count</span> == <span class="built_in">c</span> , <span class="string">"Column Number does NOT match"</span>)</span><br><span class="line">            data[row] = vector</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> m = <span class="type">Matrix</span>(row: <span class="number">2</span>, col: <span class="number">2</span>)</span><br><span class="line"><span class="comment">//m[2,2]</span></span><br><span class="line">m[<span class="number">1</span>,<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœæƒ³ä½¿ç”¨ m[1][1]</span></span><br><span class="line">m[<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">m[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">m[<span class="number">0</span>] = [<span class="number">1.5</span>,<span class="number">4.5</span>]</span><br></pre></td></tr></table></div></figure></p><h2 id="è¿ç®—ç¬¦é‡è½½">è¿ç®—ç¬¦é‡è½½<a href="post/swift-study-note#è¿ç®—ç¬¦é‡è½½"></a></h2><p>è¿ç®—ç¬¦æœ¬èº«å°±æ˜¯ä¸€ä¸ªå‡½æ•°<br><strong>1.</strong> é‡è½½è¿ç®—ç¬¦åŸºæœ¬æ“ä½œ<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é‡è½½è¿ç®—ç¬¦</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> + <span class="params">(<span class="keyword">left</span>: Vector3, <span class="keyword">right</span>: Vector3)</span></span> -&gt; <span class="type">Vector3</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Vector3</span>(x: <span class="keyword">left</span>.x + <span class="keyword">right</span>.x, y: <span class="keyword">left</span>.y + <span class="keyword">right</span>.y, z: <span class="keyword">left</span>.z + <span class="keyword">right</span>.z)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡è½½å•ç›®è¿ç®—ç¬¦ï¼Œprefixè¡¨ç¤º - æ˜¯ä¸€ä¸ªå‰ç½®è¿ç®—ç¬¦ï¼Œç›¸å¯¹åº”çš„æ˜¯postfix</span></span><br><span class="line"><span class="keyword">prefix</span> <span class="function"><span class="keyword">func</span> - <span class="params">(v: Vector3)</span></span> -&gt; <span class="type">Vector3</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Vector3</span>(x: -v.x, y: -v.y, z: -v.z)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡è½½ += è¿™ç§è¿ç®—</span></span><br><span class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> += <span class="params">(<span class="keyword">left</span>: <span class="keyword">inout</span> Vector3, <span class="keyword">right</span>: Vector3)</span></span> &#123;</span><br><span class="line">    <span class="keyword">left</span> = <span class="keyword">left</span> + <span class="keyword">right</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> va = <span class="type">Vector3</span>(x: <span class="number">1.0</span>, y: <span class="number">2.0</span>, z: <span class="number">3.0</span>)</span><br><span class="line"><span class="keyword">let</span> vb = <span class="type">Vector3</span>(x: <span class="number">3.0</span>, y: <span class="number">4.0</span>, z: <span class="number">5.0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> vc = vb + va</span><br><span class="line">vc.x</span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> é‡è½½æ¯”è¾ƒè¿ç®—ç¬¦<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é‡è½½æ¯”è¾ƒè¿ç®—ç¬¦</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> == <span class="params">(<span class="keyword">left</span>: Vector3, <span class="keyword">right</span>: Vector3)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">left</span>.x == <span class="keyword">right</span>.x &amp;&amp; <span class="keyword">left</span>.y == <span class="keyword">right</span>.y &amp;&amp; <span class="keyword">left</span>.z == <span class="keyword">right</span>.z</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> != <span class="params">(<span class="keyword">left</span>: Vector3, <span class="keyword">right</span>: Vector3)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> !(<span class="keyword">left</span> == <span class="keyword">right</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> va = <span class="type">Vector3</span>(x: <span class="number">1.0</span>, y: <span class="number">2.0</span>, z: <span class="number">3.0</span>)</span><br><span class="line"><span class="keyword">let</span> vb = <span class="type">Vector3</span>(x: <span class="number">3.0</span>, y: <span class="number">4.0</span>, z: <span class="number">5.0</span>)</span><br><span class="line"></span><br><span class="line">va == vb</span><br><span class="line">va != vb</span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> è‡ªå®šä¹‰è¿ç®—ç¬¦<br>å¦‚æœæ˜¯ASCIIå­—ç¬¦ï¼Œåªèƒ½æ˜¯ï¼š<code>/ = - + ! * % &lt; &gt; &amp; | ^ ~</code>ä¹‹å¼€å¤´ ã€‚æˆ–è€…æ˜¯Unicodeçš„å­—ç¬¦<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Vector3</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x: <span class="type">Double</span> = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">var</span> y: <span class="type">Double</span> = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">var</span> z: <span class="type">Double</span> = <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">length</span><span class="params">()</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sqrt(x*x + y*y + z*z)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> + <span class="params">(<span class="keyword">left</span>: Vector3, <span class="keyword">right</span>: Vector3)</span></span> -&gt; <span class="type">Vector3</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Vector3</span>(x: <span class="keyword">left</span>.x + <span class="keyword">right</span>.x, y: <span class="keyword">left</span>.y + <span class="keyword">right</span>.y, z: <span class="keyword">left</span>.z + <span class="keyword">right</span>.z)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> * <span class="params">(<span class="keyword">left</span>: Vector3, <span class="keyword">right</span>: Vector3)</span></span> -&gt; <span class="type">Double</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">left</span>.x * <span class="keyword">right</span>.x + <span class="keyword">left</span>.y * <span class="keyword">right</span>.y + <span class="keyword">left</span>.z * <span class="keyword">right</span>.z</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> += <span class="params">(<span class="keyword">left</span>: <span class="keyword">inout</span> Vector3, <span class="keyword">right</span>: <span class="keyword">inout</span> Vector3)</span></span>&#123;</span><br><span class="line">    <span class="keyword">left</span> = <span class="keyword">left</span> + <span class="keyword">right</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å•ç›®è¿ç®—ç¬¦çš„å®šä¹‰</span></span><br><span class="line"><span class="keyword">postfix</span> <span class="keyword">operator</span> +++</span><br><span class="line"><span class="keyword">postfix</span> <span class="function"><span class="keyword">func</span> +++ <span class="params">(vector: <span class="keyword">inout</span> Vector3)</span></span> -&gt; <span class="type">Vector3</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> addOn = <span class="type">Vector3</span>(x: <span class="number">1.0</span>, y: <span class="number">1.0</span>, z: <span class="number">1.0</span>)</span><br><span class="line">    vector += addOn</span><br><span class="line">    <span class="keyword">return</span> vector</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">prefix</span> <span class="keyword">operator</span> +++</span><br><span class="line"><span class="keyword">prefix</span> <span class="function"><span class="keyword">func</span> +++ <span class="params">(vector: <span class="keyword">inout</span> Vector3)</span></span> -&gt; <span class="type">Vector3</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> res = vector</span><br><span class="line">    <span class="keyword">var</span> addOn = <span class="type">Vector3</span>(x: <span class="number">1.0</span>, y: <span class="number">1.0</span>, z: <span class="number">1.0</span>)</span><br><span class="line">    vector += addOn</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒç›®è¿ç®—ç¬¦çš„å®šä¹‰</span></span><br><span class="line"><span class="comment">// è®¡ç®—ä¸¤ä¸ªå‘é‡çš„å¤¹è§’</span></span><br><span class="line"><span class="keyword">infix</span> <span class="keyword">operator</span> ^</span><br><span class="line"><span class="function"><span class="keyword">func</span> ^ <span class="params">(<span class="keyword">left</span>: Vector3, <span class="keyword">right</span>: Vector3)</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> acos((<span class="keyword">left</span> * <span class="keyword">right</span>) / (<span class="keyword">left</span>.length() * <span class="keyword">right</span>.length()))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¡ç®—é˜¶å±‚ï¼Œå®šä¹‰ä¼˜å…ˆç»„</span></span><br><span class="line">precedencegroup <span class="type">ExponentPrecedence</span>&#123;</span><br><span class="line">    <span class="comment">// æ˜¯ä»å·¦å‘å³è®¡ç®—è¿˜æ˜¯ä»å³å‘å·¦è®¡ç®—</span></span><br><span class="line">    <span class="keyword">associativity</span>: <span class="keyword">left</span></span><br><span class="line">    <span class="comment">// å®šä¹‰ä¼˜å…ˆçº§ï¼Œç”¨lowerThanæˆ–higherThanæ¥å®šä¹‰</span></span><br><span class="line">    higherThan: <span class="type">MultiplicationPrecedence</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">infix</span> <span class="keyword">operator</span> **: <span class="type">ExponentPrecedence</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> **<span class="params">(x: Double, p: Double)</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> pow(x, p)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>+<span class="number">2</span>**<span class="number">3</span>**<span class="number">2</span> <span class="comment">// 65</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> va = <span class="type">Vector3</span>(x: <span class="number">1.0</span>, y: <span class="number">2.0</span>, z: <span class="number">3.0</span>)</span><br><span class="line"><span class="keyword">var</span> vb = <span class="type">Vector3</span>(x: <span class="number">3.0</span>, y: <span class="number">4.0</span>, z: <span class="number">5.0</span>)</span><br><span class="line">va+++</span><br><span class="line"></span><br><span class="line">+++vb</span><br><span class="line"></span><br><span class="line">va ^ vb</span><br></pre></td></tr></table></div></figure></p><h2 id="Extension">Extension<a href="post/swift-study-note#Extension"></a></h2><p><strong>1.</strong> åŸºæœ¬ä½¿ç”¨æ–¹å¼<br>æ‰©å±•ï¼›<br>æ‰©å±•å±æ€§æ—¶ï¼Œåªèƒ½æ‰©å±•è®¡ç®—å‹å±æ€§ï¼›<br>åªèƒ½åˆ›å»ºæ–¹ä¾¿çš„æ„é€ å‡½æ•°<code>convenience</code>ï¼›<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> value: <span class="type">String</span></span><br><span class="line">    <span class="keyword">init</span>(value: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.value = value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ‰©å±•ç”¨æ–¹æ³•ä¸Šæ—¶</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">beautifulValue</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"beautiful "</span> + <span class="keyword">self</span>.value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> test = <span class="type">Test</span>(value: <span class="string">"girl"</span>)</span><br><span class="line">test.beautifulValue() <span class="comment">//"beautiful girl"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰©å±•ç”¨å˜é‡ä¸Šæ—¶ï¼Œå¿…é¡»æ˜¯è®¡ç®—å‹å˜é‡</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.value.<span class="built_in">count</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test.len <span class="comment">// 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰©å±•ç”¨æ„é€ æ—¶ï¼Œå¿…é¡»æ˜¯æ–¹ä¾¿æ„é€ </span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">convenience</span> <span class="keyword">init</span> (firstName: <span class="type">String</span>, lastName: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(value: <span class="string">"\(firstName) \(lastName)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> test2 = <span class="type">Test</span>(firstName: <span class="string">"Jiaji"</span>, lastName: <span class="string">"Xu"</span>)</span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> åµŒå¥—ç±»å‹<br>å¦‚æœæŸç±»å‹åªæœ‰åœ¨ä¸€ä¸ªç±»å‹é‡Œé¢èµ·ä½œç”¨ï¼Œé‚£ä¹ˆå¯ä»¥å°†è¯¥ç±»å‹æ”¾åˆ°é‡Œé¢ï¼Œå¦‚Stringçš„Indexç±»å‹ï¼›<br>æ‰©å±•ï¼Œå¯æ‰©å±•åµŒå¥—ç±»å‹ï¼›<br>æ‰©å±•å¯æ‰©å±•ä¸‹æ ‡ï¼›<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> origin: (x: <span class="type">Double</span>, y: <span class="type">Double</span>)</span><br><span class="line">    <span class="keyword">var</span> width: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">var</span> height: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">init</span>(origin: (<span class="type">Double</span>, <span class="type">Double</span>), width: <span class="type">Double</span>, height: <span class="type">Double</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.origin = origin</span><br><span class="line">        <span class="keyword">self</span>.width = width</span><br><span class="line">        <span class="keyword">self</span>.height = height</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Rectangle</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">Vertex</span>: <span class="title">Int</span> </span>&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="type">LeftTop</span>, <span class="type">RightTop</span>, <span class="type">RightBottom</span>, <span class="type">LeftBottom</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">subscript</span>(index: <span class="type">Int</span>) -&gt; (<span class="type">Double</span>, <span class="type">Double</span>) &#123;</span><br><span class="line">        <span class="built_in">assert</span>(index &gt;= <span class="number">0</span> &amp;&amp; index &lt; <span class="number">4</span>, <span class="string">"Index in Rectange Out of Range."</span>)</span><br><span class="line">        <span class="keyword">switch</span> <span class="type">Vertex</span>(rawValue: index)! &#123;</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">LeftTop</span>:</span><br><span class="line">            <span class="keyword">return</span> origin</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">RightTop</span>:</span><br><span class="line">            <span class="keyword">return</span> (x: origin.x + width, y: origin.y)</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">RightBottom</span>:</span><br><span class="line">            <span class="keyword">return</span> (x: origin.x + width, y: origin.y + height )</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">LeftBottom</span>:</span><br><span class="line">            <span class="keyword">return</span> (x: origin.x, y: origin.y + height )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> rect = <span class="type">Rectangle</span>(origin: (<span class="number">0.0</span>, <span class="number">0.0</span>), width: <span class="number">4</span>, height: <span class="number">3</span>)</span><br><span class="line">rect[<span class="number">0</span>]</span><br><span class="line">rect[<span class="number">1</span>]</span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> æ‰©å±•æ ‡å‡†åº“<br>// Intè¿˜æœ‰å¾ˆå¤šå¯ä»¥åšenxtensionçš„åœ°æ–¹<br>// å¦‚ 12345[2]<br>// å¦‚ toBinary, toHex<br>// å¦‚ isPrime<br>// extensionåœ¨Appå¼€å‘ä¸­è¢«ç»å¸¸ä½¿ç”¨<br>// å¦‚ String, UIColorç­‰åŸºç¡€ç±»çš„ä½¿ç”¨<br>// åœ¨Appå¼€å‘ä¸­, ä¸€ä¸ªç•Œé¢å¯èƒ½éœ€è¦å¤„ç†å¤šä¸ªäº‹ä»¶: è¡¨æ ¼æ˜¾ç¤º, ç”¨æˆ·è¾“å…¥, å¯¼èˆª, åŠ¨ç”», æ•°æ®å­˜å‚¨â€¦<br>// æ­¤æ—¶å¯ä»¥ä½¿ç”¨extensionåˆ†éš”å¼€;<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Int</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> square: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span> * <span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> cube: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span> * <span class="keyword">self</span> * <span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">inRange</span><span class="params">(start: Int, to: Int)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span> &gt;= start &amp;&amp; <span class="keyword">self</span> &lt; to</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">repetitions</span><span class="params">(task: <span class="params">(Int)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="keyword">self</span> &#123;</span><br><span class="line">            task(<span class="keyword">self</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> num = <span class="number">8</span></span><br><span class="line">num.square</span><br><span class="line">num.cube</span><br><span class="line"></span><br><span class="line">num.inRange(start: <span class="number">0</span>, to: <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">num.repetitions &#123; index <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"hello \(index)"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡º</span></span><br><span class="line"><span class="comment">//hello 8</span></span><br><span class="line"><span class="comment">//hello 8</span></span><br><span class="line"><span class="comment">//hello 8</span></span><br><span class="line"><span class="comment">//hello 8</span></span><br><span class="line"><span class="comment">//hello 8</span></span><br><span class="line"><span class="comment">//hello 8</span></span><br><span class="line"><span class="comment">//hello 8</span></span><br><span class="line"><span class="comment">//hello 8</span></span><br></pre></td></tr></table></div></figure></p><h2 id="Generic">Generic<a href="post/swift-study-note#Generic"></a></h2><p>æ³›å‹ï¼š åªå…³å¿ƒå…·ä½“æ“ä½œï¼Œä¸å…³å¿ƒå…·ä½“ç±»å‹<br><strong>1.</strong> ç”¨åœ¨æ–¹æ³•ä¸Š<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swapTwoThings</span>&lt;T&gt;<span class="params">(a: <span class="keyword">inout</span> T, b: <span class="keyword">inout</span> T)</span></span> &#123;</span><br><span class="line">    (a, b) = (b, a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hello = <span class="string">"Hello"</span></span><br><span class="line"><span class="keyword">var</span> bye = <span class="string">"Bye"</span></span><br><span class="line">swapTwoThings(a: &amp;hello, b: &amp;bye)</span><br><span class="line">hello <span class="comment">// "Bye"</span></span><br><span class="line">bye <span class="comment">// "Hello"</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> ç”¨åœ¨ç±»å‹ä¸Š<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Stack</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> items = [<span class="type">T</span>]()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span>  <span class="title">isEmpty</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> items.<span class="built_in">count</span> == <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">push</span><span class="params">(<span class="number">_</span> item: T)</span></span> &#123;</span><br><span class="line">        items.append(item)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">pop</span><span class="params">()</span></span> -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">        <span class="keyword">guard</span> !<span class="keyword">self</span>.isEmpty() <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> items.removeLast()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Stack</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">top</span><span class="params">()</span></span> -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">        <span class="keyword">return</span> items.last</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">count</span><span class="params">()</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> items.<span class="built_in">count</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s = <span class="type">Stack</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line">s.push(<span class="number">1</span>)</span><br><span class="line">s.push(<span class="number">2</span>)</span><br><span class="line">s.pop()</span><br></pre></td></tr></table></div></figure></p><h2 id="protocol">protocol<a href="post/swift-study-note#protocol"></a></h2><p><strong>1.</strong> åè®®çš„åŸºæœ¬ä½¿ç”¨<br>åè®®ï¼›<br>åªå®šä¹‰ï¼Œä¸å®ç°ï¼›<br>ä¸èƒ½ä¸ºåè®®è®¾ç½®é»˜è®¤çš„å‚æ•°å€¼ï¼Œå˜é‡ä¹Ÿä¸èƒ½æœ‰é»˜è®¤å€¼ï¼›<br>å˜é‡åªèƒ½ç”¨var<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// protocol Pet: class &#123;&#125; è¡¨ç¤ºå¦‚æœåè®®ç»§æ‰¿classï¼Œåˆ™è¯¥åè®®ä¸èƒ½åº”ç”¨äºç»“æ„ä½“</span></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Pet</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä¸èƒ½å³åˆå§‹å€¼</span></span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> &#123; <span class="keyword">get</span> <span class="keyword">set</span> &#125;</span><br><span class="line">    <span class="comment">// ç»Ÿä¸€ä½¿ç”¨varå…³é”®å­—</span></span><br><span class="line">    <span class="keyword">var</span> birthPlace: <span class="type">String</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹äºæ–¹æ³•ï¼Œä¸èƒ½æœ‰å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">playWith</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹äºæ–¹æ³•ï¼Œä¸èƒ½æœ‰é»˜è®¤å‚æ•°ï¼ˆé»˜è®¤å‚æ•°å°±æ˜¯ä¸€ç§å®ç°ï¼‰</span></span><br><span class="line">    <span class="comment">// func fed(food: String = "leftover")</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fed</span><span class="params">()</span></span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fed</span><span class="params">(food: String)</span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯ä»¥ä½¿ç”¨mutatingå…³é”®å­—ï¼Œå¼ºè°ƒåœ¨ç»“æ„ä½“é‡åº”è¯¥ä¿®æ”¹å…¶ä¸­å†…å®¹</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">changeName</span><span class="params">(newName: String)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åè®®å¯ç»§æ‰¿</span></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">PetBird</span>: <span class="title">Pet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> flySpeed: <span class="type">Double</span>&#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    <span class="keyword">var</span> flyHeight: <span class="type">Double</span>&#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Dog</span>: <span class="title">Pet</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¯ä»¥ä½¿ç”¨è®¡ç®—å‹å±æ€§</span></span><br><span class="line">    <span class="comment">//    private var myDoggyName = "Puppy"</span></span><br><span class="line">    <span class="comment">//    var name: String&#123;</span></span><br><span class="line">    <span class="comment">//        get&#123;</span></span><br><span class="line">    <span class="comment">//            return myDoggyName</span></span><br><span class="line">    <span class="comment">//        &#125;</span></span><br><span class="line">    <span class="comment">//        set&#123;</span></span><br><span class="line">    <span class="comment">//            myDoggyName = newValue</span></span><br><span class="line">    <span class="comment">//        &#125;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åè®®ä¸­å®šä¹‰çš„åªè¯»ï¼Œå¯¹äºä¸€ä¸ªå…·ä½“ç±»çš„å®ç°ï¼Œä¸ä¸€å®šæ˜¯åªè¯»ï¼Œä½†æ˜¯ä½œä¸ºPetæ—¶æ˜¯åªè¯»çš„ï¼</span></span><br><span class="line">    <span class="comment">// let birthPlace: String</span></span><br><span class="line">    <span class="keyword">var</span> birthPlace: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">playWith</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Wong!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fed</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"I want a bone."</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨å…·ä½“å®ç°ä¸Šå¯ä»¥åŠ é»˜è®¤å‚æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fed</span><span class="params">(food: String = <span class="string">"Bone"</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">changeName</span><span class="params">(newName: String)</span></span> &#123;</span><br><span class="line">        name = newName</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myDog: <span class="type">Dog</span> = <span class="type">Dog</span>(name: <span class="string">"summer"</span>, birthPlace: <span class="string">"beijing"</span>)</span><br><span class="line">myDog.birthPlace = <span class="string">"beijing"</span></span><br><span class="line"><span class="keyword">var</span> aPet: <span class="type">Pet</span> = myDog</span><br><span class="line"><span class="comment">// å½“ä½œä¸ºPetæ¥æ“ä½œçš„æ—¶å€™ï¼Œæ˜¯æ— æ³•ä¸ºbirthPlaceèµ‹å€¼çš„</span></span><br><span class="line"><span class="comment">// aPet.birthPlace = "shanghai"</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> åè®®å’Œæ„é€ å‡½æ•°<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Pet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> &#123; <span class="keyword">get</span> <span class="keyword">set</span> &#125;</span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> type: <span class="type">String</span> = <span class="string">"mammal"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœä¸€ä¸ªç±»æœ‰ç»§æ‰¿çš„ç±»ï¼Œåˆ™ç±»å¿…é¡»æ”¾åœ¨å‰é¢</span></span><br><span class="line"><span class="comment">// çˆ¶ç±»åªèƒ½æœ‰ä¸€ä¸ªï¼Œ åè®®å¯ä»¥æœ‰å¤šä¸ª</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>: <span class="title">Animal</span>, <span class="title">Pet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> = <span class="string">"Pup"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœprotocolæœ‰initï¼Œ åˆ™åœ¨classä¸­å¿…é¡»å£°æ˜requiredï¼Œå¼ºåˆ¶è®©å­ç±»å®ç°</span></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span>: <span class="title">Animal</span>, <span class="title">Pet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯final classï¼Œinitå¯ä»¥æ²¡æœ‰requiredï¼Œå› ä¸ºå®ƒä¸å†ä¼šè¢«ç»§æ‰¿</span></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bird</span>: <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> = <span class="string">"bird ..."</span></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="comment">// çœç•¥...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parrot</span>: <span class="title">Bird</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœåªç»§æ‰¿Birdï¼Œåˆ™åªéœ€è¦åŠ overrideæˆ–Bird initæ˜¯requiredï¼Œé‚£ä¹ˆåªéœ€è¦required</span></span><br><span class="line">    <span class="comment">// å› ä¸ºæœ‰Petï¼Œ åˆ™requiredä¹Ÿä¸èƒ½çœç•¥</span></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">override</span> <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(name: name + <span class="string">" "</span> + name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> ä¸ºä»€ä¹ˆä½¿ç”¨åè®®<br>åè®®æè¿°çš„æ˜¯æŸç§ç‰¹æ€§ï¼›<br>å¦‚ä¸‹é¢çš„ä¾‹å­ï¼Œé€šè¿‡åè®®ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç»§æ‰¿è‡ªä¸åŒçˆ¶ç±»ä¸åŒç±»å‹çš„ä¸œè¥¿ï¼Œç”±äºæŸç§ä¸€æ ·çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä¾è¿™ç‰¹æ€§æŠŠå®ƒä»¬å½’ä¸ºä¸€ç±»ã€‚<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Pet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> &#123; <span class="keyword">get</span> <span class="keyword">set</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Flyable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> flySpeed: <span class="type">Double</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    <span class="keyword">var</span> flyHeight: <span class="type">Double</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>: <span class="title">Animal</span>, <span class="title">Pet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> = <span class="string">"Puppy"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span>: <span class="title">Animal</span>, <span class="title">Pet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> = <span class="string">"Kitten"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bird</span>: <span class="title">Animal</span>, <span class="title">Flyable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> flySpeed: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">var</span> flyHeight: <span class="type">Double</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(flySpeed: <span class="type">Double</span>, flyHeight: <span class="type">Double</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.flySpeed = flySpeed</span><br><span class="line">        <span class="keyword">self</span>.flyHeight = flyHeight</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parrot</span>: <span class="title">Bird</span>, <span class="title">Pet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>, flySpeed: <span class="type">Double</span>, flyHeight: <span class="type">Double</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name + <span class="string">" "</span> + name</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(flySpeed: flySpeed, flyHeight: flyHeight)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sparrow</span>: <span class="title">Bird</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> color = <span class="type">UIColor</span>.gray</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Plane</span>: <span class="title">Vehicle</span>, <span class="title">Flyable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> model: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> flySpeed: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">var</span> flyHeight: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">init</span>(model: <span class="type">String</span>, flySpeed: <span class="type">Double</span>, flyHeight: <span class="type">Double</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.model = model</span><br><span class="line">        <span class="keyword">self</span>.flyHeight = flyHeight</span><br><span class="line">        <span class="keyword">self</span>.flySpeed = flySpeed</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dog = <span class="type">Dog</span>()</span><br><span class="line"><span class="keyword">var</span> cat = <span class="type">Cat</span>()</span><br><span class="line"><span class="keyword">var</span> parrot = <span class="type">Parrot</span>(name: <span class="string">"hi"</span>, flySpeed: <span class="number">10.0</span>, flyHeight: <span class="number">100.0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> pets: [<span class="type">Pet</span>] = [dog, cat, parrot]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sparrow = <span class="type">Sparrow</span>(flySpeed: <span class="number">15.0</span>, flyHeight: <span class="number">80.0</span>)</span><br><span class="line"><span class="keyword">var</span> plane = <span class="type">Plane</span>(model: <span class="string">"Boeing 747"</span>, flySpeed: <span class="number">200.0</span>, flyHeight: <span class="number">10_000</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> flyers: [<span class="type">Flyable</span>] = [parrot, sparrow, plane]</span><br><span class="line"><span class="keyword">for</span> flyer <span class="keyword">in</span> flyers &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Fly speed: \(flyer.flySpeed), Fly Height: \(flyer.flyHeight)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> ç±»å‹åˆ«å(typealias)<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typealias</span> <span class="type">Length</span> = <span class="type">Double</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Double</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> m: <span class="type">Length</span> &#123; <span class="keyword">return</span> <span class="keyword">self</span> &#125;</span><br><span class="line">    <span class="keyword">var</span> cm: <span class="type">Length</span> &#123; <span class="keyword">return</span> <span class="keyword">self</span> * <span class="number">100.0</span> &#125;</span><br><span class="line">    <span class="keyword">var</span> km: <span class="type">Length</span> &#123; <span class="keyword">return</span> <span class="keyword">self</span> / <span class="number">1000.0</span> &#125;</span><br><span class="line">    <span class="keyword">var</span> ft: <span class="type">Length</span> &#123; <span class="keyword">return</span> <span class="keyword">self</span> / <span class="number">3.28084</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> runningDistance: <span class="type">Length</span> = <span class="number">3.54</span>.km</span><br><span class="line">runningDistance</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨çš„æ—¶å€™ç›´æ¥ä½¿ç”¨AudioSampleï¼Œå¦‚æœéœ€è¦æ”¹ä¸ºUInt32æˆ–å…¶å®ƒæ—¶ç›´æ¥æ”¹è¿™é‡Œï¼Œè€Œä¸å¿…æ¯ä¸ªåœ°æ–¹éƒ½å»æ”¹</span></span><br><span class="line"><span class="keyword">typealias</span> <span class="type">AudioSample</span> = <span class="type">UInt64</span></span><br></pre></td></tr></table></div></figure></p><p><strong>4.</strong> å¹¶è”ç±»å‹(associatedtype)ï¼Œåœ¨åè®®ä¸­ä½¿ç”¨åˆ«å<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">WeightCalculable</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åè®®ä¸­å£°æ˜å®ç°ç±»éœ€è¦ä½¿ç”¨åˆ«åï¼Œç”¨associatedtype</span></span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">WeightType</span></span><br><span class="line">    <span class="keyword">var</span> weight: <span class="type">WeightType</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨å…·ä½“å®ç°ç±»ä¸­ï¼Œç”¨typealias</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">iPhone7</span>: <span class="title">WeightCalculable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">WeightType</span> = <span class="type">Double</span></span><br><span class="line">    <span class="keyword">var</span> weight: <span class="type">WeightType</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0.114</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ship</span>: <span class="title">WeightCalculable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">WeightType</span> = <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> weight: <span class="type">WeightType</span></span><br><span class="line">    <span class="keyword">init</span>(weight: <span class="type">WeightType</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.weight = weight</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Int</span> </span>&#123;</span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">Weight</span> = <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> t: <span class="type">Weight</span> &#123; <span class="keyword">return</span> <span class="number">1_000</span> * <span class="keyword">self</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> titanic = <span class="type">Ship</span>(weight: <span class="number">46_328_000</span>)</span><br></pre></td></tr></table></div></figure></p><p><strong>5.</strong> Swfitæ ‡å‡†åº“ä¸­çš„å¸¸ç”¨åè®®<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Record</span>: <span class="title">Equatable</span>, <span class="title">Comparable</span>, <span class="title">CustomStringConvertible</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> wins: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> losses: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åè®®CustomStringConvertibleä¸­çš„å®šä¹‰ï¼Œå¯ç›´æ¥è¢«printæ‰“å°</span></span><br><span class="line">    <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"WINS: \(wins), LOSSES: \(losses)"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> boolValue: <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> wins &gt; losses</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åè®®Equatableçš„ä½œç”¨ï¼Œæˆ‘ä»¬åªéœ€è¦å®ç°==ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨!=</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> ==<span class="params">(<span class="keyword">left</span>: Record, <span class="keyword">right</span>: Record)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">left</span>.wins == <span class="keyword">right</span>.wins &amp;&amp; <span class="keyword">left</span>.losses == <span class="keyword">right</span>.losses</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åè®®Comparableçš„ä½œç”¨ï¼Œå½“æˆ‘ä»¬å®šä¹‰äº†&lt;ï¼Œä¸Šé¢å³å®šä¹‰äº†==ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨&lt;=,&gt;,&gt;=</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> &lt;(left: Record, right: Record) -&gt; <span class="title">Bool</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">left</span>.wins != <span class="keyword">right</span>.wins &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">left</span>.wins &lt; <span class="keyword">right</span>.wins</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">left</span>.losses &gt; <span class="keyword">right</span>.losses</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> record = <span class="type">Record</span>(wins: <span class="number">10</span>, losses: <span class="number">5</span>)</span><br><span class="line"><span class="keyword">let</span> record2 = <span class="type">Record</span>(wins: <span class="number">11</span>, losses: <span class="number">5</span>)</span><br><span class="line">record &gt;= record2</span><br><span class="line"><span class="built_in">print</span>(record) <span class="comment">//WINS: 10, LOSSES: 5</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> records = [<span class="type">Record</span>(wins: <span class="number">10</span>, losses: <span class="number">3</span>), <span class="type">Record</span>(wins: <span class="number">8</span>, losses: <span class="number">5</span>), <span class="type">Record</span>(wins: <span class="number">8</span>, losses: <span class="number">8</span>)]</span><br><span class="line"><span class="comment">// å½“æˆ‘ä»¬å®ç°äº†Comparableï¼Œå¯ç›´æ¥æ’åº</span></span><br><span class="line">records.<span class="built_in">sort</span>()</span><br></pre></td></tr></table></div></figure></p><h2 id="é¢å‘åè®®ç¼–ç¨‹">é¢å‘åè®®ç¼–ç¨‹<a href="post/swift-study-note#é¢å‘åè®®ç¼–ç¨‹"></a></h2><p><strong>1.</strong> æ‰©å±•åè®®å’Œé»˜è®¤å®ç°<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Record</span>: <span class="title">CustomStringConvertible</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> wins: <span class="type">Int</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    <span class="keyword">var</span> losses: <span class="type">Int</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">winningPercent</span><span class="params">()</span></span> -&gt; <span class="type">Double</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰©å±•ä¸€ä¸ªåè®®çš„æ—¶å€™ï¼Œå¯ä»¥å¯¹åè®®è¿›è¡Œå®ç°</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Record</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®ç°CustomStringConvertibleåè®®ä¸­çš„descriptionï¼Œå®ç°Recordçš„å°±å¯ä»¥ä¸ç”¨å®ç°è¿™ä¸ª</span></span><br><span class="line">    <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"WINS: \(wins), LOSSES: \(losses)"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰©å±•åè®®ä¸­è¿˜å¯ä»¥å†™å…¶ä»–æ–¹æ³•çš„å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">shoutWins</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"WE WIN"</span>, wins, <span class="string">"TIMES!!!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰©å±•ä¸­è¿˜å¯ä»¥å¯¹å®šä¹‰çš„å˜é‡è¿›è¡Œè®¡ç®—ï¼Œè®¡ç®—çš„æ˜¯å¯¹åº”å®ç°ç±»ä¸­å€¼</span></span><br><span class="line">    <span class="keyword">var</span> gamePlayed: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> wins + losses</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BaseballRecord</span>: <span class="title">Record</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> wins: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> losses: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">winningPercent</span><span class="params">()</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Double</span>(wins) / <span class="type">Double</span>(gamePlayed)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> teamRecord = <span class="type">BaseballRecord</span>(wins: <span class="number">2</span>, losses: <span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(teamRecord)</span><br><span class="line">teamRecord.shoutWins()</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰©å±•æ ‡å‡†åº“ä¸­çš„åè®®</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">CustomStringConvertible</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> descriptionWithDate: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">NSData</span>().description + <span class="string">" "</span> + description</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(teamRecord.descriptionWithDate)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡º</span></span><br><span class="line"><span class="comment">// WINS: 2, LOSSES: 10</span></span><br><span class="line"><span class="comment">// WE WIN 2 TIMES!!!</span></span><br><span class="line"><span class="comment">// &lt;&gt; WINS: 2, LOSSES: 10</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> æ ¹æ®æ¡ä»¶æ‰©å±•åè®®<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Record</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> wins: <span class="type">Int</span> &#123;<span class="keyword">get</span>&#125;</span><br><span class="line">    <span class="keyword">var</span> losses: <span class="type">Int</span> &#123;<span class="keyword">get</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Record</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> gamePlayed: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> wins + losses</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">winningPercent</span><span class="params">()</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Double</span>(wins) / <span class="type">Double</span>(gamePlayed)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Tieable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> ties: <span class="type">Int</span> &#123;<span class="keyword">get</span> <span class="keyword">set</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¯¥æ‰©å±•è¡¨ç¤ºï¼šå®ç°è¯¥åè®®çš„å®ä¾‹åˆå®ç°äº†Tieableåè®®ä¼šè¿›å…¥è¿™ä¸ªæ‰©å±•</span></span><br><span class="line"><span class="comment">// ç”±äºå®ç°äº†Tieableæ‰©å±•åçš„å®ä½“éœ€è¦æ”¹å˜ä¸€äº›è®¡ç®—æ–¹å¼</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Record</span> <span class="title">where</span> <span class="title">Self</span>: <span class="title">Tieable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> gamePlayed: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> wins + losses + ties</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœä¸å†™è¦†å†™è¿™ä¸ªæ–¹æ³•ï¼Œå®ä¾‹ä¼šè°ƒç”¨ä¸Šé¢æ‰©å±•ä¸­çš„æ–¹æ³•ï¼Œå¹¶è°ƒç”¨ä¸Šé¢æ‰©å±•ä¸­çš„gamePlayedï¼Œä¼šå¯¼è‡´è®¡ç®—ç»“æœä¸å¯¹</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">winningPercent</span><span class="params">()</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Double</span>(wins) / <span class="type">Double</span>(gamePlayed) <span class="comment">// gamePlayed = wins + losses + ties</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FootballRecord</span>: <span class="title">Record</span>, <span class="title">Tieable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> wins: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> losses: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> ties: <span class="type">Int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> footballTeam = <span class="type">FootballRecord</span>(wins: <span class="number">1</span>, losses: <span class="number">1</span>, ties: <span class="number">1</span>)</span><br><span class="line">footballTeam.gamePlayed</span><br><span class="line">footballTeam.winningPercent()</span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> åè®®èšåˆ<br>åœ¨æ–¹æ³•çš„å‚æ•°ä¸­èšåˆå¤šä¸ªåè®®ä¸ºä¼ å…¥æ¡ä»¶<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Prizable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">isPrizable</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯¥æ–¹æ³•è¡¨ç¤ºå®ä¾‹å¿…é¡»åŒæ—¶å®ç°äº†CustomStringConvertibleå’ŒPrizableä¸¤ä¸ªåè®®æ‰èƒ½ä¼ å…¥</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">award</span><span class="params">(one: CustomStringConvertible &amp; Prizable)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> one.isPrizable()&#123;</span><br><span class="line">        <span class="built_in">print</span>(one)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Congratulation! You won a prize!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">print</span>(one)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"You can not have the prize!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span>: <span class="title">CustomStringConvertible</span>, <span class="title">Prizable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> score: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(score: <span class="type">Int</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.score = score</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"score = \(score)"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">isPrizable</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> score &gt; <span class="number">60</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">award(one: <span class="type">Student</span>(score: <span class="number">80</span>))</span><br></pre></td></tr></table></div></figure></p><p><strong>4.</strong> æ³›å‹çº¦æŸ<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ å…¥æ•°ç»„ï¼Œæ‰¾å‡ºæœ€å¤§å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">topOne</span>&lt;T: Comparable&gt;<span class="params">(seq:[T])</span></span> -&gt; <span class="type">T</span> &#123;</span><br><span class="line">    <span class="built_in">assert</span>(seq.<span class="built_in">count</span> &gt; <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> seq.<span class="built_in">reduce</span>(seq[<span class="number">0</span>]) &#123; <span class="built_in">max</span>($<span class="number">0</span>, $<span class="number">1</span>) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">topOne(seq: [<span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br></pre></td></tr></table></div></figure></p><p><strong>5.</strong> åˆ›å»ºè‡ªå·±çš„å§”æ‰˜æ¨¡å¼<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">TurnBaseGameDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">gameStart</span><span class="params">()</span></span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">playMove</span><span class="params">()</span></span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">gameEnd</span><span class="params">()</span></span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">gameOver</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å›åˆåˆ¶æ¸¸æˆ</span></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">TurnBasedGame</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> turn: <span class="type">Int</span> &#123; <span class="keyword">get</span> <span class="keyword">set</span> &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">play</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ç°äº†æ¸¸æˆçš„é€»è¾‘ï¼Œä½†æ˜¯å…·ä½“æ˜¯ä»€ä¹ˆæ¸¸æˆä¸çŸ¥é“ï¼Œå§”æ‰˜å‡ºå»åˆ«äººå®ç°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SinglePlayerTurnBasedGame</span>: <span class="title">TurnBasedGame</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> delegate: <span class="type">TurnBaseGameDelegate</span>!</span><br><span class="line">    <span class="keyword">var</span> turn = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">play</span><span class="params">()</span></span> &#123;</span><br><span class="line">        delegate.gameStart()</span><br><span class="line">        <span class="keyword">while</span> !delegate.gameOver() &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"ROUND"</span>, turn, <span class="string">":"</span>)</span><br><span class="line">            delegate.playMove()</span><br><span class="line">            turn += <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        delegate.gameEnd()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ç°äº†å§”æ‰˜çš„åè®®</span></span><br><span class="line"><span class="comment">// æ·éª°å­æ¸¸æˆ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RollNumberGame</span>: <span class="title">SinglePlayerTurnBasedGame</span>, <span class="title">TurnBaseGameDelegate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> score = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">        delegate = <span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">gameStart</span><span class="params">()</span></span> &#123;</span><br><span class="line">        score = <span class="number">0</span></span><br><span class="line">        turn = <span class="number">0</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Welcome to Roll Number Game."</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Try to use least turn to make total 100 scores!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">playMove</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> rollNumber = <span class="type">Int</span>(arc4random() % <span class="number">6</span>) + <span class="number">1</span></span><br><span class="line">        score += rollNumber</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"You rolled a"</span>, rollNumber, <span class="string">"! The score is"</span>, score, <span class="string">"now!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">gameEnd</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Congratulation! You win the game in"</span>, turn, <span class="string">"ROUND!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">gameOver</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> score &gt;= <span class="number">30</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> rollingNumber = <span class="type">RollNumberGame</span>()</span><br><span class="line">rollingNumber.play()</span><br></pre></td></tr></table></div></figure></p><p><strong>6.</strong> å¯é€‰çš„åè®®æ–¹æ³•<br>å¯é€‰æ–¹æ³•éœ€è¦ç”¨@objcæ ‡è®°ï¼Œå®ç°çš„å®ä½“å¯å®ç°ï¼Œå¯ä¸å®ç°ï¼Œç”¨çš„æ—¶å€™å½“åšå¯é€‰ç±»å‹æ¥ç”¨<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@objc</span> <span class="class"><span class="keyword">protocol</span> <span class="title">TurnBaseGameDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">gameStart</span><span class="params">()</span></span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">playMove</span><span class="params">()</span></span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">gameEnd</span><span class="params">()</span></span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">gameOver</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">optional</span> <span class="function"><span class="keyword">func</span> <span class="title">turnStart</span><span class="params">()</span></span></span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">optional</span> <span class="function"><span class="keyword">func</span> <span class="title">turnEnd</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><h2 id="é”™è¯¯å¤„ç†">é”™è¯¯å¤„ç†<a href="post/swift-study-note#é”™è¯¯å¤„ç†"></a></h2><p><strong>1.</strong> å¼ºåˆ¶é€€å‡ºç¨‹åº<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">assert</span>(<span class="number">1</span>&lt;<span class="number">0</span>, <span class="string">"Error msg"</span>) <span class="comment">// åªåœ¨æµ‹è¯•é˜¶æ®µæ‰æœ‰æ•ˆ</span></span><br><span class="line"><span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment">// Assertion failed: Error msg: file LearnError.playground, line 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//===========================================</span></span><br><span class="line"><span class="built_in">assertionFailure</span>()</span><br><span class="line"><span class="comment">//è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment">//Fatal error: file LearnError.playground, line 7</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//===========================================</span></span><br><span class="line"><span class="built_in">assertionFailure</span>(<span class="string">"Error msg"</span>)</span><br><span class="line"><span class="comment">//è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment">//Fatal error: Error msg: file LearnError.playground, line 7</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//===========================================</span></span><br><span class="line"><span class="built_in">precondition</span>(<span class="number">1</span>&gt;<span class="number">0</span>) <span class="comment">// æ»¡è¶³æ¡ä»¶ä¹Ÿä¼šé€€å‡º</span></span><br><span class="line"><span class="built_in">precondition</span>(<span class="number">1</span>&gt;<span class="number">0</span>, <span class="string">"Error"</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">fatalError</span>(<span class="string">"Error"</span>) <span class="comment">// ä¸¥é‡çš„é”™è¯¯</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> é”™è¯¯å¤„ç†<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VendingMachine</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">        <span class="class"><span class="keyword">enum</span> <span class="title">ItemType</span>: <span class="title">String</span> </span>&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="type">Water</span></span><br><span class="line">            <span class="keyword">case</span> <span class="type">Cola</span></span><br><span class="line">            <span class="keyword">case</span> <span class="type">Juice</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> type: <span class="type">ItemType</span></span><br><span class="line">        <span class="keyword">let</span> price: <span class="type">Int</span></span><br><span class="line">        <span class="keyword">var</span> <span class="built_in">count</span>: <span class="type">Int</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">ItemError</span>: <span class="title">Error</span>, <span class="title">CustomStringConvertible</span> </span>&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="type">NoSuchItem</span></span><br><span class="line">        <span class="keyword">case</span> <span class="type">NotEnoughMoney</span>(<span class="type">Int</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="type">OutOfStock</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">            <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">            <span class="keyword">case</span> .<span class="type">NoSuchItem</span>:                 <span class="keyword">return</span> <span class="string">"Not Such Item"</span></span><br><span class="line">            <span class="keyword">case</span> .<span class="type">NotEnoughMoney</span>(<span class="keyword">let</span> price) : <span class="keyword">return</span> <span class="string">"Not Enough Money. \(price) Yuan needed."</span></span><br><span class="line">            <span class="keyword">case</span> .<span class="type">OutOfStock</span>:                 <span class="keyword">return</span> <span class="string">"Out of Stock"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> items = [<span class="string">"MIneral Water"</span>: <span class="type">Item</span>(type: .<span class="type">Water</span>, price: <span class="number">2</span>, <span class="built_in">count</span>: <span class="number">10</span>),</span><br><span class="line">                         <span class="string">"Coca Cola"</span>: <span class="type">Item</span>(type: .<span class="type">Cola</span>, price: <span class="number">3</span>, <span class="built_in">count</span>: <span class="number">5</span>),</span><br><span class="line">                         <span class="string">"Orange Juice"</span>: <span class="type">Item</span>(type: .<span class="type">Juice</span>, price: <span class="number">5</span>, <span class="built_in">count</span>: <span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">vend</span><span class="params">(itemName: String, money: Int)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> item = items[itemName] <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="type">ItemError</span>.<span class="type">NoSuchItem</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> money &gt;= item.price <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="type">ItemError</span>.<span class="type">NotEnoughMoney</span>(item.price)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> item.<span class="built_in">count</span> &gt; <span class="number">0</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="type">ItemError</span>.<span class="type">OutOfStock</span></span><br><span class="line">        &#125;</span><br><span class="line">        items[itemName]!.<span class="built_in">count</span> -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> money - item.price</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">display</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Want something to drink?"</span>)</span><br><span class="line">        <span class="keyword">for</span> itemName <span class="keyword">in</span> items.keys &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"*"</span>, itemName)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"==========================="</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> machine = <span class="type">VendingMachine</span>()</span><br><span class="line">machine.display()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pocketMoney = <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯èƒ½æŠ›å‡ºå¼‚å¸¸ï¼Œä½†ä¸ç®¡ä¸é¡¾ï¼ŒæŠ›å‡ºå¼‚å¸¸åç›´æ¥å´©æºƒ</span></span><br><span class="line">pocketMoney = <span class="keyword">try</span>! machine.vend(itemName: <span class="string">"Coca Cola"</span>, money: pocketMoney)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœæŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™å¾—åˆ°ä¸€ä¸ªnil</span></span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">try</span>? machine.vend(itemName: <span class="string">"Coca Cola"</span>, money: pocketMoney)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼‚å¸¸å¤„ç†ï¼Œå¦‚æœæŠ›å‡ºå¼‚å¸¸åˆ™è¿›å…¥å¯¹åº”çš„å¼‚å¸¸å¤„ç†ï¼Œå¦‚æœéƒ½æ²¡æœ‰æ•è·åˆ°ï¼Œåˆ™è¿›å…¥æœ€åä¸€ä¸ªå¤„ç†</span></span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">    pocketMoney = <span class="keyword">try</span> machine.vend(itemName: <span class="string">"Coca Cola"</span>, money: pocketMoney)</span><br><span class="line">    <span class="built_in">print</span>(pocketMoney,<span class="string">"Yuan left"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> <span class="type">VendingMachine</span>.<span class="type">ItemError</span>.<span class="type">NoSuchItem</span>&#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"No Such Item"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> <span class="type">VendingMachine</span>.<span class="type">ItemError</span>.<span class="type">NotEnoughMoney</span>(<span class="keyword">let</span> price)&#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Not Enough Money."</span> , price , <span class="string">"Yuan needed."</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> <span class="type">VendingMachine</span>.<span class="type">ItemError</span>.<span class="type">OutOfStock</span>&#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Out of Stock"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>&#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Error occured during vending."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•è·å¼‚å¸¸ï¼Œå¹¶å¾—åˆ°å¼‚å¸¸å®ä¾‹</span></span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">    pocketMoney = <span class="keyword">try</span> machine.vend(itemName: <span class="string">"Coca Cola"</span>, money: pocketMoney)</span><br><span class="line">    <span class="built_in">print</span>(pocketMoney,<span class="string">"Yuan left"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> <span class="keyword">let</span> error <span class="keyword">as</span> <span class="type">VendingMachine</span>.<span class="type">ItemError</span>&#123;</span><br><span class="line">    <span class="built_in">print</span>(error)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>&#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Error occured during vending."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> defer<br>ç›¸å½“äºjavaä¸­çš„fanallyï¼Œç”¨äºæŠ›å‡ºå¼‚å¸¸æˆ–æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸éƒ½éœ€è¦æ‰§è¡Œçš„è¯­å¥ï¼›<br>ä½¿ç”¨æ–¹å¼ï¼š<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">vend</span><span class="params">(itemName itemName: String, money: Int)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">Int</span>&#123;</span><br><span class="line">    <span class="comment">// å’Œä»£ç å¹³çº§</span></span><br><span class="line">    <span class="keyword">defer</span>&#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Have a nice day"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> item = items[itemName] <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="type">VendingMachine</span>.<span class="type">ItemError</span>.<span class="type">NoSuchItem</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæœ‰å¤šä¸ªdeferï¼Œåˆ™ä¼šå€’å™æ‰§è¡Œ</span></span><br><span class="line">    <span class="comment">// å¦‚æœå‰æ–¹å°±æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™è¯¥å±€ä¸ä¼šæ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">defer</span>&#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Thank you"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> money - item.price</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></p><h2 id="å†…å­˜ç®¡ç†">å†…å­˜ç®¡ç†<a href="post/swift-study-note#å†…å­˜ç®¡ç†"></a></h2><p><strong>1.</strong> ææ„å‡½æ•°ï¼Œå®ä¾‹é”€æ¯å‰åœ¨è¿™é‡Œåšä¸€äº›å¤„ç†ã€‚ç”±äºå†…å­˜è‡ªåŠ¨é”€æ¯å®ä¾‹ç”¨çš„æƒ…å†µæ¯”è¾ƒå°‘<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"init..."</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">doSomething</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"doing something"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">deinit</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"person is leaving!!!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person: <span class="type">Person</span>? = <span class="type">Person</span>()</span><br><span class="line"><span class="comment">// å½“èµ‹å€¼ä¸ºnilåï¼Œå®ä¾‹ä¼šè¢«é”€æ¯</span></span><br><span class="line">person = <span class="literal">nil</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“å®ä¾‹è¶…å‡ºä½œç”¨åŸŸåï¼Œå®ä¾‹ä¼šè¢«é”€æ¯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">inTheShop</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"======"</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Welcome"</span>)</span><br><span class="line">    <span class="keyword">let</span> person: <span class="type">Person</span> = <span class="type">Person</span>()</span><br><span class="line">    person.doSomething()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">inTheShop()</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡º</span></span><br><span class="line"><span class="comment">//init...</span></span><br><span class="line"><span class="comment">//person is leaving!!!</span></span><br><span class="line"><span class="comment">//======</span></span><br><span class="line"><span class="comment">//Welcome</span></span><br><span class="line"><span class="comment">//init...</span></span><br><span class="line"><span class="comment">//doing something</span></span><br><span class="line"><span class="comment">//person is leaving!!!</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> å¼•ç”¨è®¡æ•°<br>å½“å¼•ç”¨å®ä¾‹çš„å˜é‡ä¸º0çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±ä¼šè¢«é‡Šæ”¾ï¼›<br>ARCï¼šAutomatic Reference Count<br><strong>3.</strong> å¼ºå¼•ç”¨å¾ªç¯å’Œweak<br>weakå¿…é¡»æ˜¯ä¸€ä¸ªå¯é€‰å‹çš„å˜é‡<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> apartment: <span class="type">Apartment</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>()&#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Person is initialized"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">deinit</span>&#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Person is being deinitialized!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Apartment</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼±å¼•ç”¨å¿…é¡»æ˜¯å¯é€‰å‹</span></span><br><span class="line">    <span class="comment">// weakå¿…é¡»æ˜¯var</span></span><br><span class="line">    <span class="comment">// å½“å¼±å¼•ç”¨çš„å®ä¾‹è¢«é”€æ¯çš„æ—¶å€™ï¼Œtenantä¼šè¢«èµ‹å€¼ä¸ºnil</span></span><br><span class="line">    <span class="keyword">weak</span> <span class="keyword">var</span> tenant: <span class="type">Person</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>()&#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Apartment is initialized!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">deinit</span>&#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Apartment is being deinitialized!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> liuyubobobo: <span class="type">Person</span>? = <span class="type">Person</span>()</span><br><span class="line"><span class="keyword">var</span> imoocApartment: <span class="type">Apartment</span>? = <span class="type">Apartment</span>()</span><br><span class="line">liuyubobobo!.apartment = imoocApartment</span><br><span class="line">imoocApartment!.tenant = liuyubobobo</span><br><span class="line"></span><br><span class="line">liuyubobobo = <span class="literal">nil</span></span><br><span class="line">imoocApartment?.tenant <span class="comment">//nil</span></span><br><span class="line">imoocApartment = <span class="literal">nil</span></span><br><span class="line"><span class="comment">// ä¸¤ç§é¡ºåºå†…å­˜éƒ½èƒ½å¤Ÿæ­£ç¡®é‡Šæ”¾</span></span><br></pre></td></tr></table></div></figure></p><p><strong>4.</strong> unowned<br>å’Œä¸Šé¢ä¸€æ ·ä¹Ÿæ˜¯å¼±å¼•ç”¨ï¼ŒåŒºåˆ«åœ¨äºå®ƒåªèƒ½ä¿®é¥°å¸¸é‡letï¼Œä¸èƒ½æ˜¯å¯é€‰çš„ï¼›<br>æ·»åŠ äº†unownedçš„å®ä¾‹æœ€å¥½åœ¨unownedå¼•ç”¨çš„å¯¹è±¡ä¹‹å‰é”€æ¯ï¼Œå› ä¸ºå¦‚æœä¸è¿™æ ·è®¿é—®unownedå¸¸é‡æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸<br><strong>5.</strong> å¼ºå¼•ç”¨å¾ªç¯<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Country</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="comment">//let capital: City</span></span><br><span class="line">    <span class="keyword">var</span> capital: <span class="type">City</span>! <span class="comment">// ç”±äºå®šä¹‰æˆè¿™ç§éšå¼çš„å¯é€‰ï¼Œè¡¨ç¤ºå æ—¶ä¸ä¼šèµ‹å€¼ï¼Œä½†è‚¯å®šä¼šè¢«èµ‹å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(countryName: <span class="type">String</span>, capitalName: <span class="type">String</span>)&#123;</span><br><span class="line">        <span class="keyword">self</span>.name = countryName</span><br><span class="line">        <span class="comment">//-------ä¸¤æ®µæ„é€ ä»æ­¤åˆ†å‰²-------</span></span><br><span class="line">        <span class="keyword">self</span>.capital = <span class="type">City</span>(cityName: capitalName, country: <span class="keyword">self</span>) <span class="comment">// ç”±äºå æ—¶ä¸ç”¨èµ‹å€¼ï¼Œæ‰€ä»¥åˆ°äº†ç¬¬äºŒæ®µæ„é€ ï¼Œäºæ˜¯å¯ä»¥ä½¿ç”¨self</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Country"</span>, name, <span class="string">"is intialized."</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">deinit</span>&#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Country"</span>,name,<span class="string">"is being deinitialized!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">City</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">unowned</span> <span class="keyword">let</span> country: <span class="type">Country</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(cityName: <span class="type">String</span>, country: <span class="type">Country</span>)&#123;</span><br><span class="line">        <span class="keyword">self</span>.name = cityName</span><br><span class="line">        <span class="keyword">self</span>.country = country</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"City"</span>, name, <span class="string">"is intialized."</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">deinit</span>&#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"City"</span>,name,<span class="string">"is being deinitialized!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> china: <span class="type">Country</span>? = <span class="type">Country</span>(countryName: <span class="string">"China"</span>, capitalName: <span class="string">"Beijing"</span>)</span><br><span class="line">china = <span class="literal">nil</span></span><br></pre></td></tr></table></div></figure></p><p><strong>6.</strong> é—­åŒ…ä¸­çš„å¼ºå¼•ç”¨å¾ªç¯<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SmartAirConditioner</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> temperature: <span class="type">Int</span> = <span class="number">26</span></span><br><span class="line">    <span class="keyword">var</span> temperatureChange: ((<span class="type">Int</span>) -&gt; ())!</span><br><span class="line">    <span class="keyword">init</span>()&#123;</span><br><span class="line">        temperatureChange = &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>]newTemperature <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> `<span class="keyword">self</span>` = <span class="keyword">self</span> <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">abs</span>(newTemperature - <span class="keyword">self</span>.temperature) &gt;= <span class="number">10</span>&#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"It's not healthy to do it!"</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">self</span>.temperature = newTemperature</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"New temperature \(newTemperature) is set!"</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">deinit</span>&#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Smart Air-conditioner is being deinitialized!"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> airCon: <span class="type">SmartAirConditioner</span>? = <span class="type">SmartAirConditioner</span>()</span><br><span class="line">airCon?.temperature</span><br><span class="line">airCon?.temperatureChange(<span class="number">100</span>)</span><br><span class="line">airCon?.temperatureChange(<span class="number">24</span>)</span><br><span class="line">airCon = <span class="literal">nil</span></span><br></pre></td></tr></table></div></figure></p><h2 id="ç±»å‹æ£€æŸ¥å’Œç±»å‹è½¬æ¢">ç±»å‹æ£€æŸ¥å’Œç±»å‹è½¬æ¢<a href="post/swift-study-note#ç±»å‹æ£€æŸ¥å’Œç±»å‹è½¬æ¢"></a></h2><p><strong>1.</strong> ç±»å‹æ£€æŸ¥<code>is</code><br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>: <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person: <span class="type">Person</span> = <span class="type">Student</span>()</span><br><span class="line"></span><br><span class="line">person <span class="keyword">is</span> <span class="type">Student</span> <span class="comment">// true</span></span><br></pre></td></tr></table></div></figure></p><p><strong>2.</strong> ç±»å‹è½¬æ¢<code>as</code><br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¡®å®šç±»å‹ï¼ˆå¤±è´¥æœ‰é£é™©ï¼‰</span></span><br><span class="line"><span class="keyword">let</span> stu1 = person <span class="keyword">as</span>! <span class="type">Student</span></span><br><span class="line"><span class="comment">// å¯é€‰ç±»å‹ï¼ˆå¤±è´¥ä¸ºnilï¼‰</span></span><br><span class="line"><span class="keyword">let</span> stu2 = person <span class="keyword">as</span>? <span class="type">Student</span></span><br></pre></td></tr></table></div></figure></p><p><strong>3.</strong> å¯ä»¥ç”¨åœ¨åè®®ä¸Š<br><strong>4.</strong> NSObject,AnyObjectå’ŒAny<br><figure class="highlight swift"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>)&#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//var objects: NSArray = [</span></span><br><span class="line"><span class="comment">//    CGFloat(3.1415926),</span></span><br><span class="line"><span class="comment">//    "imooc",</span></span><br><span class="line"><span class="comment">//    UIColor.blueColor(),</span></span><br><span class="line"><span class="comment">//    NSDate(),</span></span><br><span class="line"><span class="comment">//    Int(32),</span></span><br><span class="line"><span class="comment">//    Array&lt;Int&gt;([1,2,3])</span></span><br><span class="line"><span class="comment">//]</span></span><br><span class="line"><span class="comment">//var objects = [</span></span><br><span class="line"><span class="comment">//    CGFloat(3.1415926),</span></span><br><span class="line"><span class="comment">//    "imooc",</span></span><br><span class="line"><span class="comment">//    UIColor.blueColor(),</span></span><br><span class="line"><span class="comment">//    NSDate(),</span></span><br><span class="line"><span class="comment">//    Int(32),</span></span><br><span class="line"><span class="comment">//    Array&lt;Int&gt;([1,2,3]),</span></span><br><span class="line"><span class="comment">//    Person(name: "liuyubobobo")</span></span><br><span class="line"><span class="comment">//]</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//// a ä¸ºAnyObject</span></span><br><span class="line"><span class="comment">//let a = objects[0]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//var objects: [AnyObject] = [</span></span><br><span class="line"><span class="comment">//    CGFloat(3.1415926),</span></span><br><span class="line"><span class="comment">//    "imooc",</span></span><br><span class="line"><span class="comment">//    UIColor.blueColor(),</span></span><br><span class="line"><span class="comment">//    NSDate(),</span></span><br><span class="line"><span class="comment">//    Int(32),</span></span><br><span class="line"><span class="comment">//    Array&lt;Int&gt;([1,2,3]),</span></span><br><span class="line"><span class="comment">//    Person(name: "liuyubobobo")</span></span><br><span class="line"><span class="comment">//]</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//objects.append( &#123; (a:Int) -&gt; Int in</span></span><br><span class="line"><span class="comment">//    return a*a&#125; )</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> objects: [<span class="type">Any</span>] = [</span><br><span class="line">    <span class="type">CGFloat</span>(<span class="number">3.1415926</span>),</span><br><span class="line">    <span class="string">"imooc"</span>,</span><br><span class="line">    <span class="comment">//swift 2: UIColor.blueColor(),</span></span><br><span class="line">    <span class="comment">//swift3ä¸­ï¼Œé¢œè‰²ä»â€œxxxColor()â€å˜æˆäº†"xxx"ã€‚ç›´æ¥è°ƒç”¨UIColor.xxxå³å¯</span></span><br><span class="line">    <span class="type">UIColor</span>.blue,                <span class="comment">//swift 3</span></span><br><span class="line">    <span class="type">NSDate</span>(),</span><br><span class="line">    <span class="type">Int</span>(<span class="number">32</span>),</span><br><span class="line">    <span class="type">Array</span>&lt;<span class="type">Int</span>&gt;([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]),</span><br><span class="line">    <span class="type">Person</span>(name: <span class="string">"liuyubobobo"</span>)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">objects.append( &#123; (a:<span class="type">Int</span>) -&gt; <span class="type">Int</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> a*a&#125; )</span><br></pre></td></tr></table></div></figure></p><h2 id="ä¸€äº›æ³¨æ„äº‹é¡¹">ä¸€äº›æ³¨æ„äº‹é¡¹<a href="post/swift-study-note#ä¸€äº›æ³¨æ„äº‹é¡¹"></a></h2><p><strong>1.</strong> å˜é‡å¯ä»¥ç”¨ä¸­æ–‡ï¼Œæ”¯æŒUnicodeå­—ç¬¦ï¼Œå¹¶ä¸”å¯ä»¥ç”¨è¡¨æƒ…<br><strong>2.</strong> swiftæ²¡æœ‰ <code>++</code> <code>--</code> è¿ç®—<br><strong>3.</strong> ç±»å‹éƒ½éœ€è¦æ˜¾ç¤ºçš„è‡ªå·±å»è½¬æ¢<br><strong>4.</strong> Arrayã€Setã€Dictionaryã€Stringç­‰ç»“æ„ä½“éƒ½æ˜¯å€¼ç±»å‹çš„</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•ä¸€äº›swiftçš„åŸºæœ¬ç‰¹æ€§ï¼Œä»¥ä¾¿ä½¿ç”¨çš„æ—¶å€™æ–¹ä¾¿æŸ¥é˜…ã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Swift" scheme="https://blog.xujiaji.com/categories/Swift/"/>
    
    
      <category term="å­¦ä¹ " scheme="https://blog.xujiaji.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="ç¬”è®°" scheme="https://blog.xujiaji.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="Swift" scheme="https://blog.xujiaji.com/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>Dagger2 çš„æ·±å…¥åˆ†æä¸ä½¿ç”¨</title>
    <link href="https://blog.xujiaji.com/post/learn-dagger/index.html"/>
    <id>https://blog.xujiaji.com/post/learn-dagger/index.html</id>
    <published>2018-06-26T16:00:00.000Z</published>
    <updated>2019-04-08T06:55:53.838Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/main-mind.png" alt="è„‘å›¾" class="article-img"></p><h1 id="Dagger2-çš„æ·±å…¥åˆ†æä¸ä½¿ç”¨">Dagger2 çš„æ·±å…¥åˆ†æä¸ä½¿ç”¨<a href="post/learn-dagger#Dagger2-çš„æ·±å…¥åˆ†æä¸ä½¿ç”¨"></a></h1><p>å¬é—»Daggerå¤§åå¾ˆä¹…ï¼Œä½†ä¸€ç›´æ²¡æœ‰å»å­¦ï¼Œç›´åˆ°ä¸å¾—ä¸å­¦ ã€’â–½ã€’ã€‚<br>è¿™ä¸ªæ¡†æ¶å¼€å§‹çš„æ—¶ä¸æ˜¯å¾ˆå¥½ç†è§£ï¼Œçœ‹äº†ä¸€äº›æ–‡ç« è¿˜æ˜¯æ²¡æœ‰ç†è§£åˆ°ç²¾é«“ï¼Œä¼¼æ‡‚éæ‡‚ï¼Œäºæ˜¯è‡ªå·±åšäº†äº›ç®€å•çš„æµ‹è¯•ä»£ç è§‚å¯ŸDaggeræ³¨è§£çš„ä½œç”¨ã€‚å°†å­¦ä¹ å’Œç†è§£çš„è¿‡ç¨‹åˆ†äº«å‡ºæ¥ï¼Œå¸Œæœ›èƒ½å¸®åˆ°ä¸€äº›å­¦äº›Daggerçš„æœ‹å‹ï¼ŒåŒæ—¶æˆ‘ä¹Ÿå·©å›ºæ€»ç»“ä¸€ä¸‹ã€‚</p><p>æœ¬ç¯‡æ–‡ç« ä¸è®²ï¼ŒDaggerå“ªé‡Œå¥½å“ªé‡Œå¥½ï¼åªè®²æ€ä¹ˆç”¨çš„å’Œä¸€äº›åŸç†ï¼</p><h2 id="Daggeræ˜¯ä»€ä¹ˆï¼Ÿ">Daggeræ˜¯ä»€ä¹ˆï¼Ÿ<a href="post/learn-dagger#Daggeræ˜¯ä»€ä¹ˆï¼Ÿ"></a></h2><ul><li><p>Daggeræ˜¯ä¸€ä¸ªä¾èµ–æ³¨å…¥æ¡†æ¶ï¼ˆDependency injectionï¼‰ï¼Œç®€ç§°DIã€‚å‡å¦‚æœ‰Aå’ŒBä¸¤ä¸ªå¯¹è±¡ï¼ˆBç›¸å½“äºæ˜¯DIï¼‰ï¼ŒAä¸­å¹¶æ²¡æœ‰å¯¹è‡ªå·±å†…éƒ¨çš„æˆå‘˜è¿›è¡Œåˆå§‹åŒ–ï¼Œå®ƒçš„æˆå‘˜åˆå§‹åŒ–å…¨éƒ¨æ˜¯Bç±»æ³¨å…¥è¿›æ¥ã€‚</p></li><li><p>å¤§éƒ¨åˆ†æ³¨å…¥æ¡†æ¶æ˜¯åŸºäºåå°„å®ç°çš„ï¼ŒDaggeræ—¨åœ¨è§£å†³è®¸å¤šå›°æ‰°åŸºäºåå°„çš„è§£å†³æ–¹æ¡ˆçš„å¼€å‘å’Œæ€§èƒ½é—®é¢˜ï¼ŒDaggerçš„ä¾èµ–æ³¨å…¥æ˜¯é€šè¿‡javaä»£ç æ¥å®ç°çš„ã€‚ç›¸å½“äºä½ è‡ªå·±å¯ä»¥ç”¨javaæ‰‹å†™ä¾èµ–æ³¨å…¥ä»£ç ï¼Œä½†è¿™æ ·çš„è¯å°±ä¼šæ›´å¤§çš„å·¥ä½œé‡ï¼Œäºæ˜¯Daggeré€šè¿‡æ³¨è§£ç­‰å¸®æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆç›¸å…³çš„ä¾èµ–æ³¨å…¥é€»è¾‘ä»£ç ã€‚</p></li><li><p>é¢â€¦ï¼Œæœ‰ç‚¹ä¸€å¤´é›¾æ°´çš„æ„Ÿè§‰å§ï¼å¦‚æœå¤§å®¶æƒ³çŸ¥é“è¯¦ç»†æ¦‚å¿µçš„è¯ï¼Œå¯ä»¥å»æœç´¢ä¸€ä¸‹å•¦ï¼</p></li><li><p>åœ¨ä¸‹é¢æ‰€è®²çš„éƒ½æ˜¯ä»¥å®é™…çš„ä»£ç æ“ä½œä¸ºä¸»ï¼Œæ¥å»è§‚å¯Ÿç»“æœï¼Œä»£ç æœ¬ç¯‡ä¸ä¼šæ¶‰åŠAndroid é¡µé¢ï¼Œåªæƒ³é€šè¿‡ç®€å•çš„ä»£ç æ¥ç†æ¸…æ¥šDaggerç”ŸæˆDIçš„é€»è¾‘ã€‚</p></li></ul><h2 id="éœ€è¦æ·»åŠ çš„ä¾èµ–">éœ€è¦æ·»åŠ çš„ä¾èµ–<a href="post/learn-dagger#éœ€è¦æ·»åŠ çš„ä¾èµ–"></a></h2><p>å®˜æ–¹Dagger2é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/google/dagger" target="_blank" rel="noopener">https://github.com/google/dagger</a></p><figure class="highlight groovy"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation <span class="string">'com.google.dagger:dagger:2.15'</span></span><br><span class="line">    annotationProcessor <span class="string">'com.google.dagger:dagger-compiler:2.15'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h2 id="æ³¨è§£ä½¿ç”¨">æ³¨è§£ä½¿ç”¨<a href="post/learn-dagger#æ³¨è§£ä½¿ç”¨"></a></h2><p>æ¬¢è¿æ¥åˆ°æœ¬ç¯‡æœ€ç²¾å½©çš„åœ°æ–¹ï¼å‚è€ƒè‡ª<a href="https://google.github.io/dagger/users-guide" target="_blank" rel="noopener">å®˜æ–¹çš„ä½¿ç”¨æŒ‡å—</a></p><blockquote><p>ç¬¦å·å«ä¹‰å‚è€ƒè¡¨ï¼š</p></blockquote><div class="article-bounded"><div class="article-table"><table><thead><tr><th>ç¬¦å·â•â•â–¶</th><th><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/v-private.png" alt=""></th><th><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/v-m-private.png" alt=""></th><th><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/v-protected.png" alt=""></th><th><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/v-m-protected.png" alt=""></th><th><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611140949.png" alt=""></th><th><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611141014.png" alt=""></th><th><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611141038.png" alt=""></th><th><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611141100.png" alt=""></th></tr></thead><tbody><tr><td><strong>å«ä¹‰</strong>â•â•â–¶</td><td>privateå˜é‡</td><td>privateæ–¹æ³•</td><td>protectedå˜é‡</td><td>protectedæ–¹æ³•</td><td>åŒ…ç§æœ‰ å˜é‡</td><td>åŒ…ç§æœ‰æ–¹æ³•</td><td>public å˜é‡</td><td>public æ–¹æ³•</td></tr></tbody></table></div></div><div class="article-bounded"><div class="article-table"><table><thead><tr><th>ç¬¦å·</th><th>å«ä¹‰</th><th>ç®€å•ä¾‹å­</th></tr></thead><tbody><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611141212.png" alt=""></td><td>ç»§æ‰¿</td><td><code>class A{}</code><br><br><code>class B extend A{}</code></td></tr><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611141236.png" alt=""></td><td>å®ç°æ¥å£</td><td><code>interface I{}</code><br><br><code>class A implements I{}</code></td></tr><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611141305.png" alt=""></td><td>ä¾èµ–</td><td><code>class A{}</code><br><br><code>class B{</code><br>ã€€ã€€<code>void fun(A c) {}</code><br><br><code>}</code></td></tr><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611141339.png" alt=""></td><td>å¹¶è”</td><td><code>class A{}</code><br><br><code>class B{</code><br><br>ã€€ã€€<code>A a;</code><br><br><code>}</code></td></tr><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611141403.png" alt=""></td><td>class</td><td><code>class A{}</code></td></tr><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611141425.png" alt=""></td><td>abstract</td><td><code>abstract class A{}</code></td></tr><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611141449.png" alt=""></td><td>interface</td><td><code>interface A{}</code></td></tr><tr><td><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611141508.png" alt=""></td><td>enum</td><td><code>enum A{}</code></td></tr><tr><td><code>...</code></td><td>çœç•¥ä»£ç </td><td><code>class A {...}</code></td></tr></tbody></table></div></div><h3 id="å’–å•¡æœº">å’–å•¡æœº<a href="post/learn-dagger#å’–å•¡æœº"></a></h3><p>ç”¨å’–å•¡æœºçš„ä¾‹å­æ¥æ¼”ç¤ºï¼Œé¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸»è¦çš„å‡ ä¸ªç±»ï¼Œä¸‹é¢æ˜¯ç®€å•å’–å•¡æœºUMLå…³ç³»å›¾ï¼ï¼ˆæŸ¥è€ƒè‡ªDagger2é¡¹ç›®exampleï¼‰</p><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611141527.png" alt="å’–å•¡æœºUML" class="article-img"></p><blockquote><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¤§æ¦‚ä¼šå†™æˆè¿™æ ·ï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šä¹‰æ³µæ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Pump</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pump</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šä¹‰åŠ çƒ­å™¨æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Heater</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">off</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isHot</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”µå­åŠ çƒ­å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ElectricHeater</span> <span class="keyword">implements</span> <span class="title">Heater</span> </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> heating;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"~~~~heating~~~~"</span>);</span><br><span class="line">        <span class="keyword">this</span>.heating = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.heating = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isHot</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> heating;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çƒ­è™¹å¸</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Thermosiphon</span> <span class="keyword">implements</span> <span class="title">Pump</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Heater heater;</span><br><span class="line">    Thermosiphon(Heater heater) &#123;</span><br><span class="line">        <span class="keyword">this</span>.heater = heater;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pump</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (heater.isHot()) &#123;</span><br><span class="line">            System.out.println(<span class="string">"=&gt;=&gt; æŠ½æ°´ =&gt;=&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å’–å•¡æœº</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeMaker</span> </span>&#123;</span><br><span class="line">    Heater heater;</span><br><span class="line">    Pump pump;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CoffeeMaker</span><span class="params">(Heater heater, Pump pump)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.heater = heater;</span><br><span class="line">        <span class="keyword">this</span>.pump = pump;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">brew</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        heater.on();</span><br><span class="line">        pump.pump();</span><br><span class="line">        System.out.println(<span class="string">"[_]P coffee! [_]P"</span>);</span><br><span class="line">        heater.off();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‡ºå’–å•¡æµ‹è¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeApp</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Heater heater = <span class="keyword">new</span> ElectricHeater();<span class="comment">//å®ä¾‹åŒ–åŠ çƒ­å™¨</span></span><br><span class="line">        Pump pump = <span class="keyword">new</span> Thermosiphon(heater);<span class="comment">//å®ä¾‹åŒ–æ³µ</span></span><br><span class="line">        CoffeeMaker coffeeMaker = <span class="keyword">new</span> CoffeeMaker(heater, pump);<span class="comment">//å®ä¾‹åŒ–å’–å•¡æœº</span></span><br><span class="line">        coffeeMaker.brew();<span class="comment">//å‡ºå’–å•¡</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><h3 id="Inject">@Inject<a href="post/learn-dagger#Inject"></a></h3><p><strong><a href="https://github.com/xujiaji/learn-android/tree/master/LearnDagger/app/src/main/java/com/example/jiaji/daggertest/coffee2_test_inject" target="_blank" rel="noopener">æµ‹è¯•æ–‡ä»¶ä½ç½®</a></strong></p><ol><li><p>å…¶åï¼šæ³¨å…¥ï¼Œ@Injectçš„ç”¨æ³•æ˜¯æ ‡è®°æˆå‘˜å˜é‡ã€æ„é€ æ–¹æ³•æˆ–æˆå‘˜æ–¹æ³•ã€‚</p></li><li><p>æ ‡è®°äº†æ³¨è§£<code>@Inject</code>çš„æˆå‘˜å˜é‡æˆ–æ–¹æ³•ï¼ŒDaggerä¼šè‡ªåŠ¨ä¸ºå…¶æä¾›å®ä¾‹ï¼›æ ‡è®°äº†<code>@Inject</code>çš„æ„é€ æ–¹æ³•è¡¨ç¤ºDaggerå°†ä¼šè‡ªåŠ¨å®ä¾‹åŒ–è¯¥ç±»æä¾›ç»™å…¶ä»–éœ€è¦æ³¨å…¥çš„ç±»ã€‚</p></li><li><p>åƒè¿™è¿™æ ·ä¸€ä¸ªéœ€è¦æ³¨å…¥çš„æˆå‘˜ï¼Œä¸€ä¸ªæä¾›è¯¥å¯¹è±¡å°±è¿™æ ·å¯¹åº”èµ·æ¥äº†ã€‚ä½†æ˜¯è¿˜å·®ä¸€ä¸ªå°†å®ƒä»¬è”ç³»èµ·æ¥çš„ä¸œè¥¿ï¼Œå®ƒå«<code>Componnet</code>ã€‚ä¸‹é¢çš„ä¾‹å­å°†ä¼šæå‰ç”¨åˆ°<code>@Component</code>æ³¨è§£æ‚¨å¯ä»¥å…ˆä¸å»æ·±å…¥ç†è§£ï¼Œå æ—¶ç†è§£ä¸ºDaggerå¿…è¦å†™çš„çš„ä¸”æ˜¯æ³¨å…¥çš„å…³ç³»è¿æ¥çº½å¸¦ã€‚</p></li></ol><blockquote><p>è¿™é‡Œåœ¨æ„é€ æ–¹æ³•ä¸ŠåŠ <code>@Inject</code>å¯ä»¥ç†è§£ä¸ºï¼šæä¾›<code>new ElectricHeater()</code></p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”µå­åŠ çƒ­å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ElectricHeater</span> <span class="keyword">implements</span> <span class="title">Heater</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ElectricHeater</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p><code>@Component</code>èµ·çº½å¸¦ä½œç”¨ï¼Œç”¨æ¥å£æˆ–æŠ½è±¡ç±»æ¥å®šä¹‰ã€‚<code>Thermosiphon getPump()</code>è¡¨ç¤ºå…¶ä»–åœ°æ–¹éœ€è¦æä¾›<code>new Thermosiphon()</code></p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PumpComponent</span> </span>&#123;</span><br><span class="line">    <span class="function">Thermosiphon <span class="title">getPump</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p><code>@Inject</code>æ ‡è®°åœ¨æˆå‘˜å˜é‡ä¸Šï¼Œè¡¨ç¤ºå…¶ä»–åœ°æ–¹éœ€è¦æä¾›<code>ElectricHeater</code>å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸Šé¢ä»£ç ä¸­<code>@Inject</code>æ ‡è®°åœ¨æ„é€ æ–¹æ³•çš„ä½œç”¨ã€‚<code>@Inject</code>æ ‡è®°åœ¨æ„é€ æ–¹æ³•ä¸Šï¼Œå¯ä»¥çœ‹åš<code>new Thermosiphon()</code>ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æ¥å£ä¸­éœ€è¦çš„å¯¹è±¡ã€‚</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çƒ­è™¹å¸</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Thermosiphon</span> <span class="keyword">implements</span> <span class="title">Pump</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    ElectricHeater heater;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Thermosiphon</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pump</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (heater.isHot()) &#123;</span><br><span class="line">            System.out.println(<span class="string">"=&gt;=&gt; æŠ½æ°´ =&gt;=&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>æˆ‘ä»¬ç›´æ¥åˆ›å»ºä¸€ä¸ªCoffeeAppç±»ä¸­è¿›è¡Œæµ‹è¯•ï¼Œ<code>DaggerPumpComponent</code>æ˜¯é€šè¿‡aptè‡ªåŠ¨ç”Ÿæˆçš„ç±»ï¼ˆéœ€è¦åœ¨Android studioä¸­ç‚¹å‡»ï¼šBuild -&gt; Make Moduleï¼‰ã€‚</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿è¡Œæµ‹è¯•</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeApp</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å…¨å†™ï¼šThermosiphon pump = DaggerPumpComponent.builder().build().getPump();</span></span><br><span class="line">        Thermosiphon pump = DaggerPumpComponent.create().getPump();</span><br><span class="line">        pump.heater.on();</span><br><span class="line">        pump.pump();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p><code>CoffeeApp</code>è¿è¡Œç»“æœ</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~~~~heating~~~~</span><br><span class="line">=&gt;=&gt; æŠ½æ°´ =&gt;=&gt;</span><br></pre></td></tr></table></div></figure><blockquote><p>æµ‹è¯•ä¸€ä¸‹å°†<code>@Inject</code>æ ‡è®°åœ¨æ–¹æ³•ä¸Šï¼Œä¿®æ”¹<code>Thermosiphon</code>ç±»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çƒ­è™¹å¸</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Thermosiphon</span> <span class="keyword">implements</span> <span class="title">Pump</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">funTest</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"funTest()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">funTest</span><span class="params">(ElectricHeater heater)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"heater: "</span> + <span class="keyword">this</span>.heater.hashCode());</span><br><span class="line">        System.out.println(<span class="string">"funTest(): "</span> + heater.hashCode());</span><br><span class="line">    &#125;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p><code>CoffeeApp</code>è¿è¡Œç»“æœ</p></blockquote><figure class="highlight c"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">funTest()</span><br><span class="line">heater: <span class="number">692404036</span></span><br><span class="line">funTest(): <span class="number">1554874502</span></span><br><span class="line">~~~~heating~~~~</span><br><span class="line">=&gt;=&gt; æŠ½æ°´ =&gt;=&gt;</span><br></pre></td></tr></table></div></figure><blockquote><p>ä¸€äº›ç»“è®º</p></blockquote><ol><li>é€šè¿‡<code>DaggerPumpComponent.create().getPump();</code>æ—¢å¯ä»¥å¾—åˆ°<code>Thermosiphon</code>å¯¹è±¡ã€‚</li><li>æˆ‘ä»¬çœ‹åˆ°åœ¨<code>Thermosiphon</code>ä¸­<code>heater</code>æ˜¯ä»¥<code>ElectricHeater</code>æ¥æ¥æ”¶çš„ï¼Œå¹¶æ²¡æœ‰å‘ä¸Šè½¬å‹ä¸ºæ¥å£<code>Heater</code>å¼•ç”¨ï¼Œ<code>@Inject</code>æ ‡è®°éœ€è¦æ˜¯ç¡®åˆ‡çš„ç±»å‹ã€‚ç­‰æˆ‘ä»¬å­¦ä¹ äº†ä¸‹é¢<code>@Providesä¸¶@Module</code>éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°±èƒ½é—´æ¥çš„ç”¨<code>Heater</code>æ¥å£æ¥æ¥æ”¶ã€‚</li><li>é€šè¿‡ä¸Šé¢ä¾‹å­æˆ‘ä»¬æ˜æ˜¾çœ‹åˆ°ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰new å¯¹è±¡ï¼Œç„¶è€Œå´æœ‰<code>ElectricHeater</code>å’Œ<code>Thermosiphon</code>è¢«å®ä¾‹åŒ–ï¼Œè¿™å°±æ˜¯Daggerç”Ÿæˆjavaä»£ç ä¸­å¸®æˆ‘ä»¬è¿›è¡Œäº†å®ä¾‹åŒ–çš„æ“ä½œã€‚</li><li>æ³¨æ„<code>@Inject</code>æ ‡è®°çš„æˆå‘˜å˜é‡ã€æ–¹æ³•å’Œæ„é€ æ–¹æ³•ä¸èƒ½ä»¥<code>private</code>ä¿®é¥°ã€‚å› ä¸ºå¦‚æœæˆ‘ä»¬ç”¨privateï¼ŒDaggerä»¥javaä»£ç æ³¨å…¥ï¼Œè‡ªç„¶ä¸èƒ½å¸®æˆ‘ä»¬æ³¨å…¥å¯¹è±¡ï¼Œä¼šæŠ¥é”™!ä½ å¯ä»¥è¯•è¯•çœ‹å“¦ï¼(ï¿£â–½ï¿£)~*</li><li>ä¹Ÿè®¸ä½ æƒ³é—®<code>DaggerPumpComponent</code>æ˜¯å“ªæ¥çš„ï¼Ÿç”¨<code>@Component</code>æ ‡è®°çš„æ¥å£ä¼šç”Ÿæˆä¸€ä¸ªä»¥<code>â€œDagger + æ¥å£åâ€</code>çš„ç±»ã€‚</li><li>ç»æµ‹è¯•ï¼Œå¦‚æœå°†æˆå‘˜å˜é‡ä¸Šçš„<code>@Inject</code>å»æ‰ï¼Œä¸ä¼šæŠ¥é”™ï¼Œåªæ˜¯æ²¡æœ‰å¼•ç”¨çš„å¯¹è±¡ï¼Œå˜é‡ä¸ºnullã€‚å¦‚æœæˆå‘˜å˜é‡ä¸Šæ ‡è®°äº†<code>@Inject</code>ï¼Œè€Œæ²¡æœ‰å¯¹åº”çš„æ³¨å…¥å®ä¾‹ï¼Œåˆ™ä¼šç¼–è¯‘é”™è¯¯ã€‚</li><li>Daggerç”Ÿæˆä»£ç çš„ä½ç½®ï¼š<code>é¡¹ç›®ç›®å½• -&gt; app -&gt; build -&gt; generated -&gt; source -&gt; apt</code></li><li>å¦‚æœæˆ‘ä»¬å°†<code>@Inject</code>æ ‡è®°åœ¨æ–¹æ³•ä¸Šï¼Œå¦‚æœæœ‰å‚ï¼ŒDaggeræä¾›è¯¥å®ä¾‹ï¼Œç„¶åè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ï¼›å¦‚æœæ— å‚åˆ™ç›´æ¥è°ƒç”¨ï¼›å¦‚æœæœ‰å‚æ²¡æœ‰å¯¹åº”çš„å®ä¾‹æä¾›ï¼Œåˆ™æŠ¥é”™ã€‚</li></ol><blockquote><p><em>æ¥ä¸‹æ¥å°†ä»Daggerç”Ÿæˆçš„æ³¨å…¥ä»£ç ä¸Šè¿›è¡Œåˆ†æï¼ˆè¿™éƒ¨åˆ†è·³è¿‡ä¹Ÿå¯ä»¥æ»´ï¼(ï½€ãƒ»Ï‰ãƒ»Â´)ï¼‰</em></p><p>è¿™æ˜¯ä¸Šé¢æ•´ä½“çš„UMLå…³ç³»å›¾ï¼Œâ€œç»¿è‰²â€çš„æ˜¯Daggerè‡ªåŠ¨ç”Ÿæˆçš„ä»£ç ã€‚</p></blockquote><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/inject-uml.png" alt="inject uml"><br><strong>1.</strong> é€šè¿‡æˆ‘ä»¬å¯¹Daggerçš„ä½¿ç”¨ï¼Œå®ƒä¸ºæˆ‘ä»¬ç”Ÿæˆäº†4ä¸ªç±»ã€‚<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/build-class.png" alt="ç”Ÿæˆçš„ç±»"><br><strong>2.</strong> ä»–ä»¬è¿™æ ·å¯¹åº”ï¼š</p><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>PumpComponent</td><td>â€”â€“&gt;</td><td>DaggerPumpComponent</td></tr><tr><td>@Inject public ElectricHeater() { }</td><td>â€”â€“&gt;</td><td>ElectricHeater_Factory</td></tr><tr><td>@Inject public Thermosiphon() { }</td><td>â€”â€“&gt;</td><td>Thermosiphon_Factory</td></tr><tr><td>@Inject ElectricHeater heater;</td><td>â€”â€“&gt;</td><td>Thermosiphon_MembersInjector</td></tr></tbody></table></div></div><p>é€šè¿‡è§‚å¯Ÿæˆ‘ä»¬å¯ä»¥å¾—å‡ºè¿™äº›ç»“è®ºï¼š</p><ul><li>â‘ <code>PumpComponent</code>æ¥å£ç”Ÿæˆçš„ç±»çš„åå­—ä»¥ï¼š<code>Dagger</code> + <code>æ¥å£å</code>ã€‚<em>ï¼ˆæˆ‘ä»¬éœ€è¦ä½¿ç”¨ç”Ÿæˆçš„è¿™ä¸ªç±»ï¼Œè¿›è¡ŒDaggeråˆå§‹åŒ–çš„æ“ä½œï¼‰</em></li><li>â‘¡<code>@Inject</code>æ ‡è®°äº†æ„é€ æ–¹æ³•ç”Ÿæˆç±»åä»¥ï¼š<code>æ„é€ å</code> + <code>_Factory</code>ï¼Œçš„å‘½åç”Ÿä¸€ä¸ªå·¥å‚ç±»ã€‚<em>ï¼ˆè¯¥å·¥å‚ç±»å°†ç”¨æ¥åˆ›å»ºå¯¹åº”çš„å®ä¾‹ï¼‰</em></li><li>â‘¢ç±»ä¸­æœ‰<code>@Inject</code>æ ‡è®°æˆå‘˜å˜é‡æˆ–æ–¹æ³•çš„ç±»ï¼Œä¼šç”Ÿæˆä¸€ä¸ªä»¥ï¼š<code>è¯¥ç±»å</code> + <code>_MembersInjector</code>ï¼Œçš„å‘½åç”Ÿæˆä¸€ä¸ªæ³¨å…¥ç±»ã€‚<em>ï¼ˆè¯¥ç±»å®ç°äº†å°†å®ä¾‹ä¼ é€’åˆ°ç”¨<code>@Inject</code>æ ‡è®°çš„æˆå‘˜å˜é‡æˆ–æ–¹æ³•ï¼‰</em></li></ul><p><strong>3.</strong> æ¥çœ‹çœ‹<code>ElectricHeater</code>çš„å·¥å‚ç±»<code>ElectricHeater_Factory</code>ï¼ˆè¿™æ˜¯ä¸€ä¸ªå·¥å‚è®¾è®¡æ¨¡å¼ä¸­çš„ä¸€ç§å®ç°æ–¹å¼ï¼‰ï¼Œå®ç°ä¸€ä¸ªå·¥å‚æ¥å£<code>Factory&lt;T&gt;</code>(<code>Factory&lt;T&gt;</code>åˆç»§æ‰¿<code>Provider&lt;T&gt;</code>æ¥å£)ã€‚é€šè¿‡<code>get()</code>è·å–ä¸€ä¸ªElectricHeaterå®ä¾‹ï¼Œé€šè¿‡<code>create()</code>è·å–<code>ElectricHeater_Factory</code>å®ä¾‹ï¼ˆè¿™ä¸ªç±»å¹¶æœªè¢«ä½¿ç”¨ï¼Œå½“ä½ çœ‹åˆ°ä¸‹é¢ä»‹ç»<code>DaggerPumpComponent</code>å°±æ˜ç™½äº†ï¼‰<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/ElectricHeater_Factory.png" alt="ElectricHeater_Factory"><br><strong>4.</strong> æ¥ä¸‹æ¥çœ‹çœ‹<code>Thermosiphon_MembersInjector</code>ï¼Œè¿™ä¸ªç±»å®ç°äº†ä¸º<code>@Inject</code>æ³›å‹æ ‡è®°çš„æˆå‘˜å˜é‡æˆ–æ–¹æ³•ä¼ é€’å€¼çš„æ“ä½œã€‚å¤§å®¶çœ‹<code>injectHeater</code>æ–¹æ³•ï¼Œè¿™é‡Œå°±æ˜¯ä¸º<code>Thermosiphon</code>çš„æˆå‘˜å˜<code>heater</code>æ·»åŠ ä¾èµ–çš„åœ°æ–¹!<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/Thermosiphon_MembersInjector.png" alt="Thermosiphon_MembersInjector.java"><br><strong>5.</strong> å†çœ‹çœ‹<code>Thermosiphon_Factory</code>ï¼Œè¿™ä¸ªç±»æ¯”ä¸Šä¸€ä¸ª<code>ElectricHeater_Factory</code>å¤æ‚ä¸€ç‚¹ã€‚å› ä¸ºå®ƒåœ¨å®ä¾‹åŒ–<code>Thermosiphon</code>æ—¶ï¼Œéœ€è¦æ³¨å…¥<code>ElectricHeater</code>å¯¹è±¡ã€‚è¿™æ¯”<code>ElectricHeater_Factory</code>å¤šäº†ä¸ªæ–¹æ³•å¹¶ä¸”å®ä¾‹è¯¥å·¥å‚ç±»æ—¶å¿…é¡»ä¼ å…¥<code>ElectricHeater</code>çš„å·¥å‚ç±»å®ä¾‹ã€‚</p><ul><li>æ„é€ å‚æ•°æ˜¯<code>ElectricHeater</code>çš„å·¥å‚ï¼Œæ˜¯ä¸ºäº†é€šè¿‡å·¥å‚ç±»è·å¾—<code>ElectricHeater</code>å¯¹è±¡ï¼›</li><li>å·¥å‚æ–¹æ³•<code>get()</code>ä¸­åˆ›å»ºå®ä¾‹çš„åŒæ—¶ï¼Œé€šè¿‡<code>Thermosiphon_MembersInjector</code>çš„é™æ€æ–¹æ³•(<code>injectHeater</code>)å‘<code>Thermosiphon</code>æ³¨å…¥<code>ElectricHeater</code>å¯¹è±¡ï¼Œç„¶åå¾—åˆ°æœ€ç»ˆçš„<code>Thermosiphon</code>å®ä¾‹ï¼›</li><li>æœ€åä¸€ä¸ªé™æ€æ–¹æ³•<code>newThermosiphon()</code>è¿”å›ä¸€ä¸ªæ²¡æœ‰æ³¨å…¥<code>ElectricHeater</code>å®ä¾‹çš„<code>Thermosiphon</code>å¯¹è±¡ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142100.png" alt=""></li></ul><p><strong>6.</strong> æœ€åçœ‹<code>DaggerPumpComponent</code>è¿™ä¸ªç±»ï¼Œä¸»è¦çœ‹<code>getPump()</code>ã€<code>injectThermosiphon</code>å’Œ<code>Builder</code>ç±»</p><ul><li><code>getPump()</code>æ˜¯æˆ‘ä»¬åœ¨æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œåœ¨è¿™é‡Œå®ç°æ¥å£æ–¹æ³•ï¼Œé€šè¿‡è°ƒç”¨<code>injectThermosiphon</code>æ–¹æ³•å¹¶ä¼ å…¥ä¸€ä¸ªæ²¡æœ‰æ³¨å…¥<code>ElectricHeater</code>å®ä¾‹çš„<code>Thermosiphon</code>ï¼Œå¾—åˆ°æœ€ç»ˆçš„<code>Thermosiphon</code></li><li><code>injectThermosiphon</code>æ–¹æ³•ä¸­å¾—åˆ°ä¸Šé¢ä¼ è¿›æ¥çš„<code>Thermosiphon</code>ï¼Œç„¶åé€šè¿‡<code>Thermosiphon_MembersInjector</code>æ³¨å…¥<code>ElectricHeater</code>å®ä¾‹ã€‚çœ‹åˆ°è¿™é‡Œæˆ‘ä»¬ä¼šå‘ç°ç¬¬â€œ3.â€ä¸­ä»‹ç»çš„<code>ElectricHeater_Factory</code>å±…ç„¶æ²¡æœ‰ç”¨åˆ°ï¼Œè¿™é‡Œç›´æ¥å°±newäº†ï¼ˆè¿™ä¹Ÿæ˜¯ä¸Šé¢æåˆ°çš„å¹¶æ²¡æœ‰ä½¿ç”¨<code>ElectricHeater_Factory</code>ï¼‰ã€‚</li><li><code>Builder</code>å°±æ˜¯ç”¨æ¥åˆ›å»º<code>DaggerPumpComponent</code>çš„ç±»ï¼Œå­¦åˆ°åé¢ï¼Œè¿™ä¸ªç±»ä¼šæ ¹æ®éœ€æ±‚å˜å¾—å¤æ‚ï¼<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142127.png" alt="DaggerPumpComponent.java"></li></ul><h3 id="Providesä¸¶-Moduleä¸¶-Binds">@Providesä¸¶@Moduleä¸¶@Binds<a href="post/learn-dagger#Providesä¸¶-Moduleä¸¶-Binds"></a></h3><p><strong><a href="https://github.com/xujiaji/learn-android/blob/master/LearnDagger/app/src/main/java/com/example/jiaji/daggertest/coffee3_test_provides_module" target="_blank" rel="noopener">æµ‹è¯•æ–‡ä»¶ä½ç½®</a></strong></p><blockquote><p>ç”±äº<code>@Inject</code>æ³¨è§£æ— æ³•åšåˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š</p></blockquote><ul><li>æ¥å£ç±»å‹æ— æ³•åšä¸ºæ¥æ”¶ç±»å‹</li><li>ç¬¬ä¸‰æ–¹ç±»æ— æ³•æ·»åŠ <code>@Inject</code>æ³¨è§£ï¼ˆå› ä¸ºè¿™ä¸ªç±»ä¸æ˜¯è‡ªå·±æŒæ§çš„ï¼‰</li></ul><p>è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥ç”¨<code>@Provides</code>æ³¨é‡Šå»æ»¡è¶³ä¾èµ–ï¼Œæ–¹æ³•çš„è¿”å›ç±»å‹ç¡®å®šäº†å®ƒæä¾›ç»™è°çš„ä¾èµ–ã€‚</p><blockquote><p>ä½¿ç”¨</p></blockquote><ol><li>åˆ›å»ºä¸€ä¸ªç±»ä½œç”¨æ˜¯å­˜æ”¾æä¾›å®ä¾‹çš„æ–¹æ³•ï¼Œçº¦å®šè¯¥ç±»ä»¥<code>Module</code>ç»“å°¾ï¼ˆä¾¿äºç»Ÿä¸€åˆ†è¾¨ï¼Œå°±åƒæˆ‘ä»¬å®‰å“Activityå‘½åä»¥Activityç»“å°¾ï¼‰</li><li>åœ¨ç±»åä¸Šæ ‡è®°<code>@Module</code>æ³¨è§£</li><li>ä½¿ç”¨é™æ€æˆ–æ™®é€šæœ‰è¿”å›çš„æ–¹æ³•æ¥æä¾›å®ä¾‹<ul><li>åœ¨è¿™äº›æ–¹æ³•å‰éœ€è¦æ ‡è®°<code>@Provides</code>æ³¨è§£</li><li>è¿™äº›æ–¹æ³•ä»¥<code>provide</code>å¼€å¤´ï¼Œä¹Ÿæ˜¯ä¸€ç§çº¦å®š</li></ul></li></ol><blockquote><p>çœ‹ä¸‹æ–¹è¿™ä¸ª<code>DripCoffeeModule</code>ç±»ï¼Œå®ƒæä¾›äº†ä¸¤ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”å®ƒä»¬çš„è¿”å›ç±»å‹æŒ‡å‘çš„æ˜¯æ¥å£ã€‚ä¹Ÿå°±æ˜¯è¯´æœ‰æŸä¸ªåœ°æ–¹å¯èƒ½éœ€è¦<code>Heater</code>å’Œ<code>Pump</code>çš„å®ä¾‹ã€‚</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DripCoffeeModule</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> Heater <span class="title">provideHeater</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"provideHeater"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ElectricHeater();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> Pump <span class="title">providePump</span><span class="params">(Thermosiphon pump)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"providePump"</span>);</span><br><span class="line">        <span class="keyword">return</span> pump;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>åœ¨<code>@Component</code>æ³¨è§£ä¸­æ·»åŠ <code>DripCoffeeModule.class</code>ï¼Œå¦‚æœæœ‰å¤šä¸ªå¯å†™ä¸ºï¼š<code>@Component(modules = {DripCoffeeModule.class, ....class,....class})</code></p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(modules = DripCoffeeModule.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CoffeeShop</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function">Pump <span class="title">getPump</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>å…¶ä»–ç±»</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”µå­åŠ çƒ­å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ElectricHeater</span> <span class="keyword">implements</span> <span class="title">Heater</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ElectricHeater</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ElectricHeater()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çƒ­è™¹å¸</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Thermosiphon</span> <span class="keyword">implements</span> <span class="title">Pump</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Heater heater;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Thermosiphon</span><span class="params">(Heater heater)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Thermosiphon() heater = "</span> + heater);</span><br><span class="line">        <span class="keyword">this</span>.heater = heater;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>æµ‹è¯•ç±»ï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeApp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Pump pump = DaggerCoffeeShop.create().getPump();</span><br><span class="line">        System.out.println(<span class="string">"pump = "</span> + pump);</span><br><span class="line">        pump.pump();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>CoffeeAppçš„è¾“å‡ºç»“æœï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">provideHeater</span><br><span class="line">ElectricHeater()</span><br><span class="line">Thermosiphon() heater = com.example.jiaji.daggertest.coffee3.ElectricHeater@<span class="number">29453f</span>44</span><br><span class="line">providePump</span><br><span class="line">pump = com.example.jiaji.daggertest.coffee3.Thermosiphon@<span class="number">5</span>cad8086</span><br></pre></td></tr></table></div></figure><ul><li>é¦–å…ˆï¼Œæˆ‘ä»¬è°ƒç”¨<code>DaggerCoffeeShop.create().getPump()</code>æƒ³è¦å¾—åˆ°ä¸€ä¸ªPumpå¯¹è±¡ï¼Œäºæ˜¯<code>DripCoffeeModule</code>ä¸­çš„<code>providePump</code>æ–¹æ³•ä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªPumpå®ä¾‹ã€‚</li><li>ç„¶åï¼Œæˆ‘ä»¬çœ‹åˆ°<code>providePump</code>æ–¹æ³•æœ‰å‚æ•°<code>Thermosiphon</code>é‚£ä¹ˆè¿™ä¸ªè¿™ä¸ªå®ä¾‹ä»å“ªæ¥å‘¢ï¼Ÿæˆ‘ä»¬åœ¨<code>Thermosiphon</code>çš„æ„é€ æ–¹æ³•ä¸Šæ ‡è®°<code>@Inject</code>å°±è¡¨ç¤ºæä¾›è¯¥å¯¹è±¡äº†ã€‚</li><li>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ·±å…¥åˆ°<code>Thermosiphon</code>ç±»åˆä¼šå‘ç°ï¼Œ<code>Thermosiphon</code>ç±»çš„æ„é€ æ–¹æ³•è¦æ±‚æä¾›<code>Heater</code>å¯¹è±¡ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†Heaterå®ä¾‹ä»å“ªæ¥ï¼Ÿæ‚¨èƒ½æƒ³åˆ°ï¼æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨<code>DripCoffeeModule</code>çš„<code>provideHeater</code>æ–¹æ³•æä¾›äº†è¯¥å®ä¾‹ã€‚</li><li>æœ€åï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºæ¥ä¸ªå®¹æ˜“ç†è§£çš„å¤§æ¦‚æµç¨‹ï¼š<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611143230.png" alt=""></li></ul><p><strong>æˆ‘ä»¬éœ€è¦æ³¨æ„ï¼Œå½“<code>@Inject</code>æä¾›äº†å®ä¾‹å¹¶ä¸”<code>Module</code>ä¸­ä¹Ÿæä¾›è¯¥å®ä¾‹çš„æƒ…å†µä¸‹ï¼ŒDaggerä¼šä¼˜å…ˆ<code>Module</code>ä¸­æä¾›çš„å®ä¾‹ã€‚</strong></p><p><em>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ï¼š<code>@Inject</code>å¯ä»¥ä¸º<code>Module</code>æ–¹æ³•çš„å‚æ•°æä¾›å®ä¾‹</em></p><blockquote><p>æˆ‘ä»¬å¯ä»¥å°†Moduleä¸­çš„æ–¹æ³•åˆ†åˆ°å¤šä¸ªModuleä¸­ï¼Œåªéœ€è¦åœ¨<code>@Component</code>æ³¨é‡Šä¸­æ·»åŠ ä¸€ä¸‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DripCoffeeModule</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> Heater <span class="title">provideHeater</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"provideHeater"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ElectricHeater();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DripCoffeeModule2</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> Pump <span class="title">providePump</span><span class="params">(Thermosiphon pump)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"providePump"</span>);</span><br><span class="line">        <span class="keyword">return</span> pump;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line"><span class="meta">@Component</span>(modules = &#123;DripCoffeeModule.class, DripCoffeeModule2.class&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CoffeeShop</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function">Pump <span class="title">getPump</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>å…¶å®è¿˜æœ‰ç§å†™æ³•ï¼Œæ„æ€æ˜¯è¡¨ç¤ºæŸä¸€ä¸ªModuleåŒ…å«å¦ä¸€ä¸ªModuleã€‚æœ€ç»ˆæ•ˆæœä¸€æ ·çš„ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DripCoffeeModule2</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> Pump <span class="title">providePump</span><span class="params">(Thermosiphon pump)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"providePump"</span>);</span><br><span class="line">        <span class="keyword">return</span> pump;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line"><span class="meta">@Module</span>(includes = DripCoffeeModule2.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DripCoffeeModule</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> Heater <span class="title">provideHeater</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"provideHeater"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ElectricHeater();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line"><span class="meta">@Component</span>(modules = DripCoffeeModule.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CoffeeShop</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function">Pump <span class="title">getPump</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>@Bindså¯ä»¥ç®€åŒ–<code>DripCoffeeModule</code>ä¸­æä¾›<code>Pump</code>å®ä¾‹çš„å†™æ³•ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BModule</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Binds</span></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> Pump <span class="title">bindPump</span><span class="params">(Thermosiphon pump)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line"><span class="meta">@Component</span>(modules = &#123;DripCoffeeModule.class, BModule.class&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CoffeeShop</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p><em>æ¥ä¸‹æ¥æ˜¯å¯¹Daggerç”Ÿæˆçš„ä»£ç è¿›è¡Œåˆ†æï¼ˆè¿™éƒ¨åˆ†å¯ä»¥é€‰æ‹©æ€§è·³è¿‡ï¼(ï½€ãƒ»Ï‰ãƒ»Â´)ï¼‰</em></p><p>è¿™æ˜¯æ•´ä½“çš„UMLå…³ç³»å›¾ï¼Œâ€œç»¿è‰²â€æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç ã€‚(ç”±äºç”Ÿæˆçš„<code>Thermosiphon_Factory</code>å¹¶æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œäºæ˜¯å°±ä¸æ”¾è¿›æ¥äº†ã€‚)</p></blockquote><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142208.png" alt=""><br><strong>1.</strong> é€šè¿‡ä¸Šé¢çš„ä¸‰éƒ¨åˆ†ä»£ç ï¼ŒDaggerä¹Ÿä¸ºæˆ‘ä»¬ç”Ÿæˆäº†4ä¸ªç±»ã€‚<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142229.png" alt="daggerç”Ÿæˆçš„å››ä¸ªç±»"><br><strong>2.</strong> ä»–ä»¬è¿™æ ·å¯¹åº”ï¼š</p><div class="article-bounded"><div class="article-table"><table><tbody><tr><td>CoffeeShop</td><td>â€”â€“&gt;</td><td>DaggerCoffeeShop</td></tr><tr><td>@Provides static Heater provideHeater()</td><td>â€”â€“&gt;</td><td>DripCoffeeModule_ProvideHeaterFactory</td></tr><tr><td>@Provides static Pump providePump(Thermosiphon pump)</td><td>â€”â€“&gt;</td><td>DripCoffeeModule_ProvidePumpFactory</td></tr><tr><td>@Inject public Thermosiphon() { }</td><td>â€”â€“&gt;</td><td>Thermosiphon_Factory</td></tr></tbody></table></div></div><p>ä»åå­—ä¸Šæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š<code>@Provides</code>æ ‡è®°çš„æä¾›å®ä¾‹çš„æ–¹æ³•å¯¹åº”ç”Ÿæˆäº†ä¸€ä¸ªç±»åä»¥ï¼š<code>æ‰€åœ¨ç±»å</code> + <code>_</code> + <code>æ–¹æ³•å(é¦–å­—å¤§å†™)</code> + <code>Factory</code>ï¼Œå‘½åç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„å·¥å‚ç±»ã€‚</p><p><strong>3.</strong> æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹<code>Thermosiphon_Factory</code>è¿™ä¸ªæ²¡æœ‰è¢«ä½¿ç”¨çš„ç±»ï¼Œå¦‚æœæ‚¨æ˜¯ä»ä¸Šé¢æŒ¨ç€çœ‹ä¸‹æ¥çš„ï¼Œå°±ä¸€å®šæ˜ç™½ï¼Œå…¶ä»–åœ°æ–¹æ˜¯ç›´æ¥<code>new Thermosiphon</code>ï¼Œæ¥ç€å¾€ä¸‹çœ‹æ‚¨å°±ä¼šçœ‹åˆ°ï¼</p><ul><li>è¿™ä¸ªç±»å’Œä¸Šé¢ç”Ÿæˆçš„<code>Thermosiphon_Factory</code>æœ‰äº›ä¸ä¸€æ ·ï¼Œå› ä¸ºä¹‹å‰<code>Thermosiphon</code>æ˜¯æ— å‚æ„é€ ï¼Œç°åœ¨æ·»åŠ äº†<code>Heater</code>ä½œä¸ºæ„é€ çš„å‚æ•°ï¼ˆè¯¥å®ä¾‹åœ¨DripCoffeeModuleæä¾›ï¼‰ã€‚</li><li>å¯ä»¥çœ‹åˆ°è¦å®ä¾‹åŒ–è¿™ä¸ªå·¥å‚ç±»ï¼Œå¿…é¡»è¦ä¼ å…¥<code>Heater</code>çš„å·¥å‚ç±»ã€‚ç„¶ååœ¨åˆ›å»º<code>Thermosiphon</code>å®ä¾‹æ—¶é€šè¿‡<code>Heater</code>å·¥å‚ç±»åˆ›å»ºä¸€ä¸ª<code>Heater</code>å¯¹è±¡ä¼ å…¥æ„é€ æ–¹æ³•ä¸­ã€‚</li><li>å¹¶ä¸”å®ƒè¿˜æ·»åŠ äº†<code>ä¸€ä¸ªnewThermosiphon</code>çš„é™æ€æ–¹æ³•ï¼Œå…è®¸ä¼ å…¥<code>heater</code>å¯¹è±¡æ¥åˆ›å»º<code>Thermosiphon</code>ã€‚</li></ul><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142247.png" alt="Thermosiphon_Factory"><br><strong>4.</strong> æˆ‘ä»¬åœ¨æ¥çœ‹<code>Heater</code>å·¥å‚ç±»<code>DripCoffeeModule_ProvideHeaterFactory</code>ï¼Œå®ƒç›¸å¯¹æ¯”è¾ƒç®€å•ç‚¹ã€‚</p><ul><li>å¯ä»¥çœ‹åˆ°åœ¨åˆ›å»º<code>Heater</code>å®ä¾‹æ—¶ï¼Œç›´æ¥é€šè¿‡<code>DripCoffeeModule.provideHeater()</code>è°ƒç”¨æˆ‘ä»¬å®šä¹‰çš„ç›¸å¯¹åº”çš„é™æ€æ–¹æ³•ã€‚</li><li>é€šè¿‡<code>Preconditions.checkNotNull</code>åˆæ£€æµ‹äº†æ˜¯å¦æä¾›å¾—æœ‰å®ä¾‹ï¼Œæ²¡æœ‰å°†ä¼šæŠ¥ç¬¬äºŒå‚æ•°ä¼ å…¥çš„é”™è¯¯ä¿¡æ¯ã€‚</li><li>å·¥å‚å®ä¾‹åŒ–æ˜¯é€šè¿‡é™æ€æ–¹æ³•<code>create()</code>å®ä¾‹ï¼›é™æ€æ–¹æ³•<code>newThermosiphon</code>ï¼Œå¯ä¸åˆ›å»ºå·¥å‚ç±»çš„æƒ…å†µä¸‹ï¼Œç›´æ¥åˆ›å»º<code>Heater</code>å®ä¾‹ã€‚</li></ul><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142310.png" alt="DripCoffeeModule_ProvideHeaterFactory" class="article-img"></p><ul><li><p><code>DripCoffeeModule</code>ä¸­æä¾›å®ä¾‹çš„æ–¹æ³•ä¸ä»…å¯ä»¥æ˜¯é™æ€æ–¹æ³•ï¼è¿˜å¯ä»¥æ˜¯æ™®é€šæ–¹æ³•æˆ–æŠ½è±¡æ–¹æ³•ã€‚é‚£å¦‚æœæˆ‘ä»¬å°†<code>DripCoffeeModule</code>ä¸­çš„é™æ€æ–¹æ³•çš„staticå»æ‰æ”¹ä¸ºæ™®é€šæ–¹æ³•ç”Ÿæˆçš„ä»£ç åˆæ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ(<code>@Provides static Heater provideHeater()</code>æ”¹ä¸º<code>@Provides Heater provideHeater()</code>)çœ‹ä¸‹å›¾ï¼š</p><ul><li>å¯ä»¥çœ‹åˆ°<code>DripCoffeeModule_ProvideHeaterFactory</code>çš„åˆ›å»ºé¡»ä¼ å…¥<code>DripCoffeeModule</code>å®ä¾‹ï¼Œ<code>get()</code>æ–¹æ³•é€šè¿‡è¯¥å®ä¾‹è·å–<code>Heater</code>å®ä¾‹</li><li><p>åˆ›å»º<code>Heater</code>çš„é™æ€æ–¹æ³•<code>proxyProvideHeater</code>é¡»ä¼ å…¥<code>DripCoffeeModule</code>å®ä¾‹ã€‚</p><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142330.png" alt="DripCoffeeModule_ProvideHeaterFactory" class="article-img"></p></li></ul></li></ul><p><strong>5.</strong> æˆ‘ä»¬æ¥çœ‹çœ‹<code>Pump</code>å¯¹åº”ç”Ÿæˆçš„å·¥å‚ç±»ï¼š<code>DripCoffeeModule_ProvidePumpFactory</code></p><ul><li>åœ¨Moduleä¸­è¿™æ ·å®šä¹‰ï¼š<code>@Provides static Pump providePump(Thermosiphon pump) { return pump; }</code></li><li>è¿™ä¸ªæ–¹æ³•åˆå¿…é¡»æä¾›<code>Thermosiphon</code>å®ä¾‹ï¼Œå› æ­¤<code>DripCoffeeModule_ProvidePumpFactory</code>çš„æ„é€ å‚æ•°æ˜¯<code>Thermosiphon</code>çš„å·¥å‚å¯¹è±¡æ¥æä¾›è¯¥å®ä¾‹ï¼ˆ<code>get()</code>æ–¹æ³•ä¸­é€šè¿‡è°ƒç”¨é™æ€æ–¹æ³•<code>providePump</code>å¾—åˆ°Pumpå®ä¾‹çš„æ—¶å€™éœ€è¦è¯¥å·¥å‚ç±»æä¾›ï¼‰</li><li><p>æˆ‘ä»¬çœ‹åˆ°<code>proxyProvidePump</code>æ–¹æ³•ï¼Œä¹Ÿæ˜¯å¯åœ¨ä¸åˆ›å»ºå·¥å‚ç±»å®ä¾‹çš„æƒ…å†µä¸‹è°ƒç”¨ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142349.png" alt=""></p></li><li><p>å¦‚æœæˆ‘ä»¬ä¹ŸæŠŠModuleä¸­çš„staticä¿®é¥°å»æ‰åˆä¼šå‘ç”Ÿä»€ä¹ˆæ ·çš„å˜åŒ–å‘¢ï¼Ÿæˆ‘çŒœæ‚¨ä¹Ÿåº”è¯¥èƒ½æƒ³åˆ°äº†ï¼çœ‹ä¸‹å›¾ï¼š</p><ul><li>æ¯”4ä¸­å»æ‰staticå¤šäº†åˆ’çº¿çš„åœ°æ–¹</li><li>ä¹Ÿå°±æ˜¯è¯´å½“æˆ‘ä»¬å®šä¹‰çš„æ–¹æ³•æ˜¯æ™®é€šæ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å°±å¿…é¡»è¦æä¾›<code>Module</code>çš„å®ä¾‹<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142412.png" alt=""></li></ul></li></ul><p><strong>6.</strong> æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹<code>DaggerCoffeeShop</code>æ˜¯å¦‚ä½•å°†è¿™äº›ä¸œä¸œç»„åˆåœ¨ä¸€èµ·çš„ã€‚</p><ul><li>æˆ‘ä»¬çœ‹åˆ°<code>getPump()</code>æ–¹æ³•ï¼Œå®ƒåœ¨æ¥å£<code>CoffeeShop</code>ä¸­å®šä¹‰ï¼Œé‡Œé¢å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ</li><li>å®ƒç›´æ¥è°ƒç”¨äº†ä¸Šé¢<code>5</code>æ‰€è®²åˆ°çš„é™æ€æ–¹æ³•<code>proxyProvidePump</code>æ¥åˆ›å»º<code>Pump</code>å®ä¾‹ï¼Œä½†æ˜¯éœ€è¦æä¾›<code>Thermosiphon</code>å®ä¾‹ä½œä¸ºå‚æ•°ã€‚ï¼ˆå¦‚æœæ˜¯ç”¨çš„@Bindsæ–¹å¼ï¼Œåˆ™getPump()çš„å®ç°ä¸ºï¼š  <code>public Pump getPump() { return getThermosiphon(); }</code>ï¼‰</li><li><p>äºæ˜¯ï¼Œå®ƒå®šä¹‰äº†æ–¹æ³•<code>getThermosiphon()</code>æ¥åˆ›å»ºè¯¥å®ä¾‹ã€‚çœ‹åˆ°è¯¥æ–¹æ³•äº†å—ï¼Ÿé‡Œé¢æ˜¯ç›´æ¥<code>new Thermosiphon</code>ï¼Œè¿™å°±æ˜¯<code>Thermosiphon_Factory</code>æ²¡æœ‰ç”¨åˆ°çš„åŸå› ã€‚åˆ›å»º<code>Thermosiphon</code>çš„æ„é€ å‚æ•°<code>Heater</code>ç”±<code>DripCoffeeModule_ProvideHeaterFactory</code>ç±»åç›´æ¥è°ƒç”¨é™æ€æ–¹æ³•<code>proxyProvideHeater()</code>å®ƒåˆè°ƒç”¨<code>DripCoffeeModule.provideHeater()</code>æ¥æä¾›ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142434.png" alt=""></p></li><li><p>æ¥ä¸‹æ¥çœ‹åˆ°åˆ›å»º<code>DaggerCoffeeShop</code>çš„<code>Builder</code>é™æ€å†…éƒ¨ç±»ï¼Œè¿™é‡Œé¢å¯è¦æ¯”æˆ‘ä»¬ä¸Šæ¬¡ç”Ÿæˆçš„<code>DaggerPumpComponent</code>è¦å¤šäº†ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå‡ºç°çš„åŸå› å°±æ˜¯å› ä¸ºæˆ‘ä»¬å®šä¹‰äº†Moduleç±»ã€‚</p><ul><li>è¿™ä¸ªæ–¹æ³•çš„å‘½åæ–¹å¼æ˜¯å°†æˆ‘ä»¬å®šä¹‰çš„Moduleç±»çš„ç±»åå¼€å¤´å°å†™æ¥ä½œä¸ºåå­—ã€‚</li><li>å®ƒçš„ä½œç”¨æ˜¯æˆ‘ä»¬å¯ä»¥è‡ªå·±åˆ›å»ºModuleï¼Œå¦‚æœä¸è‡ªå·±åˆ›å»ºï¼Œå°†ä¼šè‡ªåŠ¨åˆ›å»ºã€‚</li><li>ä½†ä¸ºä»€ä¹ˆè¿™é‡Œæ ‡è®°ä¸ºå¼ƒç”¨å‘¢ï¼Ÿé‚£æ˜¯å› ä¸ºæˆ‘ä»¬Moduleä¸­å…¨æ˜¯é™æ€æ–¹æ³•ï¼Œå®Œå…¨ä¸éœ€è¦å®ä¾‹åŒ–ï¼Œå®ä¾‹åŒ–ä¹Ÿç™½æ­ï¼é‚£æˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œå¦‚æœå°†<code>DripCoffeeModule</code>ä¸­çš„æ–¹æ³•æ”¹ä¸ºæ™®é€šæ–¹æ³•æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142457.png" alt=""></li><li>çœ‹åˆ°äº†å§ï¼å¦‚æœbuild()æ–¹æ³•ä¸­åˆ¤æ–­äº†æˆ‘ä»¬å·²ç»è°ƒç”¨<code>dripCoffeeModule</code>æ–¹æ³•ä¼ è¿›æ¥Moduleå®ä¾‹ï¼Œé‚£ä¹ˆå°±ä¸å»å®ä¾‹åŒ–äº†ã€‚</li><li>è¿˜è®°å¾—ä¸Šé¢Moduleä¸­æˆ‘ä»¬å»æ‰æä¾›æ–¹æ³•staticåéœ€è¦çš„Moduleå®ä¾‹å—ï¼Ÿå®ä¾‹å°±æ˜¯å¼€å§‹äºè¿™é‡Œçš„ã€‚</li><li><code>dripCoffeeModule</code>çš„è°ƒç”¨æ–¹å¼å°±æ˜¯ï¼š<code>DaggerCoffeeShop.builder().dripCoffeeModule(new DripCoffeeModule()).build();</code>ï¼ˆå¦‚æœæˆ‘ä»¬çš„<code>@Component</code>è¿æ¥äº†å¤šä¸ª<code>Module</code>é‚£ä¹ˆå°±å¯ä»¥è¿™æ ·ä¼ å…¥è¿™ä¹ˆå¤šä¸ª<code>Module</code>å®ä¾‹ï¼‰</li><li><p>é‚£ä¹ˆè¿™ä¸ªæ–¹æ³•åˆ°åº•æœ‰ä»€ä¹ˆç¥å¥‡çš„ä½œç”¨å‘¢ï¼Ÿæˆ‘ä»¬æƒ³æƒ³çœ‹ï¼Œå¦‚æœ<code>Module</code>çš„æ„é€ æ–¹æ³•éœ€è¦ä¼ å‚ï¼Œæ­¤æ—¶æˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå¦‚ä¸‹ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestModuleAttr</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String str;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestModuleAttr</span><span class="params">(String str)</span> </span>&#123; <span class="keyword">this</span>.str = str; &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> <span class="string">"TestModuleAttr&#123;"</span> + <span class="string">"str='"</span> + str + <span class="string">'\''</span> +<span class="string">'&#125;'</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line">------------------------------------------</span><br><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DripCoffeeModule</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String str;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DripCoffeeModule</span><span class="params">(String str)</span> </span>&#123; <span class="keyword">this</span>.str = str; &#125;</span><br><span class="line">    ...</span><br><span class="line">    <span class="meta">@Provides</span> <span class="function">String <span class="title">provideStr</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> str; &#125;</span><br><span class="line">    <span class="meta">@Provides</span> <span class="function">TestModuleAttr <span class="title">provideTestModuleAttr</span><span class="params">(String s)</span> </span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> TestModuleAttr(s); &#125;</span><br><span class="line">&#125;</span><br><span class="line">------------------------------------------</span><br><span class="line"><span class="meta">@Component</span>(modules = &#123;DripCoffeeModule.class&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CoffeeShop</span></span>&#123;</span><br><span class="line">    <span class="function">Pump <span class="title">getPump</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">TestModuleAttr <span class="title">getTestModuleAttr</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">------------------------------------------</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeApp</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(</span><br><span class="line">                DaggerCoffeeShop</span><br><span class="line">                        .builder()</span><br><span class="line">                        .dripCoffeeModule(<span class="keyword">new</span> DripCoffeeModule(<span class="string">"Hello world"</span>))</span><br><span class="line">                        .build()</span><br><span class="line">                        .getTestModuleAttr());</span><br><span class="line"><span class="comment">//        Pump pump = DaggerCoffeeShop.create().getPump();</span></span><br><span class="line"><span class="comment">//        System.out.println("pump = " + pump);</span></span><br><span class="line"><span class="comment">//        pump.pump();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>è¾“å…¥ç»“æœï¼š<code>TestModuleAttr{str=&#39;Hello world&#39;}</code></p></li><li>å½“æˆ‘ä»¬æƒ³å‘æä¾›çš„å¯¹è±¡ä¼ é€’ä¸€äº›åŠ¨æ€çš„ä¸œè¥¿æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå½“ç„¶ä½ ä¹Ÿä¸ç”¨å‘æˆ‘è¿™æ ·ç»•äº†ä¸ªåœˆå­ï¼Œè¿™é‡Œåªæƒ³è¯´<code>Module</code>é‡Œé¢å¯ä»¥ç›¸äº’æä¾›å®ä¾‹ã€‚è¿™é‡Œå¯ä»¥ç›´æ¥<code>@Provides TestModuleAttr provideTestModuleAttr() { return new TestModuleAttr(str); }</code>æå®šã€‚</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœ<code>Module</code>å®ä¾‹æ˜¯æœ‰å‚æ„é€ åˆ›å»ºï¼Œæˆ‘ä»¬å¿…é¡»è‡ªå·±å®ä¾‹åŒ–<code>Module</code>ã€‚å¦åˆ™åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚åŸå› ï¼Œå¦‚ä¸‹ï¼š<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142517.png" alt=""></li></ul></li></ul><h3 id="Component">@Component<a href="post/learn-dagger#Component"></a></h3><p><strong><a href="https://github.com/xujiaji/learn-android/blob/master/LearnDagger/app/src/main/java/com/example/jiaji/daggertest/coffee4_test_component" target="_blank" rel="noopener">æµ‹è¯•æ–‡ä»¶ä½ç½®</a></strong></p><p>ä¸Šé¢éƒ½æ¶‰åŠåˆ°äº†å®ƒï¼Œæƒ³å¿…å¤§å®¶ä¹Ÿæœ‰äº›ç†Ÿæ‚‰äº†ã€‚ãƒ¾(à¹‘â•¹â—¡â•¹)ï¾‰â€</p><p>å®˜æ–¹æŠŠè¿™ä¸ªå®šä¹‰å«åšå»ºç«‹å›¾è¡¨ï¼Œå®ƒèµ·åˆ°çš„ä½œç”¨æ˜¯è¿æ¥ä¾èµ–å…³ç³»ï¼Œé€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥ç›´è§‚çš„çœ‹åˆ°åœ¨<code>DaggerXXX</code>(<code>@Component</code>ä¿®é¥°çš„ç±»æ‰€å¯¹åº”ç”Ÿæˆçš„æ–‡ä»¶)ç±»ä¸­ï¼Œä¸»è¦å°±æ˜¯å°†å„ä¸ªå·¥å‚ç±»å’ŒModuleè¿æ¥èµ·æ¥ã€‚</p><blockquote><p>å¦‚æœæˆ‘ä»¬åƒä¸‹é¢è¿™æ ·å®šä¹‰ä¸€ä¸ªComponentï¼ŒDaggerå°†ä¼šä¸ºæˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªç±»ï¼š<code>DaggerFoo_Bar_BazComponent</code></p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Bar</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Component</span></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">BazComponent</span> </span>&#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p><code>@Component</code>ä¸ä»…å¯ä»¥è£…é¥°æ¥å£è¿˜å¯ä»¥æ˜¯æŠ½è±¡ç±»ï¼Œæ¯”å¦‚ä¸Šé¢çš„<code>CoffeeShop</code>æ¥å£å¯ä»¥æ”¹æˆè¿™æ ·ï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(modules = &#123;DripCoffeeModule.class&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeShop</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> Pump <span class="title">getPump</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> TestModuleAttr <span class="title">getTestModuleAttr</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><p>åœ¨Componentä¸­å®šä¹‰çš„æ–¹æ³•æˆ‘ä»¬åœ¨å¯¹åº”ç”Ÿæˆçš„DaggerXXXå®ä¾‹è°ƒç”¨å¾—åˆ°å¯¹åº”å®ä¾‹ï¼Œäºæ˜¯æˆ‘ä»¬éœ€è¦ä¸ºå…¶æä¾›å¯¹åº”è¿”å›å®ä¾‹ã€‚</p><blockquote><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥é€šè¿‡æ¨¡æ‹Ÿå®‰å“ä¸­Activityçš„å¯åŠ¨ï¼Œè¯¥ä»£ç å¤§æ¦‚æ¨¡æ‹Ÿäº†ä¸€ä¸‹MVPã€‚ä¸ºäº†ç®€å•ï¼ŒMNActivityä½œä¸ºViewå±‚ï¼Œæˆ‘æ²¡æœ‰å†™MVPæ¥å£çš„Må±‚ã€‚è¿™é‡Œä¸»è¦æ˜¯æƒ³è§£é‡Šä¸ºä»€ä¹ˆåœ¨Compnentæ¥å£ä¸­éœ€è¦å®šä¹‰ä¸€ä¸ª<code>void inject(XXXActivity activity);</code>ï¼Œçœ‹åˆ°åˆ«äººè¿™ä¹ˆå†™çš„ï¼ä½†æˆ‘å½“æ—¶çœŸå¿ƒä¸çŸ¥é“è¿™æ˜¯å•¥æ„æ€ï¼äºæ˜¯è¿™é‡Œæˆ‘æƒ³é€šè¿‡ç®€å•çš„ä»£ç å»ç†è§£å®ƒã€‚</p></blockquote><ol><li><p>æ¨¡æ‹Ÿä¸€ä¸ªActivityï¼Œä¸€èˆ¬æˆ‘ä»¬åœ¨Activityçš„<code>onCreate()</code>æ–¹æ³•ä¸­æ˜¯è¿™æ ·å†™çš„ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MNActivity</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    MNPresenter presenter;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"MNActivity hashCode = "</span> + hashCode());</span><br><span class="line">        DaggerTestComponent</span><br><span class="line">                .builder()</span><br><span class="line">                .mNModule(<span class="keyword">new</span> MNModule(<span class="keyword">this</span>))</span><br><span class="line">                .build()</span><br><span class="line">                .inject(<span class="keyword">this</span>);</span><br><span class="line">        System.out.println(presenter);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>Presenterå±‚ï¼Œåœ¨presenterä¸­ä¸€èˆ¬æˆ‘ä»¬æ˜¯å¼•ç”¨çš„viewçš„æ¥å£ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥å¼•ç”¨activityã€‚</p><ul><li><code>@Inject</code>æ ‡è®°æ„é€ ï¼Œè¡¨æ˜è¿™é‡Œæä¾›MNPresenterå®ä¾‹</li><li>æˆ‘ä»¬çœ‹åˆ°æœ‰æ„é€ æ–¹æ³•å‚æ•°ä¸º<code>MNActivity</code>ï¼Œè¡¨æ˜éœ€è¦å®ä¾‹åŒ–æˆ‘ä»¬åˆéœ€è¦ä¸ºå®ƒæä¾›<code>MNActivity</code>ï¼ˆæˆ‘ä»¬é€šè¿‡Moduleæä¾›ï¼‰<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MNPresenter</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    MNActivity mnActivity;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    MNPresenter(MNActivity mnActivity)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.mnActivity = mnActivity;</span><br><span class="line">        System.out.println(<span class="string">"MNPresenter mnActivity = "</span> + mnActivity.hashCode());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul></li><li><p>å®ä¾‹æä¾›éƒ¨åˆ†ç±»ï¼šModule</p><ul><li><code>MNModule</code>æ˜¯æœ‰å‚æ„é€ ï¼Œé€šè¿‡ä¸Šé¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬çŸ¥é“è¿™ç§æƒ…å†µå¿…é¡»æˆ‘ä»¬è‡ªå·±å®ä¾‹åŒ–Module</li><li>é€šè¿‡<code>provedesActivity</code>æˆ‘ä»¬å¯ä»¥å°†ä¼ é€’è¿›æ¥çš„<code>MNActivity</code>å®ä¾‹ï¼Œæä¾›å‡ºå»ï¼ˆè¿™é‡Œæä¾›ç»™<code>MNPresenter</code>ï¼‰<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MNModule</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    MNActivity mnActivity;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MNModule</span><span class="params">(MNActivity mnActivity)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mnActivity = mnActivity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function">MNActivity <span class="title">provedesActivity</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mnActivity;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul></li><li><p>ç»„è£…çº½å¸¦éƒ¨åˆ†ï¼šComponent</p><ul><li>injectæ–¹æ³•è¿”å›å€¼ä¸ºvoid<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(modules = MNModule.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TestComponent</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inject</span><span class="params">(MNActivity me)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul></li><li><p>å¯åŠ¨Activityç±»</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        MNActivity injectMe = <span class="keyword">new</span> MNActivity();</span><br><span class="line">        injectMe.onCreate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>è¿è¡ŒMainçš„ç»“æœ</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MNActivity hashCode = <span class="number">21685669</span></span><br><span class="line">MNPresenter mnActivity = <span class="number">21685669</span></span><br><span class="line">com.example.jiaji.daggertest.coffee4.MNPresenter@<span class="number">61</span>bbe9ba</span><br></pre></td></tr></table></div></figure></li></ol><blockquote><p>ä¸ºä»€ä¹ˆè¿™ä¹ˆç¥å¥‡å‘¢ï¼Ÿå±…ç„¶å°±è¿™æ ·å°±å°†<code>MNPresenter</code>çš„å®ä¾‹æ³¨å…¥åˆ°<code>MNActivity</code>äº†ï¼<code>DaggerTestComponent</code>å®ç°æˆ‘ä»¬å®šä¹‰çš„<code>void inject(MNActivity me);</code>ï¼Œç„¶ååœ¨æ–¹æ³•é‡Œè¿›è¡Œäº†å¦‚è¿™æ ·çš„æ“ä½œï¼ˆç®€åŒ–åï¼‰ï¼š<code>me.presenter = new Presenter(...);</code></p></blockquote><blockquote><p>æˆ‘ä»¬å°†<code>void inject(MNActivity me);</code>çš„å®ç°ä»£ç å’Œä¸Šé¢æµ‹è¯•<code>@Inject</code>æ—¶å®šä¹‰çš„<code>Thermosiphon getPump();</code>çš„å®ç°ä»£ç è¿›è¡Œæ¯”è¾ƒï¼Œæ¥çœ‹çœ‹æœ‰ä½•åŒºåˆ«ã€‚</p></blockquote><ul><li>æˆ‘ä»¬å…ˆæ¥çœ‹<code>Thermosiphon getPump();</code>æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿé‡æ¸©ä¸€ä¸‹ï¼Œçœ‹ä¸‹å›¾ï¼š<ul><li>å®ƒé¦–å…ˆé€šè¿‡<code>Thermosiphon_Factory.newThermosiphon()</code>ç›´æ¥<code>new Thermosiphon()</code>ã€‚</li><li>ç„¶åè°ƒç”¨<code>injectThermosiphon</code>æ–¹æ³•å°†å®ä¾‹åŒ–çš„<code>Thermosiphon</code>é€šè¿‡<code>Thermosiphon_MembersInjector.injectHeater</code>å°†ä¸€ä¸ª<code>ElectricHeater</code>èµ‹å€¼åˆ°å¯¹åº”çš„æˆå‘˜å˜é‡ã€‚</li><li>æœ€åå°†ä¸€ä¸ªå®Œæˆçš„<code>Thermosiphon</code>è¿”å›ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142542.png" alt="getPump() å®ç°"></li></ul></li><li>æˆ‘ä»¬å†æ¥çœ‹<code>void inject(MNActivity me);</code>æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿçœ‹ä¸‹å›¾ï¼š<ul><li>è¿™é‡Œ<code>inject(MNActivity me)</code>çš„å®ç°çœç•¥æ‰äº†åˆ›å»º<code>MNActivity</code>çš„è¿‡ç¨‹ï¼Œç›´æ¥è°ƒç”¨<code>injectMNActivity</code>è¿›è¡Œæ³¨å…¥ã€‚</li><li>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºå½“å‰<code>MNActivity</code>å¯¹è±¡å·²ç»å­˜åœ¨ï¼Œåªéœ€è¦æ³¨å…¥æ ‡æœ‰<code>@Inject</code>çš„æˆå‘˜å˜é‡å°±è¡Œäº†ã€‚</li><li>æˆ‘ä»¬æƒ³æƒ³Androidä¸­æ‰“å¼€ä¸€ä¸ªActivityï¼Œä»–æ˜¯é€šè¿‡ç³»ç»Ÿå»å®ä¾‹åŒ–çš„ï¼æˆ‘ä»¬æ—¢ç„¶åœ¨Activityå®ä¾‹ä¹‹ä¸­ï¼Œåˆä½•å¿…å»å®ä¾‹åŒ–å®ƒå‘¢ï¼Ÿå¯¹å§ï¼<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142555.png" alt="injectæ–¹æ³•çš„å®ç°"></li></ul></li></ul><h3 id="å°†ä¸Šé¢æ‰€å­¦è¿ç”¨åˆ°ä¸€å¼€å§‹çš„å’–å•¡æœºå®ç°">å°†ä¸Šé¢æ‰€å­¦è¿ç”¨åˆ°ä¸€å¼€å§‹çš„å’–å•¡æœºå®ç°<a href="post/learn-dagger#å°†ä¸Šé¢æ‰€å­¦è¿ç”¨åˆ°ä¸€å¼€å§‹çš„å’–å•¡æœºå®ç°"></a></h3><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------------------------------</span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Heater</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">off</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isHot</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------</span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Pump</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pump</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Thermosiphon</span> <span class="keyword">implements</span> <span class="title">Pump</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Heater heater;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Thermosiphon(Heater heater) &#123;</span><br><span class="line">        System.out.println(<span class="string">"Thermosiphon(Heater heater) - heaterHash = "</span> + heater.hashCode());</span><br><span class="line">        <span class="keyword">this</span>.heater = heater;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pump</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (heater.isHot()) &#123;</span><br><span class="line">            System.out.println(<span class="string">"=&gt;=&gt; æŠ½æ°´ =&gt;=&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ElectricHeater</span> <span class="keyword">implements</span> <span class="title">Heater</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ElectricHeater</span><span class="params">()</span> </span>&#123; System.out.println(<span class="string">"ElectricHeater()"</span>); &#125;</span><br><span class="line">    <span class="keyword">boolean</span> heating;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"~~~~heating~~~~"</span>);</span><br><span class="line">        <span class="keyword">this</span>.heating = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123; <span class="keyword">this</span>.heating = <span class="keyword">false</span>; &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isHot</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> heating; &#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------</span><br><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DripCoffeeModule</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function">Heater <span class="title">provideheater</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"provideheater()"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ElectricHeater();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function">Pump <span class="title">providePump</span><span class="params">(Thermosiphon pump)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"providePump"</span>);</span><br><span class="line">        <span class="keyword">return</span> pump;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å’–å•¡æœº</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeMaker</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Heater heater;<span class="comment">//å½“æˆ‘ä»¬è¦ä½¿ç”¨å®ƒæ—¶æ‰åˆ›å»ºä¸€ä¸ªåŠ çƒ­å™¨</span></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Pump pump;<span class="comment">//æ³µ</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    CoffeeMaker() &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">brew</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"CoffeeMaker - heaterHash = "</span> + heater.hashCode());</span><br><span class="line">        heater.on();</span><br><span class="line">        pump.pump();</span><br><span class="line">        System.out.println(<span class="string">"[_]P coffee! [_]P"</span>);</span><br><span class="line">        heater.off();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------</span><br><span class="line"><span class="meta">@Component</span>(modules = &#123;DripCoffeeModule.class&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CoffeeShop</span> </span>&#123;</span><br><span class="line">    <span class="function">CoffeeMaker <span class="title">maker</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeApp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        CoffeeShop coffeeShop = DaggerCoffeeShop.builder()</span><br><span class="line">                .build();</span><br><span class="line">        coffeeShop.maker().brew();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¾“å‡ºç»“æœ</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">provideheater()</span><br><span class="line">ElectricHeater()</span><br><span class="line">provideheater()</span><br><span class="line">ElectricHeater()</span><br><span class="line">Thermosiphon(Heater heater) - heaterHash = <span class="number">1625635731</span></span><br><span class="line">providePump</span><br><span class="line">CoffeeMaker - heaterHash = <span class="number">1580066828</span></span><br><span class="line">~~~~heating~~~~</span><br><span class="line">[_]P coffee! [_]P</span><br></pre></td></tr></table></div></figure><ul><li>å¤§å®¶æœ‰æœ¨æœ‰å‘ç°ï¼Œå½“è°ƒç”¨<code>heater.on()</code>åè°ƒç”¨<code>pump.pump()</code>å±…ç„¶æ²¡æœ‰å‡ºæ°´(æ²¡æœ‰æ‰“å°ï¼š<code>=&gt;=&gt; æŠ½æ°´ =&gt;=&gt;</code>)</li><li>é€šè¿‡è¾“å‡ºç»“æœæˆ‘ä»¬çœ‹åˆ°<code>provideheater</code>è¢«è°ƒç”¨ä¸¤æ¬¡ä¹Ÿå°±æ˜¯ä¸¤æ¬¡newï¼Œæˆ‘ä»¬è¿˜ä¼šä¼šå‘ç°ï¼š<code>Thermosiphon</code>ä¸­çš„<code>Heater</code>å¯¹è±¡å’Œ<code>CoffeeMaker</code>ä¸­çš„<code>Heater</code>å¯¹è±¡æ‰“å°çš„<code>hashCode</code>ä¸ä¸€æ ·ï¼Œè¿™æ ¹æœ¬å°±æ˜¯ä¸¤ä¸ªå®ä¾‹ã€‚æ€ªä¸å¾—<code>CoffeeMaker</code>ä¸­<code>heater.on()</code>å<code>pump.pump()</code>ä¸å‡ºæ°´ï¼ŒåŸå› å°±æ˜¯<code>Pump</code>ä¸­åˆæ˜¯å¦ä¸€ä¸ª<code>Heater</code>å®ä¾‹ã€‚</li></ul><blockquote><p>çœ‹æ¥é€šè¿‡ä¸Šé¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬çš„å’–å•¡æœºè¿˜æœ‰ç‚¹ç¼ºé™·ã€‚æˆ‘ä»¬éœ€è¦é€šè¿‡ä¸‹é¢æ‰€è®²çš„<code>@Singleton</code>æ¥æ‹¯æ•‘ä¸€ä¸‹è¿™ä¸ªå¤šæ¬¡å®ä¾‹åŒ–çš„é—®é¢˜ã€‚</p></blockquote><blockquote><p>æœ€åæˆ‘å°†ä¸Šé¢è¿™äº›å¤§è‡´ç†è§£æ€è·¯ç”»äº†å¦‚ä¸‹æµç¨‹å›¾ï¼Œå¸Œæœ›èƒ½å¸®åŠ©æ‚¨ç†è§£ï¼š</p></blockquote><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142614.png" alt="dagger-liu-cheng" class="article-img"></p><h3 id="Singletonä¸¶-Scope">@Singletonä¸¶@Scope<a href="post/learn-dagger#Singletonä¸¶-Scope"></a></h3><p><strong><a href="https://github.com/xujiaji/learn-android/blob/master/LearnDagger/app/src/main/java/com/example/jiaji/daggertest/coffee5_test_scope" target="_blank" rel="noopener">æµ‹è¯•æ–‡ä»¶ä½ç½®</a></strong></p><blockquote><p>Singletonï¼šç›´æ¥ç¿»è¯‘è¿‡æ¥æ˜¯ç‹¬ç”Ÿå­çš„æ„æ€ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·å»ç†è§£ï¼Œæ ‡è®°äº†<code>@Singleton</code>æä¾›çš„ç±»ï¼Œåœ¨åŒä¸€ä¸ªComponentå®ä¾‹ä¸­(è¿™æ˜¯æ¡ä»¶)åªå­˜åœ¨ä¸€ä¸ªè¯¥å®ä¾‹ï¼Œå¤šæ¬¡éœ€è¦æ—¶ï¼Œæä¾›çš„å®ä¾‹ä¹Ÿåªæ˜¯ç¬¬ä¸€æ¬¡åˆ›å»ºçš„é‚£ä¸ªå®ä¾‹ã€‚</p></blockquote><ul><li>æˆ‘ä»¬åªéœ€è¦å°†ä¸Šé¢å’–å•¡æœºçš„å®ç°ä»£ç åŠ ä¸¤ä¸ª<code>@Singleton</code>å°±å¯ä»¥è§£å†³é—®é¢˜ï¼å¦‚ä¸‹ä»£ç ï¼š<ul><li>åœ¨æä¾›å®ä¾‹é‚£é‡ŒåŠ ä¸ª<code>@Singleton</code></li><li>åœ¨<code>Component</code>é‚£é‡ŒåŠ ä¸ª<code>@Singleton</code></li><li>ä¹Ÿå°±æ˜¯è¯´<code>@Singleton</code>èµ·æ•ˆï¼Œå¾—æ·»åŠ ä¸¤å¤„</li></ul></li></ul><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">@Singleton</span><br><span class="line">@Component(modules = &#123;DripCoffeeModule.class&#125;)</span><br><span class="line">public interface CoffeeShop &#123;</span><br><span class="line">    CoffeeMaker maker();</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------</span><br><span class="line">@Module</span><br><span class="line">public class DripCoffeeModule &#123;</span><br><span class="line">    @Singleton</span><br><span class="line">    @Provides</span><br><span class="line">    Heater provideheater() &#123;</span><br><span class="line">        System.out.println(&quot;provideheater()&quot;);</span><br><span class="line">        return new ElectricHeater();</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------</span><br><span class="line">--------------------------------------------------------</span><br><span class="line">è¾“å‡ºæ—¥å¿—ï¼š</span><br><span class="line">provideheater()</span><br><span class="line">ElectricHeater()</span><br><span class="line">Thermosiphon(Heater heater) - heaterHash = 1872034366</span><br><span class="line">providePump</span><br><span class="line">CoffeeMaker - heaterHash = 1872034366</span><br><span class="line">~~~~heating~~~~</span><br><span class="line">=&gt;=&gt; æŠ½æ°´ =&gt;=&gt;</span><br><span class="line">[_]P coffee! [_]P</span><br></pre></td></tr></table></div></figure><blockquote><p>é‚£ä¹ˆå¦‚æœæ˜¯<code>@Inject</code>æ ‡è®°çš„æ„é€ æ–¹æ³•çš„æ–¹å¼æ¥æä¾›çš„å¯¹è±¡ï¼Œ<code>@Singleton</code>è¯¥å¦‚ä½•æ ‡è®°å‘¢ï¼Ÿå¦‚ä¸‹ä»£ç ï¼š</p></blockquote><ul><li>æ”¾åˆ°ç±»åä¹‹ä¸Š<figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">@Singleton</span><br><span class="line">public class SingletonTest&#123;</span><br><span class="line">    @Inject</span><br><span class="line">    public SingletonTest()&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------</span><br><span class="line">public class CoffeeMaker &#123;</span><br><span class="line">    ...</span><br><span class="line">    @Inject</span><br><span class="line">    SingletonTest singletonTest1;</span><br><span class="line">    @Inject</span><br><span class="line">    SingletonTest singletonTest2;</span><br><span class="line">    @Inject</span><br><span class="line">    SingletonTest singletonTest3;</span><br><span class="line">    ...</span><br><span class="line">    public void brew() &#123;</span><br><span class="line">        ...</span><br><span class="line">        System.out.println(</span><br><span class="line">                &quot;singletonTest1 = &quot; + singletonTest1.hashCode() + &quot;\n&quot;</span><br><span class="line">                + &quot;singletonTest2 = &quot; + singletonTest2.hashCode() + &quot;\n&quot;</span><br><span class="line">                + &quot;singletonTest3 = &quot; + singletonTest3.hashCode() + &quot;\n&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------</span><br><span class="line">--------------------------------------------------------</span><br><span class="line">è¾“å‡ºæ—¥å¿—ï¼š</span><br><span class="line">...</span><br><span class="line">singletonTest1 = 1581781576</span><br><span class="line">singletonTest2 = 1581781576</span><br><span class="line">singletonTest3 = 1581781576</span><br></pre></td></tr></table></div></figure></li></ul><blockquote><p>ä¸ºä»€ä¹ˆè¯´ä¸Šé¢æ¡ä»¶æ˜¯éœ€è¦åœ¨ä¸€ä¸ªComponentå®ä¾‹ä¸­ï¼ŸåŸå› æ˜¯å¦‚æœComponentè¢«å¤šæ¬¡å®ä¾‹åŒ–ï¼Œé‚£ä¹ˆä¸åŒçš„Componentä¸­@Singletonæ ‡è®°çš„å®ä¾‹ä¹Ÿå°†ä¸åŒï¼</p></blockquote><ul><li>æ¥çœ‹çœ‹ä¸‹é¢æˆ‘ä»¬å¦‚æœæœ‰å¤šä¸ªComponentå®ä¾‹çš„æƒ…å†µ</li><li><p>æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹<code>CoffeeApp</code>è¿™ä¸ªç±»ï¼Œè®©ä»–é‡å¤è°ƒç”¨<code>brew()</code>æ–¹æ³•å’Œé‡æ–°åˆ›å»ºComponent</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeApp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        CoffeeShop coffeeShop = DaggerCoffeeShop.builder()</span><br><span class="line">                .build();</span><br><span class="line">        coffeeShop.maker().brew();</span><br><span class="line">        System.out.println(<span class="string">"*************************************"</span>);</span><br><span class="line">        coffeeShop.maker().brew();</span><br><span class="line">        System.out.println(<span class="string">"*************************************"</span>);</span><br><span class="line">        DaggerCoffeeShop.builder()</span><br><span class="line">                .build()</span><br><span class="line">                .maker()</span><br><span class="line">                .brew();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>è¾“å‡ºç»“æœ(æˆ‘ä»¬åªçœ‹ä¸€äº›å…³é”®éƒ¨åˆ†)ï¼š</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">CoffeeMaker - heaterHash = 1872034366</span><br><span class="line">...</span><br><span class="line">singletonTest1 = 1581781576</span><br><span class="line">...</span><br><span class="line">*************************************</span><br><span class="line">...</span><br><span class="line">CoffeeMaker - heaterHash = 1872034366</span><br><span class="line">...</span><br><span class="line">singletonTest1 = 1581781576</span><br><span class="line">...</span><br><span class="line">*************************************</span><br><span class="line">...</span><br><span class="line">CoffeeMaker - heaterHash = 1725154839</span><br><span class="line">...</span><br><span class="line">singletonTest1 = 1670675563</span><br><span class="line">...</span><br></pre></td></tr></table></div></figure></li><li><p>ä»è¾“å‡ºä¿¡æ¯ä¸­æˆ‘ä»¬å¯çœ‹å‡ºï¼Œç¬¬ä¸€æ¬¡å’Œç¬¬äºŒæ¬¡éƒ½æ˜¯åŒä¸€ä¸ªheaterå®ä¾‹ï¼Œç¬¬ä¸‰æ¬¡å´æ˜¯ä¸åŒçš„å®ä¾‹ï¼Œå› ä¸ºæˆ‘ä»¬é‡æ–°å®ä¾‹åŒ–äº†ä¸€ä¸ªComponentã€‚</p></li><li><p>å¦‚æœæˆ‘ä»¬æƒ³åœ¨å¤šä¸ªåœ°æ–¹è°ƒç”¨çš„æ—¶å€™ä¹Ÿå¾—åˆ°åŒä¸€ä¸ªComponentå®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†Componentä½œä¸ºæŠ½è±¡ç±»ï¼Œå¹¶æ”¹ä¸ºå•ä¾‹ã€‚å¦‚ä¸‹ï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(modules = &#123;DripCoffeeModule.class&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeShop</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> CoffeeShop instance;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> CoffeeMaker <span class="title">maker</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> CoffeeShop <span class="title">getInstance</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (CoffeeShop.class)</span><br><span class="line">            &#123;</span><br><span class="line">                instance = DaggerCoffeeShop.create();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>æˆ‘ä»¬çš„ä½¿ç”¨çš„æ—¶å€™ï¼Œç›´æ¥è¿™æ ·ï¼š<code>CoffeeShop.getInstance().maker().brew()</code></p></li><li>æˆ‘ä»¬åœ¨Androidä¸­ï¼Œå¯ä»¥æŠŠè¿™ç§å…¨å±€çš„å®šä¹‰æ”¾åˆ°<code>Application</code>ä¸­ä¹Ÿå¯ä»¥ç¡®ä¿åœ¨è¯¥è¿›ç¨‹ä¸­çš„å”¯ä¸€ã€‚</li></ul><blockquote><p>ä¸Šé¢è®²äº†<code>@Singleton</code>ï¼Œé‚£ä¹ˆ<code>@Scope</code>åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<code>@Scope</code>æ˜¯ç”¨æ¥æ ‡è¯†æ³¨è§£çš„ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼Œ<code>@Singleton</code>çš„æºç ä½ å°±æ˜ç™½äº†ï¼</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Scope</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Singleton &#123;&#125;</span><br></pre></td></tr></table></div></figure><ul><li>ç”¨<code>@Scope</code>æ ‡è¯†çš„æ³¨è§£éƒ½æœ‰<code>@Singleton</code>çš„åŠŸèƒ½ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥å®šä¹‰æˆ‘ä»¬è‡ªå·±æƒ³è¦çš„åå­—æ¥å®ç°ç›¸åŒåŠŸèƒ½ã€‚</li><li>ä½†éœ€è¦æ³¨æ„ä¸€ç‚¹å°±æ˜¯ç”¨çš„æ—¶å€™ç›¸å¯¹åº”çš„æ³¨è§£å¿…é¡»æ˜¯åŒä¸€ä¸ªï¼ˆæ¯”æ–¹è¯´æˆ‘å®šä¹‰äº†ä¸€ä¸ª<code>@MySingle</code>ï¼Œå°±ä¸èƒ½åœ¨Componenté‚£é‡Œç”¨<code>@MySingle</code>çš„åŒæ—¶ï¼Œå¯¹åº”çš„æä¾›å¯¹è±¡é‚£é‡Œå´ç”¨çš„æ˜¯<code>@Singleton</code>ï¼‰</li></ul><blockquote><p>åˆåˆ°äº†æˆ‘ä»¬åˆ†æç”Ÿæˆä»£ç çš„ç¯èŠ‚ï¼Œå¤§å®¶å¯ä»¥é€‰æ‹©æ€§è·³è¿‡å“¦ï¼(ã€ƒâ€™â–½â€™ã€ƒ)</p></blockquote><ol><li>æˆ‘ä»¬ç›´æ¥æ¥çœ‹<code>DaggerCoffeeShop</code>è¿™ä¸ªç±»ï¼Œå…¶ä»–éƒ½å’Œä¸Šé¢è®²è§£çš„ä¸€æ ·ï¼Œå˜åŒ–å°±åœ¨è¯¥ç±»ï¼<ul><li>æˆ‘ä»¬çœ‹åˆ°ä¸‹å›¾ç”»çº¢çº¿çš„éƒ¨åˆ†ï¼ä»–å°†<code>@Singleton</code>æ ‡è®°çš„å¯¹è±¡ç›´æ¥æ”¾åˆ°äº†<code>DaggerCoffeeShop</code>ä½œä¸ºæˆå‘˜å˜é‡ï¼ˆç”±äºä»£ç å¤ªå¤šï¼Œæˆ‘å°†<code>CoffeeMaker</code>ä¸­çš„<code>SingletonTest</code>éƒ½æ³¨é‡Šäº†ï¼‰ã€‚</li><li>ç­‰ç­‰ï¼<code>Provider&lt;Heater&gt;</code>æ ¹æ®ä¸Šé¢æˆ‘ä»¬å¯¹å·¥å‚ä»£ç çš„ç ”ç©¶ï¼æ¯æ¬¡è°ƒç”¨<code>get()</code>ä¸éƒ½ä¼šé‡æ–°å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡å—ï¼Ÿä¸ºä»€ä¹ˆæ¯æ¬¡<code>get()</code>éƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹ï¼Ÿè¿™å°±æ˜¯ç¬¬äºŒæ ¹çº¢çº¿<code>DoubleCheck</code>çš„å°è£…èµ·çš„ä½œç”¨äº†ï¼<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142629.png" alt="DaggerCoffeeShop"></li></ul></li><li><p><code>DoubleCheck.provider</code>æäº†ä»€ä¹ˆåå ‚ï¼Ÿå¤§å®¶è·Ÿç€æˆ‘ç‚¹è¿›å»æ‚„æ‚„ï¼</p><ul><li><p>æˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªé™æ€æ–¹æ³•ï¼å¾ˆæ˜æ˜¾ï¼Œå®ƒæ˜¯ä¸ºäº†åˆ›å»ºä¸€ä¸ª<code>DoubleCheck</code>å¯¹è±¡ï¼Œå¦‚æœä¼ è¿›æ¥çš„å°±æ˜¯<code>DoubleCheck</code>å¯¹è±¡ï¼Œåˆ™ç›´æ¥è¿”å›å®ä¾‹ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;P extends Provider&lt;T&gt;, T&gt; <span class="function">Provider&lt;T&gt; <span class="title">provider</span><span class="params">(P delegate)</span> </span>&#123;</span><br><span class="line">    checkNotNull(delegate);</span><br><span class="line">    <span class="keyword">if</span> (delegate <span class="keyword">instanceof</span> DoubleCheck) &#123;</span><br><span class="line">        <span class="keyword">return</span> delegate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> DoubleCheck&lt;T&gt;(delegate);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>æˆ‘ä»¬çœ‹åˆ°<code>DoubleCheck</code>ç±»ä¹Ÿæ˜¯å®ç°äº†<code>Provider</code>æ¥å£çš„ï¼Œæ‰€ä»¥åœ¨<code>DaggerCoffeeShop</code>ä¸­æ‰èƒ½ç›´æ¥ç”¨<code>Provider</code>æ¥å¼•ç”¨ã€‚å®ƒæ—¢ç„¶ä¹Ÿæ˜¯ä¸€ä¸ª<code>Provider</code>å´åˆè¦ä¼ å…¥ä¸€ä¸ª<code>Provider</code>ï¼Œå®ƒèµ·äº†ä¸€ä¸ªä»£ç†çš„ä½œç”¨ã€‚</p></li><li>ä¸ºä»€ä¹ˆ<code>get()</code>è°ƒç”¨åæ˜¯åŒä¸€ä¸ªå®ä¾‹ï¼ŸåŸå› æ˜¯<code>get()</code>ä¸­è¿›è¡Œäº†å¤„ç†ï¼Œå¦‚æœ<code>get()</code>è¿‡ä¸€æ¬¡å®ä¾‹ï¼Œé‚£ä¹ˆä¸‹æ¬¡å°†è¿”å›ä¸Šä¸€æ¬¡çš„å®ä¾‹ã€‚ä¸‹é¢æ˜¯è¿™éƒ¨åˆ†æºç ï¼š<ul><li>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒä¸ä»…ä»…ç®€å•å†™äº†åªè¿”å›ä¸€ä¸ªå®ä¾‹çš„çš„ä»£ç ï¼Œè¿˜å†™äº†ä¸€å †å…³äºå¤šçº¿ç¨‹åŒæ­¥ç›¸å…³ä»£ç ã€‚</li><li>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥æ”¾å¿ƒçš„è°ƒç”¨<code>get()</code>æ–¹æ³•ï¼Œè€Œä¸ç”¨æ‹…å¿ƒå› ä¸ºå¤šçº¿ç¨‹è€Œåˆ›å»ºé¢å¤–çš„å®ä¾‹ã€‚<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   Object result = instance;</span><br><span class="line">   <span class="keyword">if</span> (result == UNINITIALIZED) &#123;</span><br><span class="line">       <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">           result = instance;</span><br><span class="line">          <span class="keyword">if</span> (result == UNINITIALIZED) &#123;</span><br><span class="line">                result = provider.get();</span><br><span class="line">                Object currentInstance = instance;</span><br><span class="line">                <span class="keyword">if</span> (currentInstance != UNINITIALIZED &amp;&amp; currentInstance != result) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Scoped provider was invoked recursively returning "</span></span><br><span class="line">                            + <span class="string">"different results: "</span> + currentInstance + <span class="string">" &amp; "</span> + result + <span class="string">". This is likely "</span></span><br><span class="line">                            + <span class="string">"due to a circular dependency."</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                instance = result;</span><br><span class="line">                provider = <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (T) result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul></li></ul></li></ol><h3 id="Reusable">@Reusable<a href="post/learn-dagger#Reusable"></a></h3><p><strong><a href="https://github.com/xujiaji/learn-android/blob/master/LearnDagger/app/src/main/java/com/example/jiaji/daggertest/coffee5_test_scope/CoffeeApp.java" target="_blank" rel="noopener">æµ‹è¯•æ–‡ä»¶ä½ç½®</a></strong></p><p>å®ƒå’Œ<code>@Singleton</code>è¾¾åˆ°çš„æ•ˆæœå·®ä¸å¤šï¼Œè€Œä¸”é€»è¾‘ä¹Ÿå·®ä¸å¤šï¼Œä½†æ˜¯å®ƒå´ä¸ä¿è¯æ˜¯å•å®ä¾‹ï¼</p><p>å®ƒçš„ç”¨æ³•æ¯”<code>@Singleton</code>è¿˜ç®€å•ç‚¹ï¼Œåªéœ€è¦åœ¨æä¾›å®ä¾‹çš„åœ°æ–¹åŠ ä¸ª<code>@Reusable</code>å°±å¯ä»¥äº†ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p><blockquote><p>å°±åƒä¸‹é¢è¿™ä¹ˆç®€å•å°±OKäº†ï¼Œä¸ç”¨åœ¨Componentä¸­æ·»åŠ ã€‚</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DripCoffeeModule</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Reusable</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function">Heater <span class="title">provideheater</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"provideheater()"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ElectricHeater();</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹ï¼Œç”Ÿæˆçš„ä»£ç å’Œ@Singletonçš„ä¸åŒï¼</p></blockquote><ol><li>æˆ‘ä»¬æ”¹ç”¨<code>@Reusable</code>åï¼Œ<code>DaggerCoffeeShop</code>æœ‰ä»€ä¹ˆå˜åŒ–ï¼Ÿ<ul><li>å”¯ä¸€å‘ç”Ÿå˜åŒ–äº†åœ°æ–¹å°±æ˜¯è¿™ä¸ªæ–¹æ³•é‡Œé¢çš„å®ç°ç”±<code>DoubleCheck.provider</code>å˜æˆäº†<code>SingleCheck.provider</code><br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142648.png" alt=""></li></ul></li><li>é‚£æˆ‘ä»¬æ¥åˆ°<code>SingleCheck</code>è¿™ä¸ªç±»ï¼Œå®ƒå’Œ<code>DoubleCheck</code>ä¸åŒç‚¹å°±åœ¨äº<code>get()</code>æ–¹æ³•çš„å®ç°ä¸Šï¼Œè¯·çœ‹ä¸‹é¢<code>SingleCheck</code>çš„<code>get()</code>æºä»£ç ï¼š<ul><li>å¯ä»¥çœ‹åˆ°å®ƒçœå»äº†<code>DoubleCheck</code>ä¸­ä¸€å †å…³äºçº¿ç¨‹åŒæ­¥çš„ä»£ç </li><li>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åœ¨å•çº¿ç¨‹ä¸­æ˜¯å¯ä»¥æ”¾å¿ƒä½¿ç”¨<code>@Reusable</code>è€Œä¸ç”¨æ‹…å¿ƒé‡å¤å®ä¾‹åŒ–ã€‚<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Provider&lt;T&gt; providerReference = provider;</span><br><span class="line">    <span class="keyword">if</span> (instance == UNINITIALIZED) &#123;</span><br><span class="line">        instance = providerReference.get();</span><br><span class="line">        provider = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (T) instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul></li></ol><h3 id="Lazy-æ³¨å…¥">Lazy æ³¨å…¥<a href="post/learn-dagger#Lazy-æ³¨å…¥"></a></h3><p><strong><a href="https://github.com/xujiaji/learn-android/blob/master/LearnDagger/app/src/main/java/com/example/jiaji/daggertest/coffee6_test_lazy_provider" target="_blank" rel="noopener">æµ‹è¯•æ–‡ä»¶ä½ç½®</a></strong></p><p>é€šè¿‡å®ƒå¯ä»¥å®ç°æƒ°æ€§å®ä¾‹åŒ–ï¼Œä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™æ‰ä¼šåˆ›å»ºå®ä¾‹ã€‚å¹¶ä¸”å¤šæ¬¡è°ƒç”¨ä¸ä¼šå†æ¬¡åˆ›å»ºå®ä¾‹ï¼Œåªä¼šè¿”å›ç¬¬ä¸€æ¬¡è°ƒç”¨åˆ›å»ºçš„å®ä¾‹ã€‚</p><blockquote><p>æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„ç”¨æ³•ï¼</p></blockquote><ol><li><p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªéœ€è¦æä¾›çš„å¯¹è±¡</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class LazyEntity</span><br><span class="line">&#123;</span><br><span class="line">    @Inject</span><br><span class="line">    public LazyEntity()</span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(&quot;LazyEntity()&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>ç„¶åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªComponentï¼Œéœ€è¦æä¾›æä¾›ä¸€ä¸ª<code>Main</code>ç±»</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">public interface MyComponent</span><br><span class="line">&#123;</span><br><span class="line">    Main getMain();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ª<code>Main</code>ç±»ã€‚Lazyçš„ä½¿ç”¨æ–¹æ³•å°±æ˜¯å°†è¦ä½¿ç”¨çš„å¯¹è±¡ä½œä¸ºLazyçš„æ³›å‹å‚æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public class Main</span><br><span class="line">&#123;</span><br><span class="line">    @Inject</span><br><span class="line">    Lazy&lt;LazyEntity&gt; entityLazy;</span><br><span class="line"></span><br><span class="line">    @Inject</span><br><span class="line">    public Main() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args)</span><br><span class="line">    &#123;</span><br><span class="line">        Main main = DaggerMyComponent.builder()</span><br><span class="line">                .build()</span><br><span class="line">                .getMain();</span><br><span class="line">        System.out.println(&quot;æ­¤æ—¶LazyEntityè¿˜æ²¡æœ‰å®ä¾‹åŒ–&quot;);</span><br><span class="line">        for (int i = 0; i &lt; 3; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(main.entityLazy.get().hashCode());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>è¾“å‡ºç»“æœï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬é‡å¤è°ƒç”¨éƒ½æ˜¯ä¸€ä¸ªå®ä¾‹ã€‚</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ­¤æ—¶LazyEntityè¿˜æ²¡æœ‰å®ä¾‹åŒ–</span><br><span class="line">LazyEntity()</span><br><span class="line">1625635731</span><br><span class="line">1625635731</span><br><span class="line">1625635731</span><br></pre></td></tr></table></div></figure></li></ol><blockquote><p>æ¥å§ï¼è¿›å…¥ç”Ÿæˆä»£ç åˆ†æé˜¶æ®µï¼ˆå½“ç„¶å¯ä»¥é€‰æ‹©è·³è¿‡å“ˆï¼ï¼‰ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾</p></blockquote><ol><li>æˆ‘ä»¬çœ‹åˆ°Daggerç”Ÿæˆçš„<code>DaggerMyComponent</code>ï¼Œéœ€è¦å€¼å¾—æ³¨æ„çš„å°±æ˜¯ä¸‹é¢å›¾ç‰‡ä¸Šåˆ’çº¿çš„éƒ¨åˆ†ã€‚<ul><li>å¯ä»¥çœ‹åˆ°è¿™é‡Œä¹Ÿä½¿ç”¨äº†<code>DoubleCheck</code>ç±»ï¼ˆå¤§å®¶é€šè¿‡ä¸Šé¢çš„å­¦ä¹ åº”è¯¥ç†Ÿæ‚‰äº†ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¾—åˆ°çš„<code>Lazy</code>å¯¹è±¡å…¶å®å°±æ˜¯ä¸€ä¸ª<code>DoubleCheck</code>ã€‚</li><li>æ‰€ä»¥è¯´æˆ‘ä»¬èƒ½å¤šæ¬¡è°ƒç”¨ä¹Ÿåªèƒ½è¿”å›ç›¸åŒçš„å®ä¾‹ï¼Œè€Œä¸”ä¹Ÿèƒ½åœ¨å¤šçº¿ç¨‹è°ƒç”¨ä¹Ÿä¸æ‹…å¿ƒé‡å¤å®ä¾‹åŒ–ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142703.png" alt="DaggerMyComponent"></li></ul></li><li>é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>DoubleCheck.lazy</code>è¿™ä¸ªé™æ€æ–¹æ³•ï¼Œæºä»£ç å¦‚ä¸‹ï¼š<ul><li>å¯ä»¥çœ‹åˆ°å’Œä¹‹å‰ä»‹ç»çš„<code>DoubleCheck.provider</code>ä¸€ä¸ªæ¨¡å­åˆ»å‡ºæ¥çš„ï¼Œé‚£è¿™é‡Œå¤§å®¶å°±è‡ªè¡Œäº†è§£å’¯ï¼ï¼<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;P extends Provider&lt;T&gt;, T&gt; <span class="function">Lazy&lt;T&gt; <span class="title">lazy</span><span class="params">(P provider)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (provider <span class="keyword">instanceof</span> Lazy) &#123;</span><br><span class="line">        <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>) <span class="keyword">final</span> Lazy&lt;T&gt; lazy = (Lazy&lt;T&gt;) provider;</span><br><span class="line">        <span class="keyword">return</span> lazy;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> DoubleCheck&lt;T&gt;(checkNotNull(provider));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul></li></ol><h3 id="Provider-æ³¨å…¥">Provider æ³¨å…¥<a href="post/learn-dagger#Provider-æ³¨å…¥"></a></h3><p><strong><a href="https://github.com/xujiaji/learn-android/blob/master/LearnDagger/app/src/main/java/com/example/jiaji/daggertest/coffee6_test_lazy_provider" target="_blank" rel="noopener">æµ‹è¯•æ–‡ä»¶ä½ç½®</a></strong></p><p>å½“æ‚¨éœ€è¦å¤šä¸ªå®ä¾‹æ—¶ï¼Œå¯ä»¥é€šè¿‡<code>Provider&lt;T&gt;</code>ä½œä¸ºæˆå‘˜å˜é‡ï¼Œæ‚¨åªéœ€è¦æ¯æ¬¡è°ƒç”¨å®ƒçš„<code>get()</code>æ–¹æ³•å°±ä¼šè¿”å›ä¸åŒçš„å®ä¾‹ã€‚</p><blockquote><p>æˆ‘ä»¬ç›´æ¥å°†ä¸Šé¢ä¾‹å­çš„<code>Lazy</code>æ”¹æˆProviderï¼Œå…¶ä»–éƒ½ä¸å˜ï¼Œå¦‚ä¸‹ï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Provider&lt;LazyEntity&gt; entityLazy;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>æ¥çœ‹ä¸€ä¸‹è¾“å‡ºçš„ç»“æœï¼š</p></blockquote><ul><li>æˆ‘ä»¬å¾ªç¯è°ƒç”¨äº†ä¸‰æ¬¡<code>get()</code>æ–¹æ³•ï¼Œäº§ç”Ÿäº†ä¸‰ä¸ªä¸åŒçš„å®ä¾‹<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æ­¤æ—¶LazyEntityè¿˜æ²¡æœ‰å®ä¾‹åŒ–</span><br><span class="line">LazyEntity()</span><br><span class="line"><span class="number">692404036</span></span><br><span class="line">LazyEntity()</span><br><span class="line"><span class="number">1554874502</span></span><br><span class="line">LazyEntity()</span><br><span class="line"><span class="number">1846274136</span></span><br></pre></td></tr></table></div></figure></li></ul><blockquote><p>æ¥å§ï¼ç”Ÿæˆä»£ç åˆ†æé˜¶æ®µ(ï½¡ï½¥Ï‰ï½¥ï½¡)</p></blockquote><ol><li><p>æˆ‘ä»¬çœ‹<code>DaggerMyComponent</code>ä¸­æ˜¯æ€ä¹ˆæ³¨å…¥çš„ï¼çœ‹åˆ°åˆ’çº¿éƒ¨åˆ†ä¼ å…¥çš„å‚æ•°æ˜¯<code>LazyEntity</code>çš„å·¥å‚ç±»ï¼Œæ„æ€è¯´æˆ‘ä»¬å®šä¹‰çš„æˆå‘˜å˜é‡æŒ‡å‘çš„å°±æ˜¯ä¸€ä¸ªå·¥å‚ç±»<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142728.png" alt=""></p></li><li><p>æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªå·¥å‚ç±»å§ï¼ç›¸ä¿¡å¤§å®¶ä¹Ÿç›¸å½“ç†Ÿæ‚‰äº†ï¼(äºæ˜¯å°±ä¸åšè¯´æ˜äº†ï¼ï¼ï¼)<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142745.png" alt=""></p></li></ol><h3 id="Namedä¸¶-Qualifier">@Namedä¸¶@Qualifier<a href="post/learn-dagger#Namedä¸¶-Qualifier"></a></h3><p><strong><a href="https://github.com/xujiaji/learn-android/blob/master/LearnDagger/app/src/main/java/com/example/jiaji/daggertest/coffee7_test_named_qualifier" target="_blank" rel="noopener">æµ‹è¯•æ–‡ä»¶ä½ç½®</a></strong></p><p>å¤§å®¶å¯ä»¥å…ˆæ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šä¸€ä¸ªæœºå™¨äººå¯¹è±¡æœ‰ä¸¤åªæ‰‹çš„å®ä¾‹ï¼ˆå‡å¦‚æœ‰æ‰‹å®ç°ç±»ï¼š<code>Hand</code>ï¼‰ï¼Œé‚£ä¹ˆDaggeråœ¨æä¾›å®ä¾‹æ—¶ï¼Œå¦‚ä½•æ‰èƒ½åŒºåˆ†è¿™æ˜¯æä¾›ç»™å·¦çš„å®ä¾‹è¿˜æ˜¯æä¾›ç»™å³æ‰‹çš„å®ä¾‹å‘¢ï¼Ÿ</p><blockquote><p>è§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•å¯ä»¥ç”¨<code>@Named</code>åˆ†åˆ«åœ¨å˜é‡åå’Œæä¾›å®ä¾‹çš„åœ°æ–¹éƒ½æ ‡è®°ä¸€ä¸‹åå­—ã€‚è¯¥åå­—ä½œä¸º<code>@Named()</code>çš„å‚æ•°ï¼Œå¦‚ï¼š<code>@Named(&quot;who am i&quot;)</code>ã€‚è¯·çœ‹ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºï¼</p></blockquote><ol><li><p>æˆ‘ä»¬å®šä¹‰æ‰‹å®ç°ç±»</p><ul><li><code>toString()</code>è¾“å‡ºæè¿°ä¿¡æ¯ã€‚<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hand</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String desc;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Hand</span><span class="params">(String desc)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> desc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul></li><li><p>æˆ‘ä»¬å®šä¹‰<code>Module</code>ç±»æä¾›æ‰‹çš„å®ä¾‹</p><ul><li>ä½¿ç”¨<code>@Named</code>æ ‡è®°è¯¥å®ä¾‹æ˜¯å“ªåªæ‰‹ï¼Œå‚æ•°ä¸ºæœºå™¨äººå·¦æ‰‹è¿˜æ˜¯å³æ‰‹<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RobotModule</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Named</span>(<span class="string">"left"</span>)</span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> Hand <span class="title">provideLeftHand</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Hand(<span class="string">"left hand"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Named</span>(<span class="string">"right"</span>)</span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> Hand <span class="title">provideRightHand</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Hand(<span class="string">"right hand"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul></li><li><p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª<code>Robot</code>ï¼ˆå½“ç„¶è¿™é‡ŒRobotåªçœ‹è¿™ä¸¤åªæ‰‹(ï½ï¿£â–½ï¿£)ï½ ï¼‰ï¼Œé¡ºä¾¿æˆ‘å°±ç›´æ¥åœ¨è¿™ä¸ªç±»ä¸­æµ‹è¯•äº†ã€‚</p><ul><li>é€šè¿‡<code>@Named(&quot;left&quot;)</code>æ ‡è®°è¿™é‡Œè¦å¼•ç”¨å·¦æ‰‹çš„å®ä¾‹</li><li>é€šè¿‡<code>@Named(&quot;right&quot;)</code>æ ‡è®°è¿™é‡Œè¦å¼•ç”¨å³çš„å®ä¾‹<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Robot</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Named</span>(<span class="string">"left"</span>)</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Hand leftHand;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Named</span>(<span class="string">"right"</span>)</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Hand rightHand;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Robot</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Robot robot = DaggerRobotComponent.create().getRobot();</span><br><span class="line">        System.out.println(robot.leftHand);</span><br><span class="line">        System.out.println(robot.rightHand);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul></li><li><p>åˆ›å»ºä¸€ä¸ªComponent</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(modules = RobotModule.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">RobotComponent</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function">Robot <span class="title">getRobot</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹è¿è¡Œç»“æœï¼Œå¯ä»¥çœ‹å‡ºè·Ÿæˆ‘ä»¬æ ‡è®°çš„ä¸€æ ·ã€‚</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">left hand</span><br><span class="line">right hand</span><br></pre></td></tr></table></div></figure></li></ol><blockquote><p>é‚£ä¹ˆ<code>@Qualifier</code>åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå…¶å®å®ƒå’Œä¸Šé¢è®²çš„<code>@Scope</code>ä¸€æ ·ï¼Œæ˜¯æ ‡è®°åœ¨æ³¨è§£ä¸Šçš„ï¼Œå°±åƒ<code>@Singleton</code>æ˜¯å®˜æ–¹ä¸ºæˆ‘ä»¬å†™å¥½çš„ä¸€ä¸ªç”¨<code>@Scope</code>æ ‡è®°å¥½çš„æ³¨è§£ã€‚<code>@Named</code>ä¹Ÿæ˜¯å®˜æ–¹ä¸ºæˆ‘ä»¬å‡†å¤‡å¥½çš„ç”¨<code>@Qualifier</code>æ ‡æ³¨çš„æ³¨è§£ã€‚çœ‹@Namedæºç ï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Qualifier</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Named &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** The name. */</span></span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p> å› æ­¤æˆ‘ä»¬å¯ä»¥å®šä¹‰è‡ªå·±<code>@Qualifier</code>ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸ä¼ å‚æ•°çš„ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Qualifier</span></span><br><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Left &#123; &#125;</span><br><span class="line">---------------------------------------------------</span><br><span class="line"><span class="meta">@Qualifier</span></span><br><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Right &#123; &#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ä½¿ç”¨ï¼ˆç»“æœæ˜¯ä¸€æ ·çš„æ•ˆæœï¼‰ï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RobotModule</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Left</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> Hand <span class="title">provideLeftHand</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Hand(<span class="string">"left hand"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Right</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> Hand <span class="title">provideRightHand</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Hand(<span class="string">"right hand"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Robot</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Left</span></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Hand leftHand;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Right</span></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Hand rightHand;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Robot</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p>ç”Ÿæˆçš„ä»£ç åˆ†æï¼š</p></blockquote><ul><li>é€šè¿‡æ ‡è®°åå­—DaggerçŸ¥é“æˆ‘ä»¬å“ªä¸ªå˜é‡å¯¹åº”å“ªä¸ªå®ä¾‹</li></ul><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142803.png" alt="DaggerRobotComponent" class="article-img"></p><h3 id="BindsOptionalOf">@BindsOptionalOf<a href="post/learn-dagger#BindsOptionalOf"></a></h3><p><strong><a href="https://github.com/xujiaji/learn-android/blob/master/LearnDagger/app/src/main/java/com/example/jiaji/daggertest/coffee8_test_optional_binding" target="_blank" rel="noopener">æµ‹è¯•æ–‡ä»¶ä½ç½®</a></strong></p><p>å¯é€‰ç»‘å®šï¼Œæˆ‘ä»¬çŸ¥é“å¦‚æœæŸä¸ªå˜é‡æ ‡è®°äº†<code>@Inject</code>ï¼Œé‚£ä¹ˆå¿…é¡»è¦ä¸ºå®ƒæä¾›å®ä¾‹ï¼Œå¦åˆ™æ— æ³•ç¼–è¯‘é€šè¿‡ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†å˜é‡ç±»å‹æ”¾å…¥<code>Optional&lt;T&gt;</code>æ³›å‹å‚æ•°ï¼Œåˆ™å¯ä»¥è¾¾åˆ°ï¼šå³ä½¿æ²¡æœ‰æä¾›å®ƒçš„å®ä¾‹ï¼Œä¹Ÿèƒ½é€šè¿‡ç¼–è¯‘ã€‚</p><p><code>Optional</code>è¿™ä¸ªç±»æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå®ƒçš„å¼•å…¥æ˜¯ä¸ºäº†è§£å†³Javaä¸­ç©ºæŒ‡é’ˆçš„é—®é¢˜ï¼Œæ‚¨å¯ä»¥å»è¿™é‡Œäº†è§£ä¸€ä¸‹ï¼š<a href="http://www.runoob.com/java/java8-optional-class.html" target="_blank" rel="noopener">Java 8 Optional ç±»</a></p><blockquote><p>æˆ‘ä»¬è¿˜æ˜¯æ‹¿ä»£ç è¯´è¯ï¼è¿™é‡Œæœ‰ä¸€ä¸ªæ¯å­ï¼Œæ¯å­é‡Œå¯ä»¥æœ‰å’–å•¡ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰å’–å•¡ï¼</p></blockquote><blockquote><p>æˆ‘ä»¬å…ˆæ¥çœ‹æœ‰å’–å•¡çš„æ—¶å€™çš„ä»£ç </p></blockquote><ol><li><p>æˆ‘ä»¬é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå’–å•¡ç±»</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Coffee</span> </span>&#123; &#125;</span><br></pre></td></tr></table></div></figure></li><li><p>æˆ‘ä»¬å°†<code>Coffee</code>ç±»å®šä¹‰ä¸ºå¯é€‰çš„ç»‘å®š</p><ul><li>åˆ›å»ºä¸€ä¸ª<code>Module</code>æŠ½è±¡ç±»æ¥å®šä¹‰ï¼Œè¿”å›ç±»å‹å°±æ˜¯å’–å•¡</li><li>ç”¨<code>@BindsOptionalOf</code>æ¥æ ‡è®°<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CModule</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@BindsOptionalOf</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Coffee <span class="title">optionalCoffee</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul></li><li><p>æˆ‘ä»¬åœ¨å®šä¹‰ä¸€ä¸ªæœ‰æä¾›<code>Coffee</code>å®ä¾‹çš„<code>Module</code></p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeModule</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Coffee <span class="title">provideCoffee</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Coffee();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>å®šä¹‰æ¯å­ç±»å’ŒComponent</p><ul><li>æˆ‘ä»¬ç›´æ¥åœ¨<code>Cup</code>æ·»åŠ <code>main</code>æ–¹æ³•è¿›è¡Œæµ‹è¯•</li><li>Componentå°†ä¸¤ä¸ªModuleæ·»åŠ è¿›æ¥<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cup</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Optional&lt;Coffee&gt; coffee;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Cup</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Cup cup = DaggerCComponent.create().getCup();</span><br><span class="line">        System.out.println(cup.coffee);</span><br><span class="line">        <span class="keyword">if</span> (cup.coffee.isPresent())</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">"æœ‰å’–å•¡"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">"æ— å’–å•¡"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">------------------------------------------------------------------</span><br><span class="line"><span class="meta">@Component</span>(modules = &#123;CoffeeModule.class, CModule.class&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CComponent</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function">Cup <span class="title">getCup</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul></li></ol><blockquote><p>è¾“å‡ºç»“æœï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Optional[com.example.jiaji.daggertest.coffee8_optional_binding.Coffee@<span class="number">4</span>b1210ee]</span><br><span class="line">æœ‰å’–å•¡</span><br></pre></td></tr></table></div></figure><ol start="5"><li>å¦‚æœæˆ‘ä»¬å°†<code>CoffeeModule</code>æä¾›<code>Coffee</code>å®ä¾‹çš„æ–¹æ³•æ³¨é‡Šæ‰<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeModule</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="comment">//    @Provides</span></span><br><span class="line"><span class="comment">//    public Coffee provideCoffee()</span></span><br><span class="line"><span class="comment">//    &#123;</span></span><br><span class="line"><span class="comment">//        return new Coffee();</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ol><blockquote><p>è¾“å‡ºç»“æœï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Optional.empty</span><br><span class="line">æ— å’–å•¡</span><br></pre></td></tr></table></div></figure><blockquote><p>è¿™å°±æ˜¯å¯é€‰ç»‘å®šçš„ä½œç”¨ï¼Œ<code>Optional</code>è¿™ä¸ªç±»åœ¨java 8ä¸­ï¼Œå¹¶ä¸”æœ€ä½Android Api 24ã€‚æˆ–è€…ä½ å¯ä»¥é€‰æ‹©å¯¼å…¥<code>guava</code>è¿™ä¸ªç±»åº“ï¼Œä¸è¿‡æˆ‘å»å–µäº†ä¸€çœ¼ï¼Œå®ƒå‘€çš„å¤ªå¤§äº†ï¼ï¼</p></blockquote><p><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142833.png" alt="" class="article-img"></p><blockquote><p>Optionalè¿˜å¯ä»¥è¿™æ ·ç”¨ï¼</p></blockquote><ul><li><code>Optional&lt;Coffee&gt;</code></li><li><code>Optional&lt;Provider&lt;Coffee&gt;&gt;</code></li><li><code>Optional&lt;Lazy&lt;Coffee&gt;&gt;</code></li><li><code>Optional&lt;Provider&lt;Lazy&lt;Coffee&gt;&gt;&gt;</code></li></ul><blockquote><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹ç”Ÿæˆçš„ä»£ç é•¿ä»€ä¹ˆæ ·å§! ãƒ¾(=ï½¥Ï‰ï½¥=)o</p></blockquote><p>ç›®å‰æˆ‘ä»¬ç›´æ¥çœ‹<code>Component</code>å°±å¤Ÿäº†ï¼Œäºæ˜¯æˆ‘ä»¬çœ‹åˆ°<code>DaggerCComponent</code></p><ul><li>è¿™æ˜¯æ²¡æœ‰æä¾›<code>Coffee</code>å®ä¾‹çš„æƒ…å†µä¸‹<ul><li>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ³¨å…¥çš„æ—¶å€™ï¼Œç›´æ¥é€šè¿‡<code>Optional.&lt;Coffee&gt;empty()</code>åˆ›å»ºäº†äº†ä¸€ä¸ªæ²¡æœ‰å†…å®¹çš„<code>Optional</code><br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142852.png" alt="DaggerCComponent"></li></ul></li><li>æ¥çœ‹æä¾›äº†<code>Coffee</code>å®ä¾‹çš„æƒ…å†µ<ul><li>æˆ‘ä»¬éœ€è¦çŸ¥é“<code>Optional.of()</code>æ˜¯å‘<code>Optional</code>é‡Œé¢æ·»åŠ å®ä¾‹çš„æ„æ€ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªåŒ…å«æœ‰è¯¥å®ä¾‹çš„<code>Optional</code>ç±»<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142915.png" alt=""></li></ul></li></ul><h3 id="BindsInstance">@BindsInstance<a href="post/learn-dagger#BindsInstance"></a></h3><p><strong><a href="https://github.com/xujiaji/learn-android/blob/master/LearnDagger/app/src/main/java/com/example/jiaji/daggertest/coffee9_test_bindsinstance" target="_blank" rel="noopener">æµ‹è¯•æ–‡ä»¶ä½ç½®</a></strong></p><p>ç»‘å®šå®ä¾‹ï¼Œå¤§å®¶å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼šå¦‚æœæˆ‘ä»¬æä¾›å®ä¾‹çš„æ—¶å€™ï¼Œéœ€è¦åœ¨è¿è¡Œæ—¶æä¾›å‚æ•°å»åˆ›å»ºï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•åšå‘¢ï¼Ÿ</p><blockquote><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Builderç»‘å®šå®ä¾‹æ¥åšï¼è¿™é‡Œæˆ‘ä»¬ä¸¾ä¾‹ä¸€ä¸ªéœ€è¦å‚æ•°åå­—å’Œçˆ±å¥½æ‰èƒ½åˆ›å»ºçš„<code>User</code>å¯¹è±¡ã€‚</p></blockquote><ol><li><p>åå­—å’Œçˆ±å¥½éƒ½æ˜¯Stringç±»å‹ï¼Œå®šä¹‰äº†ä¸¤ä¸ª<code>@Scope</code>æ³¨è§£æ¥æ ‡è¯†</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Qualifier</span></span><br><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Name &#123; &#125;</span><br><span class="line">----------------------------------------------------------</span><br><span class="line"><span class="meta">@Qualifier</span></span><br><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Love &#123; &#125;</span><br></pre></td></tr></table></div></figure></li><li><p>åˆ›å»ºä¸€ä¸ª<code>User</code>ç±»</p><ul><li>è¯¥ç±»ä¸ºéœ€è¦æä¾›çš„å¯¹è±¡ï¼Œåœ¨æ„é€ æ–¹æ³•ä¸Šç”¨<code>@Inject</code>æ ‡è¯†</li><li>ç”±äºå§“åå’Œçˆ±å¥½éƒ½å±äºStringç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ ‡è®°ä¸€ä¸‹åŒºåˆ†<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String love;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(@Name String name, @Love String love)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.love = love;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User&#123;"</span> +</span><br><span class="line">                <span class="string">"name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", love='"</span> + love + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul></li><li><p>åˆ›å»ºComponentï¼Œè¿™é‡Œæ˜¯å…³é”®éƒ¨åˆ†äº†</p><ul><li>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨è¯¥æ¥å£å†…éƒ¨åœ¨å®šä¹‰Builderæ¥å£ï¼Œè¯¥æ¥å£ç”¨<a href="mailto:`@Component.Builder" target="_blank" rel="noopener">`@Component.Builder</a><code>æ ‡è®°ï¼Œè¡¨ç¤ºè¯¥æ¥å£ä¼šç”±Componentçš„</code>Builder`é™æ€å†…éƒ¨ç±»å®ç°ã€‚</li><li>ç„¶åæˆ‘ä»¬éœ€è¦ä¸ºå®šä¹‰æ–¹æ³•<code>name()</code>å’Œ<code>love()</code>ï¼ŒåŠ ä¸Šæ³¨è§£<code>@BindsInstance</code>ï¼Œè¿”å›ç±»å‹ä¸ºBuilderã€‚ä¼ å…¥çš„å‚æ•°éœ€è¦ç”¨æ³¨è§£æ ‡è¯†ï¼Œå»å¯¹åº”<code>User</code>æ„é€ å‚æ•°ã€‚éœ€è¦æ³¨æ„ä¸€ç‚¹çš„å°±æ˜¯æ–¹æ³•åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¦‚æœå¤šä¸ªå‚æ•°å°±ä¼šæŠ¥é”™ï¼šåªèƒ½æœ‰ä¸€ä¸ªå‚æ•°ã€‚</li><li>æœ€å<code>UComponent build();</code>å°±æ˜¯æˆ‘ä»¬é€šå¸¸æœ€åè°ƒç”¨çš„é‚£ä¸ª<code>build()</code>æ–¹æ³•ï¼Œåˆ›å»ºè¿”å›Componentå®ä¾‹ã€‚<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UComponent</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function">User <span class="title">getUser</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Component</span>.Builder</span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Builder</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="meta">@BindsInstance</span> <span class="function">Builder <span class="title">name</span><span class="params">(@Name String name)</span></span>;</span><br><span class="line">        <span class="meta">@BindsInstance</span> <span class="function">Builder <span class="title">love</span><span class="params">(@Love String love)</span></span>;</span><br><span class="line">        <span class="function">UComponent <span class="title">build</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul></li><li><p>ä½¿ç”¨æµ‹è¯•ï¼š</p><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Main</span><br><span class="line">&#123;</span><br><span class="line">    public static void main(String[] args)</span><br><span class="line">    &#123;</span><br><span class="line">        UComponent uComponent = DaggerUComponent.builder()</span><br><span class="line">                .name(&quot;å¥å“æ›²&quot;)</span><br><span class="line">                .love(&quot;beautiful girl&quot;)</span><br><span class="line">                .build();</span><br><span class="line">        System.out.println(uComponent.getUser());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ol><blockquote><p>è¾“å‡ºç»“æœï¼š</p></blockquote><figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User&#123;name=&apos;å¥å“æ›²&apos;, love=&apos;beautiful girl&apos;&#125;</span><br></pre></td></tr></table></div></figure><p>å¯ä»¥çœ‹å‡ºBindsInstanceå°±æ˜¯å°±æ˜¯æ”¹é€ äº†<code>Component</code>é‡Œé¢çš„<code>Builder</code>ç±»ï¼ŒBuilderç±»å®ç°äº†ç”¨<a href="mailto:`@Component.Builder" target="_blank" rel="noopener">`@Component.Builder</a>`æ ‡æ³¨çš„æ¥å£ã€‚</p><blockquote><p>æ¥ä¸‹æ¥æ¥çœ‹ä¸€ä¸‹ç”Ÿæˆçš„ç›¸å…³ä»£ç ï¼</p></blockquote><ul><li>å¯ä»¥çœ‹åˆ°Componentä¸­çš„<code>Builder</code>å®ç°äº†<code>UComponent.Builder</code>æ¥å£ï¼Œå¹¶å°†ä¼ é€’è¿›æ¥çš„å‚æ•°è¿›è¡Œç©ºæ£€æµ‹ä¸æˆå‘˜å˜é‡å¼•ç”¨</li><li>å¹¶ä¸”å‚æ•°çš„å®ä¾‹ä¹Ÿå°†ä¼šä½œä¸º<code>Component</code>çš„æˆå‘˜å˜é‡ï¼Œå½“åˆ›å»º<code>User</code>æ—¶ä½œä¸ºå…¶å‚æ•°ä¼ å…¥ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611142933.png" alt="DaggerUComponent"></li></ul><h3 id="Component-dependencies">Component dependencies<a href="post/learn-dagger#Component-dependencies"></a></h3><p><strong><a href="https://github.com/xujiaji/learn-android/blob/master/LearnDagger/app/src/main/java/com/example/jiaji/daggertest/coffee10_test_subcomponent_dependencies" target="_blank" rel="noopener">æµ‹è¯•æ–‡ä»¶ä½ç½®</a></strong></p><p><code>dependencies</code>æ˜¯æ³¨è§£<code>@Component</code>ä¸­çš„ä¸€ä¸ªå‚æ•°å¯ä»¥å¼•ç”¨å…¶ä»–<code>Component</code>ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å®ƒçš„æºç ï¼š</p><ul><li>å¯ä»¥çœ‹åˆ°å®ƒçš„å®šä¹‰å’Œ<code>modules</code>æ˜¯ä¸€æ¨¡ä¸€æ ·</li><li>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ä¾èµ–ä¸€ä¸ªæˆ–å¤šä¸ª<code>Component</code><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(TYPE)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Component &#123;</span><br><span class="line">  Class&lt;?&gt;[] modules() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">  Class&lt;?&gt;[] dependencies() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul><p>å®ƒçš„ä¸»è¦ä½œç”¨å°±æ˜¯å°†éœ€è¦ä¾èµ–çš„Componentï¼Œæ”¾åˆ°è‡ªå·±çš„Componentä¸­å½“åšæˆå‘˜å˜é‡ç›´æ¥å¼•ç”¨ã€‚è¢«ä¾èµ–çš„Componentå°±å¯ä»¥ä¸ºä¸»Componentæä¾›å®ƒåœ¨æ¥å£ä¸­å®šä¹‰çš„éœ€è¦è¿”å›çš„å®ä¾‹ã€‚</p><ul><li>å¦‚æœæœ‰<code>AComponent dependencies BComponent</code></li><li>é‚£ä¹ˆåˆ™ç”Ÿæˆ<code>public class DaggerAComponent implements AComponent { BComponent bComponent;...}</code></li><li>å¹¶ä¸”è¿™ä¸ª<code>bComponent</code>å®ä¾‹æ˜¯æˆ‘ä»¬åœ¨<code>Builder</code>ç±»é‡Œé¢ä¼ è¿›å»çš„ã€‚</li></ul><p><code>Component dependency</code>åªå…è®¸æ‚¨é€šè¿‡ç»„ä»¶ä¾èµ–å…³ç³»è®¿é—®æ¥å£ä¸­å…¬å¼€çš„ç±»å‹ï¼Œæ—¢ï¼šä½ åªèƒ½è®¿é—®åˆ°Componentæ¥å£ä¸­å®šä¹‰çš„è¿”å›ç±»å‹ã€‚</p><blockquote><p>æˆ‘ä»¬æ¥å®é™…æ“ä½œï¼ä¾‹å­ï¼šå’–å•¡å’Œæ°´</p></blockquote><ol><li><p>å®šä¹‰å’–å•¡å’Œæ°´çš„å®ä¾‹ï¼Œåœ¨Coffeeä¸­æˆ‘ä»¬è¦†å†™<code>toString()</code>æŠŠCoffeeå’ŒWaterçš„hashCodeæ‰“å°å‡ºæ¥ã€‚</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Water</span> </span>&#123; &#125;</span><br><span class="line">---------------------------------------------------</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Coffee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Water water;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Coffee</span><span class="params">(Water water)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.water = water;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"coffee:"</span> + hashCode() + <span class="string">"; water:"</span> + water.hashCode();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>å®šä¹‰ä¸¤ä¸ªçš„Moduleåˆ†åˆ«æä¾›å®ä¾‹</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WModule</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Water <span class="title">provideWater</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Water();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------</span><br><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CModule</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Coffee <span class="title">provideCoffee</span><span class="params">(Water water)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Coffee(water);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li><li><p>æˆ‘ä»¬å®šä¹‰<code>WComponent</code>ä¸ºWaterçš„Componentï¼Œå®šä¹‰<code>CComponent</code>ä¸ºCoffeeçš„Componentã€‚<code>CComponent</code>ä¾èµ–äº<code>WComponent</code></p><ul><li>å¦‚ä¸‹ä»£ç æˆ‘ä»¬åªéœ€è¦åœ¨æ³¨è§£<code>@Component</code>ä¸­æ·»åŠ <code>dependencies = WComponent.class</code>å°±å¯ä»¥äº§ç”Ÿä¾èµ–ã€‚</li><li>åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨åˆ›å»ºCComponentçš„<code>Builder</code>å¯¹è±¡ä¸­ä¼ å…¥<code>WComponent</code>å°±å¯ä»¥äº†ã€‚<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ComponentDependency</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Component</span>(modules = WModule.class)</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WComponent</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="function">Water <span class="title">water</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Component</span>(modules = CModule.class, dependencies = WComponent.class)</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CComponent</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="function">Coffee <span class="title">coffee</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        WComponent wComponent = DaggerComponentDependency_WComponent</span><br><span class="line">                .create();</span><br><span class="line">        System.out.println(<span class="string">"water:"</span> + wComponent.water().hashCode());</span><br><span class="line"></span><br><span class="line">        CComponent cComponent = DaggerComponentDependency_CComponent</span><br><span class="line">                .builder()</span><br><span class="line">                .wComponent(wComponent)</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        System.out.println(cComponent.coffee());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul></li></ol><blockquote><p>è¾“å‡ºç»“æœï¼š</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">water:<span class="number">1846274136</span></span><br><span class="line">coffee:<span class="number">1639705018</span>; water:<span class="number">1627674070</span></span><br></pre></td></tr></table></div></figure><blockquote><p>é€šè¿‡ç»“æœæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>Water</code>è¢«é‡å¤å®ä¾‹åŒ–äº†ï¼Œæœ€ç®€å•çš„è§£å†³æ–¹æ³•å°±æ˜¯ç›´æ¥åœ¨<code>provideWater()</code>åŠ ä¸Š<code>@Reusable</code>æ³¨è§£ã€‚OKï¼Œè¾¾åˆ°æ•ˆæœ</p></blockquote><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WModule</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Reusable</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Water <span class="title">provideWater</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Water();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------</span><br><span class="line">è¿è¡Œç»“æœï¼š</span><br><span class="line">water:<span class="number">491044090</span></span><br><span class="line">coffee:<span class="number">644117698</span>; water:<span class="number">491044090</span></span><br></pre></td></tr></table></div></figure><blockquote><p>ä½†è¿™ä¹Ÿè®¸ä¸èƒ½ä¿è¯æ‚¨å¾—åˆ°çš„ä¸€å®šæ˜¯åŒä¸€ä¸ªå®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥åŠ ä¸Š<code>@Singleton</code>æ³¨è§£ï¼Œä½†æ˜¯è¿™é‡Œå´æ˜¯ä¸€ä¸ªå‘ï¼å› ä¸ºè¿™äº›Componentçš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä¸èƒ½è·¨å¤šä¸ªComponentç”¨åŒä¸€ä¸ª<code>@Singleton</code>æ¥æ ‡è®°ã€‚å¦‚æœè¿™æ ·åšå°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼š<code>This @Singleton component cannot depend on scoped components</code><a href="https://stackoverflow.com/questions/39709317/dagger-2-singleton-component-depend-on-singleton/39710308" target="_blank" rel="noopener">stackoverflow</a></p></blockquote><ol><li><p>æˆ‘ä»¬å¯è¿™æ ·åšï¼Œè‡ªå®šä¹‰ä¸€ä¸ª<code>Scope</code></p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Scope</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MySingle &#123; &#125;</span><br></pre></td></tr></table></div></figure></li><li><p>æˆ‘ä»¬åœ¨Waterè¿™è¾¹ç”¨<code>@Singleton</code></p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Water <span class="title">provideWater</span><span class="params">()</span></span></span><br><span class="line"><span class="function">---------------------------------------------------</span></span><br><span class="line"><span class="function">    @Singleton</span></span><br><span class="line"><span class="function">    @<span class="title">Component</span><span class="params">(modules = WModule.class)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> interface WComponent</span></span><br></pre></td></tr></table></div></figure></li><li><p>æˆ‘ä»¬åœ¨Coffeeè¿™è¾¹ç”¨<code>@MySingle</code></p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@MySingle</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Coffee <span class="title">provideCoffee</span><span class="params">(Water water)</span></span></span><br><span class="line"><span class="function">---------------------------------------------------</span></span><br><span class="line"><span class="function">    @MySingle</span></span><br><span class="line"><span class="function">    @<span class="title">Component</span><span class="params">(modules = CModule.class, dependencies = WComponent.class)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> interface CComponent</span></span><br></pre></td></tr></table></div></figure></li><li><p>è¾“å‡ºç»“æœOKï¼š</p><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">water:<span class="number">1625635731</span></span><br><span class="line">coffee:<span class="number">1580066828</span>; water:<span class="number">1625635731</span></span><br></pre></td></tr></table></div></figure></li></ol><blockquote><p>æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹Daggeræ‰€ç”Ÿæˆçš„ä»£ç ï¼Œä¸»è¦æˆ‘ä»¬çœ‹åˆ°<code>DaggerComponentDependency_CComponent</code>è¿™ä¸ªç±»ï¼Œä¸»è¦å˜åŒ–äº†åœ¨è¿™é‡Œï¼</p></blockquote><ol><li>æˆ‘ä»¬çœ‹åˆ°<code>DaggerComponentDependency_CComponent</code>çš„å†…éƒ¨Builderé™æ€ç±»<ul><li>ä»ä¸‹é¢åˆ’çº¿çš„åœ°æ–¹æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¿…é¡»è¦ä¼ å…¥ä¾èµ–çš„Componentçš„å®ä¾‹ï¼Œå¦åˆ™ä¼šæŠ›å¼‚å¸¸ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611143001.png" alt="Builder"></li></ul></li><li>æˆ‘ä»¬çœ‹<code>DaggerComponentDependency_CComponent</code>é‡Œé¢çš„å®ç°<ul><li>çœ‹åˆ°ç¬¬ä¸€æ ¹åˆ’çº¿å¤„ï¼Œå®ƒä¼šæŠŠBuilderä¸­ä¾èµ–çš„Componentå®ä¾‹çš„å¼•ç”¨ä¼ é€’ç»™æˆå‘˜å˜é‡ã€‚</li><li>çœ‹åˆ°ç¬¬äºŒæ ¹åˆ’çº¿å¤„ï¼Œè¿™é‡Œå°±è·Ÿæˆ‘ä»¬å¹³å¸¸è°ƒç”¨æ¥å£ä¸­çš„æ–¹æ³•ä¸€æ ·èƒ½è·å¾—éœ€è¦çš„å®ä¾‹ï¼Œä½†æ˜¯è¿™é‡Œå®ä¾‹æ˜¯é€šè¿‡ä¾èµ–çš„Componentæ¥è·å–çš„å®ä¾‹ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611143021.png" alt="DaggerComponentDependency_CComponent"></li></ul></li><li>å½“æˆ‘ä»¬ç”¨äº†Scopeçš„æ—¶å€™ï¼Œ<code>DaggerComponentDependency_CComponent</code>è¿˜ä¼šç”Ÿæˆä¸€ä¸ªé™æ€ç±»å†…éƒ¨ç±»<ul><li>å¯ä»¥çœ‹å‡ºå®ƒå®ç°äº†<code>Provider&lt;T&gt;</code>å› è¯¥å°±æ˜¯ä¸ºäº†é€šè¿‡<code>Provider</code>çš„<code>get()</code>æ–¹æ³•æ¥æä¾›<code>Water</code>å®ä¾‹ã€‚</li><li>å¹¶ä¸”è¿™é‡Œå®ƒå°†ä¾èµ–çš„Componentæ”¾è¿™é‡Œé¢äº†<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611143105.png" alt=""></li></ul></li><li>æˆ‘ä»¬å†æ¥çœ‹æ­¤æ—¶çš„<code>DaggerComponentDependency_CComponent</code><ul><li>å®ƒä¾èµ–çš„åˆ™æ˜¯ä¸Šé¢çš„é™æ€å†…éƒ¨ç±»ã€‚</li><li>å¹¶ä¸”é€šè¿‡æˆ‘ä»¬ç†Ÿæ‚‰çš„<code>DoubleCheck.provider</code>æ¥å¯¹<code>get()</code>å†…é€»è¾‘è¿›è¡Œçš„è½¬å˜ï¼Œä½¿æˆ‘ä»¬åªè·å–ä¸€ä¸ªå®ä¾‹ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611143123.png" alt=""></li></ul></li></ol><h3 id="Subcomponent">@Subcomponent<a href="post/learn-dagger#Subcomponent"></a></h3><p><strong><a href="https://github.com/xujiaji/learn-android/blob/master/LearnDagger/app/src/main/java/com/example/jiaji/daggertest/coffee10_test_subcomponent_dependencies" target="_blank" rel="noopener">æµ‹è¯•æ–‡ä»¶ä½ç½®</a></strong></p><p>æœ€åæˆ‘ä»¬æ¥ç ”ç©¶ä¸€ä¸‹<code>@Subcomponent</code>ï¼Œå°±å¦‚å®ƒåå­—ä¸€æ ·ï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªComponentçš„å­ç±»ã€‚</p><blockquote><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®ƒçš„æºç ï¼š</p></blockquote><ul><li>é™¤äº†æ²¡æœ‰<code>Class&lt;?&gt;[] dependencies() default {};</code>é•¿å¾—å’Œ<code>@Component</code>ä¸€æ ·ã€‚</li><li>ä¹Ÿå°±æ˜¯è¯´<code>Subcomponent</code>å°±ä¸èƒ½ä¾èµ–å…¶ä»–Componentäº†<figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(TYPE)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Subcomponent &#123;</span><br><span class="line">  Class&lt;?&gt;[] modules() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">  <span class="meta">@Target</span>(TYPE)</span><br><span class="line">  <span class="meta">@Documented</span></span><br><span class="line">  <span class="meta">@interface</span> Builder &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ul><p><code>SubComponent</code>å¯ä»¥åœ¨å£°æ˜å®ƒæ—¶ä»çˆ¶çº§è®¿é—®æ•´ä¸ªç»‘å®šå›¾ï¼Œå³å¯ä»¥ä½¿ç”¨åœ¨å…¶<code>Modules</code>ä¸­æä¾›çš„å®ä¾‹ã€‚</p><blockquote><p>æ€ä¹ˆä½¿ç”¨ï¼Œæˆ‘ä»¬å°±ç›´æ¥ç”¨ä¸Šä¸ªå’–å•¡å’Œæ°´çš„ä»£ç ï¼é‡æ–°å†™ä¸€ä¸‹ä»–ä»¬çš„Componentå°±è¡Œã€‚</p></blockquote><ul><li>è¿™é‡Œæˆ‘ä»¬å°†<code>CComponent</code>ä½œä¸ºå­Componentç”¨<code>Subcomponent</code>æ¥æ ‡è®°</li><li>ç„¶åæˆ‘ä»¬è¿˜å¾—åœ¨å®ƒçš„çˆ¶Componentä¸­æ·»åŠ ï¼Œå¦‚ä¸‹é¢ä»£ç ä¸­çš„<code>CComponent cComponent(CModule cModule);</code>ï¼Œå¦‚æœ<code>@Subcomponent</code>æœ‰å¤šä¸ªModuleï¼Œé‚£ä¹ˆå¯ä»¥å°±è¦ä¼ é€’å¤šä¸ªModuleçš„å‚æ•°ã€‚å‡å¦‚æœ‰ï¼š<code>@Subcomponent(modules = {CModule.class, CModule2.class})</code>ï¼Œé‚£ä¹ˆå¯ä»¥è¿™æ ·ï¼š<code>CComponent cComponent(CModule cModule, CModule2 cModule2);</code></li><li>æˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™éœ€è¦å…ˆåˆ›å»ºçˆ¶<code>Component</code>ï¼Œç„¶åæ‰èƒ½å»åˆ›å»ºå­<code>Component</code>ï¼Œå¦‚ä¸‹<code>main()</code>æ–¹æ³•ä¸­</li></ul><figure class="highlight java"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubComponent</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Component</span>(modules = WModule.class)</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WComponent</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="function">CComponent <span class="title">cComponent</span><span class="params">(CModule cModule)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Subcomponent</span>(modules = CModule.class)</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CComponent</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="function">Coffee <span class="title">coffee</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        WComponent wComponent = DaggerSubComponent_WComponent</span><br><span class="line">                .create();</span><br><span class="line"></span><br><span class="line">        CComponent cComponent = wComponent</span><br><span class="line">                .cComponent(<span class="keyword">new</span> CModule());</span><br><span class="line"></span><br><span class="line">        System.out.println(cComponent.coffee());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure><blockquote><p><code>@Subcomponent</code> å’Œ<code>Component dependencies</code>çš„ä¸€äº›å¯¹æ¯”</p></blockquote><ul><li><code>@Subcomponent</code>å®ä¾‹æ˜¯é€šè¿‡çˆ¶Componentåˆ›å»ºã€‚<code>Component dependencies</code>å¯ä»¥ä¾èµ–å¤šä¸ªComponentï¼Œå¹¶ä¸”å„ä¸ªComponentå•ç‹¬åˆ›å»ºä¸”åˆ†ç¦»ã€‚</li><li><code>Component dependencies</code>åªè¿è¡Œæ‚¨è®¿é—®æ¥å£ä¸­å…¬å¼€å®šä¹‰æä¾›çš„å®ä¾‹ï¼Œ<code>@Subcomponent</code>å¯è®¿é—®å…¶<code>Modules</code>ä¸­å£°æ˜çš„æ‰€æœ‰å¯¹è±¡</li><li><code>Component dependencies</code>å­˜åœ¨ç”Ÿå‘½å‘¨æœŸçš„ä¸åŒï¼Œ<code>@Subcomponent</code>æ˜¯æ¯”å½“å‰çˆ¶<code>Component</code> â€œæ›´å°â€çš„å‘¨æœŸã€‚</li></ul><blockquote><p>æ¥çœ‹ä¸€ä¸‹ç”Ÿæˆçš„ä»£ç <code>DaggerSubComponent_WComponent</code>ï¼Œæˆ‘ä»¬å°†å…¶åˆ†æˆä¸‰éƒ¨åˆ†æ¥çœ‹</p></blockquote><ol><li>é¦–å…ˆæˆ‘ä»¬çœ‹åˆ°<code>DaggerSubComponent_WComponent</code>å†…éƒ¨ç±»ï¼šå­Componentçš„å®šä¹‰<ul><li>å®ƒå®ç°äº†æˆ‘ä»¬å®šä¹‰çš„æ¥å£ï¼Œå¹¶ä¸”å’Œæˆ‘ä»¬ä¹‹å‰æ‰€ç”Ÿæˆçš„Componentæ˜¯ç±»ä¼¼çš„ï¼Œåªä¸è¿‡å†…éƒ¨æ²¡æœ‰Builderé™æ€ç±»äº†ã€‚</li><li>ç”±äºæ˜¯å†…éƒ¨ç±»ï¼Œæ‰€ä»¥å®ƒèƒ½è®¿é—®æ‰€æœ‰çˆ¶<code>Component</code>æˆå‘˜ã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611143142.png" alt=""></li></ul></li><li>æˆ‘ä»¬æ¥çœ‹Builderï¼ŒBuilderå¥½è¯´çš„ï¼Œè·³è¿‡ï¼<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611143155.png" alt=""></li><li>æˆ‘ä»¬æ¥çœ‹<code>DaggerSubComponent_WComponent</code>çš„æ–¹æ³•<ul><li>å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬è°ƒç”¨<code>cComponent</code>æ—¶å°±ä¼šåˆ›å»ºä¸€ä¸ªå­Componentç°åœ¨ç±»å®ä¾‹</li><li>è¿™æ˜¯ç”±äºå­Componentæ˜¯æ²¡æœ‰Builderå»åˆ›å»ºçš„ä¹Ÿæ²¡æœ‰é»˜è®¤åˆ›å»º<code>Module</code>çš„åŠŸèƒ½ã€‚å½“ç„¶å­Componentä¹Ÿæ˜¯éœ€è¦ä»–çš„<code>Module</code>çš„ï¼Œäºæ˜¯è¦åˆ›å»ºå®ƒéœ€è¦çš„<code>Module</code>ç»™å®ƒã€‚<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/20180611143210.png" alt="DaggerSubComponent_WComponent"></li></ul></li></ol><p><a href="https://stackoverflow.com/questions/29587130/dagger-2-subcomponents-vs-component-dependencies" target="_blank" rel="noopener">Subcomponentå’ŒComponent dependenciesçš„å…³ç³»åŒºåˆ«</a></p><h3 id="å®‰å“æ‰©å±•çš„ç›¸å…³æ¡†æ¶">å®‰å“æ‰©å±•çš„ç›¸å…³æ¡†æ¶<a href="post/learn-dagger#å®‰å“æ‰©å±•çš„ç›¸å…³æ¡†æ¶"></a></h3><p>å¦‚æœæœ‰æœºä¼šï¼Œå¦‚æœå¸Œæœ›çœ‹æˆ‘è¿™ç§å•°å—¦ä»‹ç»çš„äººå¤šçš„è¯ï¼Œåœ¨å†™ä¸€ç¯‡å…³äºè¿™ä¸ªçš„å§ï¼</p><hr><h3 id="ç»“æŸ">ç»“æŸ<a href="post/learn-dagger#ç»“æŸ"></a></h3><p>å¥½äº†ï¼Œç¥ä¸çŸ¥é¬¼ä¸è§‰çš„ä¸€æ˜ŸæœŸç äº†è¿™ä¹ˆå¤šå­—ã€‚èƒ½æŒ¨ç€çœ‹åˆ°è¿™é‡Œçš„åŒå­¦ï¼Œèƒ½æœ‰å¤šå°‘å’§Î£(ã£Â°Ğ”Â°;)ã£</p><p>æƒ³èµ·æ¥ï¼Œæˆ‘ä»¥å‰å†™äº†ä¸€ä¸ªMVPæ¡†æ¶<a href="https://github.com/xujiaji/XMVP" target="_blank" rel="noopener">XMVP</a>å°±æ˜¯é€šè¿‡è·å–é…ç½®çš„æ³›å‹å‚æ•°ç±»å‹ç„¶åå†é€šè¿‡åå°„å»å®ä¾‹åŒ–çš„è‡ªåŠ¨å®Œæˆå®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚ä¹Ÿå¯ä»¥è¯´æ˜¯è¿™å°±æ˜¯ä¾èµ–æ³¨å…¥äº†å§ï¼å“ˆå“ˆï¼æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥å»çœ‹ä¸€çœ‹ç”¨ä¸€ç”¨éå¸¸ç®€æ´å“¦ï¼(ï½€ãƒ»Ï‰ãƒ»Â´)</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th>ç›¸å…³ä¿¡æ¯</th><th>é“¾æ¥</th></tr></thead><tbody><tr><td>æ–‡ç« ä¸­æ‰€æœ‰ä»£ç çš„åœ°å€</td><td><a href="https://github.com/xujiaji/learn-android/tree/learn-dagger" target="_blank" rel="noopener">https://github.com/xujiaji/learn-android/tree/learn-dagger</a></td></tr><tr><td>æœ¬æ–‡ä½œè€…ï¼ˆæ¬¢è¿å…³æ³¨ï¼‰</td><td><a href="https://juejin.im/user/5829eafe2f301e0057799f1a" target="_blank" rel="noopener">å¥å“æ›²</a></td></tr><tr><td>Github</td><td><a href="https://github.com/xujiaji/" target="_blank" rel="noopener">https://github.com/xujiaji/</a></td></tr><tr><td>ä¸ªäººåšå®¢</td><td><a href="https://blog.xujiaji.com">https://blog.xujiaji.com</a></td></tr><tr><td>æœ¬æ–‡åœ°å€</td><td><a href="https://blog.xujiaji.com/post/learn-dagger">https://blog.xujiaji.com/post/learn-dagger</a></td></tr></tbody></table></div></div><p>å¦‚æœæ–‡ä¸­å†…å®¹æœ‰è¯¯æˆ–ä¸åˆé€‚æ¬¢è¿æ‚¨çš„æŒ‡æ­£ï¼</p><p>over</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/learn-dagger/main-mind.png&quot; alt=&quot;è„‘å›¾&quot; class=&quot;article-img&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;Dagger2-
      
    
    </summary>
    
      <category term="Android" scheme="https://blog.xujiaji.com/categories/Android/"/>
    
    
      <category term="Android" scheme="https://blog.xujiaji.com/tags/Android/"/>
    
      <category term="åˆ†ææ¡†æ¶" scheme="https://blog.xujiaji.com/tags/%E5%88%86%E6%9E%90%E6%A1%86%E6%9E%B6/"/>
    
      <category term="Dagger" scheme="https://blog.xujiaji.com/tags/Dagger/"/>
    
  </entry>
  
  <entry>
    <title>python web ä»Winéƒ¨ç½²åˆ°ubuntuå°è®°</title>
    <link href="https://blog.xujiaji.com/post/python_server_deploy/index.html"/>
    <id>https://blog.xujiaji.com/post/python_server_deploy/index.html</id>
    <published>2018-05-28T07:54:30.000Z</published>
    <updated>2019-04-08T06:56:53.997Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡æ–‡ç« ä¸»è¦æ˜¯ç”¨æ¥è®°å½•æˆ‘å°†pythonåå°éƒ¨ç½²åˆ°amazon ec2æœåŠ¡å™¨çš„å…¨è¿‡ç¨‹ï¼Œä»¥åŠä¸€äº›å‘å‘æ´¼æ´¼ã€‚å¸Œæœ›å¯¹æœ‰éœ€è¦çš„æœ‹å‹æä¾›å¸®åŠ©ï¼Œå¹¶ä¸”å¾€åä¹Ÿå¥½å¿«é€Ÿå›å¿†ã€‚æˆ‘çš„å­¦ä¹ åœ°å€:<a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014323392805925d5b69ddad514511bf0391fe2a0df2b0000" target="_blank" rel="noopener">å»–é›ªå³° å®æˆ˜ Day15-éƒ¨ç½²Web App</a><br><a id="more"></a></p><h2 id="æ³¨å†Œå¹¶åˆ›å»ºAmazon-EC2å®ä¾‹">æ³¨å†Œå¹¶åˆ›å»ºAmazon EC2å®ä¾‹<a href="post/python_server_deploy#æ³¨å†Œå¹¶åˆ›å»ºAmazon-EC2å®ä¾‹"></a></h2><ol><li>é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªè´¦å·ï¼Œæœ‰12 ä¸ªæœˆçš„å…è´¹å¥—é¤è®¿é—®æƒé™ã€‚æ³¨å†Œæµç¨‹æœ‰ç‚¹éº»çƒ¦ï¼Œéœ€è¦æ·»åŠ ä¿¡ç”¨å¡ï¼Œæ”¯ä»˜1ç¾å…ƒæ¥è®¤è¯è´¦å·(â€¢Ìã¸â€¢Ìâ•¬)ã€‚ç„¶åéªŒè¯ç å±…ç„¶æ˜¯æ‰“ç”µè¯è®¤è¯ï¼Œç”µè„‘ä¸Šä¼šæ˜¾ç¤ºéªŒè¯ç ï¼Œéšåç”µè¯æ¥äº†ç­‰å¥¹è¯´å®Œï¼Œæ‰‹æœºè¾“å…¥éªŒè¯ç â€œ#â€ç»“æŸã€‚åˆ°æ­¤å› è¯¥éƒ½æ³¨å†ŒæˆåŠŸäº†ï¼</li><li>æ‰¾åˆ°EC2å¯åŠ¨å®ä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªubuntuçš„å®ä¾‹ï¼Œé»˜è®¤åˆ›å»ºå°±OKäº†ã€‚</li><li>åˆ›å»ºç»“æŸä¼šè®©ä½ è¾“å…¥ä¸€ä¸ªsshå¯†é’¥çš„åç§°ï¼Œä½ è¾“å…¥ä¸€ä¸ªé‚®ç®±ä¹‹ç±»çš„å°±è¡Œäº†ï¼Œéšåä¼šå¸®ä½ ç”Ÿæˆä¸€ä¸ª<code>.pem</code>çš„ç§å¯†ï¼Œä¸‹è½½ä¸‹æ¥æ”¾å¥½å’¯ï¼è¿™ç©æ„å„¿å°±ç›¸å½“äºç™»å½•å¯†ç äº†ã€‚</li><li>ç¼–è¾‘å®‰å…¨ç»„ï¼Œæ·»åŠ 22ç«¯å£å’Œ80ç«¯å£çš„è®¿é—®æƒé™<ul><li>åœ¨EC2ç®¡ç†ç•Œé¢å°†ä½ åˆ›å»ºçš„å®ä¾‹æ‹‰æ‹‰åˆ°æœ€å³è¾¹æœ‰ä¸ªå«å®‰å…¨ç»„çš„æ ç›®ï¼Œç‚¹è¿›å»<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//an_quan_zu1.png" alt=""></li><li>è¿›å»åç‚¹å‡»å…¥ç«™-ç¼–è¾‘<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//an_quan_zu2.png" alt=""></li><li>åˆ›å»ºSSHå…¥ç«™è§„åˆ™ï¼Œç»‘å®šè‡ªå·±çš„IPåœ°å€ï¼Œç¬¬3æ­¥é€‰äº†åä¼šè‡ªåŠ¨è·å–ä½ çš„ipåœ°å€ã€‚å¦‚ä¸‹å›¾<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//an_quan_zu3.png" alt=""></li><li>æ‚¨è¿˜éœ€è¦æ·»åŠ http 80ç«¯å£ï¼Œå¹¶ä¸”è®¾ç½®ä¸ºä»»ä½•ä½ç½®éƒ½å¯è®¿é—®ï¼Œå¦‚ä¸‹ï¼š<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//20180530103931.png" alt=""></li></ul></li></ol><h2 id="è¿æ¥åˆ°æœåŠ¡å™¨">è¿æ¥åˆ°æœåŠ¡å™¨<a href="post/python_server_deploy#è¿æ¥åˆ°æœåŠ¡å™¨"></a></h2><h3 id="ä½¿ç”¨-PuTTY-è¿æ¥åˆ°æœåŠ¡å™¨">ä½¿ç”¨ PuTTY è¿æ¥åˆ°æœåŠ¡å™¨<a href="post/python_server_deploy#ä½¿ç”¨-PuTTY-è¿æ¥åˆ°æœåŠ¡å™¨"></a></h3><ol><li><a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html" target="_blank" rel="noopener">ä¸‹è½½å¹¶å®‰è£…PuTTY</a></li><li>æ‰¾åˆ°PuTTYå®‰è£…ç›®å½•ï¼ŒåŒå‡»æ‰“å¼€<code>puttygen.exe</code></li><li>åŠ è½½ä¹‹å‰æ‚¨ä¸‹è½½çš„<code>.pem</code>æ–‡ä»¶ï¼Œéœ€è¦è½¬æ¢ä¸€ä¸‹ç§å¯†æ ¼å¼<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//load_pem.png" alt=""></li><li>ç‚¹å‡»saveè¿›è¡Œä¿å­˜<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//save_key.png" alt=""><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//server_key2.png" alt=""></li><li>æ‰“å¼€PuTTYè¿›è¡Œé…ç½®<ol><li>é…ç½®SSH<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//load_ppk.png" alt=""></li><li>é…ç½®ä¸»æœºåœ°å€(ubuntuæœåŠ¡å™¨åœ°å€å‰éœ€è¦åŠ ä¸Š<code>ubuntu@</code>)ï¼Œå¹¶ä¿å­˜é…ç½®ã€‚ä¸»æœºåœ°å€<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//server_address.png" alt=""></li><li>æœ€åè¾“å…¥é…ç½®åç§°ç‚¹å‡»ä¿å­˜ï¼Œä¸‹æ¬¡å°±å¯ä»¥ç›´æ¥åŒå‡»å·²é…ç½®å¥½çš„é€‰é¡¹ç›´æ¥è¿›å…¥ã€‚<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//server_config_save.png" alt=""></li><li>æ‰“å¼€åä¹Ÿè®¸ä¹Ÿè®¸ä½ ä¼šå‘ç°è¿›ä¸å»ï¼è¿™æ—¶ä½ éœ€è¦æ£€æŸ¥æœåŠ¡å™¨<code>å®‰å…¨ç»„</code>é‡Œæ˜¯å¦æ·»åŠ SSHï¼ˆå¦‚æœæœ€åä¹Ÿæ— æ³•è¿æ¥å¯æŠŠsshæ¥æºæ”¹ä¸ºä»»ä½•ä½ç½®è¯•è¯•ï¼‰ï¼Œè¿˜æœ‰æ£€æŸ¥windowé˜²ç«å¢™æ˜¯å¦å¼€æ”¾22ç«¯å£ï¼ˆå¯å…³é—­é˜²ç«å¢™è¯•è¯•ï¼Œæˆ–åœ¨é˜²ç«å¢™é«˜çº§è§„åˆ™é‡Œé¢æ·»åŠ 22ç«¯å£è®¿é—®ï¼‰<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//cannot_in_server.png" alt=""></li></ol></li></ol><h3 id="WinSCP-ç®¡ç†æœåŠ¡å™¨æ–‡ä»¶èµ„æº">WinSCP ç®¡ç†æœåŠ¡å™¨æ–‡ä»¶èµ„æº<a href="post/python_server_deploy#WinSCP-ç®¡ç†æœåŠ¡å™¨æ–‡ä»¶èµ„æº"></a></h3><ol><li><a href="https://winscp.net/eng/download.php" target="_blank" rel="noopener">ä¸‹è½½åœ°å€</a></li><li>å®‰è£…æ—¶ä¼šè‡ªåŠ¨æ£€æµ‹åˆ°PuTTYçš„é…ç½®ï¼Œé€‰æ‹©å¯¼å…¥<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//install_winSCP.png" alt=""><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//install_winSCP2.png" alt=""></li><li>ç›´æ¥é€‰ä¸­ä½ çš„ç«™ç‚¹ç™»å½•å°±OKäº†ã€‚</li><li>ä¹Ÿè®¸ä½ ä¼šé‡åˆ°æ²¡æœ‰æƒé™æ— æ³•åˆ›å»ºæ–‡ä»¶çš„æƒ…å†µ<a href="https://blog.csdn.net/xuejinliang/article/details/52301349" target="_blank" rel="noopener">winscpæ™®é€šç”¨æˆ·ä¸Šä¼ æ–‡ä»¶æ²¡æœ‰æƒé™è§£å†³</a></li></ol><h2 id="é…ç½®python-webç¯å¢ƒ">é…ç½®python webç¯å¢ƒ<a href="post/python_server_deploy#é…ç½®python-webç¯å¢ƒ"></a></h2><blockquote><p>æ¥ä¸‹æ¥å¯ä»¥ç›´æ¥åˆ°è¿™é‡Œå»çœ‹éƒ¨ç½²è¿‡ç¨‹äº† <a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014323392805925d5b69ddad514511bf0391fe2a0df2b0000" target="_blank" rel="noopener">å»–é›ªå³° Python Day 15 - éƒ¨ç½²Web App</a></p></blockquote><ol><li>æ­¤æ—¶æˆ‘ä»¬é€šè¿‡PuTTYç™»å½•æœåŠ¡å™¨ï¼Œæˆ‘ä»¬è¾“å…¥pythonï¼Œä¼šå‘ç°è¿›å…¥çš„æ˜¯python2çš„ç‰ˆæœ¬<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//python_version1.png" alt=""></li><li>æˆ‘ä»¬éœ€è¦å®‰è£…python 3.6çš„ç‰ˆæœ¬ï¼Œæ³¨æ„æˆ‘ä»¬ä¸è¦ç›´æ¥<code>apt-get install python3</code>ï¼Œè¿™æ ·ä¼šç›´æ¥å®‰è£…æˆ3.5çš„ç‰ˆæœ¬ï¼Œç„¶è€Œaiomysqlè¿™ä¸ªåº“ä¸æ”¯æŒï¼ŒæŠ˜è…¾äº†è®¸ä¹…ã€‚pip3ä¹Ÿéœ€è¦è‡ªå·±æ‰‹åŠ¨å»å®‰è£…çš„ã€‚</li><li><a href="https://www.cnblogs.com/weiyiming007/p/9075986.html" target="_blank" rel="noopener">Ubuntu16.04å®‰è£…Python3.6 å’Œpip</a></li><li>å®‰è£…<code>Nginx</code>ä¸¶<code>Supervisor</code>ä¸¶<code>MySQL</code>å‘½ä»¤ï¼š<code>$ sudo apt-get install nginx supervisor mysql-server</code><ul><li>mysqlå®‰è£…çš„æ—¶å€™éœ€è¦é…ç½®å¯†ç ï¼Œå¯†ç å¾—è®°å¥½äº†</li><li>ç¼–è¾‘mysqlé…ç½®æ–‡ä»¶è®¾ç½®utf8ç¼–ç ï¼Œè¾“å…¥å‘½ä»¤ï¼š<code>vim /etc/mysql/my.cnf</code></li><li><code>i</code>è¿›å…¥è¾“å…¥æ¨¡å¼ï¼Œæ·»åŠ ä¸‹é¢é…ç½®, <code>Esc</code>è¿›å…¥å‘½ä»¤æ¨¡å¼ <code>:wq</code>è¿›è¡Œä¿å­˜é€€å‡º</li><li>é‡å¯MySQL<figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">default-character-set = utf8</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">default-storage-engine = INNODB</span><br><span class="line">character-set-server = utf8</span><br><span class="line">collation-server = utf8_general_ci</span><br></pre></td></tr></table></div></figure></li></ul></li></ol><p>5.å°†sqlå»ºæ•°æ®åº“å’Œè¡¨çš„é…ç½®æ–‡ä»¶ä¼ åˆ°æœåŠ¡å™¨è¿è¡Œï¼š<code>$ mysql -u root -p &lt; schema.sql</code><br><br>6.é€šè¿‡Navicatè¿æ¥æœåŠ¡å™¨æ•°æ®åº“ï¼Œè¿™é‡Œçš„é…ç½®å°±è·Ÿæœ¬åœ°çš„é…ç½®ä¸€æ ·çš„ï¼Œå¯†ç å°±æ˜¯æ•°æ®åº“çš„å¯†ç ã€‚ç„¶åæˆ‘ä»¬å»é…ç½®SSH<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//navicat_config1.png" alt=""><br>ipåœ°å€å°±æ˜¯ä¹‹å‰æˆ‘ä»¬åœ¨ç½‘é¡µåå°çœ‹åˆ°çš„åœ°å€ï¼Œç«¯å£å·é»˜è®¤çš„22ï¼Œé€‰æ‹©å…¬é’¥éªŒè¯ï¼Œç§å¯†é€‰æ‹©æˆ‘ä»¬ä¹‹å‰ç”¨<code>puttygen.exe</code>å¯¼å‡ºçš„<code>.ppk</code>æ–‡ä»¶ï¼Œå¯†ç çŸ­è¯­å°±æ˜¯åˆ›å»ºæœåŠ¡å™¨ååˆ›å»ºçš„å¯†é’¥åç§°ï¼ˆå¯ä»¥åœ¨EC2ç½‘é¡µåå°çœ‹åˆ°å¯†é’¥åç§°è¿™ä¸€æ ï¼‰<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//navicat_config2.png" alt=""><br>è¿™ä¸‹å°±çˆ½äº†<br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//navicat_config3.png" alt=""><br><br>7.å®‰è£…Web Appç”¨åˆ°çš„pythonåº“ï¼Œå‘½ä»¤ï¼š<code>$ sudo pip3 install jinja2 aiomysql aiohttp</code></p><h2 id="éƒ¨ç½²">éƒ¨ç½²<a href="post/python_server_deploy#éƒ¨ç½²"></a></h2><ol><li>å®‰è£…è‡ªåŠ¨åŒ–éƒ¨ç½²å·¥å…·Fabricï¼Œå‘½ä»¤ï¼š<code>pip3 install fabric3</code></li><li>æ­¤å¤„éƒ½å¯ä»¥å»çœ‹<a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014323392805925d5b69ddad514511bf0391fe2a0df2b0000" target="_blank" rel="noopener">å»–è€å¸ˆæ‰€è®²çš„éƒ¨ç½²</a>ï¼Œå› ä¸ºæ•™ç¨‹æ˜¯å®‰è£…çš„python2ç¯å¢ƒä¸‹çš„fabricæ‰€ä»¥åœ¨è¿™é‡Œç»•äº†å¾ˆä¹…ã€‚</li><li>é…ç½®çš„æ—¶å€™æˆ‘ä»¬é…ç½®éªŒè¯çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨sshæ¥è¿›è¡ŒéªŒè¯ï¼Œ<code>env.hosts</code>å°±æ˜¯ä¹‹å‰æˆ‘ä»¬é…ç½®PuTTYæ˜¯çš„ä¸»æœºåœ°å€ï¼Œ<code>env.key_filename</code>å°±æ˜¯æˆ‘ä»¬ä¸‹è½½çš„sshç§å¯†<code>.pem</code><br><img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy//fabric_config.png" alt=""></li><li>æˆ‘çš„<code>fabric</code>é…ç½®ï¼š<code>fabfile.py</code><figure class="highlight py"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># fabfile.py</span></span><br><span class="line"><span class="keyword">import</span> os, re</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å…¥Fabric API:</span></span><br><span class="line"><span class="keyword">from</span> fabric.api <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æœåŠ¡å™¨ç™»å½•ç”¨æˆ·å:</span></span><br><span class="line"><span class="comment"># env.user = 'ubuntu'</span></span><br><span class="line"><span class="comment"># sudoç”¨æˆ·ä¸ºroot:</span></span><br><span class="line"><span class="comment"># env.sudo_user = 'ubuntu'</span></span><br><span class="line"><span class="comment"># æœåŠ¡å™¨åœ°å€ï¼Œå¯ä»¥æœ‰å¤šä¸ªï¼Œä¾æ¬¡éƒ¨ç½²:</span></span><br><span class="line">env.hosts = [<span class="string">'ubuntu@ec2-18-220-216-89.us-east-2.compute.amazonaws.com'</span>]</span><br><span class="line">env.key_filename = <span class="string">'~/.ssh/jiajixuqqcom.pem'</span></span><br><span class="line"><span class="comment"># env.ssh_config_path = '~/.ssh/config'</span></span><br><span class="line"><span class="comment"># env.use_ssh_config = True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æœåŠ¡å™¨MySQLç”¨æˆ·åå’Œå£ä»¤:</span></span><br><span class="line">db_user = <span class="string">'root'</span></span><br><span class="line">db_password = <span class="string">'6Sb8qzM38'</span></span><br><span class="line"></span><br><span class="line">_TAR_FILE = <span class="string">'dist-awesome.tar.gz'</span></span><br><span class="line">_REMOTE_TMP_TAR = <span class="string">'/tmp/%s'</span> % _TAR_FILE</span><br><span class="line">_REMOTE_BASE_DIR = <span class="string">'/srv/awesome'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">touchfile</span><span class="params">()</span>:</span>                         <span class="comment"># éšä¾¿åˆ›å»ºä¸€ä¸ªä»»åŠ¡ï¼Œç”¨æ¥æµ‹è¯•</span></span><br><span class="line">    run(<span class="string">'touch /tmp/www.txt'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deploy</span><span class="params">()</span>:</span></span><br><span class="line">    newdir = <span class="string">'www-%s'</span> % _now()</span><br><span class="line">    <span class="comment"># åˆ é™¤å·²æœ‰çš„taræ–‡ä»¶:</span></span><br><span class="line">    run(<span class="string">'rm -f %s'</span> % _REMOTE_TMP_TAR)</span><br><span class="line">    <span class="comment"># ä¸Šä¼ æ–°çš„taræ–‡ä»¶:</span></span><br><span class="line">    put(<span class="string">'dist/%s'</span> % _TAR_FILE, _REMOTE_TMP_TAR)</span><br><span class="line">    <span class="comment"># åˆ›å»ºæ–°ç›®å½•:</span></span><br><span class="line">    <span class="keyword">with</span> cd(_REMOTE_BASE_DIR):</span><br><span class="line">        sudo(<span class="string">'mkdir %s'</span> % newdir)</span><br><span class="line">    <span class="comment"># è§£å‹åˆ°æ–°ç›®å½•:</span></span><br><span class="line">    <span class="keyword">with</span> cd(<span class="string">'%s/%s'</span> % (_REMOTE_BASE_DIR, newdir)):</span><br><span class="line">        sudo(<span class="string">'tar -xzvf %s'</span> % _REMOTE_TMP_TAR)</span><br><span class="line">        <span class="comment"># éœ€è¦æ·»åŠ æƒé™æµè§ˆå™¨æ‰èƒ½è®¿é—®</span></span><br><span class="line">        sudo(<span class="string">'chmod -R 775 static/'</span>)</span><br><span class="line">        sudo(<span class="string">'chmod 775 favicon.ico'</span>)</span><br><span class="line">        <span class="comment"># ç”±äºapp.pyçš„æ–‡ä»¶æ ¼å¼æœ‰é—®é¢˜ï¼Œè½¬æ¢ä¸€ä¸‹</span></span><br><span class="line">        run(<span class="string">'dos2unix app.py'</span>)</span><br><span class="line">    <span class="comment"># é‡ç½®è½¯é“¾æ¥:</span></span><br><span class="line">    <span class="keyword">with</span> cd(_REMOTE_BASE_DIR):</span><br><span class="line">        sudo(<span class="string">'rm -f www'</span>)</span><br><span class="line">        sudo(<span class="string">'ln -s %s www'</span> % newdir)</span><br><span class="line">        sudo(<span class="string">'chown ubuntu:ubuntu www'</span>)</span><br><span class="line">        sudo(<span class="string">'chown -R ubuntu:ubuntu %s'</span> % newdir)</span><br><span class="line">    <span class="comment"># é‡å¯PythonæœåŠ¡å’ŒnginxæœåŠ¡å™¨:</span></span><br><span class="line">    <span class="keyword">with</span> settings(warn_only=<span class="keyword">True</span>):</span><br><span class="line">        sudo(<span class="string">'supervisorctl stop awesome'</span>)</span><br><span class="line">        sudo(<span class="string">'supervisorctl start awesome'</span>)</span><br><span class="line">        sudo(<span class="string">'/etc/init.d/nginx reload'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build</span><span class="params">()</span>:</span></span><br><span class="line">    includes = [<span class="string">'static'</span>, <span class="string">'templates'</span>, <span class="string">'transwarp'</span>, <span class="string">'favicon.ico'</span>, <span class="string">'*.py'</span>]</span><br><span class="line">    excludes = [<span class="string">'test'</span>, <span class="string">'.*'</span>, <span class="string">'*.pyc'</span>, <span class="string">'*.pyo'</span>]</span><br><span class="line">    local(<span class="string">'rm -f dist/%s'</span> % _TAR_FILE)</span><br><span class="line">    <span class="keyword">with</span> lcd(os.path.join(os.path.abspath(<span class="string">'.'</span>), <span class="string">'www'</span>)):</span><br><span class="line">        cmd = [<span class="string">'tar'</span>, <span class="string">'--dereference'</span>, <span class="string">'-czvf'</span>, <span class="string">'../dist/%s'</span> % _TAR_FILE]</span><br><span class="line">        cmd.extend([<span class="string">'--exclude=\'%s\''</span> % ex <span class="keyword">for</span> ex <span class="keyword">in</span> excludes])</span><br><span class="line">        cmd.extend(includes)</span><br><span class="line">        local(<span class="string">' '</span>.join(cmd))</span><br></pre></td></tr></table></div></figure></li></ol><h2 id="æ·»åŠ https">æ·»åŠ https<a href="post/python_server_deploy#æ·»åŠ https"></a></h2><p>æ·»åŠ è¿™ä¸ªçš„åŸå› å˜›ï¼å°±ä¸åŠ å¤šå°‘çš„å•¦ï¼æ¥çœ‹å¦‚ä½•å¦‚ä½•åšå§ï¼</p><ol><li>æˆ‘æ˜¯åœ¨é˜¿é‡Œäº‘ä¸Šé¢æ‰¾çš„ä¸€ä¸ªå…è´¹ç‰ˆï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼Œè¿›å»åç‚¹å‡»ç«‹å³è´­ä¹°<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy/aliyun_ac1.png" alt=""></li><li>é€‰æ‹©å…è´¹ç±»å‹ï¼Œå¦‚ä¸‹æ“ä½œ<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy/aliyun_ac2.png" alt=""></li><li>ç„¶åå°±æ˜¯éœ€è¦å¡«å†™ä¸€äº›æ‚¨çš„ä¸ªäººä¿¡æ¯å’Œéœ€è¦ç»‘å®šçš„åŸŸåï¼Œæ¯”å¦‚æˆ‘ç»‘å®šï¼š<code>www.xujiaji.com</code>ï¼Œæäº¤å®¡æ ¸ã€‚ï¼ˆæ­¤æ—¶å¯èƒ½éœ€è¦ç­‰ä¸ªåŠä¸ªæ¥å°æ—¶å®¡æ ¸ï¼‰</li><li>ç‚¹å‡»ä¸‹è½½<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy/aliyun_ac_3.png" alt=""></li><li>ç‚¹å‡»ä¸‹è½½è¯ä¹¦for Nginxï¼Œç„¶åå°†å‹ç¼©åŒ…è§£å‹å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶ã€‚æˆ‘ä»¬å°†è¿™ä¸¤ä¸ªæ–‡ä»¶æ”¾åˆ°å¦‚ä¸‹ä½ç½®ï¼Œ<code>/ect/nginx/</code>æ˜¯æœåŠ¡å™¨nginxçš„å®‰è£…ç›®å½•ï¼Œ<code>cert</code>æ˜¯æ–°å»ºçš„ç›®å½•ï¼Œå°±æ”¾è¿™é‡Œé¢<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy/config_https1.png" alt=""></li><li>ç„¶åæˆ‘ä»¬ç¼–è¾‘<code>/etc/nginx/sites-available/awesome</code>ï¼Œæˆ‘ä»¬å°†è¿™äº›ä¸œè¥¿ç›´æ¥æ‹·è´è¿‡æ¥<img src="https://xujiaji.oss-cn-beijing.aliyuncs.com/blog/python-web-deploy/config_https2.png" alt=""></li><li>é‡å¯nginxï¼š<code>sudo /etc/init.d/nginx reload</code></li><li>é…ç½®å®Œæˆåæ‚¨å¯èƒ½è¿˜æ˜¯æ— æ³•è®¿é—®httpsï¼ˆæˆ‘å°±åœ¨è¿™çº ç»“äº†åŠå¤©ï¼‰ï¼Œæ³¨æ„éœ€è¦åœ¨æœåŠ¡å™¨å®‰å…¨ç»„æ·»åŠ æ‰€æœ‰ç”¨æˆ·å¯¹<code>443</code>ç«¯å£çš„è®¿é—®æƒé™ã€‚</li><li>ä¸‹é¢æ˜¯æˆ‘çš„nginxæ•´ä½“é…ç½®ä»£ç ï¼Œå«ä¹‰è¯·çœ‹æ³¨é‡Š<figure class="highlight plain"><div><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    # ç›‘å¬80ç«¯å£ï¼Œä½œç”¨æ˜¯å°†ç”¨æˆ·httpçš„è¯·æ±‚è½¬å‘åˆ°https</span><br><span class="line">    listen      80;</span><br><span class="line">    # ç»‘å®šçš„åŸŸå</span><br><span class="line">    server_name www.xujiaji.com;</span><br><span class="line">    rewrite ^(.*)$  https://www.xujiaji.com permanent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    #listen      80;</span><br><span class="line">    # ä¸‹é¢è¿™éƒ¨åˆ†å°±æ˜¯ä»é˜¿é‡Œäº‘ä¸‹è½½ACè®¤è¯é‚£é‡Œç›´æ¥æ‹·è´è¿‡æ¥çš„é…ç½®</span><br><span class="line">    listen 443;</span><br><span class="line">    ssl on;</span><br><span class="line">    ssl_certificate   cert/214731123750166.pem;</span><br><span class="line">    ssl_certificate_key  cert/214731123750166.key;</span><br><span class="line">    ssl_session_timeout 5m;</span><br><span class="line">    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">    ssl_prefer_server_ciphers on;    </span><br><span class="line"></span><br><span class="line">    # ä»£ç†çš„æœåŠ¡å™¨æ ¹ç›®å½• æ—¥å¿—</span><br><span class="line">    root       /srv/awesome/www;</span><br><span class="line">    access_log /srv/awesome/log/access_log;</span><br><span class="line">    error_log  /srv/awesome/log/error_log;</span><br><span class="line"></span><br><span class="line">    server_name www.xujiaji.com;</span><br><span class="line"></span><br><span class="line">    client_max_body_size 1m;</span><br><span class="line"></span><br><span class="line">    gzip            on;</span><br><span class="line">    gzip_min_length 1024;</span><br><span class="line">    gzip_buffers    4 8k;</span><br><span class="line">    gzip_types      text/css application/x-javascript application/json;</span><br><span class="line"></span><br><span class="line">    sendfile on;</span><br><span class="line"></span><br><span class="line">    location /favicon.ico &#123;</span><br><span class="line">        root /srv/awesome/www;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location ~ ^\/static\/.*$ &#123;</span><br><span class="line">        root /srv/awesome/www;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass       http://127.0.0.1:9000;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header Host $host;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ¬ç¯‡æ–‡ç« ä¸»è¦æ˜¯ç”¨æ¥è®°å½•æˆ‘å°†pythonåå°éƒ¨ç½²åˆ°amazon ec2æœåŠ¡å™¨çš„å…¨è¿‡ç¨‹ï¼Œä»¥åŠä¸€äº›å‘å‘æ´¼æ´¼ã€‚å¸Œæœ›å¯¹æœ‰éœ€è¦çš„æœ‹å‹æä¾›å¸®åŠ©ï¼Œå¹¶ä¸”å¾€åä¹Ÿå¥½å¿«é€Ÿå›å¿†ã€‚æˆ‘çš„å­¦ä¹ åœ°å€:&lt;a href=&quot;https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014323392805925d5b69ddad514511bf0391fe2a0df2b0000&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å»–é›ªå³° å®æˆ˜ Day15-éƒ¨ç½²Web App&lt;/a&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Python" scheme="https://blog.xujiaji.com/categories/Python/"/>
    
    
      <category term="ç¬”è®°" scheme="https://blog.xujiaji.com/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="Linux" scheme="https://blog.xujiaji.com/tags/Linux/"/>
    
      <category term="Python" scheme="https://blog.xujiaji.com/tags/Python/"/>
    
  </entry>
  
</feed>
