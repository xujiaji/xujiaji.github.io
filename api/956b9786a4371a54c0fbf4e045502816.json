{"title":"HappyBubble-气泡对话框（根据被点击View位置显示、可定制）","slug":"happy-bubble","url":"http://yoursite.com/happy-bubble","author":"xujiaji","date":"2017-12-16T06:08:50.000Z","updated":"2018-02-28T08:27:53.145Z","comments":true,"excerpt":"","thumbnail":"image/happy-bubble/img5.png","tags":["android","library"],"content":"<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://github.com/xujiaji/HappyBubble/releases\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/Download-demo--apk-brightgreen.svg\" alt=\"GitHub release\"></a></td>\n<td><a href=\"https://bintray.com/xujiaji/maven/happy-bubble/1.1.0\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/bintray-1.1.0-brightgreen.svg\" alt=\"GitHub release\"></a></td>\n</tr>\n</tbody>\n</table>\n<p><a href=\"https://github.com/xujiaji/HappyBubble\" target=\"_blank\" rel=\"noopener\">Github</a></p>\n<p>气泡布局的形状可以改变，如四角弧度、气泡颜色、箭头大小和阴影。</p>\n<p>气泡Dialog可以根据被点击的view的位置来确定自己展示的位置。</p>\n<h2 id=\"更新\"><a href=\"#更新\" class=\"headerlink\" title=\"更新\"></a>更新</h2><ul>\n<li><p>1.1.0:<br>①Dialog交互事件传递到Activity达到不在不关闭Dialog的情况下做其他Activity的操作。<br>②添加自动根据被点击View距离屏幕边缘的距离确定Dialog的位置。<br>③新增“autoPosition”和“setThroughEvent”方法，请参考“BubbleDialog方法参考表”<br><img src=\"image/happy-bubble/1.1.0.gif\" alt=\"1.1.0.gif\"></p>\n</li>\n<li><p>1.0.3:继续优化了点击在气泡之外才会被dismiss；修复了Dialog周围会有部分点击无法dismiss；</p>\n</li>\n<li><p>1.0.2:修复点击dialog边缘无法取消</p>\n</li>\n</ul>\n<h2 id=\"如何开始\"><a href=\"#如何开始\" class=\"headerlink\" title=\"如何开始?\"></a>如何开始?</h2><p>在你模块中的build.gradle添加上HappyBubble依赖<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compile &apos;com.github.xujiaji:happy-bubble:1.1.0&apos;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"如何使用-HappyBubble-BubbleDialog\"><a href=\"#如何使用-HappyBubble-BubbleDialog\" class=\"headerlink\" title=\"如何使用 HappyBubble-BubbleDialog?\"></a>如何使用 HappyBubble-BubbleDialog?</h2><blockquote>\n<p>方法参考表</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">方法名</th>\n<th style=\"text-align:center\">参数</th>\n<th style=\"text-align:left\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">addContentView</td>\n<td style=\"text-align:center\">View</td>\n<td style=\"text-align:left\">添加填充在气泡中的视图</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">setClickedView</td>\n<td style=\"text-align:center\">View</td>\n<td style=\"text-align:left\">被点击的View（触发Dialog出现的View）</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">setPosition</td>\n<td style=\"text-align:center\">enum BubbleDialog.Position:LEFT, TOP, RIGHT, BOTTOM</td>\n<td style=\"text-align:left\">BubbleDialog相对于被点击的view的位置</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">calBar</td>\n<td style=\"text-align:center\">boolean</td>\n<td style=\"text-align:left\">是否计算状态栏的高度（如果布局没有全屏，则需要计算）</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">setOffsetX</td>\n<td style=\"text-align:center\">int</td>\n<td style=\"text-align:left\">如果您对dialog所展示的x轴位置不满，需要调整x轴方向偏移</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">setOffsetY</td>\n<td style=\"text-align:center\">int</td>\n<td style=\"text-align:left\">如果您对dialog所展示的y轴位置不满，需要调整y轴方向偏移</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">setBubbleLayout</td>\n<td style=\"text-align:center\">BubbleLayout</td>\n<td style=\"text-align:left\">自定义dialog的气泡布局</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">setTransParentBackground</td>\n<td style=\"text-align:center\">-</td>\n<td style=\"text-align:left\">背景透明</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">softShowUp</td>\n<td style=\"text-align:center\">-</td>\n<td style=\"text-align:left\">当气泡dialog中有EditText时，软键盘弹出会遮挡EditText时，dialog随软键盘上移。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">show</td>\n<td style=\"text-align:center\">-</td>\n<td style=\"text-align:left\">显示</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">autoPosition</td>\n<td style=\"text-align:center\">boolean</td>\n<td style=\"text-align:left\">是否开启自动确定位置功能，开启后，“setPosition”功能失效</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">setThroughEvent</td>\n<td style=\"text-align:center\">boolean, boolean</td>\n<td style=\"text-align:left\">第一个参数isThroughEvent设置是否穿透Dialog手势交互。<br>第二个参数cancelable 点击空白是否能取消Dialog，只有当”isThroughEvent = false”时才有效</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"最简单的实现\"><a href=\"#最简单的实现\" class=\"headerlink\" title=\"最简单的实现\"></a>最简单的实现</h3><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><img src=\"image/happy-bubble/img_example1.png\" alt=\"exampel1\"></td>\n<td><img src=\"image/happy-bubble/img_example2.png\" alt=\"exampel2\"></td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>需要提供：Context、填充的View、被点击的View。<br><br>如果最外层布局没有全屏时，您需要计算状态栏的高度，否则会多向下偏移一个状态栏的高度。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> BubbleDialog(<span class=\"keyword\">this</span>)</span><br><span class=\"line\">        .addContentView(LayoutInflater.from(<span class=\"keyword\">this</span>).inflate(R.layout.dialog_view3, <span class=\"keyword\">null</span>))</span><br><span class=\"line\">        .setClickedView(mButton)</span><br><span class=\"line\">        .calBar(<span class=\"keyword\">true</span>)</span><br><span class=\"line\">        .show();</span><br></pre></td></tr></table></figure>\n<h3 id=\"向下偏移8dp\"><a href=\"#向下偏移8dp\" class=\"headerlink\" title=\"向下偏移8dp\"></a>向下偏移8dp</h3><p><img src=\"image/happy-bubble/img_example3.png\" alt=\"exampel3\"><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> BubbleDialog(<span class=\"keyword\">this</span>)</span><br><span class=\"line\">        .addContentView(LayoutInflater.from(<span class=\"keyword\">this</span>).inflate(R.layout.dialog_view3, <span class=\"keyword\">null</span>))</span><br><span class=\"line\">        .setClickedView(mButton4)</span><br><span class=\"line\">        .setPosition(mPosition)</span><br><span class=\"line\">        .setOffsetY(<span class=\"number\">8</span>)</span><br><span class=\"line\">        .calBar(<span class=\"keyword\">true</span>)</span><br><span class=\"line\">        .show();</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"当想要输入框随软键盘上移时\"><a href=\"#当想要输入框随软键盘上移时\" class=\"headerlink\" title=\"当想要输入框随软键盘上移时\"></a>当想要输入框随软键盘上移时</h3><p><img src=\"image/happy-bubble/gif_example4.gif\" alt=\"exampel4\"><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> BubbleDialog(<span class=\"keyword\">this</span>)</span><br><span class=\"line\">        .addContentView(LayoutInflater.from(<span class=\"keyword\">this</span>).inflate(R.layout.dialog_view, <span class=\"keyword\">null</span>))</span><br><span class=\"line\">        .setClickedView(mButton12)</span><br><span class=\"line\">        .setPosition(mPosition)</span><br><span class=\"line\">        .calBar(<span class=\"keyword\">true</span>)</span><br><span class=\"line\">        .softShowUp()</span><br><span class=\"line\">        .show();</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"自定义-BubbleLayout\"><a href=\"#自定义-BubbleLayout\" class=\"headerlink\" title=\"自定义 BubbleLayout.\"></a>自定义 BubbleLayout.</h3><p><img src=\"image/happy-bubble/img_example5.png\" alt=\"exampel5\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">BubbleLayout bl = <span class=\"keyword\">new</span> BubbleLayout(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">bl.setBubbleColor(Color.BLUE);</span><br><span class=\"line\">bl.setShadowColor(Color.RED);</span><br><span class=\"line\">bl.setLookLength(Util.dpToPx(<span class=\"keyword\">this</span>, <span class=\"number\">54</span>));</span><br><span class=\"line\">bl.setLookWidth(Util.dpToPx(<span class=\"keyword\">this</span>, <span class=\"number\">48</span>));</span><br><span class=\"line\"><span class=\"keyword\">new</span> BubbleDialog(<span class=\"keyword\">this</span>)</span><br><span class=\"line\">        .addContentView(LayoutInflater.from(<span class=\"keyword\">this</span>).inflate(R.layout.dialog_view5, <span class=\"keyword\">null</span>))</span><br><span class=\"line\">        .setClickedView(mButton8)</span><br><span class=\"line\">        .setPosition(mPosition)</span><br><span class=\"line\">        .calBar(<span class=\"keyword\">true</span>)</span><br><span class=\"line\">        .setBubbleLayout(bl)</span><br><span class=\"line\">        .show();</span><br></pre></td></tr></table></figure>\n<h3 id=\"自定义-BubbleDialog，可交互的-BubbleDialog\"><a href=\"#自定义-BubbleDialog，可交互的-BubbleDialog\" class=\"headerlink\" title=\"自定义 BubbleDialog，可交互的 BubbleDialog.\"></a>自定义 BubbleDialog，可交互的 BubbleDialog.</h3><p><img src=\"image/happy-bubble/gif_example6.gif\" alt=\"exampel6\"></p>\n<blockquote>\n<p>1、布局</p>\n</blockquote>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">LinearLayout</span> <span class=\"attr\">xmlns:android</span>=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:layout_width</span>=<span class=\"string\">\"160dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:layout_height</span>=<span class=\"string\">\"match_parent\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:orientation</span>=<span class=\"string\">\"vertical\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">Button</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:id</span>=<span class=\"string\">\"@+id/button13\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:layout_width</span>=<span class=\"string\">\"match_parent\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:layout_height</span>=<span class=\"string\">\"wrap_content\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:text</span>=<span class=\"string\">\"Button1\"</span> /&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">Button</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:id</span>=<span class=\"string\">\"@+id/button14\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:layout_width</span>=<span class=\"string\">\"match_parent\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:layout_height</span>=<span class=\"string\">\"wrap_content\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:text</span>=<span class=\"string\">\"Button2\"</span> /&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">Button</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:id</span>=<span class=\"string\">\"@+id/button15\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:layout_width</span>=<span class=\"string\">\"match_parent\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:layout_height</span>=<span class=\"string\">\"wrap_content\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:text</span>=<span class=\"string\">\"Button3\"</span> /&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>2、自定义 BubbleDialog</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 自定义可操作性dialog</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JiajiXu on 17-12-11.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CustomOperateDialog</span> <span class=\"keyword\">extends</span> <span class=\"title\">BubbleDialog</span> <span class=\"keyword\">implements</span> <span class=\"title\">View</span>.<span class=\"title\">OnClickListener</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ViewHolder mViewHolder;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> OnClickCustomButtonListener mListener;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CustomOperateDialog</span><span class=\"params\">(Context context)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>(context);</span><br><span class=\"line\">        calBar(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        setTransParentBackground();</span><br><span class=\"line\">        setPosition(Position.TOP);</span><br><span class=\"line\">        View rootView = LayoutInflater.from(context).inflate(R.layout.dialog_view4, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">        mViewHolder = <span class=\"keyword\">new</span> ViewHolder(rootView);</span><br><span class=\"line\">        addContentView(rootView);</span><br><span class=\"line\">        mViewHolder.btn13.setOnClickListener(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">        mViewHolder.btn14.setOnClickListener(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">        mViewHolder.btn15.setOnClickListener(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onClick</span><span class=\"params\">(View v)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (mListener != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            mListener.onClick(((Button)v).getText().toString());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ViewHolder</span></span></span><br><span class=\"line\"><span class=\"class\">    </span>&#123;</span><br><span class=\"line\">        Button btn13, btn14, btn15;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ViewHolder</span><span class=\"params\">(View rootView)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            btn13 = rootView.findViewById(R.id.button13);</span><br><span class=\"line\">            btn14 = rootView.findViewById(R.id.button14);</span><br><span class=\"line\">            btn15 = rootView.findViewById(R.id.button15);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setClickListener</span><span class=\"params\">(OnClickCustomButtonListener l)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.mListener = l;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">OnClickCustomButtonListener</span></span></span><br><span class=\"line\"><span class=\"class\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">onClick</span><span class=\"params\">(String str)</span></span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>3、显示</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CustomOperateDialog codDialog = <span class=\"keyword\">new</span> CustomOperateDialog(<span class=\"keyword\">this</span>)</span><br><span class=\"line\">        .setPosition(mPosition)</span><br><span class=\"line\">        .setClickedView(mButton10);</span><br><span class=\"line\">codDialog.setClickListener(<span class=\"keyword\">new</span> CustomOperateDialog.OnClickCustomButtonListener()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onClick</span><span class=\"params\">(String str)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        mButton10.setText(<span class=\"string\">\"点击了：\"</span> + str);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">codDialog.show();</span><br></pre></td></tr></table></figure>\n<h3 id=\"查看关于BappyDialog的使用代码\"><a href=\"#查看关于BappyDialog的使用代码\" class=\"headerlink\" title=\"查看关于BappyDialog的使用代码\"></a>查看关于BappyDialog的使用代码</h3><p><a href=\"app/src/main/java/com/xujiaji/happybubbletest/TestDialogActivity.java\">TestDialogActivity 代码</a></p>\n<h3 id=\"写法建议\"><a href=\"#写法建议\" class=\"headerlink\" title=\"写法建议\"></a>写法建议</h3><p>根据<a href=\"https://juejin.im/user/57bda1ada633bd005d4bc2a9\" target=\"_blank\" rel=\"noopener\">@hm</a>该朋友在<a href=\"https://juejin.im/post/5a333f0af265da431523f408\" target=\"_blank\" rel=\"noopener\">文章</a>中反馈的多次点击后位置不对的问题，是由于多次对BappyDialog进行了设置导致，所以建议下方写法。(当然如果对重复调用setClickedView()方法设置不同的被点击的控件来更新位置有需要，是需要写在外面的。)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(mBubbleDialog == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    mBubbleDialog = <span class=\"keyword\">new</span> BubbleDialog(<span class=\"keyword\">this</span>)</span><br><span class=\"line\">        .addContentView(LayoutInflater.from(<span class=\"keyword\">this</span>).inflate(R.layout.dialog_view3, <span class=\"keyword\">null</span>))</span><br><span class=\"line\">        .setClickedView(mButton4)</span><br><span class=\"line\">        .setPosition(mPosition)</span><br><span class=\"line\">        .setOffsetY(<span class=\"number\">8</span>)</span><br><span class=\"line\">        .calBar(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">mBubbleDialog.show();</span><br></pre></td></tr></table></figure>\n<hr>\n<h2 id=\"如何使用-HappyBubble-BubbleLayout\"><a href=\"#如何使用-HappyBubble-BubbleLayout\" class=\"headerlink\" title=\"如何使用 HappyBubble-BubbleLayout?\"></a>如何使用 HappyBubble-BubbleLayout?</h2><h3 id=\"在XML代码中设置属性值\"><a href=\"#在XML代码中设置属性值\" class=\"headerlink\" title=\"在XML代码中设置属性值\"></a>在XML代码中设置属性值</h3><blockquote>\n<p>属性参照表</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">属性</th>\n<th style=\"text-align:center\">值</th>\n<th style=\"text-align:left\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">lookAt</td>\n<td style=\"text-align:center\">left, top, right, bottom</td>\n<td style=\"text-align:left\">箭头指向</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">lookLength</td>\n<td style=\"text-align:center\">dimension</td>\n<td style=\"text-align:left\">箭头的长度</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">lookPosition</td>\n<td style=\"text-align:center\">dimension</td>\n<td style=\"text-align:left\">箭头相对于x或y轴的位置</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">lookWidth</td>\n<td style=\"text-align:center\">dimension</td>\n<td style=\"text-align:left\">箭头的宽度</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">bubbleColor</td>\n<td style=\"text-align:center\">color</td>\n<td style=\"text-align:left\">气泡的颜色</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">bubbleRadius</td>\n<td style=\"text-align:center\">dimension</td>\n<td style=\"text-align:left\">气泡四角的圆弧</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">bubblePadding</td>\n<td style=\"text-align:center\">dimension</td>\n<td style=\"text-align:left\">气泡边缘到内容的距离</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">shadowRadius</td>\n<td style=\"text-align:center\">dimension</td>\n<td style=\"text-align:left\">阴影的扩散大小</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">shadowX</td>\n<td style=\"text-align:center\">dimension</td>\n<td style=\"text-align:left\">阴影在x轴方向的偏移</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">shadowY</td>\n<td style=\"text-align:center\">dimension</td>\n<td style=\"text-align:left\">阴影在y轴方向的偏移</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">shadowColor</td>\n<td style=\"text-align:center\">color</td>\n<td style=\"text-align:left\">阴影的颜色</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>xml 例子</p>\n</blockquote>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">com.xujiaji.happybubble.BubbleLayout</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:app</span>=<span class=\"string\">\"http://schemas.android.com/apk/res-auto\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:id</span>=<span class=\"string\">\"@+id/bubbleLayout\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:layout_width</span>=<span class=\"string\">\"match_parent\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:layout_height</span>=<span class=\"string\">\"200dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:layout_margin</span>=<span class=\"string\">\"16dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:lookAt</span>=<span class=\"string\">\"left\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:lookLength</span>=<span class=\"string\">\"16dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:lookPosition</span>=<span class=\"string\">\"20dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:lookWidth</span>=<span class=\"string\">\"16dp\"</span> /&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"在java代码中定义属性值。\"><a href=\"#在java代码中定义属性值。\" class=\"headerlink\" title=\"在java代码中定义属性值。\"></a>在java代码中定义属性值。</h3><blockquote>\n<p>BubbleLayout 通过“set属性名”方法和invalidate方法来更新BubbleLayout。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mBubbleLayout.setLook(BubbleLayout.Look.LEFT);</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>查看更多</p>\n</blockquote>\n<p><a href=\"app/src/main/java/com/xujiaji/happybubbletest/MainActivity.java\">MainActivity 代码</a></p>\n<p><img src=\"image/happy-bubble/gif1.gif\" alt=\"GIF\"></p>\n<h3 id=\"demo-下载\"><a href=\"#demo-下载\" class=\"headerlink\" title=\"demo 下载\"></a>demo 下载</h3><p><a href=\"https://github.com/xujiaji/HappyBubble/releases\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/Download-demo--apk-brightgreen.svg\" alt=\"GitHub release\"></a></p>\n<hr>\n<h1 id=\"License\"><a href=\"#License\" class=\"headerlink\" title=\"License\"></a>License</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Copyright 2016 XuJiaji</span><br><span class=\"line\"></span><br><span class=\"line\">Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><br><span class=\"line\">you may not use this file except in compliance with the License.</span><br><span class=\"line\">You may obtain a copy of the License at</span><br><span class=\"line\"></span><br><span class=\"line\">    http://www.apache.org/licenses/LICENSE-2.0</span><br><span class=\"line\"></span><br><span class=\"line\">Unless required by applicable law or agreed to in writing, software</span><br><span class=\"line\">distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br><span class=\"line\">WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class=\"line\">See the License for the specific language governing permissions and</span><br><span class=\"line\">limitations under the License.</span><br></pre></td></tr></table></figure>\n","prev":{"title":"Android开发笔记","slug":"android-notes"},"next":{"title":"Android开发中的bug清单","slug":"android-bug-list"}}